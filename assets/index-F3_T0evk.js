(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var hr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $g(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var rp={exports:{}},Ao={},np={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pa=Symbol.for("react.element"),Wg=Symbol.for("react.portal"),zg=Symbol.for("react.fragment"),Hg=Symbol.for("react.strict_mode"),Vg=Symbol.for("react.profiler"),Kg=Symbol.for("react.provider"),Gg=Symbol.for("react.context"),Xg=Symbol.for("react.forward_ref"),qg=Symbol.for("react.suspense"),Yg=Symbol.for("react.memo"),Jg=Symbol.for("react.lazy"),Bf=Symbol.iterator;function Qg(e){return e===null||typeof e!="object"?null:(e=Bf&&e[Bf]||e["@@iterator"],typeof e=="function"?e:null)}var sp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ip=Object.assign,ap={};function hi(e,t,r){this.props=e,this.context=t,this.refs=ap,this.updater=r||sp}hi.prototype.isReactComponent={};hi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};hi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lp(){}lp.prototype=hi.prototype;function a0(e,t,r){this.props=e,this.context=t,this.refs=ap,this.updater=r||sp}var l0=a0.prototype=new lp;l0.constructor=a0;ip(l0,hi.prototype);l0.isPureReactComponent=!0;var Uf=Array.isArray,op=Object.prototype.hasOwnProperty,o0={current:null},cp={key:!0,ref:!0,__self:!0,__source:!0};function up(e,t,r){var n,s={},i=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)op.call(t,n)&&!cp.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var o=Array(l),c=0;c<l;c++)o[c]=arguments[c+2];s.children=o}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Pa,type:e,key:i,ref:a,props:s,_owner:o0.current}}function Zg(e,t){return{$$typeof:Pa,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function c0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Pa}function ev(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var $f=/\/+/g;function oc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ev(""+e.key):t.toString(36)}function Cl(e,t,r,n,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Pa:case Wg:a=!0}}if(a)return a=e,s=s(a),e=n===""?"."+oc(a,0):n,Uf(s)?(r="",e!=null&&(r=e.replace($f,"$&/")+"/"),Cl(s,t,r,"",function(c){return c})):s!=null&&(c0(s)&&(s=Zg(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace($f,"$&/")+"/")+e)),t.push(s)),1;if(a=0,n=n===""?".":n+":",Uf(e))for(var l=0;l<e.length;l++){i=e[l];var o=n+oc(i,l);a+=Cl(i,t,r,o,s)}else if(o=Qg(e),typeof o=="function")for(e=o.call(e),l=0;!(i=e.next()).done;)i=i.value,o=n+oc(i,l++),a+=Cl(i,t,r,o,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Za(e,t,r){if(e==null)return e;var n=[],s=0;return Cl(e,n,"","",function(i){return t.call(r,i,s++)}),n}function tv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Mt={current:null},bl={transition:null},rv={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:bl,ReactCurrentOwner:o0};function fp(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Za,forEach:function(e,t,r){Za(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Za(e,function(){t++}),t},toArray:function(e){return Za(e,function(t){return t})||[]},only:function(e){if(!c0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=hi;ke.Fragment=zg;ke.Profiler=Vg;ke.PureComponent=a0;ke.StrictMode=Hg;ke.Suspense=qg;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rv;ke.act=fp;ke.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=ip({},e.props),s=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=o0.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(o in t)op.call(t,o)&&!cp.hasOwnProperty(o)&&(n[o]=t[o]===void 0&&l!==void 0?l[o]:t[o])}var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){l=Array(o);for(var c=0;c<o;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:Pa,type:e.type,key:s,ref:i,props:n,_owner:a}};ke.createContext=function(e){return e={$$typeof:Gg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Kg,_context:e},e.Consumer=e};ke.createElement=up;ke.createFactory=function(e){var t=up.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:Xg,render:e}};ke.isValidElement=c0;ke.lazy=function(e){return{$$typeof:Jg,_payload:{_status:-1,_result:e},_init:tv}};ke.memo=function(e,t){return{$$typeof:Yg,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=bl.transition;bl.transition={};try{e()}finally{bl.transition=t}};ke.unstable_act=fp;ke.useCallback=function(e,t){return Mt.current.useCallback(e,t)};ke.useContext=function(e){return Mt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return Mt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return Mt.current.useEffect(e,t)};ke.useId=function(){return Mt.current.useId()};ke.useImperativeHandle=function(e,t,r){return Mt.current.useImperativeHandle(e,t,r)};ke.useInsertionEffect=function(e,t){return Mt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return Mt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return Mt.current.useMemo(e,t)};ke.useReducer=function(e,t,r){return Mt.current.useReducer(e,t,r)};ke.useRef=function(e){return Mt.current.useRef(e)};ke.useState=function(e){return Mt.current.useState(e)};ke.useSyncExternalStore=function(e,t,r){return Mt.current.useSyncExternalStore(e,t,r)};ke.useTransition=function(){return Mt.current.useTransition()};ke.version="18.3.1";np.exports=ke;var ee=np.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nv=ee,sv=Symbol.for("react.element"),iv=Symbol.for("react.fragment"),av=Object.prototype.hasOwnProperty,lv=nv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ov={key:!0,ref:!0,__self:!0,__source:!0};function dp(e,t,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)av.call(t,n)&&!ov.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:sv,type:e,key:i,ref:a,props:s,_owner:lv.current}}Ao.Fragment=iv;Ao.jsx=dp;Ao.jsxs=dp;rp.exports=Ao;var u=rp.exports,hp={exports:{}},sr={},pp={exports:{}},mp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Y,le){var I=Y.length;Y.push(le);e:for(;0<I;){var pe=I-1>>>1,O=Y[pe];if(0<s(O,le))Y[pe]=le,Y[I]=O,I=pe;else break e}}function r(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var le=Y[0],I=Y.pop();if(I!==le){Y[0]=I;e:for(var pe=0,O=Y.length,P=O>>>1;pe<P;){var R=2*(pe+1)-1,D=Y[R],V=R+1,oe=Y[V];if(0>s(D,I))V<O&&0>s(oe,D)?(Y[pe]=oe,Y[V]=I,pe=V):(Y[pe]=D,Y[R]=I,pe=R);else if(V<O&&0>s(oe,I))Y[pe]=oe,Y[V]=I,pe=V;else break e}}return le}function s(Y,le){var I=Y.sortIndex-le.sortIndex;return I!==0?I:Y.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var o=[],c=[],f=1,d=null,h=3,m=!1,x=!1,p=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(Y){for(var le=r(c);le!==null;){if(le.callback===null)n(c);else if(le.startTime<=Y)n(c),le.sortIndex=le.expirationTime,t(o,le);else break;le=r(c)}}function S(Y){if(p=!1,g(Y),!x)if(r(o)!==null)x=!0,J(j);else{var le=r(c);le!==null&&ye(S,le.startTime-Y)}}function j(Y,le){x=!1,p&&(p=!1,v(F),F=-1),m=!0;var I=h;try{for(g(le),d=r(o);d!==null&&(!(d.expirationTime>le)||Y&&!G());){var pe=d.callback;if(typeof pe=="function"){d.callback=null,h=d.priorityLevel;var O=pe(d.expirationTime<=le);le=e.unstable_now(),typeof O=="function"?d.callback=O:d===r(o)&&n(o),g(le)}else n(o);d=r(o)}if(d!==null)var P=!0;else{var R=r(c);R!==null&&ye(S,R.startTime-le),P=!1}return P}finally{d=null,h=I,m=!1}}var N=!1,k=null,F=-1,L=5,B=-1;function G(){return!(e.unstable_now()-B<L)}function q(){if(k!==null){var Y=e.unstable_now();B=Y;var le=!0;try{le=k(!0,Y)}finally{le?se():(N=!1,k=null)}}else N=!1}var se;if(typeof y=="function")se=function(){y(q)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ve=de.port2;de.port1.onmessage=q,se=function(){ve.postMessage(null)}}else se=function(){_(q,0)};function J(Y){k=Y,N||(N=!0,se())}function ye(Y,le){F=_(function(){Y(e.unstable_now())},le)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){x||m||(x=!0,J(j))},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(o)},e.unstable_next=function(Y){switch(h){case 1:case 2:case 3:var le=3;break;default:le=h}var I=h;h=le;try{return Y()}finally{h=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,le){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var I=h;h=Y;try{return le()}finally{h=I}},e.unstable_scheduleCallback=function(Y,le,I){var pe=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?pe+I:pe):I=pe,Y){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=I+O,Y={id:f++,callback:le,priorityLevel:Y,startTime:I,expirationTime:O,sortIndex:-1},I>pe?(Y.sortIndex=I,t(c,Y),r(o)===null&&Y===r(c)&&(p?(v(F),F=-1):p=!0,ye(S,I-pe))):(Y.sortIndex=O,t(o,Y),x||m||(x=!0,J(j))),Y},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(Y){var le=h;return function(){var I=h;h=le;try{return Y.apply(this,arguments)}finally{h=I}}}})(mp);pp.exports=mp;var cv=pp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uv=ee,rr=cv;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xp=new Set,aa={};function hs(e,t){si(e,t),si(e+"Capture",t)}function si(e,t){for(aa[e]=t,e=0;e<t.length;e++)xp.add(t[e])}var tn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jc=Object.prototype.hasOwnProperty,fv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wf={},zf={};function dv(e){return Jc.call(zf,e)?!0:Jc.call(Wf,e)?!1:fv.test(e)?zf[e]=!0:(Wf[e]=!0,!1)}function hv(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function pv(e,t,r,n){if(t===null||typeof t>"u"||hv(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Bt(e,t,r,n,s,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var Et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Et[e]=new Bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Et[t]=new Bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Et[e]=new Bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Et[e]=new Bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Et[e]=new Bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Et[e]=new Bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Et[e]=new Bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Et[e]=new Bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Et[e]=new Bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var u0=/[\-:]([a-z])/g;function f0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(u0,f0);Et[t]=new Bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(u0,f0);Et[t]=new Bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(u0,f0);Et[t]=new Bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Et[e]=new Bt(e,1,!1,e.toLowerCase(),null,!1,!1)});Et.xlinkHref=new Bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Et[e]=new Bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function d0(e,t,r,n){var s=Et.hasOwnProperty(t)?Et[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(pv(t,r,s,n)&&(r=null),n||s===null?dv(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var on=uv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,el=Symbol.for("react.element"),Rs=Symbol.for("react.portal"),Is=Symbol.for("react.fragment"),h0=Symbol.for("react.strict_mode"),Qc=Symbol.for("react.profiler"),gp=Symbol.for("react.provider"),vp=Symbol.for("react.context"),p0=Symbol.for("react.forward_ref"),Zc=Symbol.for("react.suspense"),eu=Symbol.for("react.suspense_list"),m0=Symbol.for("react.memo"),pn=Symbol.for("react.lazy"),yp=Symbol.for("react.offscreen"),Hf=Symbol.iterator;function Ni(e){return e===null||typeof e!="object"?null:(e=Hf&&e[Hf]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Object.assign,cc;function Di(e){if(cc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);cc=t&&t[1]||""}return`
`+cc+e}var uc=!1;function fc(e,t){if(!e||uc)return"";uc=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var o=`
`+s[a].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}while(1<=a&&0<=l);break}}}finally{uc=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Di(e):""}function mv(e){switch(e.tag){case 5:return Di(e.type);case 16:return Di("Lazy");case 13:return Di("Suspense");case 19:return Di("SuspenseList");case 0:case 2:case 15:return e=fc(e.type,!1),e;case 11:return e=fc(e.type.render,!1),e;case 1:return e=fc(e.type,!0),e;default:return""}}function tu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Is:return"Fragment";case Rs:return"Portal";case Qc:return"Profiler";case h0:return"StrictMode";case Zc:return"Suspense";case eu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vp:return(e.displayName||"Context")+".Consumer";case gp:return(e._context.displayName||"Context")+".Provider";case p0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case m0:return t=e.displayName||null,t!==null?t:tu(e.type)||"Memo";case pn:t=e._payload,e=e._init;try{return tu(e(t))}catch{}}return null}function xv(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tu(t);case 8:return t===h0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _p(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function gv(e){var t=_p(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function tl(e){e._valueTracker||(e._valueTracker=gv(e))}function wp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_p(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ul(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ru(e,t){var r=t.checked;return qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Vf(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=jn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Sp(e,t){t=t.checked,t!=null&&d0(e,"checked",t,!1)}function nu(e,t){Sp(e,t);var r=jn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?su(e,t.type,r):t.hasOwnProperty("defaultValue")&&su(e,t.type,jn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Kf(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function su(e,t,r){(t!=="number"||Ul(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Li=Array.isArray;function Xs(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+jn(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function iu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gf(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Z(92));if(Li(r)){if(1<r.length)throw Error(Z(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:jn(r)}}function Ep(e,t){var r=jn(t.value),n=jn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Xf(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Tp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function au(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Tp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rl,kp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function la(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vv=["Webkit","ms","Moz","O"];Object.keys(Wi).forEach(function(e){vv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wi[t]=Wi[e]})});function Np(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wi.hasOwnProperty(e)&&Wi[e]?(""+t).trim():t+"px"}function Ap(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Np(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var yv=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lu(e,t){if(t){if(yv[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function ou(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cu=null;function x0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var uu=null,qs=null,Ys=null;function qf(e){if(e=Da(e)){if(typeof uu!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=jo(t),uu(e.stateNode,e.type,t))}}function Cp(e){qs?Ys?Ys.push(e):Ys=[e]:qs=e}function bp(){if(qs){var e=qs,t=Ys;if(Ys=qs=null,qf(e),t)for(e=0;e<t.length;e++)qf(t[e])}}function Op(e,t){return e(t)}function Fp(){}var dc=!1;function jp(e,t,r){if(dc)return e(t,r);dc=!0;try{return Op(e,t,r)}finally{dc=!1,(qs!==null||Ys!==null)&&(Fp(),bp())}}function oa(e,t){var r=e.stateNode;if(r===null)return null;var n=jo(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Z(231,t,typeof r));return r}var fu=!1;if(tn)try{var Ai={};Object.defineProperty(Ai,"passive",{get:function(){fu=!0}}),window.addEventListener("test",Ai,Ai),window.removeEventListener("test",Ai,Ai)}catch{fu=!1}function _v(e,t,r,n,s,i,a,l,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var zi=!1,$l=null,Wl=!1,du=null,wv={onError:function(e){zi=!0,$l=e}};function Sv(e,t,r,n,s,i,a,l,o){zi=!1,$l=null,_v.apply(wv,arguments)}function Ev(e,t,r,n,s,i,a,l,o){if(Sv.apply(this,arguments),zi){if(zi){var c=$l;zi=!1,$l=null}else throw Error(Z(198));Wl||(Wl=!0,du=c)}}function ps(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Pp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Yf(e){if(ps(e)!==e)throw Error(Z(188))}function Tv(e){var t=e.alternate;if(!t){if(t=ps(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Yf(s),e;if(i===n)return Yf(s),t;i=i.sibling}throw Error(Z(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(Z(189))}}if(r.alternate!==n)throw Error(Z(190))}if(r.tag!==3)throw Error(Z(188));return r.stateNode.current===r?e:t}function Rp(e){return e=Tv(e),e!==null?Ip(e):null}function Ip(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Ip(e);if(t!==null)return t;e=e.sibling}return null}var Dp=rr.unstable_scheduleCallback,Jf=rr.unstable_cancelCallback,kv=rr.unstable_shouldYield,Nv=rr.unstable_requestPaint,tt=rr.unstable_now,Av=rr.unstable_getCurrentPriorityLevel,g0=rr.unstable_ImmediatePriority,Lp=rr.unstable_UserBlockingPriority,zl=rr.unstable_NormalPriority,Cv=rr.unstable_LowPriority,Mp=rr.unstable_IdlePriority,Co=null,Br=null;function bv(e){if(Br&&typeof Br.onCommitFiberRoot=="function")try{Br.onCommitFiberRoot(Co,e,void 0,(e.current.flags&128)===128)}catch{}}var Ar=Math.clz32?Math.clz32:jv,Ov=Math.log,Fv=Math.LN2;function jv(e){return e>>>=0,e===0?32:31-(Ov(e)/Fv|0)|0}var nl=64,sl=4194304;function Mi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Hl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,i=e.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=Mi(l):(i&=a,i!==0&&(n=Mi(i)))}else a=r&~s,a!==0?n=Mi(a):i!==0&&(n=Mi(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ar(t),s=1<<r,n|=e[r],t&=~s;return n}function Pv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rv(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-Ar(i),l=1<<a,o=s[a];o===-1?(!(l&r)||l&n)&&(s[a]=Pv(l,t)):o<=t&&(e.expiredLanes|=l),i&=~l}}function hu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bp(){var e=nl;return nl<<=1,!(nl&4194240)&&(nl=64),e}function hc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ra(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ar(t),e[t]=r}function Iv(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Ar(r),i=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~i}}function v0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ar(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Ie=0;function Up(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $p,y0,Wp,zp,Hp,pu=!1,il=[],Tn=null,kn=null,Nn=null,ca=new Map,ua=new Map,xn=[],Dv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qf(e,t){switch(e){case"focusin":case"focusout":Tn=null;break;case"dragenter":case"dragleave":kn=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":ca.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ua.delete(t.pointerId)}}function Ci(e,t,r,n,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Da(t),t!==null&&y0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Lv(e,t,r,n,s){switch(t){case"focusin":return Tn=Ci(Tn,e,t,r,n,s),!0;case"dragenter":return kn=Ci(kn,e,t,r,n,s),!0;case"mouseover":return Nn=Ci(Nn,e,t,r,n,s),!0;case"pointerover":var i=s.pointerId;return ca.set(i,Ci(ca.get(i)||null,e,t,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,ua.set(i,Ci(ua.get(i)||null,e,t,r,n,s)),!0}return!1}function Vp(e){var t=Zn(e.target);if(t!==null){var r=ps(t);if(r!==null){if(t=r.tag,t===13){if(t=Pp(r),t!==null){e.blockedOn=t,Hp(e.priority,function(){Wp(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ol(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=mu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);cu=n,r.target.dispatchEvent(n),cu=null}else return t=Da(r),t!==null&&y0(t),e.blockedOn=r,!1;t.shift()}return!0}function Zf(e,t,r){Ol(e)&&r.delete(t)}function Mv(){pu=!1,Tn!==null&&Ol(Tn)&&(Tn=null),kn!==null&&Ol(kn)&&(kn=null),Nn!==null&&Ol(Nn)&&(Nn=null),ca.forEach(Zf),ua.forEach(Zf)}function bi(e,t){e.blockedOn===t&&(e.blockedOn=null,pu||(pu=!0,rr.unstable_scheduleCallback(rr.unstable_NormalPriority,Mv)))}function fa(e){function t(s){return bi(s,e)}if(0<il.length){bi(il[0],e);for(var r=1;r<il.length;r++){var n=il[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Tn!==null&&bi(Tn,e),kn!==null&&bi(kn,e),Nn!==null&&bi(Nn,e),ca.forEach(t),ua.forEach(t),r=0;r<xn.length;r++)n=xn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<xn.length&&(r=xn[0],r.blockedOn===null);)Vp(r),r.blockedOn===null&&xn.shift()}var Js=on.ReactCurrentBatchConfig,Vl=!0;function Bv(e,t,r,n){var s=Ie,i=Js.transition;Js.transition=null;try{Ie=1,_0(e,t,r,n)}finally{Ie=s,Js.transition=i}}function Uv(e,t,r,n){var s=Ie,i=Js.transition;Js.transition=null;try{Ie=4,_0(e,t,r,n)}finally{Ie=s,Js.transition=i}}function _0(e,t,r,n){if(Vl){var s=mu(e,t,r,n);if(s===null)Ec(e,t,n,Kl,r),Qf(e,n);else if(Lv(s,e,t,r,n))n.stopPropagation();else if(Qf(e,n),t&4&&-1<Dv.indexOf(e)){for(;s!==null;){var i=Da(s);if(i!==null&&$p(i),i=mu(e,t,r,n),i===null&&Ec(e,t,n,Kl,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Ec(e,t,n,null,r)}}var Kl=null;function mu(e,t,r,n){if(Kl=null,e=x0(n),e=Zn(e),e!==null)if(t=ps(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Pp(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kl=e,null}function Kp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Av()){case g0:return 1;case Lp:return 4;case zl:case Cv:return 16;case Mp:return 536870912;default:return 16}default:return 16}}var yn=null,w0=null,Fl=null;function Gp(){if(Fl)return Fl;var e,t=w0,r=t.length,n,s="value"in yn?yn.value:yn.textContent,i=s.length;for(e=0;e<r&&t[e]===s[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===s[i-n];n++);return Fl=s.slice(e,1<n?1-n:void 0)}function jl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function al(){return!0}function ed(){return!1}function ir(e){function t(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?al:ed,this.isPropagationStopped=ed,this}return qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),t}var pi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},S0=ir(pi),Ia=qe({},pi,{view:0,detail:0}),$v=ir(Ia),pc,mc,Oi,bo=qe({},Ia,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:E0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oi&&(Oi&&e.type==="mousemove"?(pc=e.screenX-Oi.screenX,mc=e.screenY-Oi.screenY):mc=pc=0,Oi=e),pc)},movementY:function(e){return"movementY"in e?e.movementY:mc}}),td=ir(bo),Wv=qe({},bo,{dataTransfer:0}),zv=ir(Wv),Hv=qe({},Ia,{relatedTarget:0}),xc=ir(Hv),Vv=qe({},pi,{animationName:0,elapsedTime:0,pseudoElement:0}),Kv=ir(Vv),Gv=qe({},pi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xv=ir(Gv),qv=qe({},pi,{data:0}),rd=ir(qv),Yv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Qv[e])?!!t[e]:!1}function E0(){return Zv}var ey=qe({},Ia,{key:function(e){if(e.key){var t=Yv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Jv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:E0,charCode:function(e){return e.type==="keypress"?jl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ty=ir(ey),ry=qe({},bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nd=ir(ry),ny=qe({},Ia,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:E0}),sy=ir(ny),iy=qe({},pi,{propertyName:0,elapsedTime:0,pseudoElement:0}),ay=ir(iy),ly=qe({},bo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),oy=ir(ly),cy=[9,13,27,32],T0=tn&&"CompositionEvent"in window,Hi=null;tn&&"documentMode"in document&&(Hi=document.documentMode);var uy=tn&&"TextEvent"in window&&!Hi,Xp=tn&&(!T0||Hi&&8<Hi&&11>=Hi),sd=" ",id=!1;function qp(e,t){switch(e){case"keyup":return cy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ds=!1;function fy(e,t){switch(e){case"compositionend":return Yp(t);case"keypress":return t.which!==32?null:(id=!0,sd);case"textInput":return e=t.data,e===sd&&id?null:e;default:return null}}function dy(e,t){if(Ds)return e==="compositionend"||!T0&&qp(e,t)?(e=Gp(),Fl=w0=yn=null,Ds=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xp&&t.locale!=="ko"?null:t.data;default:return null}}var hy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ad(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!hy[e.type]:t==="textarea"}function Jp(e,t,r,n){Cp(n),t=Gl(t,"onChange"),0<t.length&&(r=new S0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Vi=null,da=null;function py(e){om(e,0)}function Oo(e){var t=Bs(e);if(wp(t))return e}function my(e,t){if(e==="change")return t}var Qp=!1;if(tn){var gc;if(tn){var vc="oninput"in document;if(!vc){var ld=document.createElement("div");ld.setAttribute("oninput","return;"),vc=typeof ld.oninput=="function"}gc=vc}else gc=!1;Qp=gc&&(!document.documentMode||9<document.documentMode)}function od(){Vi&&(Vi.detachEvent("onpropertychange",Zp),da=Vi=null)}function Zp(e){if(e.propertyName==="value"&&Oo(da)){var t=[];Jp(t,da,e,x0(e)),jp(py,t)}}function xy(e,t,r){e==="focusin"?(od(),Vi=t,da=r,Vi.attachEvent("onpropertychange",Zp)):e==="focusout"&&od()}function gy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Oo(da)}function vy(e,t){if(e==="click")return Oo(t)}function yy(e,t){if(e==="input"||e==="change")return Oo(t)}function _y(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Or=typeof Object.is=="function"?Object.is:_y;function ha(e,t){if(Or(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Jc.call(t,s)||!Or(e[s],t[s]))return!1}return!0}function cd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ud(e,t){var r=cd(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cd(r)}}function em(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?em(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tm(){for(var e=window,t=Ul();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ul(e.document)}return t}function k0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wy(e){var t=tm(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&em(r.ownerDocument.documentElement,r)){if(n!==null&&k0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!e.extend&&i>n&&(s=n,n=i,i=s),s=ud(r,i);var a=ud(r,n);s&&a&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Sy=tn&&"documentMode"in document&&11>=document.documentMode,Ls=null,xu=null,Ki=null,gu=!1;function fd(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;gu||Ls==null||Ls!==Ul(n)||(n=Ls,"selectionStart"in n&&k0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ki&&ha(Ki,n)||(Ki=n,n=Gl(xu,"onSelect"),0<n.length&&(t=new S0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ls)))}function ll(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ms={animationend:ll("Animation","AnimationEnd"),animationiteration:ll("Animation","AnimationIteration"),animationstart:ll("Animation","AnimationStart"),transitionend:ll("Transition","TransitionEnd")},yc={},rm={};tn&&(rm=document.createElement("div").style,"AnimationEvent"in window||(delete Ms.animationend.animation,delete Ms.animationiteration.animation,delete Ms.animationstart.animation),"TransitionEvent"in window||delete Ms.transitionend.transition);function Fo(e){if(yc[e])return yc[e];if(!Ms[e])return e;var t=Ms[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in rm)return yc[e]=t[r];return e}var nm=Fo("animationend"),sm=Fo("animationiteration"),im=Fo("animationstart"),am=Fo("transitionend"),lm=new Map,dd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ln(e,t){lm.set(e,t),hs(t,[e])}for(var _c=0;_c<dd.length;_c++){var wc=dd[_c],Ey=wc.toLowerCase(),Ty=wc[0].toUpperCase()+wc.slice(1);Ln(Ey,"on"+Ty)}Ln(nm,"onAnimationEnd");Ln(sm,"onAnimationIteration");Ln(im,"onAnimationStart");Ln("dblclick","onDoubleClick");Ln("focusin","onFocus");Ln("focusout","onBlur");Ln(am,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ky=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bi));function hd(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ev(n,t,void 0,e),e.currentTarget=null}function om(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var a=n.length-1;0<=a;a--){var l=n[a],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==i&&s.isPropagationStopped())break e;hd(s,l,c),i=o}else for(a=0;a<n.length;a++){if(l=n[a],o=l.instance,c=l.currentTarget,l=l.listener,o!==i&&s.isPropagationStopped())break e;hd(s,l,c),i=o}}}if(Wl)throw e=du,Wl=!1,du=null,e}function Ue(e,t){var r=t[Su];r===void 0&&(r=t[Su]=new Set);var n=e+"__bubble";r.has(n)||(cm(t,e,2,!1),r.add(n))}function Sc(e,t,r){var n=0;t&&(n|=4),cm(r,e,n,t)}var ol="_reactListening"+Math.random().toString(36).slice(2);function pa(e){if(!e[ol]){e[ol]=!0,xp.forEach(function(r){r!=="selectionchange"&&(ky.has(r)||Sc(r,!1,e),Sc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ol]||(t[ol]=!0,Sc("selectionchange",!1,t))}}function cm(e,t,r,n){switch(Kp(t)){case 1:var s=Bv;break;case 4:s=Uv;break;default:s=_0}r=s.bind(null,t,r,e),s=void 0,!fu||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Ec(e,t,r,n,s){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var o=a.tag;if((o===3||o===4)&&(o=a.stateNode.containerInfo,o===s||o.nodeType===8&&o.parentNode===s))return;a=a.return}for(;l!==null;){if(a=Zn(l),a===null)return;if(o=a.tag,o===5||o===6){n=i=a;continue e}l=l.parentNode}}n=n.return}jp(function(){var c=i,f=x0(r),d=[];e:{var h=lm.get(e);if(h!==void 0){var m=S0,x=e;switch(e){case"keypress":if(jl(r)===0)break e;case"keydown":case"keyup":m=ty;break;case"focusin":x="focus",m=xc;break;case"focusout":x="blur",m=xc;break;case"beforeblur":case"afterblur":m=xc;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=td;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=zv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=sy;break;case nm:case sm:case im:m=Kv;break;case am:m=ay;break;case"scroll":m=$v;break;case"wheel":m=oy;break;case"copy":case"cut":case"paste":m=Xv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=nd}var p=(t&4)!==0,_=!p&&e==="scroll",v=p?h!==null?h+"Capture":null:h;p=[];for(var y=c,g;y!==null;){g=y;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,v!==null&&(S=oa(y,v),S!=null&&p.push(ma(y,S,g)))),_)break;y=y.return}0<p.length&&(h=new m(h,x,null,r,f),d.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==cu&&(x=r.relatedTarget||r.fromElement)&&(Zn(x)||x[rn]))break e;if((m||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=c,x=x?Zn(x):null,x!==null&&(_=ps(x),x!==_||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=c),m!==x)){if(p=td,S="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(p=nd,S="onPointerLeave",v="onPointerEnter",y="pointer"),_=m==null?h:Bs(m),g=x==null?h:Bs(x),h=new p(S,y+"leave",m,r,f),h.target=_,h.relatedTarget=g,S=null,Zn(f)===c&&(p=new p(v,y+"enter",x,r,f),p.target=g,p.relatedTarget=_,S=p),_=S,m&&x)t:{for(p=m,v=x,y=0,g=p;g;g=Ss(g))y++;for(g=0,S=v;S;S=Ss(S))g++;for(;0<y-g;)p=Ss(p),y--;for(;0<g-y;)v=Ss(v),g--;for(;y--;){if(p===v||v!==null&&p===v.alternate)break t;p=Ss(p),v=Ss(v)}p=null}else p=null;m!==null&&pd(d,h,m,p,!1),x!==null&&_!==null&&pd(d,_,x,p,!0)}}e:{if(h=c?Bs(c):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var j=my;else if(ad(h))if(Qp)j=yy;else{j=gy;var N=xy}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=vy);if(j&&(j=j(e,c))){Jp(d,j,r,f);break e}N&&N(e,h,c),e==="focusout"&&(N=h._wrapperState)&&N.controlled&&h.type==="number"&&su(h,"number",h.value)}switch(N=c?Bs(c):window,e){case"focusin":(ad(N)||N.contentEditable==="true")&&(Ls=N,xu=c,Ki=null);break;case"focusout":Ki=xu=Ls=null;break;case"mousedown":gu=!0;break;case"contextmenu":case"mouseup":case"dragend":gu=!1,fd(d,r,f);break;case"selectionchange":if(Sy)break;case"keydown":case"keyup":fd(d,r,f)}var k;if(T0)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else Ds?qp(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(Xp&&r.locale!=="ko"&&(Ds||F!=="onCompositionStart"?F==="onCompositionEnd"&&Ds&&(k=Gp()):(yn=f,w0="value"in yn?yn.value:yn.textContent,Ds=!0)),N=Gl(c,F),0<N.length&&(F=new rd(F,e,null,r,f),d.push({event:F,listeners:N}),k?F.data=k:(k=Yp(r),k!==null&&(F.data=k)))),(k=uy?fy(e,r):dy(e,r))&&(c=Gl(c,"onBeforeInput"),0<c.length&&(f=new rd("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=k))}om(d,t)})}function ma(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gl(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=oa(e,r),i!=null&&n.unshift(ma(e,i,s)),i=oa(e,t),i!=null&&n.push(ma(e,i,s))),e=e.return}return n}function Ss(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pd(e,t,r,n,s){for(var i=t._reactName,a=[];r!==null&&r!==n;){var l=r,o=l.alternate,c=l.stateNode;if(o!==null&&o===n)break;l.tag===5&&c!==null&&(l=c,s?(o=oa(r,i),o!=null&&a.unshift(ma(r,o,l))):s||(o=oa(r,i),o!=null&&a.push(ma(r,o,l)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Ny=/\r\n?/g,Ay=/\u0000|\uFFFD/g;function md(e){return(typeof e=="string"?e:""+e).replace(Ny,`
`).replace(Ay,"")}function cl(e,t,r){if(t=md(t),md(e)!==t&&r)throw Error(Z(425))}function Xl(){}var vu=null,yu=null;function _u(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wu=typeof setTimeout=="function"?setTimeout:void 0,Cy=typeof clearTimeout=="function"?clearTimeout:void 0,xd=typeof Promise=="function"?Promise:void 0,by=typeof queueMicrotask=="function"?queueMicrotask:typeof xd<"u"?function(e){return xd.resolve(null).then(e).catch(Oy)}:wu;function Oy(e){setTimeout(function(){throw e})}function Tc(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),fa(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);fa(t)}function An(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function gd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var mi=Math.random().toString(36).slice(2),Mr="__reactFiber$"+mi,xa="__reactProps$"+mi,rn="__reactContainer$"+mi,Su="__reactEvents$"+mi,Fy="__reactListeners$"+mi,jy="__reactHandles$"+mi;function Zn(e){var t=e[Mr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[rn]||r[Mr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=gd(e);e!==null;){if(r=e[Mr])return r;e=gd(e)}return t}e=r,r=e.parentNode}return null}function Da(e){return e=e[Mr]||e[rn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function jo(e){return e[xa]||null}var Eu=[],Us=-1;function Mn(e){return{current:e}}function $e(e){0>Us||(e.current=Eu[Us],Eu[Us]=null,Us--)}function Be(e,t){Us++,Eu[Us]=e.current,e.current=t}var Pn={},Ft=Mn(Pn),zt=Mn(!1),is=Pn;function ii(e,t){var r=e.type.contextTypes;if(!r)return Pn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ht(e){return e=e.childContextTypes,e!=null}function ql(){$e(zt),$e(Ft)}function vd(e,t,r){if(Ft.current!==Pn)throw Error(Z(168));Be(Ft,t),Be(zt,r)}function um(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Z(108,xv(e)||"Unknown",s));return qe({},r,n)}function Yl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pn,is=Ft.current,Be(Ft,e),Be(zt,zt.current),!0}function yd(e,t,r){var n=e.stateNode;if(!n)throw Error(Z(169));r?(e=um(e,t,is),n.__reactInternalMemoizedMergedChildContext=e,$e(zt),$e(Ft),Be(Ft,e)):$e(zt),Be(zt,r)}var Xr=null,Po=!1,kc=!1;function fm(e){Xr===null?Xr=[e]:Xr.push(e)}function Py(e){Po=!0,fm(e)}function Bn(){if(!kc&&Xr!==null){kc=!0;var e=0,t=Ie;try{var r=Xr;for(Ie=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Xr=null,Po=!1}catch(s){throw Xr!==null&&(Xr=Xr.slice(e+1)),Dp(g0,Bn),s}finally{Ie=t,kc=!1}}return null}var $s=[],Ws=0,Jl=null,Ql=0,cr=[],ur=0,as=null,qr=1,Yr="";function Gn(e,t){$s[Ws++]=Ql,$s[Ws++]=Jl,Jl=e,Ql=t}function dm(e,t,r){cr[ur++]=qr,cr[ur++]=Yr,cr[ur++]=as,as=e;var n=qr;e=Yr;var s=32-Ar(n)-1;n&=~(1<<s),r+=1;var i=32-Ar(t)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,qr=1<<32-Ar(t)+s|r<<s|n,Yr=i+e}else qr=1<<i|r<<s|n,Yr=e}function N0(e){e.return!==null&&(Gn(e,1),dm(e,1,0))}function A0(e){for(;e===Jl;)Jl=$s[--Ws],$s[Ws]=null,Ql=$s[--Ws],$s[Ws]=null;for(;e===as;)as=cr[--ur],cr[ur]=null,Yr=cr[--ur],cr[ur]=null,qr=cr[--ur],cr[ur]=null}var tr=null,er=null,He=!1,Tr=null;function hm(e,t){var r=fr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _d(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,tr=e,er=An(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,tr=e,er=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=as!==null?{id:qr,overflow:Yr}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=fr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,tr=e,er=null,!0):!1;default:return!1}}function Tu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ku(e){if(He){var t=er;if(t){var r=t;if(!_d(e,t)){if(Tu(e))throw Error(Z(418));t=An(r.nextSibling);var n=tr;t&&_d(e,t)?hm(n,r):(e.flags=e.flags&-4097|2,He=!1,tr=e)}}else{if(Tu(e))throw Error(Z(418));e.flags=e.flags&-4097|2,He=!1,tr=e}}}function wd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;tr=e}function ul(e){if(e!==tr)return!1;if(!He)return wd(e),He=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_u(e.type,e.memoizedProps)),t&&(t=er)){if(Tu(e))throw pm(),Error(Z(418));for(;t;)hm(e,t),t=An(t.nextSibling)}if(wd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){er=An(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}er=null}}else er=tr?An(e.stateNode.nextSibling):null;return!0}function pm(){for(var e=er;e;)e=An(e.nextSibling)}function ai(){er=tr=null,He=!1}function C0(e){Tr===null?Tr=[e]:Tr.push(e)}var Ry=on.ReactCurrentBatchConfig;function Fi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Z(309));var n=r.stateNode}if(!n)throw Error(Z(147,e));var s=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(Z(284));if(!r._owner)throw Error(Z(290,e))}return e}function fl(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sd(e){var t=e._init;return t(e._payload)}function mm(e){function t(v,y){if(e){var g=v.deletions;g===null?(v.deletions=[y],v.flags|=16):g.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function s(v,y){return v=Fn(v,y),v.index=0,v.sibling=null,v}function i(v,y,g){return v.index=g,e?(g=v.alternate,g!==null?(g=g.index,g<y?(v.flags|=2,y):g):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,g,S){return y===null||y.tag!==6?(y=jc(g,v.mode,S),y.return=v,y):(y=s(y,g),y.return=v,y)}function o(v,y,g,S){var j=g.type;return j===Is?f(v,y,g.props.children,S,g.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pn&&Sd(j)===y.type)?(S=s(y,g.props),S.ref=Fi(v,y,g),S.return=v,S):(S=Bl(g.type,g.key,g.props,null,v.mode,S),S.ref=Fi(v,y,g),S.return=v,S)}function c(v,y,g,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=Pc(g,v.mode,S),y.return=v,y):(y=s(y,g.children||[]),y.return=v,y)}function f(v,y,g,S,j){return y===null||y.tag!==7?(y=ns(g,v.mode,S,j),y.return=v,y):(y=s(y,g),y.return=v,y)}function d(v,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=jc(""+y,v.mode,g),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case el:return g=Bl(y.type,y.key,y.props,null,v.mode,g),g.ref=Fi(v,null,y),g.return=v,g;case Rs:return y=Pc(y,v.mode,g),y.return=v,y;case pn:var S=y._init;return d(v,S(y._payload),g)}if(Li(y)||Ni(y))return y=ns(y,v.mode,g,null),y.return=v,y;fl(v,y)}return null}function h(v,y,g,S){var j=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return j!==null?null:l(v,y,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case el:return g.key===j?o(v,y,g,S):null;case Rs:return g.key===j?c(v,y,g,S):null;case pn:return j=g._init,h(v,y,j(g._payload),S)}if(Li(g)||Ni(g))return j!==null?null:f(v,y,g,S,null);fl(v,g)}return null}function m(v,y,g,S,j){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(g)||null,l(y,v,""+S,j);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case el:return v=v.get(S.key===null?g:S.key)||null,o(y,v,S,j);case Rs:return v=v.get(S.key===null?g:S.key)||null,c(y,v,S,j);case pn:var N=S._init;return m(v,y,g,N(S._payload),j)}if(Li(S)||Ni(S))return v=v.get(g)||null,f(y,v,S,j,null);fl(y,S)}return null}function x(v,y,g,S){for(var j=null,N=null,k=y,F=y=0,L=null;k!==null&&F<g.length;F++){k.index>F?(L=k,k=null):L=k.sibling;var B=h(v,k,g[F],S);if(B===null){k===null&&(k=L);break}e&&k&&B.alternate===null&&t(v,k),y=i(B,y,F),N===null?j=B:N.sibling=B,N=B,k=L}if(F===g.length)return r(v,k),He&&Gn(v,F),j;if(k===null){for(;F<g.length;F++)k=d(v,g[F],S),k!==null&&(y=i(k,y,F),N===null?j=k:N.sibling=k,N=k);return He&&Gn(v,F),j}for(k=n(v,k);F<g.length;F++)L=m(k,v,F,g[F],S),L!==null&&(e&&L.alternate!==null&&k.delete(L.key===null?F:L.key),y=i(L,y,F),N===null?j=L:N.sibling=L,N=L);return e&&k.forEach(function(G){return t(v,G)}),He&&Gn(v,F),j}function p(v,y,g,S){var j=Ni(g);if(typeof j!="function")throw Error(Z(150));if(g=j.call(g),g==null)throw Error(Z(151));for(var N=j=null,k=y,F=y=0,L=null,B=g.next();k!==null&&!B.done;F++,B=g.next()){k.index>F?(L=k,k=null):L=k.sibling;var G=h(v,k,B.value,S);if(G===null){k===null&&(k=L);break}e&&k&&G.alternate===null&&t(v,k),y=i(G,y,F),N===null?j=G:N.sibling=G,N=G,k=L}if(B.done)return r(v,k),He&&Gn(v,F),j;if(k===null){for(;!B.done;F++,B=g.next())B=d(v,B.value,S),B!==null&&(y=i(B,y,F),N===null?j=B:N.sibling=B,N=B);return He&&Gn(v,F),j}for(k=n(v,k);!B.done;F++,B=g.next())B=m(k,v,F,B.value,S),B!==null&&(e&&B.alternate!==null&&k.delete(B.key===null?F:B.key),y=i(B,y,F),N===null?j=B:N.sibling=B,N=B);return e&&k.forEach(function(q){return t(v,q)}),He&&Gn(v,F),j}function _(v,y,g,S){if(typeof g=="object"&&g!==null&&g.type===Is&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case el:e:{for(var j=g.key,N=y;N!==null;){if(N.key===j){if(j=g.type,j===Is){if(N.tag===7){r(v,N.sibling),y=s(N,g.props.children),y.return=v,v=y;break e}}else if(N.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===pn&&Sd(j)===N.type){r(v,N.sibling),y=s(N,g.props),y.ref=Fi(v,N,g),y.return=v,v=y;break e}r(v,N);break}else t(v,N);N=N.sibling}g.type===Is?(y=ns(g.props.children,v.mode,S,g.key),y.return=v,v=y):(S=Bl(g.type,g.key,g.props,null,v.mode,S),S.ref=Fi(v,y,g),S.return=v,v=S)}return a(v);case Rs:e:{for(N=g.key;y!==null;){if(y.key===N)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(v,y.sibling),y=s(y,g.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=Pc(g,v.mode,S),y.return=v,v=y}return a(v);case pn:return N=g._init,_(v,y,N(g._payload),S)}if(Li(g))return x(v,y,g,S);if(Ni(g))return p(v,y,g,S);fl(v,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(v,y.sibling),y=s(y,g),y.return=v,v=y):(r(v,y),y=jc(g,v.mode,S),y.return=v,v=y),a(v)):r(v,y)}return _}var li=mm(!0),xm=mm(!1),Zl=Mn(null),eo=null,zs=null,b0=null;function O0(){b0=zs=eo=null}function F0(e){var t=Zl.current;$e(Zl),e._currentValue=t}function Nu(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qs(e,t){eo=e,b0=zs=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function pr(e){var t=e._currentValue;if(b0!==e)if(e={context:e,memoizedValue:t,next:null},zs===null){if(eo===null)throw Error(Z(308));zs=e,eo.dependencies={lanes:0,firstContext:e}}else zs=zs.next=e;return t}var es=null;function j0(e){es===null?es=[e]:es.push(e)}function gm(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,j0(t)):(r.next=s.next,s.next=r),t.interleaved=r,nn(e,n)}function nn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var mn=!1;function P0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Jr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Cn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,be&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,nn(e,r)}return s=n.interleaved,s===null?(t.next=t,j0(n)):(t.next=s.next,s.next=t),n.interleaved=t,nn(e,r)}function Pl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,v0(e,r)}}function Ed(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=t:i=i.next=t}else s=i=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function to(e,t,r,n){var s=e.updateQueue;mn=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var o=l,c=o.next;o.next=null,a===null?i=c:a.next=c,a=o;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=c:l.next=c,f.lastBaseUpdate=o))}if(i!==null){var d=s.baseState;a=0,f=c=o=null,l=i;do{var h=l.lane,m=l.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,p=l;switch(h=t,m=r,p.tag){case 1:if(x=p.payload,typeof x=="function"){d=x.call(m,d,h);break e}d=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=p.payload,h=typeof x=="function"?x.call(m,d,h):x,h==null)break e;d=qe({},d,h);break e;case 2:mn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(c=f=m,o=d):f=f.next=m,a|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(o=d),s.baseState=o,s.firstBaseUpdate=c,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do a|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);os|=a,e.lanes=a,e.memoizedState=d}}function Td(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Z(191,s));s.call(n)}}}var La={},Ur=Mn(La),ga=Mn(La),va=Mn(La);function ts(e){if(e===La)throw Error(Z(174));return e}function R0(e,t){switch(Be(va,t),Be(ga,e),Be(Ur,La),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:au(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=au(t,e)}$e(Ur),Be(Ur,t)}function oi(){$e(Ur),$e(ga),$e(va)}function ym(e){ts(va.current);var t=ts(Ur.current),r=au(t,e.type);t!==r&&(Be(ga,e),Be(Ur,r))}function I0(e){ga.current===e&&($e(Ur),$e(ga))}var Ge=Mn(0);function ro(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Nc=[];function D0(){for(var e=0;e<Nc.length;e++)Nc[e]._workInProgressVersionPrimary=null;Nc.length=0}var Rl=on.ReactCurrentDispatcher,Ac=on.ReactCurrentBatchConfig,ls=0,Xe=null,ct=null,ft=null,no=!1,Gi=!1,ya=0,Iy=0;function Nt(){throw Error(Z(321))}function L0(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Or(e[r],t[r]))return!1;return!0}function M0(e,t,r,n,s,i){if(ls=i,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rl.current=e===null||e.memoizedState===null?By:Uy,e=r(n,s),Gi){i=0;do{if(Gi=!1,ya=0,25<=i)throw Error(Z(301));i+=1,ft=ct=null,t.updateQueue=null,Rl.current=$y,e=r(n,s)}while(Gi)}if(Rl.current=so,t=ct!==null&&ct.next!==null,ls=0,ft=ct=Xe=null,no=!1,t)throw Error(Z(300));return e}function B0(){var e=ya!==0;return ya=0,e}function Dr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?Xe.memoizedState=ft=e:ft=ft.next=e,ft}function mr(){if(ct===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ct.next;var t=ft===null?Xe.memoizedState:ft.next;if(t!==null)ft=t,ct=e;else{if(e===null)throw Error(Z(310));ct=e,e={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ft===null?Xe.memoizedState=ft=e:ft=ft.next=e}return ft}function _a(e,t){return typeof t=="function"?t(e):t}function Cc(e){var t=mr(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=ct,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,o=null,c=i;do{var f=c.lane;if((ls&f)===f)o!==null&&(o=o.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};o===null?(l=o=d,a=n):o=o.next=d,Xe.lanes|=f,os|=f}c=c.next}while(c!==null&&c!==i);o===null?a=n:o.next=l,Or(n,t.memoizedState)||(Wt=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=o,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do i=s.lane,Xe.lanes|=i,os|=i,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function bc(e){var t=mr(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,i=t.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=e(i,a.action),a=a.next;while(a!==s);Or(i,t.memoizedState)||(Wt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function _m(){}function wm(e,t){var r=Xe,n=mr(),s=t(),i=!Or(n.memoizedState,s);if(i&&(n.memoizedState=s,Wt=!0),n=n.queue,U0(Tm.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||ft!==null&&ft.memoizedState.tag&1){if(r.flags|=2048,wa(9,Em.bind(null,r,n,s,t),void 0,null),mt===null)throw Error(Z(349));ls&30||Sm(r,t,s)}return s}function Sm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Em(e,t,r,n){t.value=r,t.getSnapshot=n,km(t)&&Nm(e)}function Tm(e,t,r){return r(function(){km(t)&&Nm(e)})}function km(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Or(e,r)}catch{return!0}}function Nm(e){var t=nn(e,1);t!==null&&Cr(t,e,1,-1)}function kd(e){var t=Dr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_a,lastRenderedState:e},t.queue=e,e=e.dispatch=My.bind(null,Xe,e),[t.memoizedState,e]}function wa(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Am(){return mr().memoizedState}function Il(e,t,r,n){var s=Dr();Xe.flags|=e,s.memoizedState=wa(1|t,r,void 0,n===void 0?null:n)}function Ro(e,t,r,n){var s=mr();n=n===void 0?null:n;var i=void 0;if(ct!==null){var a=ct.memoizedState;if(i=a.destroy,n!==null&&L0(n,a.deps)){s.memoizedState=wa(t,r,i,n);return}}Xe.flags|=e,s.memoizedState=wa(1|t,r,i,n)}function Nd(e,t){return Il(8390656,8,e,t)}function U0(e,t){return Ro(2048,8,e,t)}function Cm(e,t){return Ro(4,2,e,t)}function bm(e,t){return Ro(4,4,e,t)}function Om(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fm(e,t,r){return r=r!=null?r.concat([e]):null,Ro(4,4,Om.bind(null,t,e),r)}function $0(){}function jm(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L0(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Pm(e,t){var r=mr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&L0(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Rm(e,t,r){return ls&21?(Or(r,t)||(r=Bp(),Xe.lanes|=r,os|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=r)}function Dy(e,t){var r=Ie;Ie=r!==0&&4>r?r:4,e(!0);var n=Ac.transition;Ac.transition={};try{e(!1),t()}finally{Ie=r,Ac.transition=n}}function Im(){return mr().memoizedState}function Ly(e,t,r){var n=On(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Dm(e))Lm(t,r);else if(r=gm(e,t,r,n),r!==null){var s=Dt();Cr(r,e,n,s),Mm(r,t,n)}}function My(e,t,r){var n=On(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Dm(e))Lm(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,Or(l,a)){var o=t.interleaved;o===null?(s.next=s,j0(t)):(s.next=o.next,o.next=s),t.interleaved=s;return}}catch{}finally{}r=gm(e,t,s,n),r!==null&&(s=Dt(),Cr(r,e,n,s),Mm(r,t,n))}}function Dm(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function Lm(e,t){Gi=no=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Mm(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,v0(e,r)}}var so={readContext:pr,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},By={readContext:pr,useCallback:function(e,t){return Dr().memoizedState=[e,t===void 0?null:t],e},useContext:pr,useEffect:Nd,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Il(4194308,4,Om.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Il(4194308,4,e,t)},useInsertionEffect:function(e,t){return Il(4,2,e,t)},useMemo:function(e,t){var r=Dr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Dr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ly.bind(null,Xe,e),[n.memoizedState,e]},useRef:function(e){var t=Dr();return e={current:e},t.memoizedState=e},useState:kd,useDebugValue:$0,useDeferredValue:function(e){return Dr().memoizedState=e},useTransition:function(){var e=kd(!1),t=e[0];return e=Dy.bind(null,e[1]),Dr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Xe,s=Dr();if(He){if(r===void 0)throw Error(Z(407));r=r()}else{if(r=t(),mt===null)throw Error(Z(349));ls&30||Sm(n,t,r)}s.memoizedState=r;var i={value:r,getSnapshot:t};return s.queue=i,Nd(Tm.bind(null,n,i,e),[e]),n.flags|=2048,wa(9,Em.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Dr(),t=mt.identifierPrefix;if(He){var r=Yr,n=qr;r=(n&~(1<<32-Ar(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ya++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Iy++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Uy={readContext:pr,useCallback:jm,useContext:pr,useEffect:U0,useImperativeHandle:Fm,useInsertionEffect:Cm,useLayoutEffect:bm,useMemo:Pm,useReducer:Cc,useRef:Am,useState:function(){return Cc(_a)},useDebugValue:$0,useDeferredValue:function(e){var t=mr();return Rm(t,ct.memoizedState,e)},useTransition:function(){var e=Cc(_a)[0],t=mr().memoizedState;return[e,t]},useMutableSource:_m,useSyncExternalStore:wm,useId:Im,unstable_isNewReconciler:!1},$y={readContext:pr,useCallback:jm,useContext:pr,useEffect:U0,useImperativeHandle:Fm,useInsertionEffect:Cm,useLayoutEffect:bm,useMemo:Pm,useReducer:bc,useRef:Am,useState:function(){return bc(_a)},useDebugValue:$0,useDeferredValue:function(e){var t=mr();return ct===null?t.memoizedState=e:Rm(t,ct.memoizedState,e)},useTransition:function(){var e=bc(_a)[0],t=mr().memoizedState;return[e,t]},useMutableSource:_m,useSyncExternalStore:wm,useId:Im,unstable_isNewReconciler:!1};function wr(e,t){if(e&&e.defaultProps){t=qe({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Au(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:qe({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Io={isMounted:function(e){return(e=e._reactInternals)?ps(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Dt(),s=On(e),i=Jr(n,s);i.payload=t,r!=null&&(i.callback=r),t=Cn(e,i,s),t!==null&&(Cr(t,e,s,n),Pl(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Dt(),s=On(e),i=Jr(n,s);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Cn(e,i,s),t!==null&&(Cr(t,e,s,n),Pl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Dt(),n=On(e),s=Jr(r,n);s.tag=2,t!=null&&(s.callback=t),t=Cn(e,s,n),t!==null&&(Cr(t,e,n,r),Pl(t,e,n))}};function Ad(e,t,r,n,s,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,a):t.prototype&&t.prototype.isPureReactComponent?!ha(r,n)||!ha(s,i):!0}function Bm(e,t,r){var n=!1,s=Pn,i=t.contextType;return typeof i=="object"&&i!==null?i=pr(i):(s=Ht(t)?is:Ft.current,n=t.contextTypes,i=(n=n!=null)?ii(e,s):Pn),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Io,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Cd(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Io.enqueueReplaceState(t,t.state,null)}function Cu(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},P0(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=pr(i):(i=Ht(t)?is:Ft.current,s.context=ii(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Au(e,t,i,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Io.enqueueReplaceState(s,s.state,null),to(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function ci(e,t){try{var r="",n=t;do r+=mv(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Oc(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function bu(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Wy=typeof WeakMap=="function"?WeakMap:Map;function Um(e,t,r){r=Jr(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ao||(ao=!0,Bu=n),bu(e,t)},r}function $m(e,t,r){r=Jr(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){bu(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){bu(e,t),typeof n!="function"&&(bn===null?bn=new Set([this]):bn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function bd(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Wy;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=r2.bind(null,e,t,r),t.then(e,e))}function Od(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Fd(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Jr(-1,1),t.tag=2,Cn(r,t,1))),r.lanes|=1),e)}var zy=on.ReactCurrentOwner,Wt=!1;function Pt(e,t,r,n){t.child=e===null?xm(t,null,r,n):li(t,e.child,r,n)}function jd(e,t,r,n,s){r=r.render;var i=t.ref;return Qs(t,s),n=M0(e,t,r,n,i,s),r=B0(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,sn(e,t,s)):(He&&r&&N0(t),t.flags|=1,Pt(e,t,n,s),t.child)}function Pd(e,t,r,n,s){if(e===null){var i=r.type;return typeof i=="function"&&!q0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Wm(e,t,i,n,s)):(e=Bl(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:ha,r(a,n)&&e.ref===t.ref)return sn(e,t,s)}return t.flags|=1,e=Fn(i,n),e.ref=t.ref,e.return=t,t.child=e}function Wm(e,t,r,n,s){if(e!==null){var i=e.memoizedProps;if(ha(i,n)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=n=i,(e.lanes&s)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,sn(e,t,s)}return Ou(e,t,r,n,s)}function zm(e,t,r){var n=t.pendingProps,s=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Vs,Yt),Yt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(Vs,Yt),Yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Be(Vs,Yt),Yt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Be(Vs,Yt),Yt|=n;return Pt(e,t,s,r),t.child}function Hm(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ou(e,t,r,n,s){var i=Ht(r)?is:Ft.current;return i=ii(t,i),Qs(t,s),r=M0(e,t,r,n,i,s),n=B0(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,sn(e,t,s)):(He&&n&&N0(t),t.flags|=1,Pt(e,t,r,s),t.child)}function Rd(e,t,r,n,s){if(Ht(r)){var i=!0;Yl(t)}else i=!1;if(Qs(t,s),t.stateNode===null)Dl(e,t),Bm(t,r,n),Cu(t,r,n,s),n=!0;else if(e===null){var a=t.stateNode,l=t.memoizedProps;a.props=l;var o=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=pr(c):(c=Ht(r)?is:Ft.current,c=ii(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||o!==c)&&Cd(t,a,n,c),mn=!1;var h=t.memoizedState;a.state=h,to(t,n,a,s),o=t.memoizedState,l!==n||h!==o||zt.current||mn?(typeof f=="function"&&(Au(t,r,f,n),o=t.memoizedState),(l=mn||Ad(t,r,l,n,h,o,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),a.props=n,a.state=o,a.context=c,n=l):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,vm(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:wr(t.type,l),a.props=c,d=t.pendingProps,h=a.context,o=r.contextType,typeof o=="object"&&o!==null?o=pr(o):(o=Ht(r)?is:Ft.current,o=ii(t,o));var m=r.getDerivedStateFromProps;(f=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==d||h!==o)&&Cd(t,a,n,o),mn=!1,h=t.memoizedState,a.state=h,to(t,n,a,s);var x=t.memoizedState;l!==d||h!==x||zt.current||mn?(typeof m=="function"&&(Au(t,r,m,n),x=t.memoizedState),(c=mn||Ad(t,r,c,n,h,x,o)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,x,o),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,x,o)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),a.props=n,a.state=x,a.context=o,n=c):(typeof a.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Fu(e,t,r,n,i,s)}function Fu(e,t,r,n,s,i){Hm(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return s&&yd(t,r,!1),sn(e,t,i);n=t.stateNode,zy.current=t;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=li(t,e.child,null,i),t.child=li(t,null,l,i)):Pt(e,t,l,i),t.memoizedState=n.state,s&&yd(t,r,!0),t.child}function Vm(e){var t=e.stateNode;t.pendingContext?vd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&vd(e,t.context,!1),R0(e,t.containerInfo)}function Id(e,t,r,n,s){return ai(),C0(s),t.flags|=256,Pt(e,t,r,n),t.child}var ju={dehydrated:null,treeContext:null,retryLane:0};function Pu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Km(e,t,r){var n=t.pendingProps,s=Ge.current,i=!1,a=(t.flags&128)!==0,l;if((l=a)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Be(Ge,s&1),e===null)return ku(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,i?(n=t.mode,i=t.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Mo(a,n,0,null),e=ns(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Pu(r),t.memoizedState=ju,e):W0(t,a));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Hy(e,t,a,n,l,s,r);if(i){i=n.fallback,a=t.mode,s=e.child,l=s.sibling;var o={mode:"hidden",children:n.children};return!(a&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=o,t.deletions=null):(n=Fn(s,o),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Fn(l,i):(i=ns(i,a,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,a=e.child.memoizedState,a=a===null?Pu(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~r,t.memoizedState=ju,n}return i=e.child,e=i.sibling,n=Fn(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function W0(e,t){return t=Mo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function dl(e,t,r,n){return n!==null&&C0(n),li(t,e.child,null,r),e=W0(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Hy(e,t,r,n,s,i,a){if(r)return t.flags&256?(t.flags&=-257,n=Oc(Error(Z(422))),dl(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,s=t.mode,n=Mo({mode:"visible",children:n.children},s,0,null),i=ns(i,s,a,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&li(t,e.child,null,a),t.child.memoizedState=Pu(a),t.memoizedState=ju,i);if(!(t.mode&1))return dl(e,t,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Z(419)),n=Oc(i,n,void 0),dl(e,t,a,n)}if(l=(a&e.childLanes)!==0,Wt||l){if(n=mt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,nn(e,s),Cr(n,e,s,-1))}return X0(),n=Oc(Error(Z(421))),dl(e,t,a,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=n2.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,er=An(s.nextSibling),tr=t,He=!0,Tr=null,e!==null&&(cr[ur++]=qr,cr[ur++]=Yr,cr[ur++]=as,qr=e.id,Yr=e.overflow,as=t),t=W0(t,n.children),t.flags|=4096,t)}function Dd(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Nu(e.return,t,r)}function Fc(e,t,r,n,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Gm(e,t,r){var n=t.pendingProps,s=n.revealOrder,i=n.tail;if(Pt(e,t,n.children,r),n=Ge.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dd(e,r,t);else if(e.tag===19)Dd(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Be(Ge,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&ro(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Fc(t,!1,s,r,i);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ro(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Fc(t,!0,r,null,i);break;case"together":Fc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Dl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function sn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),os|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,r=Fn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Fn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Vy(e,t,r){switch(t.tag){case 3:Vm(t),ai();break;case 5:ym(t);break;case 1:Ht(t.type)&&Yl(t);break;case 4:R0(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Be(Zl,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Be(Ge,Ge.current&1),t.flags|=128,null):r&t.child.childLanes?Km(e,t,r):(Be(Ge,Ge.current&1),e=sn(e,t,r),e!==null?e.sibling:null);Be(Ge,Ge.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Gm(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(Ge,Ge.current),n)break;return null;case 22:case 23:return t.lanes=0,zm(e,t,r)}return sn(e,t,r)}var Xm,Ru,qm,Ym;Xm=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ru=function(){};qm=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ts(Ur.current);var i=null;switch(r){case"input":s=ru(e,s),n=ru(e,n),i=[];break;case"select":s=qe({},s,{value:void 0}),n=qe({},n,{value:void 0}),i=[];break;case"textarea":s=iu(e,s),n=iu(e,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Xl)}lu(r,n);var a;r=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(aa.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var o=n[c];if(l=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&o!==l&&(o!=null||l!=null))if(c==="style")if(l){for(a in l)!l.hasOwnProperty(a)||o&&o.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in o)o.hasOwnProperty(a)&&l[a]!==o[a]&&(r||(r={}),r[a]=o[a])}else r||(i||(i=[]),i.push(c,r)),r=o;else c==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,l=l?l.__html:void 0,o!=null&&l!==o&&(i=i||[]).push(c,o)):c==="children"?typeof o!="string"&&typeof o!="number"||(i=i||[]).push(c,""+o):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(aa.hasOwnProperty(c)?(o!=null&&c==="onScroll"&&Ue("scroll",e),i||l===o||(i=[])):(i=i||[]).push(c,o))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Ym=function(e,t,r,n){r!==n&&(t.flags|=4)};function ji(e,t){if(!He)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function At(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Ky(e,t,r){var n=t.pendingProps;switch(A0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(t),null;case 1:return Ht(t.type)&&ql(),At(t),null;case 3:return n=t.stateNode,oi(),$e(zt),$e(Ft),D0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ul(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tr!==null&&(Wu(Tr),Tr=null))),Ru(e,t),At(t),null;case 5:I0(t);var s=ts(va.current);if(r=t.type,e!==null&&t.stateNode!=null)qm(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Z(166));return At(t),null}if(e=ts(Ur.current),ul(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Mr]=t,n[xa]=i,e=(t.mode&1)!==0,r){case"dialog":Ue("cancel",n),Ue("close",n);break;case"iframe":case"object":case"embed":Ue("load",n);break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ue(Bi[s],n);break;case"source":Ue("error",n);break;case"img":case"image":case"link":Ue("error",n),Ue("load",n);break;case"details":Ue("toggle",n);break;case"input":Vf(n,i),Ue("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ue("invalid",n);break;case"textarea":Gf(n,i),Ue("invalid",n)}lu(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,l,e),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,l,e),s=["children",""+l]):aa.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&Ue("scroll",n)}switch(r){case"input":tl(n),Kf(n,i,!0);break;case"textarea":tl(n),Xf(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Xl)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Tp(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Mr]=t,e[xa]=n,Xm(e,t,!1,!1),t.stateNode=e;e:{switch(a=ou(r,n),r){case"dialog":Ue("cancel",e),Ue("close",e),s=n;break;case"iframe":case"object":case"embed":Ue("load",e),s=n;break;case"video":case"audio":for(s=0;s<Bi.length;s++)Ue(Bi[s],e);s=n;break;case"source":Ue("error",e),s=n;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),s=n;break;case"details":Ue("toggle",e),s=n;break;case"input":Vf(e,n),s=ru(e,n),Ue("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=qe({},n,{value:void 0}),Ue("invalid",e);break;case"textarea":Gf(e,n),s=iu(e,n),Ue("invalid",e);break;default:s=n}lu(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var o=l[i];i==="style"?Ap(e,o):i==="dangerouslySetInnerHTML"?(o=o?o.__html:void 0,o!=null&&kp(e,o)):i==="children"?typeof o=="string"?(r!=="textarea"||o!=="")&&la(e,o):typeof o=="number"&&la(e,""+o):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(aa.hasOwnProperty(i)?o!=null&&i==="onScroll"&&Ue("scroll",e):o!=null&&d0(e,i,o,a))}switch(r){case"input":tl(e),Kf(e,n,!1);break;case"textarea":tl(e),Xf(e);break;case"option":n.value!=null&&e.setAttribute("value",""+jn(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?Xs(e,!!n.multiple,i,!1):n.defaultValue!=null&&Xs(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Xl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return At(t),null;case 6:if(e&&t.stateNode!=null)Ym(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Z(166));if(r=ts(va.current),ts(Ur.current),ul(t)){if(n=t.stateNode,r=t.memoizedProps,n[Mr]=t,(i=n.nodeValue!==r)&&(e=tr,e!==null))switch(e.tag){case 3:cl(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&cl(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Mr]=t,t.stateNode=n}return At(t),null;case 13:if($e(Ge),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(He&&er!==null&&t.mode&1&&!(t.flags&128))pm(),ai(),t.flags|=98560,i=!1;else if(i=ul(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Z(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Z(317));i[Mr]=t}else ai(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;At(t),i=!1}else Tr!==null&&(Wu(Tr),Tr=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ge.current&1?ut===0&&(ut=3):X0())),t.updateQueue!==null&&(t.flags|=4),At(t),null);case 4:return oi(),Ru(e,t),e===null&&pa(t.stateNode.containerInfo),At(t),null;case 10:return F0(t.type._context),At(t),null;case 17:return Ht(t.type)&&ql(),At(t),null;case 19:if($e(Ge),i=t.memoizedState,i===null)return At(t),null;if(n=(t.flags&128)!==0,a=i.rendering,a===null)if(n)ji(i,!1);else{if(ut!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=ro(e),a!==null){for(t.flags|=128,ji(i,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Be(Ge,Ge.current&1|2),t.child}e=e.sibling}i.tail!==null&&tt()>ui&&(t.flags|=128,n=!0,ji(i,!1),t.lanes=4194304)}else{if(!n)if(e=ro(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ji(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!He)return At(t),null}else 2*tt()-i.renderingStartTime>ui&&r!==1073741824&&(t.flags|=128,n=!0,ji(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(r=i.last,r!==null?r.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tt(),t.sibling=null,r=Ge.current,Be(Ge,n?r&1|2:r&1),t):(At(t),null);case 22:case 23:return G0(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yt&1073741824&&(At(t),t.subtreeFlags&6&&(t.flags|=8192)):At(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function Gy(e,t){switch(A0(t),t.tag){case 1:return Ht(t.type)&&ql(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return oi(),$e(zt),$e(Ft),D0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return I0(t),null;case 13:if($e(Ge),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));ai()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(Ge),null;case 4:return oi(),null;case 10:return F0(t.type._context),null;case 22:case 23:return G0(),null;case 24:return null;default:return null}}var hl=!1,Ct=!1,Xy=typeof WeakSet=="function"?WeakSet:Set,he=null;function Hs(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Je(e,t,n)}else r.current=null}function Iu(e,t,r){try{r()}catch(n){Je(e,t,n)}}var Ld=!1;function qy(e,t){if(vu=Vl,e=tm(),k0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,o=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var m;d!==r||s!==0&&d.nodeType!==3||(l=a+s),d!==i||n!==0&&d.nodeType!==3||(o=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(m=d.firstChild)!==null;)h=d,d=m;for(;;){if(d===e)break t;if(h===r&&++c===s&&(l=a),h===i&&++f===n&&(o=a),(m=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=m}r=l===-1||o===-1?null:{start:l,end:o}}else r=null}r=r||{start:0,end:0}}else r=null;for(yu={focusedElem:e,selectionRange:r},Vl=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var p=x.memoizedProps,_=x.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?p:wr(t.type,p),_);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(S){Je(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return x=Ld,Ld=!1,x}function Xi(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Iu(t,r,i)}s=s.next}while(s!==n)}}function Do(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Du(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Jm(e){var t=e.alternate;t!==null&&(e.alternate=null,Jm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Mr],delete t[xa],delete t[Su],delete t[Fy],delete t[jy])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Qm(e){return e.tag===5||e.tag===3||e.tag===4}function Md(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Qm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Lu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Xl));else if(n!==4&&(e=e.child,e!==null))for(Lu(e,t,r),e=e.sibling;e!==null;)Lu(e,t,r),e=e.sibling}function Mu(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Mu(e,t,r),e=e.sibling;e!==null;)Mu(e,t,r),e=e.sibling}var gt=null,Sr=!1;function un(e,t,r){for(r=r.child;r!==null;)Zm(e,t,r),r=r.sibling}function Zm(e,t,r){if(Br&&typeof Br.onCommitFiberUnmount=="function")try{Br.onCommitFiberUnmount(Co,r)}catch{}switch(r.tag){case 5:Ct||Hs(r,t);case 6:var n=gt,s=Sr;gt=null,un(e,t,r),gt=n,Sr=s,gt!==null&&(Sr?(e=gt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gt.removeChild(r.stateNode));break;case 18:gt!==null&&(Sr?(e=gt,r=r.stateNode,e.nodeType===8?Tc(e.parentNode,r):e.nodeType===1&&Tc(e,r),fa(e)):Tc(gt,r.stateNode));break;case 4:n=gt,s=Sr,gt=r.stateNode.containerInfo,Sr=!0,un(e,t,r),gt=n,Sr=s;break;case 0:case 11:case 14:case 15:if(!Ct&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Iu(r,t,a),s=s.next}while(s!==n)}un(e,t,r);break;case 1:if(!Ct&&(Hs(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Je(r,t,l)}un(e,t,r);break;case 21:un(e,t,r);break;case 22:r.mode&1?(Ct=(n=Ct)||r.memoizedState!==null,un(e,t,r),Ct=n):un(e,t,r);break;default:un(e,t,r)}}function Bd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Xy),t.forEach(function(n){var s=s2.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function gr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=e,a=t,l=a;e:for(;l!==null;){switch(l.tag){case 5:gt=l.stateNode,Sr=!1;break e;case 3:gt=l.stateNode.containerInfo,Sr=!0;break e;case 4:gt=l.stateNode.containerInfo,Sr=!0;break e}l=l.return}if(gt===null)throw Error(Z(160));Zm(i,a,s),gt=null,Sr=!1;var o=s.alternate;o!==null&&(o.return=null),s.return=null}catch(c){Je(s,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)e1(t,e),t=t.sibling}function e1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gr(t,e),Pr(e),n&4){try{Xi(3,e,e.return),Do(3,e)}catch(p){Je(e,e.return,p)}try{Xi(5,e,e.return)}catch(p){Je(e,e.return,p)}}break;case 1:gr(t,e),Pr(e),n&512&&r!==null&&Hs(r,r.return);break;case 5:if(gr(t,e),Pr(e),n&512&&r!==null&&Hs(r,r.return),e.flags&32){var s=e.stateNode;try{la(s,"")}catch(p){Je(e,e.return,p)}}if(n&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,a=r!==null?r.memoizedProps:i,l=e.type,o=e.updateQueue;if(e.updateQueue=null,o!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sp(s,i),ou(l,a);var c=ou(l,i);for(a=0;a<o.length;a+=2){var f=o[a],d=o[a+1];f==="style"?Ap(s,d):f==="dangerouslySetInnerHTML"?kp(s,d):f==="children"?la(s,d):d0(s,f,d,c)}switch(l){case"input":nu(s,i);break;case"textarea":Ep(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Xs(s,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?Xs(s,!!i.multiple,i.defaultValue,!0):Xs(s,!!i.multiple,i.multiple?[]:"",!1))}s[xa]=i}catch(p){Je(e,e.return,p)}}break;case 6:if(gr(t,e),Pr(e),n&4){if(e.stateNode===null)throw Error(Z(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(p){Je(e,e.return,p)}}break;case 3:if(gr(t,e),Pr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{fa(t.containerInfo)}catch(p){Je(e,e.return,p)}break;case 4:gr(t,e),Pr(e);break;case 13:gr(t,e),Pr(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(V0=tt())),n&4&&Bd(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Ct=(c=Ct)||f,gr(t,e),Ct=c):gr(t,e),Pr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(he=e,f=e.child;f!==null;){for(d=he=f;he!==null;){switch(h=he,m=h.child,h.tag){case 0:case 11:case 14:case 15:Xi(4,h,h.return);break;case 1:Hs(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(p){Je(n,r,p)}}break;case 5:Hs(h,h.return);break;case 22:if(h.memoizedState!==null){$d(d);continue}}m!==null?(m.return=h,he=m):$d(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=d.stateNode,o=d.memoizedProps.style,a=o!=null&&o.hasOwnProperty("display")?o.display:null,l.style.display=Np("display",a))}catch(p){Je(e,e.return,p)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(p){Je(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gr(t,e),Pr(e),n&4&&Bd(e);break;case 21:break;default:gr(t,e),Pr(e)}}function Pr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Qm(r)){var n=r;break e}r=r.return}throw Error(Z(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(la(s,""),n.flags&=-33);var i=Md(e);Mu(e,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=Md(e);Lu(e,l,a);break;default:throw Error(Z(161))}}catch(o){Je(e,e.return,o)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Yy(e,t,r){he=e,t1(e)}function t1(e,t,r){for(var n=(e.mode&1)!==0;he!==null;){var s=he,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||hl;if(!a){var l=s.alternate,o=l!==null&&l.memoizedState!==null||Ct;l=hl;var c=Ct;if(hl=a,(Ct=o)&&!c)for(he=s;he!==null;)a=he,o=a.child,a.tag===22&&a.memoizedState!==null?Wd(s):o!==null?(o.return=a,he=o):Wd(s);for(;i!==null;)he=i,t1(i),i=i.sibling;he=s,hl=l,Ct=c}Ud(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,he=i):Ud(e)}}function Ud(e){for(;he!==null;){var t=he;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ct||Do(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ct)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:wr(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Td(t,i,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Td(t,a,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var o=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&r.focus();break;case"img":o.src&&(r.src=o.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&fa(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Ct||t.flags&512&&Du(t)}catch(h){Je(t,t.return,h)}}if(t===e){he=null;break}if(r=t.sibling,r!==null){r.return=t.return,he=r;break}he=t.return}}function $d(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var r=t.sibling;if(r!==null){r.return=t.return,he=r;break}he=t.return}}function Wd(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Do(4,t)}catch(o){Je(t,r,o)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(o){Je(t,s,o)}}var i=t.return;try{Du(t)}catch(o){Je(t,i,o)}break;case 5:var a=t.return;try{Du(t)}catch(o){Je(t,a,o)}}}catch(o){Je(t,t.return,o)}if(t===e){he=null;break}var l=t.sibling;if(l!==null){l.return=t.return,he=l;break}he=t.return}}var Jy=Math.ceil,io=on.ReactCurrentDispatcher,z0=on.ReactCurrentOwner,dr=on.ReactCurrentBatchConfig,be=0,mt=null,nt=null,wt=0,Yt=0,Vs=Mn(0),ut=0,Sa=null,os=0,Lo=0,H0=0,qi=null,Ut=null,V0=0,ui=1/0,Kr=null,ao=!1,Bu=null,bn=null,pl=!1,_n=null,lo=0,Yi=0,Uu=null,Ll=-1,Ml=0;function Dt(){return be&6?tt():Ll!==-1?Ll:Ll=tt()}function On(e){return e.mode&1?be&2&&wt!==0?wt&-wt:Ry.transition!==null?(Ml===0&&(Ml=Bp()),Ml):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:Kp(e.type)),e):1}function Cr(e,t,r,n){if(50<Yi)throw Yi=0,Uu=null,Error(Z(185));Ra(e,r,n),(!(be&2)||e!==mt)&&(e===mt&&(!(be&2)&&(Lo|=r),ut===4&&gn(e,wt)),Vt(e,n),r===1&&be===0&&!(t.mode&1)&&(ui=tt()+500,Po&&Bn()))}function Vt(e,t){var r=e.callbackNode;Rv(e,t);var n=Hl(e,e===mt?wt:0);if(n===0)r!==null&&Jf(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Jf(r),t===1)e.tag===0?Py(zd.bind(null,e)):fm(zd.bind(null,e)),by(function(){!(be&6)&&Bn()}),r=null;else{switch(Up(n)){case 1:r=g0;break;case 4:r=Lp;break;case 16:r=zl;break;case 536870912:r=Mp;break;default:r=zl}r=c1(r,r1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function r1(e,t){if(Ll=-1,Ml=0,be&6)throw Error(Z(327));var r=e.callbackNode;if(Zs()&&e.callbackNode!==r)return null;var n=Hl(e,e===mt?wt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=oo(e,n);else{t=n;var s=be;be|=2;var i=s1();(mt!==e||wt!==t)&&(Kr=null,ui=tt()+500,rs(e,t));do try{e2();break}catch(l){n1(e,l)}while(!0);O0(),io.current=i,be=s,nt!==null?t=0:(mt=null,wt=0,t=ut)}if(t!==0){if(t===2&&(s=hu(e),s!==0&&(n=s,t=$u(e,s))),t===1)throw r=Sa,rs(e,0),gn(e,n),Vt(e,tt()),r;if(t===6)gn(e,n);else{if(s=e.current.alternate,!(n&30)&&!Qy(s)&&(t=oo(e,n),t===2&&(i=hu(e),i!==0&&(n=i,t=$u(e,i))),t===1))throw r=Sa,rs(e,0),gn(e,n),Vt(e,tt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Z(345));case 2:Xn(e,Ut,Kr);break;case 3:if(gn(e,n),(n&130023424)===n&&(t=V0+500-tt(),10<t)){if(Hl(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Dt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=wu(Xn.bind(null,e,Ut,Kr),t);break}Xn(e,Ut,Kr);break;case 4:if(gn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var a=31-Ar(n);i=1<<a,a=t[a],a>s&&(s=a),n&=~i}if(n=s,n=tt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Jy(n/1960))-n,10<n){e.timeoutHandle=wu(Xn.bind(null,e,Ut,Kr),n);break}Xn(e,Ut,Kr);break;case 5:Xn(e,Ut,Kr);break;default:throw Error(Z(329))}}}return Vt(e,tt()),e.callbackNode===r?r1.bind(null,e):null}function $u(e,t){var r=qi;return e.current.memoizedState.isDehydrated&&(rs(e,t).flags|=256),e=oo(e,t),e!==2&&(t=Ut,Ut=r,t!==null&&Wu(t)),e}function Wu(e){Ut===null?Ut=e:Ut.push.apply(Ut,e)}function Qy(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Or(i(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function gn(e,t){for(t&=~H0,t&=~Lo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ar(t),n=1<<r;e[r]=-1,t&=~n}}function zd(e){if(be&6)throw Error(Z(327));Zs();var t=Hl(e,0);if(!(t&1))return Vt(e,tt()),null;var r=oo(e,t);if(e.tag!==0&&r===2){var n=hu(e);n!==0&&(t=n,r=$u(e,n))}if(r===1)throw r=Sa,rs(e,0),gn(e,t),Vt(e,tt()),r;if(r===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Xn(e,Ut,Kr),Vt(e,tt()),null}function K0(e,t){var r=be;be|=1;try{return e(t)}finally{be=r,be===0&&(ui=tt()+500,Po&&Bn())}}function cs(e){_n!==null&&_n.tag===0&&!(be&6)&&Zs();var t=be;be|=1;var r=dr.transition,n=Ie;try{if(dr.transition=null,Ie=1,e)return e()}finally{Ie=n,dr.transition=r,be=t,!(be&6)&&Bn()}}function G0(){Yt=Vs.current,$e(Vs)}function rs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Cy(r)),nt!==null)for(r=nt.return;r!==null;){var n=r;switch(A0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ql();break;case 3:oi(),$e(zt),$e(Ft),D0();break;case 5:I0(n);break;case 4:oi();break;case 13:$e(Ge);break;case 19:$e(Ge);break;case 10:F0(n.type._context);break;case 22:case 23:G0()}r=r.return}if(mt=e,nt=e=Fn(e.current,null),wt=Yt=t,ut=0,Sa=null,H0=Lo=os=0,Ut=qi=null,es!==null){for(t=0;t<es.length;t++)if(r=es[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}es=null}return e}function n1(e,t){do{var r=nt;try{if(O0(),Rl.current=so,no){for(var n=Xe.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}no=!1}if(ls=0,ft=ct=Xe=null,Gi=!1,ya=0,z0.current=null,r===null||r.return===null){ut=1,Sa=t,nt=null;break}e:{var i=e,a=r.return,l=r,o=t;if(t=wt,l.flags|=32768,o!==null&&typeof o=="object"&&typeof o.then=="function"){var c=o,f=l,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var m=Od(a);if(m!==null){m.flags&=-257,Fd(m,a,l,i,t),m.mode&1&&bd(i,c,t),t=m,o=c;var x=t.updateQueue;if(x===null){var p=new Set;p.add(o),t.updateQueue=p}else x.add(o);break e}else{if(!(t&1)){bd(i,c,t),X0();break e}o=Error(Z(426))}}else if(He&&l.mode&1){var _=Od(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Fd(_,a,l,i,t),C0(ci(o,l));break e}}i=o=ci(o,l),ut!==4&&(ut=2),qi===null?qi=[i]:qi.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Um(i,o,t);Ed(i,v);break e;case 1:l=o;var y=i.type,g=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(bn===null||!bn.has(g)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=$m(i,l,t);Ed(i,S);break e}}i=i.return}while(i!==null)}a1(r)}catch(j){t=j,nt===r&&r!==null&&(nt=r=r.return);continue}break}while(!0)}function s1(){var e=io.current;return io.current=so,e===null?so:e}function X0(){(ut===0||ut===3||ut===2)&&(ut=4),mt===null||!(os&268435455)&&!(Lo&268435455)||gn(mt,wt)}function oo(e,t){var r=be;be|=2;var n=s1();(mt!==e||wt!==t)&&(Kr=null,rs(e,t));do try{Zy();break}catch(s){n1(e,s)}while(!0);if(O0(),be=r,io.current=n,nt!==null)throw Error(Z(261));return mt=null,wt=0,ut}function Zy(){for(;nt!==null;)i1(nt)}function e2(){for(;nt!==null&&!kv();)i1(nt)}function i1(e){var t=o1(e.alternate,e,Yt);e.memoizedProps=e.pendingProps,t===null?a1(e):nt=t,z0.current=null}function a1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Gy(r,t),r!==null){r.flags&=32767,nt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ut=6,nt=null;return}}else if(r=Ky(r,t,Yt),r!==null){nt=r;return}if(t=t.sibling,t!==null){nt=t;return}nt=t=e}while(t!==null);ut===0&&(ut=5)}function Xn(e,t,r){var n=Ie,s=dr.transition;try{dr.transition=null,Ie=1,t2(e,t,r,n)}finally{dr.transition=s,Ie=n}return null}function t2(e,t,r,n){do Zs();while(_n!==null);if(be&6)throw Error(Z(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Iv(e,i),e===mt&&(nt=mt=null,wt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||pl||(pl=!0,c1(zl,function(){return Zs(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=dr.transition,dr.transition=null;var a=Ie;Ie=1;var l=be;be|=4,z0.current=null,qy(e,r),e1(r,e),wy(yu),Vl=!!vu,yu=vu=null,e.current=r,Yy(r),Nv(),be=l,Ie=a,dr.transition=i}else e.current=r;if(pl&&(pl=!1,_n=e,lo=s),i=e.pendingLanes,i===0&&(bn=null),bv(r.stateNode),Vt(e,tt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ao)throw ao=!1,e=Bu,Bu=null,e;return lo&1&&e.tag!==0&&Zs(),i=e.pendingLanes,i&1?e===Uu?Yi++:(Yi=0,Uu=e):Yi=0,Bn(),null}function Zs(){if(_n!==null){var e=Up(lo),t=dr.transition,r=Ie;try{if(dr.transition=null,Ie=16>e?16:e,_n===null)var n=!1;else{if(e=_n,_n=null,lo=0,be&6)throw Error(Z(331));var s=be;for(be|=4,he=e.current;he!==null;){var i=he,a=i.child;if(he.flags&16){var l=i.deletions;if(l!==null){for(var o=0;o<l.length;o++){var c=l[o];for(he=c;he!==null;){var f=he;switch(f.tag){case 0:case 11:case 15:Xi(8,f,i)}var d=f.child;if(d!==null)d.return=f,he=d;else for(;he!==null;){f=he;var h=f.sibling,m=f.return;if(Jm(f),f===c){he=null;break}if(h!==null){h.return=m,he=h;break}he=m}}}var x=i.alternate;if(x!==null){var p=x.child;if(p!==null){x.child=null;do{var _=p.sibling;p.sibling=null,p=_}while(p!==null)}}he=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,he=a;else e:for(;he!==null;){if(i=he,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xi(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,he=v;break e}he=i.return}}var y=e.current;for(he=y;he!==null;){a=he;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,he=g;else e:for(a=y;he!==null;){if(l=he,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Do(9,l)}}catch(j){Je(l,l.return,j)}if(l===a){he=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,he=S;break e}he=l.return}}if(be=s,Bn(),Br&&typeof Br.onPostCommitFiberRoot=="function")try{Br.onPostCommitFiberRoot(Co,e)}catch{}n=!0}return n}finally{Ie=r,dr.transition=t}}return!1}function Hd(e,t,r){t=ci(r,t),t=Um(e,t,1),e=Cn(e,t,1),t=Dt(),e!==null&&(Ra(e,1,t),Vt(e,t))}function Je(e,t,r){if(e.tag===3)Hd(e,e,r);else for(;t!==null;){if(t.tag===3){Hd(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(bn===null||!bn.has(n))){e=ci(r,e),e=$m(t,e,1),t=Cn(t,e,1),e=Dt(),t!==null&&(Ra(t,1,e),Vt(t,e));break}}t=t.return}}function r2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&r,mt===e&&(wt&r)===r&&(ut===4||ut===3&&(wt&130023424)===wt&&500>tt()-V0?rs(e,0):H0|=r),Vt(e,t)}function l1(e,t){t===0&&(e.mode&1?(t=sl,sl<<=1,!(sl&130023424)&&(sl=4194304)):t=1);var r=Dt();e=nn(e,t),e!==null&&(Ra(e,t,r),Vt(e,r))}function n2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),l1(e,r)}function s2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Z(314))}n!==null&&n.delete(t),l1(e,r)}var o1;o1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||zt.current)Wt=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Wt=!1,Vy(e,t,r);Wt=!!(e.flags&131072)}else Wt=!1,He&&t.flags&1048576&&dm(t,Ql,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Dl(e,t),e=t.pendingProps;var s=ii(t,Ft.current);Qs(t,r),s=M0(null,t,n,e,s,r);var i=B0();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(n)?(i=!0,Yl(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,P0(t),s.updater=Io,t.stateNode=s,s._reactInternals=t,Cu(t,n,e,r),t=Fu(null,t,n,!0,i,r)):(t.tag=0,He&&i&&N0(t),Pt(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Dl(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=a2(n),e=wr(n,e),s){case 0:t=Ou(null,t,n,e,r);break e;case 1:t=Rd(null,t,n,e,r);break e;case 11:t=jd(null,t,n,e,r);break e;case 14:t=Pd(null,t,n,wr(n.type,e),r);break e}throw Error(Z(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wr(n,s),Ou(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wr(n,s),Rd(e,t,n,s,r);case 3:e:{if(Vm(t),e===null)throw Error(Z(387));n=t.pendingProps,i=t.memoizedState,s=i.element,vm(e,t),to(t,n,null,r);var a=t.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=ci(Error(Z(423)),t),t=Id(e,t,n,r,s);break e}else if(n!==s){s=ci(Error(Z(424)),t),t=Id(e,t,n,r,s);break e}else for(er=An(t.stateNode.containerInfo.firstChild),tr=t,He=!0,Tr=null,r=xm(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ai(),n===s){t=sn(e,t,r);break e}Pt(e,t,n,r)}t=t.child}return t;case 5:return ym(t),e===null&&ku(t),n=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,a=s.children,_u(n,s)?a=null:i!==null&&_u(n,i)&&(t.flags|=32),Hm(e,t),Pt(e,t,a,r),t.child;case 6:return e===null&&ku(t),null;case 13:return Km(e,t,r);case 4:return R0(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=li(t,null,n,r):Pt(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wr(n,s),jd(e,t,n,s,r);case 7:return Pt(e,t,t.pendingProps,r),t.child;case 8:return Pt(e,t,t.pendingProps.children,r),t.child;case 12:return Pt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,i=t.memoizedProps,a=s.value,Be(Zl,n._currentValue),n._currentValue=a,i!==null)if(Or(i.value,a)){if(i.children===s.children&&!zt.current){t=sn(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var o=l.firstContext;o!==null;){if(o.context===n){if(i.tag===1){o=Jr(-1,r&-r),o.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?o.next=o:(o.next=f.next,f.next=o),c.pending=o}}i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Nu(i.return,r,t),l.lanes|=r;break}o=o.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Z(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Nu(a,r,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Pt(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Qs(t,r),s=pr(s),n=n(s),t.flags|=1,Pt(e,t,n,r),t.child;case 14:return n=t.type,s=wr(n,t.pendingProps),s=wr(n.type,s),Pd(e,t,n,s,r);case 15:return Wm(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wr(n,s),Dl(e,t),t.tag=1,Ht(n)?(e=!0,Yl(t)):e=!1,Qs(t,r),Bm(t,n,s),Cu(t,n,s,r),Fu(null,t,n,!0,e,r);case 19:return Gm(e,t,r);case 22:return zm(e,t,r)}throw Error(Z(156,t.tag))};function c1(e,t){return Dp(e,t)}function i2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(e,t,r,n){return new i2(e,t,r,n)}function q0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function a2(e){if(typeof e=="function")return q0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===p0)return 11;if(e===m0)return 14}return 2}function Fn(e,t){var r=e.alternate;return r===null?(r=fr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Bl(e,t,r,n,s,i){var a=2;if(n=e,typeof e=="function")q0(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Is:return ns(r.children,s,i,t);case h0:a=8,s|=8;break;case Qc:return e=fr(12,r,t,s|2),e.elementType=Qc,e.lanes=i,e;case Zc:return e=fr(13,r,t,s),e.elementType=Zc,e.lanes=i,e;case eu:return e=fr(19,r,t,s),e.elementType=eu,e.lanes=i,e;case yp:return Mo(r,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gp:a=10;break e;case vp:a=9;break e;case p0:a=11;break e;case m0:a=14;break e;case pn:a=16,n=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=fr(a,r,t,s),t.elementType=e,t.type=n,t.lanes=i,t}function ns(e,t,r,n){return e=fr(7,e,n,t),e.lanes=r,e}function Mo(e,t,r,n){return e=fr(22,e,n,t),e.elementType=yp,e.lanes=r,e.stateNode={isHidden:!1},e}function jc(e,t,r){return e=fr(6,e,null,t),e.lanes=r,e}function Pc(e,t,r){return t=fr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function l2(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hc(0),this.expirationTimes=hc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hc(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Y0(e,t,r,n,s,i,a,l,o){return e=new l2(e,t,r,l,o),t===1?(t=1,i===!0&&(t|=8)):t=0,i=fr(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},P0(i),e}function o2(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Rs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function u1(e){if(!e)return Pn;e=e._reactInternals;e:{if(ps(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var r=e.type;if(Ht(r))return um(e,r,t)}return t}function f1(e,t,r,n,s,i,a,l,o){return e=Y0(r,n,!0,e,s,i,a,l,o),e.context=u1(null),r=e.current,n=Dt(),s=On(r),i=Jr(n,s),i.callback=t??null,Cn(r,i,s),e.current.lanes=s,Ra(e,s,n),Vt(e,n),e}function Bo(e,t,r,n){var s=t.current,i=Dt(),a=On(s);return r=u1(r),t.context===null?t.context=r:t.pendingContext=r,t=Jr(i,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Cn(s,t,a),e!==null&&(Cr(e,s,a,i),Pl(e,s,a)),a}function co(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function J0(e,t){Vd(e,t),(e=e.alternate)&&Vd(e,t)}function c2(){return null}var d1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Q0(e){this._internalRoot=e}Uo.prototype.render=Q0.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Bo(e,t,null,null)};Uo.prototype.unmount=Q0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;cs(function(){Bo(null,e,null,null)}),t[rn]=null}};function Uo(e){this._internalRoot=e}Uo.prototype.unstable_scheduleHydration=function(e){if(e){var t=zp();e={blockedOn:null,target:e,priority:t};for(var r=0;r<xn.length&&t!==0&&t<xn[r].priority;r++);xn.splice(r,0,e),r===0&&Vp(e)}};function Z0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $o(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Kd(){}function u2(e,t,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=co(a);i.call(c)}}var a=f1(t,n,e,0,null,!1,!1,"",Kd);return e._reactRootContainer=a,e[rn]=a.current,pa(e.nodeType===8?e.parentNode:e),cs(),a}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var c=co(o);l.call(c)}}var o=Y0(e,0,!1,null,null,!1,!1,"",Kd);return e._reactRootContainer=o,e[rn]=o.current,pa(e.nodeType===8?e.parentNode:e),cs(function(){Bo(t,o,r,n)}),o}function Wo(e,t,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var o=co(a);l.call(o)}}Bo(t,a,e,s)}else a=u2(r,t,e,s,n);return co(a)}$p=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Mi(t.pendingLanes);r!==0&&(v0(t,r|1),Vt(t,tt()),!(be&6)&&(ui=tt()+500,Bn()))}break;case 13:cs(function(){var n=nn(e,1);if(n!==null){var s=Dt();Cr(n,e,1,s)}}),J0(e,1)}};y0=function(e){if(e.tag===13){var t=nn(e,134217728);if(t!==null){var r=Dt();Cr(t,e,134217728,r)}J0(e,134217728)}};Wp=function(e){if(e.tag===13){var t=On(e),r=nn(e,t);if(r!==null){var n=Dt();Cr(r,e,t,n)}J0(e,t)}};zp=function(){return Ie};Hp=function(e,t){var r=Ie;try{return Ie=e,t()}finally{Ie=r}};uu=function(e,t,r){switch(t){case"input":if(nu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=jo(n);if(!s)throw Error(Z(90));wp(n),nu(n,s)}}}break;case"textarea":Ep(e,r);break;case"select":t=r.value,t!=null&&Xs(e,!!r.multiple,t,!1)}};Op=K0;Fp=cs;var f2={usingClientEntryPoint:!1,Events:[Da,Bs,jo,Cp,bp,K0]},Pi={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},d2={bundleType:Pi.bundleType,version:Pi.version,rendererPackageName:Pi.rendererPackageName,rendererConfig:Pi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:on.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Rp(e),e===null?null:e.stateNode},findFiberByHostInstance:Pi.findFiberByHostInstance||c2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ml=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ml.isDisabled&&ml.supportsFiber)try{Co=ml.inject(d2),Br=ml}catch{}}sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=f2;sr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z0(t))throw Error(Z(200));return o2(e,t,null,r)};sr.createRoot=function(e,t){if(!Z0(e))throw Error(Z(299));var r=!1,n="",s=d1;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Y0(e,1,!1,null,null,r,!1,n,s),e[rn]=t.current,pa(e.nodeType===8?e.parentNode:e),new Q0(t)};sr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=Rp(t),e=e===null?null:e.stateNode,e};sr.flushSync=function(e){return cs(e)};sr.hydrate=function(e,t,r){if(!$o(t))throw Error(Z(200));return Wo(null,e,t,!0,r)};sr.hydrateRoot=function(e,t,r){if(!Z0(e))throw Error(Z(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=d1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=f1(t,null,e,1,r??null,s,!1,i,a),e[rn]=t.current,pa(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Uo(t)};sr.render=function(e,t,r){if(!$o(t))throw Error(Z(200));return Wo(null,e,t,!1,r)};sr.unmountComponentAtNode=function(e){if(!$o(e))throw Error(Z(40));return e._reactRootContainer?(cs(function(){Wo(null,null,e,!1,function(){e._reactRootContainer=null,e[rn]=null})}),!0):!1};sr.unstable_batchedUpdates=K0;sr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$o(r))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Wo(e,t,r,!1,n)};sr.version="18.3.1-next-f1338f8080-20240426";function h1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h1)}catch(e){console.error(e)}}h1(),hp.exports=sr;var h2=hp.exports,p1,Gd=h2;p1=Gd.createRoot,Gd.hydrateRoot;const p2="modulepreload",m2=function(e){return"/"+e},Xd={},Ma=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(o=>{if(o=m2(o),o in Xd)return;Xd[o]=!0;const c=o.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${f}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":p2,c||(d.as="script"),d.crossOrigin="",d.href=o,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((h,m)=>{d.addEventListener("load",h),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${o}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},x2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>xi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ef extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class g2 extends ef{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class qd extends ef{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Yd extends ef{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var zu;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(zu||(zu={}));var v2=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};class y2{constructor(t,{headers:r={},customFetch:n,region:s=zu.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=x2(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return v2(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let l={},{region:o}=r;o||(o=this.region);const c=new URL(`${this.url}/${t}`);o&&o!=="any"&&(l["x-region"]=o,c.searchParams.set("forceFunctionRegion",o));let f;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=a):typeof a=="string"?(l["Content-Type"]="text/plain",f=a):typeof FormData<"u"&&a instanceof FormData?f=a:(l["Content-Type"]="application/json",f=JSON.stringify(a)));const d=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:f}).catch(p=>{throw new g2(p)}),h=d.headers.get("x-relay-error");if(h&&h==="true")throw new qd(d);if(!d.ok)throw new Yd(d);let m=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield d.json():m==="application/octet-stream"?x=yield d.blob():m==="text/event-stream"?x=d:m==="multipart/form-data"?x=yield d.formData():x=yield d.text(),{data:x,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof Yd||s instanceof qd?s.context:void 0}}})}}var $t={},tf={},zo={},Ba={},Ho={},Vo={},_2=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fi=_2();const w2=fi.fetch,m1=fi.fetch.bind(fi),x1=fi.Headers,S2=fi.Request,E2=fi.Response,xi=Object.freeze(Object.defineProperty({__proto__:null,Headers:x1,Request:S2,Response:E2,default:m1,fetch:w2},Symbol.toStringTag,{value:"Module"})),T2=$g(xi);var Ko={};Object.defineProperty(Ko,"__esModule",{value:!0});let k2=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ko.default=k2;var g1=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Vo,"__esModule",{value:!0});const N2=g1(T2),A2=g1(Ko);let C2=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=N2.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,l,o,c;let f=null,d=null,h=null,m=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?d=y:d=JSON.parse(y))}const _=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),v=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");_&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(f={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,m=406,x="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const _=await i.text();try{f=JSON.parse(_),Array.isArray(f)&&i.status===404&&(d=[],f=null,m=200,x="OK")}catch{i.status===404&&_===""?(m=204,x="No Content"):f={message:_}}if(f&&this.isMaybeSingle&&(!((c=f==null?void 0:f.details)===null||c===void 0)&&c.includes("0 rows"))&&(f=null,m=200,x="OK"),f&&this.shouldThrowOnError)throw new A2.default(f)}return{error:f,data:d,count:h,status:m,statusText:x}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,l,o;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(o=i==null?void 0:i.code)!==null&&o!==void 0?o:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};Vo.default=C2;var b2=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ho,"__esModule",{value:!0});const O2=b2(Vo);let F2=class extends O2.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",l=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var l;const o=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${o};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};Ho.default=F2;var j2=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ba,"__esModule",{value:!0});const P2=j2(Ho);let R2=class extends P2.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Ba.default=R2;var I2=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zo,"__esModule",{value:!0});const Ri=I2(Ba);let D2=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",a),n&&this.headers.append("Prefer",`count=${n}`),new Ri.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((l,o)=>l.concat(Object.keys(o)),[]);if(a.length>0){const l=[...new Set(a)].map(o=>`"${o}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ri.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var a;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(o.length>0){const c=[...new Set(o)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ri.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Ri.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ri.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};zo.default=D2;var v1=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tf,"__esModule",{value:!0});const L2=v1(zo),M2=v1(Ba);let B2=class y1{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new L2.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new y1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:i}={}){var a;let l;const o=new URL(`${this.url}/rpc/${t}`);let c;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{o.searchParams.append(d,h)})):(l="POST",c=r);const f=new Headers(this.headers);return i&&f.set("Prefer",`count=${i}`),new M2.default({method:l,url:o,headers:f,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};tf.default=B2;var gi=hr&&hr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($t,"__esModule",{value:!0});$t.PostgrestError=$t.PostgrestBuilder=$t.PostgrestTransformBuilder=$t.PostgrestFilterBuilder=$t.PostgrestQueryBuilder=$t.PostgrestClient=void 0;const _1=gi(tf);$t.PostgrestClient=_1.default;const w1=gi(zo);$t.PostgrestQueryBuilder=w1.default;const S1=gi(Ba);$t.PostgrestFilterBuilder=S1.default;const E1=gi(Ho);$t.PostgrestTransformBuilder=E1.default;const T1=gi(Vo);$t.PostgrestBuilder=T1.default;const k1=gi(Ko);$t.PostgrestError=k1.default;var U2=$t.default={PostgrestClient:_1.default,PostgrestQueryBuilder:w1.default,PostgrestFilterBuilder:S1.default,PostgrestTransformBuilder:E1.default,PostgrestBuilder:T1.default,PostgrestError:k1.default};const{PostgrestClient:$2,PostgrestQueryBuilder:sC,PostgrestFilterBuilder:iC,PostgrestTransformBuilder:aC,PostgrestBuilder:lC,PostgrestError:oC}=U2;class W2{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const z2="2.15.5",H2=`realtime-js/${z2}`,V2="1.0.0",Hu=1e4,K2=1e3,G2=100;var Ji;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ji||(Ji={}));var at;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(at||(at={}));var Er;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Er||(Er={}));var Vu;(function(e){e.websocket="websocket"})(Vu||(Vu={}));var Yn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Yn||(Yn={}));class X2{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(t.slice(a,a+s));a=a+s;const o=n.decode(t.slice(a,a+i));a=a+i;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:l,event:o,payload:c}}}class N1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Me;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Me||(Me={}));const Jd=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,a)=>(i[a]=q2(a,e,t,s),i),{})},q2=(e,t,r,n)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,a=r[e];return i&&!n.includes(i)?A1(i,a):Ku(a)},A1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Z2(t,r)}switch(e){case Me.bool:return Y2(t);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return J2(t);case Me.json:case Me.jsonb:return Q2(t);case Me.timestamp:return e_(t);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return Ku(t);default:return Ku(t)}},Ku=e=>e,Y2=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},J2=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Q2=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Z2=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const a=e.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(l=>A1(t,l))}return e},e_=e=>typeof e=="string"?e.replace(" ","T"):e,C1=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Rc{constructor(t,r,n={},s=Hu){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Qd;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Qd||(Qd={}));class Qi{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Qi.syncState(this.state,s,i,a),this.pendingDiffs.forEach(o=>{this.state=Qi.syncDiff(this.state,o,i,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Qi.syncDiff(this.state,s,i,a),l())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const i=this.cloneDeep(t),a=this.transformState(r),l={},o={};return this.map(i,(c,f)=>{a[c]||(o[c]=f)}),this.map(a,(c,f)=>{const d=i[c];if(d){const h=f.map(_=>_.presence_ref),m=d.map(_=>_.presence_ref),x=f.filter(_=>m.indexOf(_.presence_ref)<0),p=d.filter(_=>h.indexOf(_.presence_ref)<0);x.length>0&&(l[c]=x),p.length>0&&(o[c]=p)}else l[c]=f}),this.syncDiff(i,{joins:l,leaves:o},n,s)}static syncDiff(t,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(l,o)=>{var c;const f=(c=t[l])!==null&&c!==void 0?c:[];if(t[l]=this.cloneDeep(o),f.length>0){const d=t[l].map(m=>m.presence_ref),h=f.filter(m=>d.indexOf(m.presence_ref)<0);t[l].unshift(...h)}n(l,f,o)}),this.map(a,(l,o)=>{let c=t[l];if(!c)return;const f=o.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[l]=c,s(l,c,o),c.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Zd;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Zd||(Zd={}));var Zi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Zi||(Zi={}));var Gr;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Gr||(Gr={}));class rf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=at.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Rc(this,Er.join,this.params,this.timeout),this.rejoinTimer=new N1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=at.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=at.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=at.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Er.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Qi(this),this.broadcastEndpointURL=C1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==at.closed){const{config:{broadcast:a,presence:l,private:o}}=this.params,c=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[Zi.PRESENCE]&&this.bindings[Zi.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,d={},h={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:f}),postgres_changes:c,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Gr.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Gr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket.setAuth(),m===void 0){t==null||t(Gr.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,_=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,v=[];for(let y=0;y<_;y++){const g=p[y],{filter:{event:S,schema:j,table:N,filter:k}}=g,F=m&&m[y];if(F&&F.event===S&&F.schema===j&&F.table===N&&F.filter===k)v.push(Object.assign(Object.assign({},g),{id:F.id}));else{this.unsubscribe(),this.state=at.errored,t==null||t(Gr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Gr.SUBSCRIBED);return}}).receive("error",m=>{this.state=at.errored,t==null||t(Gr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Gr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===at.joined&&t===Zi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:a}=t,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,l,o;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((o=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||o===void 0)&&o.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=at.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Er.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Rc(this,Er.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=at.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Rc(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>G2){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,i;const a=t.toLocaleLowerCase(),{close:l,error:o,leave:c,join:f}=Er;if(n&&[l,o,c,f].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var x,p,_;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((_=(p=m.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===a}).map(m=>m.callback(h,n)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var x,p,_,v,y,g;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const S=m.id,j=(x=m.filter)===null||x===void 0?void 0:x.event;return S&&((p=r.ids)===null||p===void 0?void 0:p.includes(S))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const S=(y=(v=m==null?void 0:m.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return S==="*"||S===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:_,commit_timestamp:v,type:y,errors:g}=x;h=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:v,eventType:y,new:{},old:{},errors:g}),this._getPayloadRecords(x))}m.callback(h,n)})}_isClosed(){return this.state===at.closed}_isJoined(){return this.state===at.joined}_isJoining(){return this.state===at.joining}_isLeaving(){return this.state===at.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&rf.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Er.close,{},t)}_onError(t){this._on(Er.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=at.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Jd(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Jd(t.columns,t.old_record)),r}}const Ic=()=>{},xl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},t_=[1e3,2e3,5e3,1e4],r_=1e4,n_=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class s_{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Hu,this.transport=null,this.heartbeatIntervalMs=xl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ic,this.ref=0,this.reconnectTimer=null,this.logger=Ic,this.conn=null,this.sendBuffer=[],this.serializer=new X2,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>Ma(async()=>{const{default:l}=await Promise.resolve().then(()=>xi);return{default:l}},void 0).then(({default:l})=>l(...a)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Vu.websocket}`,this.httpEndpoint=C1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=W2.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:V2}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ji.connecting:return Yn.Connecting;case Ji.open:return Yn.Open;case Ji.closing:return Yn.Closing;default:return Yn.Closed}}isConnected(){return this.connectionState()===Yn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new rf(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:s,ref:i}=t,a=()=>{this.encode(t,l=>{var o;(o=this.conn)===null||o===void 0||o.send(l)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(K2,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},xl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:a}=r,l=a?`(${a})`:"",o=i.status||"";this.log("receive",`${o} ${n} ${s} ${l}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(s,i,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Er.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([n_],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:H2};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Er.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new N1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,i,a,l,o,c,f;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Hu,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:xl.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=t==null?void 0:t.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Ic,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(o=t==null?void 0:t.reconnectAfterMs)!==null&&o!==void 0?o:d=>t_[d-1]||r_,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class nf extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function ot(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class i_ extends nf{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Gu extends nf{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var a_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};const b1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>xi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},l_=()=>a_(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ma(()=>Promise.resolve().then(()=>xi),void 0)).Response:Response}),Xu=e=>{if(Array.isArray(e))return e.map(r=>Xu(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=Xu(n)}),t},o_=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var ms=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};const Dc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),c_=(e,t,r)=>ms(void 0,void 0,void 0,function*(){const n=yield l_();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,a=(s==null?void 0:s.statusCode)||i+"";t(new i_(Dc(s),i,a))}).catch(s=>{t(new Gu(Dc(s),s))}):t(new Gu(Dc(e),e))}),u_=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(o_(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function Ua(e,t,r,n,s,i){return ms(this,void 0,void 0,function*(){return new Promise((a,l)=>{e(r,u_(t,n,s,i)).then(o=>{if(!o.ok)throw o;return n!=null&&n.noResolveJson?o:o.json()}).then(o=>a(o)).catch(o=>c_(o,l,n))})})}function uo(e,t,r,n){return ms(this,void 0,void 0,function*(){return Ua(e,"GET",t,r,n)})}function Lr(e,t,r,n,s){return ms(this,void 0,void 0,function*(){return Ua(e,"POST",t,n,s,r)})}function qu(e,t,r,n,s){return ms(this,void 0,void 0,function*(){return Ua(e,"PUT",t,n,s,r)})}function f_(e,t,r,n){return ms(this,void 0,void 0,function*(){return Ua(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function O1(e,t,r,n,s){return ms(this,void 0,void 0,function*(){return Ua(e,"DELETE",t,n,s,r)})}var jt=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};const d_={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class h_{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=b1(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return jt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},eh),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const o=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),o&&i.append("metadata",this.encodeMetadata(o))):(i=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,o&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),d=yield(t=="PUT"?qu:Lr)(this.fetch,`${this.url}/object/${f}`,i,Object.assign({headers:l},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ot(i))return{data:null,error:i};throw i}})}upload(t,r,n){return jt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return jt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),a=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",r);try{let o;const c=Object.assign({upsert:eh.upsert},s),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",c.cacheControl),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",c.cacheControl)):(o=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const d=yield qu(this.fetch,l.toString(),o,{headers:f});return{data:{path:i,fullPath:d.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(ot(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(t,r){return jt(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Lr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),l=a.searchParams.get("token");if(!l)throw new nf("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n))return{data:null,error:n};throw n}})}update(t,r,n){return jt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return jt(this,void 0,void 0,function*(){try{return{data:yield Lr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ot(s))return{data:null,error:s};throw s}})}copy(t,r,n){return jt(this,void 0,void 0,function*(){try{return{data:{path:(yield Lr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ot(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return jt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Lr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ot(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return jt(this,void 0,void 0,function*(){try{const s=yield Lr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ot(s))return{data:null,error:s};throw s}})}download(t,r){return jt(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield uo(this.fetch,`${this.url}/${s}/${l}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ot(l))return{data:null,error:l};throw l}})}info(t){return jt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield uo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Xu(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n))return{data:null,error:n};throw n}})}exists(t){return jt(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield f_(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n)&&n instanceof Gu){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});o!==""&&s.push(o);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${c}`)}}}remove(t){return jt(this,void 0,void 0,function*(){try{return{data:yield O1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ot(r))return{data:null,error:r};throw r}})}list(t,r,n){return jt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},d_),r),{prefix:t||""});return{data:yield Lr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ot(s))return{data:null,error:s};throw s}})}listV2(t,r){return jt(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Lr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const p_="2.12.1",m_={"X-Client-Info":`storage-js/${p_}`};var Es=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};class x_{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},m_),r),this.fetch=b1(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Es(this,void 0,void 0,function*(){try{return{data:yield uo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ot(t))return{data:null,error:t};throw t}})}getBucket(t){return Es(this,void 0,void 0,function*(){try{return{data:yield uo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ot(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Es(this,void 0,void 0,function*(){try{return{data:yield Lr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Es(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ot(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Es(this,void 0,void 0,function*(){try{return{data:yield Lr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ot(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Es(this,void 0,void 0,function*(){try{return{data:yield O1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ot(r))return{data:null,error:r};throw r}})}}class g_ extends x_{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new h_(this.url,this.headers,t,this.fetch)}}const v_="2.57.4";let Ui="";typeof Deno<"u"?Ui="deno":typeof document<"u"?Ui="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ui="react-native":Ui="node";const y_={"X-Client-Info":`supabase-js-${Ui}/${v_}`},__={headers:y_},w_={schema:"public"},S_={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},E_={};var T_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};const k_=e=>{let t;return e?t=e:typeof fetch>"u"?t=m1:t=fetch,(...r)=>t(...r)},N_=()=>typeof Headers>"u"?x1:Headers,A_=(e,t,r)=>{const n=k_(r),s=N_();return(i,a)=>T_(void 0,void 0,void 0,function*(){var l;const o=(l=yield t())!==null&&l!==void 0?l:e;let c=new s(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${o}`),n(i,Object.assign(Object.assign({},a),{headers:c}))})};var C_=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};function b_(e){return e.endsWith("/")?e:e+"/"}function O_(e,t){var r,n;const{db:s,auth:i,realtime:a,global:l}=e,{db:o,auth:c,realtime:f,global:d}=t,h={db:Object.assign(Object.assign({},o),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},f),a),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>C_(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function F_(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b_(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const F1="2.71.1",Fs=30*1e3,Yu=3,Lc=Yu*Fs,j_="http://localhost:9999",P_="supabase.auth.token",R_={"X-Client-Info":`gotrue-js/${F1}`},Ju="X-Supabase-Api-Version",j1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},I_=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,D_=10*60*1e3;class sf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function we(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class L_ extends sf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function M_(e){return we(e)&&e.name==="AuthApiError"}class P1 extends sf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Un extends sf{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class hn extends Un{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function B_(e){return we(e)&&e.name==="AuthSessionMissingError"}class gl extends Un{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vl extends Un{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yl extends Un{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function U_(e){return we(e)&&e.name==="AuthImplicitGrantRedirectError"}class th extends Un{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qu extends Un{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Mc(e){return we(e)&&e.name==="AuthRetryableFetchError"}class rh extends Un{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Zu extends Un{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const fo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nh=` 	
\r=`.split(""),$_=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<nh.length;t+=1)e[nh[t].charCodeAt(0)]=-2;for(let t=0;t<fo.length;t+=1)e[fo[t].charCodeAt(0)]=t;return e})();function sh(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(fo[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(fo[n]),t.queuedBits-=6}}function R1(e,t,r){const n=$_[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function ih(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{H_(a,n,r)};for(let a=0;a<e.length;a+=1)R1(e.charCodeAt(a),s,i);return t.join("")}function W_(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function z_(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}W_(n,t)}}function H_(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function V_(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)R1(e.charCodeAt(s),r,n);return new Uint8Array(t)}function K_(e){const t=[];return z_(e,r=>t.push(r)),new Uint8Array(t)}function G_(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>sh(s,r,n)),sh(null,r,n),t.join("")}function X_(e){return Math.round(Date.now()/1e3)+e}function q_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const _r=()=>typeof window<"u"&&typeof document<"u",Vn={tested:!1,writable:!1},I1=()=>{if(!_r())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vn.tested)return Vn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vn.tested=!0,Vn.writable=!0}catch{Vn.tested=!0,Vn.writable=!1}return Vn.writable};function Y_(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const D1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ma(async()=>{const{default:n}=await Promise.resolve().then(()=>xi);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},J_=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",js=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Kn=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},fn=async(e,t)=>{await e.removeItem(t)};class Go{constructor(){this.promise=new Go.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Go.promiseConstructor=Promise;function Bc(e){const t=e.split(".");if(t.length!==3)throw new Zu("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!I_.test(t[n]))throw new Zu("JWT not in base64url format");return{header:JSON.parse(ih(t[0])),payload:JSON.parse(ih(t[1])),signature:V_(t[2]),raw:{header:t[0],payload:t[1]}}}async function Q_(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Z_(e,t){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await e(i);if(!t(i,null,a)){n(a);return}}catch(a){if(!t(i,a)){s(a);return}}})()})}function ew(e){return("0"+e.toString(16)).substr(-2)}function tw(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,ew).join("")}async function rw(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function nw(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await rw(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ts(e,t,r=!1){const n=tw();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await js(e,`${t}-code-verifier`,s);const i=await nw(n);return[i,n===i?"plain":"s256"]}const sw=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iw(e){const t=e.headers.get(Ju);if(!t||!t.match(sw))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function aw(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lw(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ow=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ks(e){if(!ow.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Uc(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ah(e){return JSON.parse(JSON.stringify(e))}var cw=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const qn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),uw=[502,503,504];async function lh(e){var t;if(!J_(e))throw new Qu(qn(e),0);if(uw.includes(e.status))throw new Qu(qn(e),e.status);let r;try{r=await e.json()}catch(i){throw new P1(qn(i),i)}let n;const s=iw(e);if(s&&s.getTime()>=j1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new rh(qn(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new hn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new rh(qn(r),e.status,r.weak_password.reasons);throw new L_(qn(r),e.status||500,n)}const fw=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Te(e,t,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Ju]||(i[Ju]=j1["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",o=await dw(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(o):{data:Object.assign({},o),error:null}}async function dw(e,t,r,n,s,i){const a=fw(t,n,s,i);let l;try{l=await e(r,Object.assign({},a))}catch(o){throw console.error(o),new Qu(qn(o),0)}if(l.ok||await lh(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(o){await lh(o)}}function Vr(e){var t;let r=null;xw(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=X_(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function oh(e){const t=Vr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function vn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function hw(e){return{data:e,error:null}}function pw(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=e,a=cw(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},o=Object.assign({},a);return{data:{properties:l,user:o},error:null}}function mw(e){return e}function xw(e){return e.access_token&&e.refresh_token&&e.expires_in}const $c=["global","local","others"];var gw=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class vw{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=D1(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=$c[0]){if($c.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$c.join(", ")}`);try{return await Te(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Te(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:vn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=gw(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:pw,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(we(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Te(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:vn})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,i,a,l,o;try{const c={nextPage:null,lastPage:0,total:0},f=await Te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:mw});if(f.error)throw f.error;const d=await f.json(),h=(a=f.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(o=(l=f.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&o!==void 0?o:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(x.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(we(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){ks(t);try{return await Te(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:vn})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ks(t);try{return await Te(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:vn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ks(t);try{return await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:vn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ks(t.userId);try{const{data:r,error:n}=await Te(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(we(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ks(t.userId),ks(t.id);try{return{data:await Te(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}}function ch(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function yw(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ns={debug:!!(globalThis&&I1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class L1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class _w extends L1{}async function ww(e,t,r){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Ns.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new _w(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ns.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}yw();const Sw={url:j_,storageKey:P_,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:R_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function uh(e,t,r){return await r()}const As={};class Ea{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ea.nextInstanceID,Ea.nextInstanceID+=1,this.instanceID>0&&_r()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Sw),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new vw({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=D1(s.fetch),this.lock=s.lock||uh,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:_r()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=ww:this.lock=uh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:I1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=ch(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=ch(this.memoryStorage)),_r()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=As[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){As[this.storageKey]=Object.assign(Object.assign({},As[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=As[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){As[this.storageKey]=Object.assign(Object.assign({},As[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${F1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Y_(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),_r()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),U_(i)){const o=(t=i.details)===null||t===void 0?void 0:t.code;if(o==="identity_already_exists"||o==="identity_not_found"||o==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return we(r)?{error:r}:{error:new P1("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const i=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Vr}),{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const o=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(i){if(we(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,s;try{let i;if("email"in t){const{email:f,password:d,options:h}=t;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await Ts(this.storage,this.storageKey)),i=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Vr})}else if("phone"in t){const{phone:f,password:d,options:h}=t;i=await Te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Vr})}else throw new vl("You must provide either an email or phone number and a password");const{data:a,error:l}=i;if(l||!a)return{data:{user:null,session:null},error:l};const o=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(i){if(we(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:a,options:l}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:oh})}else if("phone"in t){const{phone:i,password:a,options:l}=t;r=await Te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:oh})}else throw new vl("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new gl}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,s,i,a,l,o,c,f,d,h,m;let x,p;if("message"in t)x=t.message,p=t.signature;else{const{chain:_,wallet:v,statement:y,options:g}=t;let S;if(_r())if(typeof v=="object")S=v;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))S=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=v}const j=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const N=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),y?{statement:y}:null));let k;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")k=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)k=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),p=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${j.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((d=(f=g==null?void 0:g.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...g.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const N=await S.signMessage(new TextEncoder().encode(x),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=N}}try{const{data:_,error:v}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:G_(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Vr});if(v)throw v;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new gl}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:v})}catch(_){if(we(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(t){const r=await Kn(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Vr});if(await fn(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new gl}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(we(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=t,l=await Te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Vr}),{data:o,error:c}=l;return c?{data:{user:null,session:null},error:c}:!o||!o.session||!o.user?{data:{user:null,session:null},error:new gl}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:c})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,i,a;try{if("email"in t){const{email:l,options:o}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Ts(this.storage,this.storageKey));const{error:d}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=o==null?void 0:o.data)!==null&&r!==void 0?r:{},create_user:(n=o==null?void 0:o.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:l,options:o}=t,{data:c,error:f}=await Te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=o==null?void 0:o.data)!==null&&s!==void 0?s:{},create_user:(i=o==null?void 0:o.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken},channel:(a=o==null?void 0:o.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new vl("You must provide either an email or phone number.")}catch(l){if(we(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await Te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Vr});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const o=a.session,c=a.user;return o!=null&&o.access_token&&(await this._saveSession(o),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:c,session:o},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Ts(this.storage,this.storageKey)),await Te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:hw})}catch(i){if(we(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new hn;const{error:s}=await Te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:i}=t,{error:a}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:s,options:i}=t,{data:a,error:l}=await Te(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:l}}throw new vl("You must provide either an email or phone number and a type")}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Kn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Lc:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const a=await Kn(this.userStorage,this.storageKey+"-user");a!=null&&a.user?t.user=a.user:t.user=Uc()}if(this.storage.isServer&&t.user){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(o,c,f)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(o,c,f))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:vn}):await this._useSession(async r=>{var n,s,i;const{data:a,error:l}=r;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new hn}:await Te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:vn})})}catch(r){if(we(r))return B_(r)&&(await this._removeSession(),await fn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new hn;const a=s.session;let l=null,o=null;this.flowType==="pkce"&&t.email!=null&&([l,o]=await Ts(this.storage,this.storageKey));const{data:c,error:f}=await Te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:o}),jwt:a.access_token,xform:vn});if(f)throw f;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new hn;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=Bc(t.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:l,error:o}=await this._callRefreshToken(t.refresh_token);if(o)return{data:{user:null,session:null},error:o};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:o}=await this._getUser(t.access_token);if(o)throw o;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(we(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:l}=r;if(l)throw l;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new hn;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!_r())throw new yl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new yl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new th("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new th("No code detected.");const{data:y,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:l,expires_at:o,token_type:c}=t;if(!i||!l||!a||!c)throw new yl("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(l);let h=f+d;o&&(h=parseInt(o));const m=h-f;m*1e3<=Fs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${d}s`);const x=h-d;f-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,f):f-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,f);const{data:p,error:_}=await this._getUser(i);if(_)throw _;const v={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(n){if(we(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Kn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,t);if(l&&!(M_(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await fn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=q_(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ts(this.storage,this.storageKey,!0));try{return await Te(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(we(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,l,o,c,f;const{data:d,error:h}=i;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:!0});return await Te(this.fetch,"GET",m,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return _r()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(we(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Te(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Z_(async s=>(s>0&&await Q_(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Vr})),(s,i)=>{const a=200*Math.pow(2,s);return i&&Mc(i)&&Date.now()+a-n<Fs})}catch(n){if(this._debug(r,"error",n),we(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),_r()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Kn(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Kn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await js(this.userStorage,this.storageKey+"-user",a)),s.user=(t=a==null?void 0:a.user)!==null&&t!==void 0?t:Uc()}else if(s&&!s.user&&!s.user){const a=await Kn(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await fn(this.storage,this.storageKey+"-user"),await js(this.storage,this.storageKey,s)):s.user=Uc()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Lc;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Lc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Mc(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(s.access_token);!l&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new hn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Go;const{data:i,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!i.session)throw new hn;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),we(i)){const a={session:null,error:i};return Mc(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(o){i.push(o)}});if(await Promise.all(a),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await js(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=ah(s);await js(this.storage,this.storageKey,i)}else{const s=ah(r);await js(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await fn(this.storage,this.storageKey),await fn(this.storage,this.storageKey+"-code-verifier"),await fn(this.storage,this.storageKey+"-user"),this.userStorage&&await fn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&_r()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Fs);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Fs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Fs}ms, refresh threshold is ${Yu} ticks`),s<=Yu&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof L1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!_r()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ts(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Te(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:o,error:c}=await Te(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((s=o==null?void 0:o.totp)===null||s===void 0)&&s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:l}=await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(r){if(we(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Te(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(we(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Bc(s.access_token);let l=null;a.aal&&(l=a.aal);let o=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(o="aal2");const f=a.amr||[];return{data:{currentLevel:l,nextLevel:o,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+D_>s)return n;const{data:i,error:a}=await Te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};n=m.session.access_token}const{header:s,payload:i,signature:a,raw:{header:l,payload:o}}=Bc(n);r!=null&&r.allowExpired||aw(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:s,signature:a},error:null}}const f=lw(s.alg),d=await crypto.subtle.importKey("jwk",c,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,a,K_(`${l}.${o}`)))throw new Zu("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}}Ea.nextInstanceID=0;const Ew=Ea;class Tw extends Ew{constructor(t){super(t)}}var kw=function(e,t,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{c(n.next(f))}catch(d){a(d)}}function o(f){try{c(n.throw(f))}catch(d){a(d)}}function c(f){f.done?i(f.value):s(f.value).then(l,o)}c((n=n.apply(e,t||[])).next())})};class Nw{constructor(t,r,n){var s,i,a;this.supabaseUrl=t,this.supabaseKey=r;const l=F_(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const o=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:w_,realtime:E_,auth:Object.assign(Object.assign({},S_),{storageKey:o}),global:__},f=O_(n??{},c);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=f.auth)!==null&&a!==void 0?a:{},this.headers,f.global.fetch),this.fetch=A_(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new $2(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new g_(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new y2(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return kw(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:a,flowType:l,lock:o,debug:c},f,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Tw({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),f),storageKey:a,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:l,lock:o,debug:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new s_(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Aw=(e,t,r)=>new Nw(e,t,r);function Cw(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Cw()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const bw="https://ddqayedrbldmaqkbkuro.supabase.co",Ow="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkcWF5ZWRyYmxkbWFxa2JrdXJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0MTQ5NjcsImV4cCI6MjA3NTk5MDk2N30.Da3b-6YLgRrd2hMRHLpiUa-M8ooGW3g4qS531FY_NoA",xe=Aw(bw,Ow,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),M1=ee.createContext(void 0);function Fw({children:e}){const[t,r]=ee.useState(null),[n,s]=ee.useState(null),[i,a]=ee.useState(null),[l,o]=ee.useState(!0),c=async p=>{try{const{data:_,error:v}=await xe.from("user_profiles").select("*").eq("id",p).maybeSingle();if(v)throw v;s(_)}catch(_){console.error("Error fetching profile:",_),s(null)}};ee.useEffect(()=>{xe.auth.getSession().then(({data:{session:_}})=>{a(_),r((_==null?void 0:_.user)??null),_!=null&&_.user&&c(_.user.id),o(!1)});const{data:{subscription:p}}=xe.auth.onAuthStateChange((_,v)=>{(async()=>(a(v),r((v==null?void 0:v.user)??null),v!=null&&v.user?await c(v.user.id):s(null),o(!1)))()});return()=>p.unsubscribe()},[]);const x={user:t,profile:n,session:i,loading:l,signIn:async(p,_)=>{try{const y=await fetch("https://ddqayedrbldmaqkbkuro.supabase.co/functions/v1/login",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkcWF5ZWRyYmxkbWFxa2JrdXJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0MTQ5NjcsImV4cCI6MjA3NTk5MDk2N30.Da3b-6YLgRrd2hMRHLpiUa-M8ooGW3g4qS531FY_NoA"},body:JSON.stringify({netId:p,password:_})}),g=await y.json();if(!y.ok)return{error:new Error(g.error||"Login failed")};const{error:S}=await xe.auth.setSession({access_token:g.session.access_token,refresh_token:g.session.refresh_token});return S?{error:S}:{error:null}}catch(v){return{error:v}}},signOut:async()=>{await xe.auth.signOut(),r(null),s(null),a(null)},updatePassword:async p=>{try{const{error:_}=await xe.auth.updateUser({password:p});return _?{error:_}:(n!=null&&n.temporary_password&&(await xe.from("user_profiles").update({temporary_password:!1}).eq("id",t.id),await c(t.id)),{error:null})}catch(_){return{error:_}}},refreshProfile:async()=>{t&&await c(t.id)}};return u.jsx(M1.Provider,{value:x,children:e})}function Fr(){const e=ee.useContext(M1);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ne=(e,t)=>{const r=ee.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:o,...c},f)=>ee.createElement("svg",{ref:f,...jw,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${Pw(e)}`,l].join(" "),...c},[...t.map(([d,h])=>ee.createElement(d,h)),...Array.isArray(o)?o:[o]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=Ne("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=Ne("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Ne("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=Ne("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Ne("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=Ne("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=Ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Ne("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Ne("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=Ne("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=Ne("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=Ne("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=Ne("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=Ne("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=Ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=Ne("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Ne("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uw=Ne("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=Ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Ne("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=Ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Ne("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zw=Ne("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W1=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Ne("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=Ne("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=Ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z1=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Ne("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H1=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Kw(){const[e,t]=ee.useState("database"),[r,n]=ee.useState({supabaseUrl:"https://ddqayedrbldmaqkbkuro.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRkcWF5ZWRyYmxkbWFxa2JrdXJvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA0MTQ5NjcsImV4cCI6MjA3NTk5MDk2N30.Da3b-6YLgRrd2hMRHLpiUa-M8ooGW3g4qS531FY_NoA"}),[s,i]=ee.useState({netId:"",email:"",fullName:"",password:"",confirmPassword:""}),[a,l]=ee.useState(!1),[o,c]=ee.useState(""),f=async h=>{h.preventDefault(),c(""),l(!0);try{if(!(await fetch(`${r.supabaseUrl}/functions/v1/check-setup`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.supabaseAnonKey}`}})).ok)throw new Error("Unable to connect to database. Please check your credentials.");t("admin")}catch(m){c(m instanceof Error?m.message:"Failed to connect to database")}finally{l(!1)}},d=async h=>{if(h.preventDefault(),c(""),s.password!==s.confirmPassword){c("Passwords do not match");return}if(s.password.length<8){c("Password must be at least 8 characters");return}l(!0);try{const m=`${r.supabaseUrl}/functions/v1/create-first-admin`,x=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.supabaseAnonKey}`},body:JSON.stringify({netId:s.netId,email:s.email,fullName:s.fullName,password:s.password})}),p=await x.json();if(!x.ok)throw new Error(p.error||"Failed to create administrator");t("success")}catch(m){c(m instanceof Error?m.message:"An error occurred")}finally{l(!1)}};return e==="database"?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:u.jsx(Ta,{className:"w-12 h-12 text-white"})})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"University Key Management System"}),u.jsx("p",{className:"text-sm text-center text-slate-600 mb-2",children:"Step 1 of 2: Database Configuration"}),u.jsx("p",{className:"text-xs text-center text-slate-400 mb-6",children:"Designed by Hector Reyes & Oscar Melo"}),o&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700",children:o})}),u.jsxs("form",{onSubmit:f,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supabase URL"}),u.jsx("input",{type:"url",value:r.supabaseUrl,onChange:h=>n({...r,supabaseUrl:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"https://your-project.supabase.co",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supabase Anon Key"}),u.jsx("textarea",{value:r.supabaseAnonKey,onChange:h=>n({...r,supabaseAnonKey:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition font-mono text-xs",placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,required:!0,disabled:a})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Testing Connection...":"Continue to Admin Setup"})]})]})})}):e==="success"?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:"bg-green-500 p-4 rounded-2xl",children:u.jsx(Vw,{className:"w-12 h-12 text-white"})})}),u.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Setup Complete!"}),u.jsx("p",{className:"text-slate-600 mb-4",children:"Your super administrator account has been created successfully."}),u.jsx("p",{className:"text-xs text-slate-400 mb-6",children:"University Key Management System by Hector Reyes & Oscar Melo"}),u.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6 text-left",children:[u.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"Login Credentials:"}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"NetID:"})," ",s.netId]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Email:"})," ",s.email]})]}),u.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Go to Login"})]})})}):u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:u.jsx(af,{className:"w-12 h-12 text-white"})})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Create Super Administrator"}),u.jsx("p",{className:"text-sm text-center text-slate-600 mb-8",children:"Step 2 of 2: Create your first Super Administrator account"}),o&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700",children:o})}),u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name"}),u.jsx("input",{type:"text",value:s.fullName,onChange:h=>i({...s,fullName:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"John Doe",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID"}),u.jsx("input",{type:"text",value:s.netId,onChange:h=>i({...s,netId:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"admin",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),u.jsx("input",{type:"email",value:s.email,onChange:h=>i({...s,email:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"admin@university.edu",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),u.jsx("input",{type:"password",value:s.password,onChange:h=>i({...s,password:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Minimum 8 characters",required:!0,disabled:a,minLength:8})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),u.jsx("input",{type:"password",value:s.confirmPassword,onChange:h=>i({...s,confirmPassword:h.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Confirm your password",required:!0,disabled:a,minLength:8})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Creating...":"Create Administrator"})]})]})})})}function Gw(){const[e,t]=ee.useState(""),[r,n]=ee.useState(""),[s,i]=ee.useState(""),[a,l]=ee.useState(!1),{signIn:o}=Fr(),c=async f=>{f.preventDefault(),i(""),l(!0);const{error:d}=await o(e,r);d&&i(d.message),l(!1)};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:u.jsx(af,{className:"w-12 h-12 text-white"})})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"University Key Management System"}),u.jsx("p",{className:"text-sm text-center text-slate-600 mb-6",children:"Multi-Campus Key Management Solution"}),u.jsx("p",{className:"text-xs text-center text-slate-400 mb-8",children:"Designed by Hector Reyes & Oscar Melo"}),s&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700",children:s})}),u.jsxs("form",{onSubmit:c,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"netId",className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID"}),u.jsx("input",{id:"netId",type:"text",value:e,onChange:f=>t(f.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter your NetID",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),u.jsx("input",{id:"password",type:"password",value:r,onChange:f=>n(f.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter your password",required:!0,disabled:a})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Signing in...":"Sign In"})]})]}),u.jsx("p",{className:"text-center text-sm text-slate-600 mt-6",children:"Authorized personnel only"})]})})}function Xw(){const[e,t]=ee.useState(""),[r,n]=ee.useState(""),[s,i]=ee.useState(""),[a,l]=ee.useState(!1),{updatePassword:o,profile:c}=Fr(),f=async d=>{if(d.preventDefault(),i(""),e.length<8){i("Password must be at least 8 characters long");return}if(e!==r){i("Passwords do not match");return}l(!0);const{error:h}=await o(e);h&&(i(h.message),l(!1))};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"w-full max-w-md",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:"bg-amber-500 p-4 rounded-2xl",children:u.jsx($w,{className:"w-12 h-12 text-white"})})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Change Password Required"}),u.jsxs("p",{className:"text-sm text-center text-slate-600 mb-8",children:["Welcome, ",c==null?void 0:c.full_name,". Please set a new password to continue."]}),u.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg flex gap-3",children:[u.jsx(B1,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{className:"text-sm text-amber-800",children:[u.jsx("p",{className:"font-medium mb-1",children:"Password Requirements:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"At least 8 characters long"}),u.jsx("li",{children:"Use a strong, unique password"})]})]})]}),s&&u.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:u.jsx("p",{className:"text-sm text-red-700",children:s})}),u.jsxs("form",{onSubmit:f,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-slate-700 mb-1",children:"New Password"}),u.jsx("input",{id:"newPassword",type:"password",value:e,onChange:d=>t(d.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter new password",required:!0,disabled:a})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),u.jsx("input",{id:"confirmPassword",type:"password",value:r,onChange:d=>n(d.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Confirm new password",required:!0,disabled:a})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Updating...":"Update Password"})]})]})})})}function qw({children:e,currentView:t,onNavigate:r}){const{profile:n,signOut:s}=Fr(),[i,a]=ee.useState(!0),l=(n==null?void 0:n.role)==="administrator"||(n==null?void 0:n.role)==="super_administrator",o=l,c=l,f=l,d=(n==null?void 0:n.role)==="super_administrator",h=[{id:"dashboard",label:"Dashboard",icon:Uw,show:!0},{id:"campuses",label:"Campuses",icon:lf,show:!0},{id:"buildings",label:"Buildings",icon:Xo,show:!0},{id:"key-systems",label:"Key Systems",icon:Ta,show:!0},{id:"keys",label:"Keys",icon:ka,show:!0},{id:"reports",label:"Reports",icon:U1,show:!0},{id:"users",label:"User Management",icon:z1,show:l},{id:"audit-logs",label:"Audit Logs",icon:$1,show:o},{id:"error-reports",label:"Error Reports",icon:e0,show:c},{id:"backup",label:"Backup & Export",icon:Ta,show:f},{id:"system-config",label:"System Configuration",icon:W1,show:d}],m=p=>{switch(p){case"super_administrator":return"bg-red-100 text-red-700 border-red-200";case"administrator":return"bg-blue-100 text-blue-700 border-blue-200";case"standard_user":return"bg-green-100 text-green-700 border-green-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},x=p=>{switch(p){case"super_administrator":return"Super Admin";case"administrator":return"Administrator";case"standard_user":return"Standard User";case"basic_user":return"Basic User";default:return p}};return u.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[u.jsxs("aside",{className:`${i?"w-64":"w-20"} bg-white border-r border-slate-200 transition-all duration-300 flex flex-col`,children:[u.jsxs("div",{className:"h-16 border-b border-slate-200 flex items-center justify-between px-4",children:[i&&u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"bg-slate-900 p-2 rounded-lg",children:u.jsx(af,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"font-bold text-slate-900 text-sm",children:"UKMS"}),u.jsx("span",{className:"text-[9px] text-slate-500 leading-tight",children:"by HR & OM"})]})]}),u.jsx("button",{onClick:()=>a(!i),className:"p-2 hover:bg-slate-100 rounded-lg transition",children:i?u.jsx(H1,{className:"w-5 h-5 text-slate-600"}):u.jsx(Ww,{className:"w-5 h-5 text-slate-600"})})]}),u.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:h.filter(p=>p.show).map(p=>{const _=p.icon,v=t===p.id;return u.jsxs("button",{onClick:()=>r(p.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition ${v?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-100"}`,title:i?"":p.label,children:[u.jsx(_,{className:"w-5 h-5 flex-shrink-0"}),i&&u.jsx("span",{className:"text-sm font-medium",children:p.label})]},p.id)})}),u.jsx("div",{className:"border-t border-slate-200 p-4",children:i?u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:n==null?void 0:n.full_name}),u.jsx("p",{className:"text-xs text-slate-600 truncate",children:n==null?void 0:n.net_id}),u.jsx("span",{className:`inline-block mt-2 text-xs font-medium px-2 py-1 rounded border ${m((n==null?void 0:n.role)||"")}`,children:x((n==null?void 0:n.role)||"")})]}),u.jsxs("button",{onClick:s,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-700 hover:bg-red-50 rounded-lg transition",children:[u.jsx(dh,{className:"w-4 h-4"}),u.jsx("span",{children:"Sign Out"})]})]}):u.jsx("button",{onClick:s,className:"w-full p-2 text-red-700 hover:bg-red-50 rounded-lg transition",title:"Sign Out",children:u.jsx(dh,{className:"w-5 h-5"})})})]}),u.jsx("main",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"p-8",children:e})})]})}function ph(){const[e,t]=ee.useState({campuses:0,buildings:0,totalKeys:0,assignedKeys:0,unassignedKeys:0,users:0}),[r,n]=ee.useState(!0);ee.useEffect(()=>{s()},[]);const s=async()=>{var a,l;try{const[o,c,f,d]=await Promise.all([xe.from("campuses").select("id",{count:"exact",head:!0}),xe.from("buildings").select("id",{count:"exact",head:!0}),xe.from("keys").select("id, status",{count:"exact"}),xe.from("user_profiles").select("id",{count:"exact",head:!0})]),h=((a=f.data)==null?void 0:a.filter(x=>x.status==="assigned").length)||0,m=((l=f.data)==null?void 0:l.filter(x=>x.status==="unassigned").length)||0;t({campuses:o.count||0,buildings:c.count||0,totalKeys:f.count||0,assignedKeys:h,unassignedKeys:m,users:d.count||0})}catch(o){console.error("Error fetching stats:",o)}finally{n(!1)}},i=[{label:"Total Campuses",value:e.campuses,icon:lf,color:"bg-blue-500"},{label:"Total Buildings",value:e.buildings,icon:Xo,color:"bg-green-500"},{label:"Total Keys",value:e.totalKeys,icon:ka,color:"bg-slate-500"},{label:"Assigned Keys",value:e.assignedKeys,icon:t0,color:"bg-emerald-500"},{label:"Available Keys",value:e.unassignedKeys,icon:ka,color:"bg-amber-500"},{label:"System Users",value:e.users,icon:z1,color:"bg-slate-600"}];return r?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Dashboard"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((a,l)=>u.jsxs("div",{className:"bg-white rounded-xl p-6 animate-pulse",children:[u.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/2 mb-4"}),u.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/3"})]},l))})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Dashboard"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Overview of the University Key Management System"})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((a,l)=>{const o=a.icon;return u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-slate-600 mb-2",children:a.label}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:a.value})]}),u.jsx("div",{className:`${a.color} p-3 rounded-xl`,children:u.jsx(o,{className:"w-6 h-6 text-white"})})]})},l)})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"System Status"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between py-2",children:[u.jsx("span",{className:"text-sm text-slate-600",children:"Database Connection"}),u.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[u.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),u.jsx("span",{className:"text-green-700 font-medium",children:"Connected"})]})]}),u.jsxs("div",{className:"flex items-center justify-between py-2",children:[u.jsx("span",{className:"text-sm text-slate-600",children:"System Health"}),u.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[u.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),u.jsx("span",{className:"text-green-700 font-medium",children:"Operational"})]})]}),u.jsxs("div",{className:"flex items-center justify-between py-2",children:[u.jsx("span",{className:"text-sm text-slate-600",children:"Key Utilization"}),u.jsxs("span",{className:"text-sm font-medium text-slate-900",children:[e.totalKeys>0?Math.round(e.assignedKeys/e.totalKeys*100):0,"%"]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Quick Actions"}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"View All Keys"}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Generate Report"}),u.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Assign New Key"})]})]})]})]})}function Ha(){const{profile:e}=Fr();return{logAction:async(r,n,s,i)=>{if(e)try{await xe.from("audit_logs").insert({user_id:e.id,user_net_id:e.net_id,user_full_name:e.full_name,action_type:r,entity_type:n,description:s,entity_id:(i==null?void 0:i.entityId)||null,campus_id:(i==null?void 0:i.campusId)||null,building_id:(i==null?void 0:i.buildingId)||null,metadata:(i==null?void 0:i.metadata)||{}})}catch(a){console.error("Failed to log action:",a)}}}}function Yw(){const{profile:e}=Fr(),{logAction:t}=Ha(),[r,n]=ee.useState([]),[s,i]=ee.useState(!0),[a,l]=ee.useState(""),[o,c]=ee.useState(!1),[f,d]=ee.useState(null),[h,m]=ee.useState({name:"",code:"",address:"",active:!0}),x=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="super_administrator";ee.useEffect(()=>{p()},[]);const p=async()=>{try{const{data:S,error:j}=await xe.from("campuses").select("*").order("name");if(j)throw j;n(S||[])}catch(S){console.error("Error fetching campuses:",S)}finally{i(!1)}},_=async S=>{S.preventDefault();try{if(f){const{error:j}=await xe.from("campuses").update({...h,updated_at:new Date().toISOString()}).eq("id",f.id);if(j)throw j;await t("update","campus",`Updated campus: ${h.name}`,{entityId:f.id,metadata:h})}else{const{data:j,error:N}=await xe.from("campuses").insert([h]).select().single();if(N)throw N;await t("create","campus",`Created campus: ${h.name}`,{entityId:j.id,metadata:h})}c(!1),d(null),m({name:"",code:"",address:"",active:!0}),p()}catch(j){console.error("Error saving campus:",j),alert("Error saving campus. Please try again.")}},v=S=>{d(S),m({name:S.name,code:S.code,address:S.address,active:S.active}),c(!0)},y=async S=>{if(confirm(`Are you sure you want to delete "${S.name}"?`))try{const{error:j}=await xe.from("campuses").delete().eq("id",S.id);if(j)throw j;await t("delete","campus",`Deleted campus: ${S.name}`,{entityId:S.id,metadata:{name:S.name,code:S.code}}),p()}catch(j){console.error("Error deleting campus:",j),alert("Error deleting campus. It may have associated buildings or keys.")}},g=r.filter(S=>S.name.toLowerCase().includes(a.toLowerCase())||S.code.toLowerCase().includes(a.toLowerCase()));return s?u.jsx("div",{className:"text-center py-12",children:"Loading campuses..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Campuses"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage university campuses"})]}),x&&u.jsxs("button",{onClick:()=>{d(null),m({name:"",code:"",address:"",active:!0}),c(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[u.jsx(Wa,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Campus"})]})]}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:f?"Edit Campus":"Add Campus"}),u.jsxs("form",{onSubmit:_,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus Name"}),u.jsx("input",{type:"text",value:h.name,onChange:S=>m({...h,name:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus Code"}),u.jsx("input",{type:"text",value:h.code,onChange:S=>m({...h,code:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Address"}),u.jsx("textarea",{value:h.address,onChange:S=>m({...h,address:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"active",checked:h.active,onChange:S=>m({...h,active:S.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),u.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:f?"Update":"Create"}),u.jsx("button",{type:"button",onClick:()=>{c(!1),d(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("div",{className:"relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search campuses...",value:a,onChange:S=>l(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Code"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Address"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),x&&u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-slate-200",children:[g.map(S=>u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:u.jsx(lf,{className:"w-5 h-5 text-slate-600"})}),u.jsx("span",{className:"font-medium text-slate-900",children:S.name})]})}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.code}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.address||"-"}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${S.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:S.active?"Active":"Inactive"})}),x&&u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(S),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:u.jsx($a,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>y(S),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:u.jsx(za,{className:"w-4 h-4"})})]})})]},S.id)),g.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:x?5:4,className:"px-6 py-12 text-center text-slate-500",children:"No campuses found"})})]})]})})]})]})}function Jw(){const{profile:e}=Fr(),{logAction:t}=Ha(),[r,n]=ee.useState([]),[s,i]=ee.useState([]),[a,l]=ee.useState(!0),[o,c]=ee.useState(""),[f,d]=ee.useState(!1),[h,m]=ee.useState(null),[x,p]=ee.useState({name:"",code:"",address:"",campus_id:"",active:!0}),_=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="super_administrator";ee.useEffect(()=>{v()},[]);const v=async()=>{try{const[N,k]=await Promise.all([xe.from("buildings").select("*, campus:campuses(name)").order("name"),xe.from("campuses").select("id, name").eq("active",!0).order("name")]);N.data&&n(N.data),k.data&&i(k.data)}catch(N){console.error("Error fetching data:",N)}finally{l(!1)}},y=async N=>{N.preventDefault();try{if(h){const{error:k}=await xe.from("buildings").update({...x,updated_at:new Date().toISOString()}).eq("id",h.id);if(k)throw k;await t("update","building",`Updated building: ${x.name}`,{entityId:h.id,metadata:x})}else{const{data:k,error:F}=await xe.from("buildings").insert([x]).select().single();if(F)throw F;await t("create","building",`Created building: ${x.name}`,{entityId:k.id,metadata:x})}d(!1),m(null),p({name:"",code:"",address:"",campus_id:"",active:!0}),v()}catch(k){console.error("Error saving building:",k),alert("Error saving building. Please try again.")}},g=N=>{m(N),p({name:N.name,code:N.code,address:N.address,campus_id:N.campus_id,active:N.active}),d(!0)},S=async N=>{if(confirm(`Are you sure you want to delete "${N.name}"?`))try{const{error:k}=await xe.from("buildings").delete().eq("id",N.id);if(k)throw k;await t("delete","building",`Deleted building: ${N.name}`,{entityId:N.id,metadata:{name:N.name,code:N.code}}),v()}catch(k){console.error("Error deleting building:",k),alert("Error deleting building. It may have associated keys.")}},j=r.filter(N=>N.name.toLowerCase().includes(o.toLowerCase())||N.code.toLowerCase().includes(o.toLowerCase()));return a?u.jsx("div",{className:"text-center py-12",children:"Loading buildings..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Buildings"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage buildings across campuses"})]}),_&&u.jsxs("button",{onClick:()=>{m(null),p({name:"",code:"",address:"",campus_id:"",active:!0}),d(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[u.jsx(Wa,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Building"})]})]}),f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:h?"Edit Building":"Add Building"}),u.jsxs("form",{onSubmit:y,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus"}),u.jsxs("select",{value:x.campus_id,onChange:N=>p({...x,campus_id:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[u.jsx("option",{value:"",children:"Select Campus"}),s.map(N=>u.jsx("option",{value:N.id,children:N.name},N.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Building Name"}),u.jsx("input",{type:"text",value:x.name,onChange:N=>p({...x,name:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Building Code"}),u.jsx("input",{type:"text",value:x.code,onChange:N=>p({...x,code:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Address"}),u.jsx("textarea",{value:x.address,onChange:N=>p({...x,address:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"active",checked:x.active,onChange:N=>p({...x,active:N.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),u.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:h?"Update":"Create"}),u.jsx("button",{type:"button",onClick:()=>{d(!1),m(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("div",{className:"relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search buildings...",value:o,onChange:N=>c(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Building"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Code"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Address"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),_&&u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-slate-200",children:[j.map(N=>{var k;return u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:u.jsx(Xo,{className:"w-5 h-5 text-slate-600"})}),u.jsx("span",{className:"font-medium text-slate-900",children:N.name})]})}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:N.code}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:((k=N.campus)==null?void 0:k.name)||"-"}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:N.address||"-"}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${N.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:N.active?"Active":"Inactive"})}),_&&u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>g(N),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:u.jsx($a,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>S(N),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:u.jsx(za,{className:"w-4 h-4"})})]})})]},N.id)}),j.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:_?6:5,className:"px-6 py-12 text-center text-slate-500",children:"No buildings found"})})]})]})})]})]})}function Qw(){const{profile:e}=Fr(),{logAction:t}=Ha(),[r,n]=ee.useState([]),[s,i]=ee.useState([]),[a,l]=ee.useState(!0),[o,c]=ee.useState(""),[f,d]=ee.useState(!1),[h,m]=ee.useState(null),[x,p]=ee.useState({name:"",brand:"",campus_id:"",description:"",active:!0}),_=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="super_administrator";ee.useEffect(()=>{v()},[]);const v=async()=>{try{const[N,k]=await Promise.all([xe.from("key_systems").select("*, campus:campuses(name)").order("name"),xe.from("campuses").select("id, name").eq("active",!0).order("name")]);N.data&&n(N.data),k.data&&i(k.data)}catch(N){console.error("Error fetching data:",N)}finally{l(!1)}},y=async N=>{N.preventDefault();try{if(h){const{error:k}=await xe.from("key_systems").update({...x,updated_at:new Date().toISOString()}).eq("id",h.id);if(k)throw k;await t("update","system",`Updated key system: ${x.name}`,{entityId:h.id,metadata:x})}else{const{data:k,error:F}=await xe.from("key_systems").insert([x]).select().single();if(F)throw F;await t("create","system",`Created key system: ${x.name}`,{entityId:k.id,metadata:x})}d(!1),m(null),p({name:"",brand:"",campus_id:"",description:"",active:!0}),v()}catch(k){console.error("Error saving key system:",k),alert("Error saving key system. Please try again.")}},g=N=>{m(N),p({name:N.name,brand:N.brand,campus_id:N.campus_id,description:N.description,active:N.active}),d(!0)},S=async N=>{if(confirm(`Are you sure you want to delete "${N.name}"?`))try{const{error:k}=await xe.from("key_systems").delete().eq("id",N.id);if(k)throw k;await t("delete","system",`Deleted key system: ${N.name}`,{entityId:N.id,metadata:{name:N.name,brand:N.brand}}),v()}catch(k){console.error("Error deleting key system:",k),alert("Error deleting key system. It may have associated keys.")}},j=r.filter(N=>N.name.toLowerCase().includes(o.toLowerCase())||N.brand.toLowerCase().includes(o.toLowerCase()));return a?u.jsx("div",{className:"text-center py-12",children:"Loading key systems..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Key Systems"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage key systems, brands, and specifications"})]}),_&&u.jsxs("button",{onClick:()=>{m(null),p({name:"",brand:"",campus_id:"",description:"",active:!0}),d(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[u.jsx(Wa,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Key System"})]})]}),f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:h?"Edit Key System":"Add Key System"}),u.jsxs("form",{onSubmit:y,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"System Name"}),u.jsx("input",{type:"text",value:x.name,onChange:N=>p({...x,name:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",placeholder:"e.g., Main Building System",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Brand"}),u.jsx("input",{type:"text",value:x.brand,onChange:N=>p({...x,brand:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",placeholder:"e.g., Medeco, Schlage, Yale",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus"}),u.jsxs("select",{value:x.campus_id,onChange:N=>p({...x,campus_id:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[u.jsx("option",{value:"",children:"Select Campus"}),s.map(N=>u.jsx("option",{value:N.id,children:N.name},N.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),u.jsx("textarea",{value:x.description,onChange:N=>p({...x,description:N.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3,placeholder:"System details, specifications, notes..."})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"active",checked:x.active,onChange:N=>p({...x,active:N.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),u.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:h?"Update":"Create"}),u.jsx("button",{type:"button",onClick:()=>{d(!1),m(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("div",{className:"relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search key systems...",value:o,onChange:N=>c(N.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"System Name"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Brand"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Description"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),_&&u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-slate-200",children:[j.map(N=>{var k;return u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:u.jsx(Ta,{className:"w-5 h-5 text-slate-600"})}),u.jsx("span",{className:"font-medium text-slate-900",children:N.name})]})}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:N.brand}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:((k=N.campus)==null?void 0:k.name)||"-"}),u.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:N.description||"-"}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${N.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:N.active?"Active":"Inactive"})}),_&&u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>g(N),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:u.jsx($a,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>S(N),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:u.jsx(za,{className:"w-4 h-4"})})]})})]},N.id)}),j.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:_?6:5,className:"px-6 py-12 text-center text-slate-500",children:"No key systems found"})})]})]})})]})]})}function Zw(e){const t=[{label:"Top",values:e.top},{label:"Control",values:e.control},{label:"Master",values:e.master},{label:"Bottom",values:e.bottom}];return`
    <div style="display: flex; justify-content: center; margin: 30px 0;">
      <table style="border-collapse: collapse; border: 2px solid #000; background: white;">
        <thead>
          <tr style="background-color: #f3f4f6;">
            <th style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; text-align: center;">Pin Type</th>
            ${Array.from({length:7},(r,n)=>`<th style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; text-align: center;">Pin ${n+1}</th>`).join("")}
          </tr>
        </thead>
        <tbody>
          ${t.map(r=>`
            <tr>
              <td style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; background-color: #f9fafb; text-align: center;">${r.label}</td>
              ${r.values.map(n=>`<td style="border: 1px solid #000; padding: 8px 12px; text-align: center; font-family: monospace;">${typeof n=="number"&&!isNaN(n)?n.toString().padStart(2,"0"):"--"}</td>`).join("")}
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  `}function eS(e){const t=e.top_pins&&e.top_pins.length>0,r={top:e.top_pins||Array(7).fill(null),control:e.control_pins||Array(7).fill(null),master:e.master_pins||Array(7).fill(null),bottom:e.bottom_pins||Array(7).fill(null)},n=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Key ${e.key_code} - Print</title>
      <style>
        body {
          font-family: Arial, sans-serif;
          padding: 40px;
          max-width: 800px;
          margin: 0 auto;
        }
        .header {
          text-align: center;
          margin-bottom: 40px;
          border-bottom: 3px solid #000;
          padding-bottom: 20px;
        }
        .header h1 {
          margin: 0;
          font-size: 28px;
          color: #1e293b;
        }
        .header p {
          margin: 5px 0 0 0;
          color: #64748b;
          font-size: 14px;
        }
        .info-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
          margin: 30px 0;
        }
        .info-item {
          display: flex;
          flex-direction: column;
        }
        .info-label {
          font-weight: bold;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
          margin-bottom: 4px;
        }
        .info-value {
          font-size: 16px;
          color: #1e293b;
          font-weight: 500;
        }
        .notes-section {
          margin: 30px 0;
          padding: 20px;
          background: #f8fafc;
          border-radius: 8px;
          border: 1px solid #e2e8f0;
        }
        .notes-section h3 {
          margin: 0 0 10px 0;
          font-size: 14px;
          color: #64748b;
          text-transform: uppercase;
        }
        .notes-section p {
          margin: 0;
          color: #1e293b;
          line-height: 1.6;
        }
        @media print {
          body {
            padding: 20px;
          }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1>University Key Management System</h1>
        <p>Key Information Report - Designed by Hector Reyes & Oscar Melo</p>
      </div>

      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Key Code</span>
          <span class="info-value">${e.key_code||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Campus</span>
          <span class="info-value">${e.campus||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Building</span>
          <span class="info-value">${e.building||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Room Number</span>
          <span class="info-value">${e.room_number||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Key System</span>
          <span class="info-value">${e.system||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Brand</span>
          <span class="info-value">${e.brand||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Bitting Code</span>
          <span class="info-value">${e.bitting||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Core Code</span>
          <span class="info-value">${e.core_code||"N/A"}</span>
        </div>
      </div>

      ${t?`
        <div style="margin: 40px 0;">
          <h2 style="text-align: center; color: #1e293b; margin-bottom: 20px;">Medeco Pin Configuration</h2>
          ${Zw(r)}
        </div>
      `:""}

      ${e.notes?`
        <div class="notes-section">
          <h3>Notes</h3>
          <p>${e.notes}</p>
        </div>
      `:""}

      <div style="margin-top: 60px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; color: #94a3b8; font-size: 12px;">
        <p>Printed on ${new Date().toLocaleString()}</p>
        <p>University Key Management System -  2025 Hector Reyes & Oscar Melo</p>
      </div>
    </body>
    </html>
  `,s=window.open("","_blank");s&&(s.document.write(n),s.document.close(),s.focus(),setTimeout(()=>{s.print()},250))}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ho={};ho.version="0.18.5";var V1=1252,tS=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],K1=function(e){tS.indexOf(e)!=-1&&(V1=e)};function rS(){K1(1252)}var Na=function(e){K1(e)};function nS(){Na(1200),rS()}var _l=function(t){return String.fromCharCode(t)},mh=function(t){return String.fromCharCode(t)},Jn,Sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Aa(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0,o=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,s=e.charCodeAt(c++),l=(n&15)<<2|s>>6,o=s&63,isNaN(n)?l=o=64:isNaN(s)&&(o=64),t+=Sn.charAt(i)+Sn.charAt(a)+Sn.charAt(l)+Sn.charAt(o);return t}function an(e){var t="",r=0,n=0,s=0,i=0,a=0,l=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Sn.indexOf(e.charAt(c++)),a=Sn.indexOf(e.charAt(c++)),r=i<<2|a>>4,t+=String.fromCharCode(r),l=Sn.indexOf(e.charAt(c++)),n=(a&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),o=Sn.indexOf(e.charAt(c++)),s=(l&3)<<6|o,o!==64&&(t+=String.fromCharCode(s));return t}var Fe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function us(e){return Fe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function xh(e){return Fe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var kr=function(t){return Fe?cn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qo(e){if(typeof ArrayBuffer>"u")return kr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Va(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function sS(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var yt=Fe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:cn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function iS(e){for(var t=[],r=0,n=e.length+250,s=us(e.length+255),i=0;i<e.length;++i){var a=e.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|l>>6&15|(a&3)<<4,s[r++]=128|l&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(t.push(s.slice(0,r)),r=0,s=us(65535),n=65530)}return t.push(s.slice(0,r)),yt(t)}var ea=/\u0000/g,wl=/[\u0001-\u0006]/g;function ei(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Nr(e,t){var r=""+e;return r.length>=t?r:Qe("0",t-r.length)+r}function of(e,t){var r=""+e;return r.length>=t?r:Qe(" ",t-r.length)+r}function po(e,t){var r=""+e;return r.length>=t?r:r+Qe(" ",t-r.length)}function aS(e,t){var r=""+Math.round(e);return r.length>=t?r:Qe("0",t-r.length)+r}function lS(e,t){var r=""+e;return r.length>=t?r:Qe("0",t-r.length)+r}var gh=Math.pow(2,32);function Cs(e,t){if(e>gh||e<-gh)return aS(e,t);var r=Math.round(e);return lS(r,t)}function mo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var vh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oS(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},cS={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xo(e,t,r){for(var n=e<0?-1:1,s=e*n,i=0,a=1,l=0,o=1,c=0,f=0,d=Math.floor(s);c<t&&(d=Math.floor(s),l=d*a+i,f=d*c+o,!(s-d<5e-8));)s=1/(s-d),i=a,a=l,o=c,c=f;if(f>t&&(c>t?(f=o,l=i):(f=c,l=a)),!r)return[0,n*l,f];var h=Math.floor(n*l/f);return[h,n*l-h*f,f]}function Sl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),i=0,a=[],l={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++n,++l.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var o=new Date(1900,0,1);o.setDate(o.getDate()+n-1),a=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),n<60&&(i=(i+6)%7),r&&(i=xS(o,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var G1=new Date(1899,11,31,0,0,0),uS=G1.getTime(),fS=new Date(1900,2,1,0,0,0);function X1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=fS&&(r+=24*60*60*1e3),(r-(uS+(e.getTimezoneOffset()-G1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function cf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function dS(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function hS(e){var t=e<0?12:11,r=cf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function pS(e){var t=cf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function mS(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=hS(e):t===10?r=e.toFixed(10).substr(0,12):r=pS(e),cf(dS(r.toUpperCase()))}function r0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):mS(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Rn(14,X1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function xS(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function gS(e,t,r,n){var s="",i=0,a=0,l=r.y,o,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:o=l%100,c=2;break;default:o=l%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,c=t.length;break;case 3:return zc[r.m-1][1];case 5:return zc[r.m-1][0];default:return zc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,c=t.length;break;case 3:return vh[r.q][0];default:return vh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Nr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),t==="s"?i===0?"0":""+i/a:(s=Nr(i,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:o=l,c=1;break}var f=c>0?Nr(o,c):"";return f}function En(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var q1=/%/g;function vS(e,t,r){var n=t.replace(q1,""),s=t.length-n.length;return Qr(e,n,r*Math.pow(10,2*s))+Qe("%",s)}function yS(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Y1(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y1(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,c,f){return o+c+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J1=/# (\?+)( ?)\/( ?)(\d+)/;function _S(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),i=Math.floor(s/n),a=s-i*n,l=n;return r+(i===0?"":""+i)+" "+(a===0?Qe(" ",e[1].length+1+e[4].length):of(a,e[1].length)+e[2]+"/"+e[3]+Nr(l,e[4].length))}function wS(e,t,r){return r+(t===0?"":""+t)+Qe(" ",e[1].length+2+e[4].length)}var Q1=/^#*0*\.([0#]+)/,Z1=/\).*[0#]/,ex=/\(###\) ###\\?-####/;function Rt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function _h(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function wh(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function SS(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ES(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function lr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?lr("n",n,r):"("+lr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return yS(e,t,r);if(t.indexOf("%")!==-1)return vS(e,t,r);if(t.indexOf("E")!==-1)return Y1(t,r);if(t.charCodeAt(0)===36)return"$"+lr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Cs(o,t.length);if(t.match(/^[#?]+$/))return s=Cs(r,0),s==="0"&&(s=""),s.length>t.length?s:Rt(t.substr(0,t.length-s.length))+s;if(i=t.match(J1))return _S(i,o,c);if(t.match(/^#+0+$/))return c+Cs(o,t.length-t.indexOf("0"));if(i=t.match(Q1))return s=_h(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Rt(i[1])).replace(/\.$/,"."+Rt(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Qe("0",Rt(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+_h(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+En(Cs(o,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+lr(e,t,-r):En(""+(Math.floor(r)+SS(r,i[1].length)))+"."+Nr(wh(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return lr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ei(lr(e,t.replace(/[\\-]/g,""),r)),a=0,ei(ei(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(ex))return s=lr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=xo(o,Math.pow(10,a)-1,!1),s=""+c,f=Qr("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=po(l[2],a),f.length<i[4].length&&(f=Rt(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=xo(o,Math.pow(10,a)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?of(l[1],a)+i[2]+"/"+i[3]+po(l[2],a):Qe(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Cs(r,0),t.length<=s.length?s:Rt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=t.indexOf(".")-a,h=t.length-s.length-d;return Rt(t.substr(0,d)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return a=wh(r,i[1].length),r<0?"-"+lr(e,t,-r):En(ES(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Nr(0,3-x.length):"")+x})+"."+Nr(a,i[1].length);switch(t){case"###,##0.00":return lr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=En(Cs(o,0));return m!=="0"?c+m:"";case"###,###.00":return lr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return lr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function TS(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Qr(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function kS(e,t,r){var n=t.replace(q1,""),s=t.length-n.length;return Qr(e,n,r*Math.pow(10,2*s))+Qe("%",s)}function tx(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tx(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,o,c,f){return o+c+f.substr(0,(s+i)%s)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Rr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Z1)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rr("n",n,r):"("+Rr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return TS(e,t,r);if(t.indexOf("%")!==-1)return kS(e,t,r);if(t.indexOf("E")!==-1)return tx(t,r);if(t.charCodeAt(0)===36)return"$"+Rr(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,a,l,o=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Nr(o,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Rt(t.substr(0,t.length-s.length))+s;if(i=t.match(J1))return wS(i,o,c);if(t.match(/^#+0+$/))return c+Nr(o,t.length-t.indexOf("0"));if(i=t.match(Q1))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Rt(i[1])).replace(/\.$/,"."+Rt(i[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+Qe("0",Rt(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+En(""+o);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rr(e,t,-r):En(""+r)+"."+Qe("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Rr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ei(Rr(e,t.replace(/[\\-]/g,""),r)),a=0,ei(ei(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return a<s.length?s.charAt(a++):x==="0"?"0":""}));if(t.match(ex))return s=Rr(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),l=xo(o,Math.pow(10,a)-1,!1),s=""+c,f=Qr("n",i[1],l[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+i[2]+"/"+i[3],f=po(l[2],a),f.length<i[4].length&&(f=Rt(i[4].substr(i[4].length-f.length))+f),s+=f,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),l=xo(o,Math.pow(10,a)-1,!0),c+(l[0]||(l[1]?"":"0"))+" "+(l[1]?of(l[1],a)+i[2]+"/"+i[3]+po(l[2],a):Qe(" ",2*a+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Rt(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var d=t.indexOf(".")-a,h=t.length-s.length-d;return Rt(t.substr(0,d)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Rr(e,t,-r):En(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Nr(0,3-x.length):"")+x})+"."+Nr(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=En(""+o);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return Rr(e,t.slice(0,t.lastIndexOf(".")),r)+Rt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Qr(e,t,r){return(r|0)===r?Rr(e,t,r):lr(e,t,r)}function NS(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nx(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":mo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rx))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function AS(e,t,r,n){for(var s=[],i="",a=0,l="",o="t",c,f,d,h="H";a<e.length;)switch(l=e.charAt(a)){case"G":if(!mo(e,a))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(d=e.charCodeAt(++a))!==34&&a<e.length;)i+=String.fromCharCode(d);s[s.length]={t:"t",v:i},++a;break;case"\\":var m=e.charAt(++a),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=Sl(t,r,e.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:e.substr(a,2)},o=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Sl(t,r),c==null))return"";for(i=l;++a<e.length&&e.charAt(a).toLowerCase()===l;)i+=l;l==="m"&&o.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:i},o=l;break;case"A":case"a":case"":var p={t:l,v:l};if(c==null&&(c=Sl(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="/"?(c!=null&&(p.v=c.H>=12?"":""),p.t="T",a+=5,h="h"):(p.t="t",++a),c==null&&p.t==="T")return"";s[s.length]=p,o=l;break;case"[":for(i=l;e.charAt(a++)!=="]"&&a<e.length;)i+=e.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(rx)){if(c==null&&(c=Sl(t,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",nx(e)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=l;++a<e.length&&(l=e.charAt(a))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++a<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(a))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++a)===l;)i+=l;s[s.length]={t:l,v:i},o=l;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)i+=e.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++a;break}var _=0,v=0,y;for(a=s.length-1,o="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,o="h",_<1&&(_=1);break;case"s":(y=s[a].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":o=s[a].t;break;case"m":o==="s"&&(s[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&s[a].v.match(/[Hh]/)&&(_=1),_<2&&s[a].v.match(/[Mm]/)&&(_=2),_<3&&s[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",S;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=gS(s[a].t.charCodeAt(0),s[a].v,c,v),s[a].t="t";break;case"n":case"?":for(S=a+1;s[S]!=null&&((l=s[S].t)==="?"||l==="D"||(l===" "||l==="t")&&s[S+1]!=null&&(s[S+1].t==="?"||s[S+1].t==="t"&&s[S+1].v==="/")||s[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[S].v==="/"||s[S].v===" "&&s[S+1]!=null&&s[S+1].t=="?"));)s[a].v+=s[S].v,s[S]={v:"",t:";"},++S;g+=s[a].v,a=S-1;break;case"G":s[a].t="t",s[a].v=r0(t,r);break}var j="",N,k;if(g.length>0){g.charCodeAt(0)==40?(N=t<0&&g.charCodeAt(0)===45?-t:t,k=Qr("n",g,N)):(N=t<0&&n>1?-t:t,k=Qr("n",g,N),N<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),S=k.length-1;var F=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){F=a;break}var L=s.length;if(F===s.length&&k.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(S>=s[a].v.length-1?(S-=s[a].v.length,s[a].v=k.substr(S+1,s[a].v.length)):S<0?s[a].v="":(s[a].v=k.substr(0,S+1),S=-1),s[a].t="t",L=a);S>=0&&L<s.length&&(s[L].v=k.substr(0,S+1)+s[L].v)}else if(F!==s.length&&k.indexOf("E")===-1){for(S=k.indexOf(".")-1,a=F;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(f=s[a].v.indexOf(".")>-1&&a===F?s[a].v.indexOf(".")-1:s[a].v.length-1,j=s[a].v.substr(f+1);f>=0;--f)S>=0&&(s[a].v.charAt(f)==="0"||s[a].v.charAt(f)==="#")&&(j=k.charAt(S--)+j);s[a].v=j,s[a].t="t",L=a}for(S>=0&&L<s.length&&(s[L].v=k.substr(0,S+1)+s[L].v),S=k.indexOf(".")+1,a=F;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==F)){for(f=s[a].v.indexOf(".")>-1&&a===F?s[a].v.indexOf(".")+1:0,j=s[a].v.substr(0,f);f<s[a].v.length;++f)S<k.length&&(j+=k.charAt(S++));s[a].v=j,s[a].t="t",L=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(N=n>1&&t<0&&a>0&&s[a-1].v==="-"?-t:t,s[a].v=Qr(s[a].t,s[a].v,N),s[a].t="t");var B="";for(a=0;a!==s.length;++a)s[a]!=null&&(B+=s[a].v);return B}var Sh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Eh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function CS(e,t){var r=NS(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Sh),l=r[1].match(Sh);return Eh(t,a)?[n,r[0]]:Eh(t,l)?[n,r[1]]:[n,r[a!=null&&l!=null?2:1]]}return[n,i]}function Rn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ze)[e],n==null&&(n=r.table&&r.table[yh[e]]||Ze[yh[e]]),n==null&&(n=cS[e]||"General");break}if(mo(n,0))return r0(t,r);t instanceof Date&&(t=X1(t,r.date1904));var s=CS(n,t);if(mo(s[1]))return r0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return AS(s[1],t,r,s[0])}function sx(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ze[r]==null){t<0&&(t=r);continue}if(Ze[r]==e){t=r;break}}t<0&&(t=391)}return Ze[t]=e,t}function Yo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&sx(e[t],t)}function Jo(){Ze=oS()}var ix=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bS(e){var t=typeof e=="number"?Ze[e]:e;return t=t.replace(ix,"(\\d+)"),new RegExp("^"+t+"$")}function OS(e,t,r){var n=-1,s=-1,i=-1,a=-1,l=-1,o=-1;(t.match(ix)||[]).forEach(function(d,h){var m=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=m;break;case"d":i=m;break;case"h":a=m;break;case"s":o=m;break;case"m":a>=0?l=m:s=m;break}}),o>=0&&l==-1&&s>=0&&(l=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return a==-1&&l==-1&&o==-1?c:n==-1&&s==-1&&i==-1?f:c+"T"+f}var FS=function(){var e={};e.version="1.2.0";function t(){for(var k=0,F=new Array(256),L=0;L!=256;++L)k=L,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,F[L]=k;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(k){var F=0,L=0,B=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)G[B]=k[B];for(B=0;B!=256;++B)for(L=k[B],F=256+B;F<4096;F+=256)L=G[F]=L>>>8^k[L&255];var q=[];for(B=1;B!=16;++B)q[B-1]=typeof Int32Array<"u"?G.subarray(B*256,B*256+256):G.slice(B*256,B*256+256);return q}var s=n(r),i=s[0],a=s[1],l=s[2],o=s[3],c=s[4],f=s[5],d=s[6],h=s[7],m=s[8],x=s[9],p=s[10],_=s[11],v=s[12],y=s[13],g=s[14];function S(k,F){for(var L=F^-1,B=0,G=k.length;B<G;)L=L>>>8^r[(L^k.charCodeAt(B++))&255];return~L}function j(k,F){for(var L=F^-1,B=k.length-15,G=0;G<B;)L=g[k[G++]^L&255]^y[k[G++]^L>>8&255]^v[k[G++]^L>>16&255]^_[k[G++]^L>>>24]^p[k[G++]]^x[k[G++]]^m[k[G++]]^h[k[G++]]^d[k[G++]]^f[k[G++]]^c[k[G++]]^o[k[G++]]^l[k[G++]]^a[k[G++]]^i[k[G++]]^r[k[G++]];for(B+=15;G<B;)L=L>>>8^r[(L^k[G++])&255];return~L}function N(k,F){for(var L=F^-1,B=0,G=k.length,q=0,se=0;B<G;)q=k.charCodeAt(B++),q<128?L=L>>>8^r[(L^q)&255]:q<2048?(L=L>>>8^r[(L^(192|q>>6&31))&255],L=L>>>8^r[(L^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,se=k.charCodeAt(B++)&1023,L=L>>>8^r[(L^(240|q>>8&7))&255],L=L>>>8^r[(L^(128|q>>2&63))&255],L=L>>>8^r[(L^(128|se>>6&15|(q&3)<<4))&255],L=L>>>8^r[(L^(128|se&63))&255]):(L=L>>>8^r[(L^(224|q>>12&15))&255],L=L>>>8^r[(L^(128|q>>6&63))&255],L=L>>>8^r[(L^(128|q&63))&255]);return~L}return e.table=r,e.bstr=S,e.buf=j,e.str=N,e}(),Le=function(){var t={};t.version="1.2.1";function r(w,A){for(var E=w.split("/"),T=A.split("/"),C=0,b=0,U=Math.min(E.length,T.length);C<U;++C){if(b=E[C].length-T[C].length)return b;if(E[C]!=T[C])return E[C]<T[C]?-1:1}return E.length-T.length}function n(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:n(w.slice(0,-1));var A=w.lastIndexOf("/");return A===-1?w:w.slice(0,A+1)}function s(w){if(w.charAt(w.length-1)=="/")return s(w.slice(0,-1));var A=w.lastIndexOf("/");return A===-1?w:w.slice(A+1)}function i(w,A){typeof A=="string"&&(A=new Date(A));var E=A.getHours();E=E<<6|A.getMinutes(),E=E<<5|A.getSeconds()>>>1,w.write_shift(2,E);var T=A.getFullYear()-1980;T=T<<4|A.getMonth()+1,T=T<<5|A.getDate(),w.write_shift(2,T)}function a(w){var A=w.read_shift(2)&65535,E=w.read_shift(2)&65535,T=new Date,C=E&31;E>>>=5;var b=E&15;E>>>=4,T.setMilliseconds(0),T.setFullYear(E+1980),T.setMonth(b-1),T.setDate(C);var U=A&31;A>>>=5;var K=A&63;return A>>>=6,T.setHours(A),T.setMinutes(K),T.setSeconds(U<<1),T}function l(w){Jt(w,0);for(var A={},E=0;w.l<=w.length-4;){var T=w.read_shift(2),C=w.read_shift(2),b=w.l+C,U={};switch(T){case 21589:E=w.read_shift(1),E&1&&(U.mtime=w.read_shift(4)),C>5&&(E&2&&(U.atime=w.read_shift(4)),E&4&&(U.ctime=w.read_shift(4))),U.mtime&&(U.mt=new Date(U.mtime*1e3));break}w.l=b,A[T]=U}return A}var o;function c(){return o||(o={})}function f(w,A){if(w[0]==80&&w[1]==75)return Mf(w,A);if((w[0]|32)==109&&(w[1]|32)==105)return Ig(w,A);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var E=3,T=512,C=0,b=0,U=0,K=0,M=0,W=[],z=w.slice(0,512);Jt(z,0);var Q=d(z);switch(E=Q[0],E){case 3:T=512;break;case 4:T=4096;break;case 0:if(Q[1]==0)return Mf(w,A);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}T!==512&&(z=w.slice(0,T),Jt(z,28));var ae=w.slice(0,T);h(z,E);var fe=z.read_shift(4,"i");if(E===3&&fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+fe);z.l+=4,U=z.read_shift(4,"i"),z.l+=4,z.chk("00100000","Mini Stream Cutoff Size: "),K=z.read_shift(4,"i"),C=z.read_shift(4,"i"),M=z.read_shift(4,"i"),b=z.read_shift(4,"i");for(var te=-1,ce=0;ce<109&&(te=z.read_shift(4,"i"),!(te<0));++ce)W[ce]=te;var _e=m(w,T);_(M,b,_e,T,W);var Ve=y(_e,U,W,T);Ve[U].name="!Directory",C>0&&K!==se&&(Ve[K].name="!MiniFAT"),Ve[W[0]].name="!FAT",Ve.fat_addrs=W,Ve.ssz=T;var Ke={},kt=[],Ei=[],Ti=[];g(U,Ve,_e,kt,C,Ke,Ei,K),x(Ei,Ti,kt),kt.shift();var ki={FileIndex:Ei,FullPaths:Ti};return A&&A.raw&&(ki.raw={header:ae,sectors:_e}),ki}function d(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(de,"Header Signature: "),w.l+=16;var A=w.read_shift(2,"u");return[w.read_shift(2,"u"),A]}function h(w,A){var E=9;switch(w.l+=2,E=w.read_shift(2)){case 9:if(A!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(A!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function m(w,A){for(var E=Math.ceil(w.length/A)-1,T=[],C=1;C<E;++C)T[C-1]=w.slice(C*A,(C+1)*A);return T[E-1]=w.slice(E*A),T}function x(w,A,E){for(var T=0,C=0,b=0,U=0,K=0,M=E.length,W=[],z=[];T<M;++T)W[T]=z[T]=T,A[T]=E[T];for(;K<z.length;++K)T=z[K],C=w[T].L,b=w[T].R,U=w[T].C,W[T]===T&&(C!==-1&&W[C]!==C&&(W[T]=W[C]),b!==-1&&W[b]!==b&&(W[T]=W[b])),U!==-1&&(W[U]=T),C!==-1&&T!=W[T]&&(W[C]=W[T],z.lastIndexOf(C)<K&&z.push(C)),b!==-1&&T!=W[T]&&(W[b]=W[T],z.lastIndexOf(b)<K&&z.push(b));for(T=1;T<M;++T)W[T]===T&&(b!==-1&&W[b]!==b?W[T]=W[b]:C!==-1&&W[C]!==C&&(W[T]=W[C]));for(T=1;T<M;++T)if(w[T].type!==0){if(K=T,K!=W[K])do K=W[K],A[T]=A[K]+"/"+A[T];while(K!==0&&W[K]!==-1&&K!=W[K]);W[T]=-1}for(A[0]+="/",T=1;T<M;++T)w[T].type!==2&&(A[T]+="/")}function p(w,A,E){for(var T=w.start,C=w.size,b=[],U=T;E&&C>0&&U>=0;)b.push(A.slice(U*q,U*q+q)),C-=q,U=Qn(E,U*4);return b.length===0?H(0):yt(b).slice(0,w.size)}function _(w,A,E,T,C){var b=se;if(w===se){if(A!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var U=E[w],K=(T>>>2)-1;if(!U)return;for(var M=0;M<K&&(b=Qn(U,M*4))!==se;++M)C.push(b);_(Qn(U,T-4),A-1,E,T,C)}}function v(w,A,E,T,C){var b=[],U=[];C||(C=[]);var K=T-1,M=0,W=0;for(M=A;M>=0;){C[M]=!0,b[b.length]=M,U.push(w[M]);var z=E[Math.floor(M*4/T)];if(W=M*4&K,T<4+W)throw new Error("FAT boundary crossed: "+M+" 4 "+T);if(!w[z])break;M=Qn(w[z],W)}return{nodes:b,data:Fh([U])}}function y(w,A,E,T){var C=w.length,b=[],U=[],K=[],M=[],W=T-1,z=0,Q=0,ae=0,fe=0;for(z=0;z<C;++z)if(K=[],ae=z+A,ae>=C&&(ae-=C),!U[ae]){M=[];var te=[];for(Q=ae;Q>=0;){te[Q]=!0,U[Q]=!0,K[K.length]=Q,M.push(w[Q]);var ce=E[Math.floor(Q*4/T)];if(fe=Q*4&W,T<4+fe)throw new Error("FAT boundary crossed: "+Q+" 4 "+T);if(!w[ce]||(Q=Qn(w[ce],fe),te[Q]))break}b[ae]={nodes:K,data:Fh([M])}}return b}function g(w,A,E,T,C,b,U,K){for(var M=0,W=T.length?2:0,z=A[w].data,Q=0,ae=0,fe;Q<z.length;Q+=128){var te=z.slice(Q,Q+128);Jt(te,64),ae=te.read_shift(2),fe=pf(te,0,ae-W),T.push(fe);var ce={name:fe,type:te.read_shift(1),color:te.read_shift(1),L:te.read_shift(4,"i"),R:te.read_shift(4,"i"),C:te.read_shift(4,"i"),clsid:te.read_shift(16),state:te.read_shift(4,"i"),start:0,size:0},_e=te.read_shift(2)+te.read_shift(2)+te.read_shift(2)+te.read_shift(2);_e!==0&&(ce.ct=S(te,te.l-8));var Ve=te.read_shift(2)+te.read_shift(2)+te.read_shift(2)+te.read_shift(2);Ve!==0&&(ce.mt=S(te,te.l-8)),ce.start=te.read_shift(4,"i"),ce.size=te.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=se,ce.name=""),ce.type===5?(M=ce.start,C>0&&M!==se&&(A[M].name="!StreamData")):ce.size>=4096?(ce.storage="fat",A[ce.start]===void 0&&(A[ce.start]=v(E,ce.start,A.fat_addrs,A.ssz)),A[ce.start].name=ce.name,ce.content=A[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:M!==se&&ce.start!==se&&A[M]&&(ce.content=p(ce,A[M].data,(A[K]||{}).data))),ce.content&&Jt(ce.content,0),b[fe]=ce,U.push(ce)}}function S(w,A){return new Date((Zt(w,A+4)/1e7*Math.pow(2,32)+Zt(w,A)/1e7-11644473600)*1e3)}function j(w,A){return c(),f(o.readFileSync(w),A)}function N(w,A){var E=A&&A.type;switch(E||Fe&&Buffer.isBuffer(w)&&(E="buffer"),E||"base64"){case"file":return j(w,A);case"base64":return f(kr(an(w)),A);case"binary":return f(kr(w),A)}return f(w,A)}function k(w,A){var E=A||{},T=E.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=T+"/",w.FileIndex[0]={name:T,type:5}),E.CLSID&&(w.FileIndex[0].clsid=E.CLSID),F(w)}function F(w){var A="Sh33tJ5";if(!Le.find(w,"/"+A)){var E=H(4);E[0]=55,E[1]=E[3]=50,E[2]=54,w.FileIndex.push({name:A,type:2,content:E,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+A),L(w)}}function L(w,A){k(w);for(var E=!1,T=!1,C=w.FullPaths.length-1;C>=0;--C){var b=w.FileIndex[C];switch(b.type){case 0:T?E=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:T=!0,isNaN(b.R*b.L*b.C)&&(E=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!A)){var U=new Date(1987,1,19),K=0,M=Object.create?Object.create(null):{},W=[];for(C=0;C<w.FullPaths.length;++C)M[w.FullPaths[C]]=!0,w.FileIndex[C].type!==0&&W.push([w.FullPaths[C],w.FileIndex[C]]);for(C=0;C<W.length;++C){var z=n(W[C][0]);T=M[z],T||(W.push([z,{name:s(z).replace("/",""),type:1,clsid:J,ct:U,mt:U,content:null}]),M[z]=!0)}for(W.sort(function(fe,te){return r(fe[0],te[0])}),w.FullPaths=[],w.FileIndex=[],C=0;C<W.length;++C)w.FullPaths[C]=W[C][0],w.FileIndex[C]=W[C][1];for(C=0;C<W.length;++C){var Q=w.FileIndex[C],ae=w.FullPaths[C];if(Q.name=s(ae).replace("/",""),Q.L=Q.R=Q.C=-(Q.color=1),Q.size=Q.content?Q.content.length:0,Q.start=0,Q.clsid=Q.clsid||J,C===0)Q.C=W.length>1?1:-1,Q.size=0,Q.type=5;else if(ae.slice(-1)=="/"){for(K=C+1;K<W.length&&n(w.FullPaths[K])!=ae;++K);for(Q.C=K>=W.length?-1:K,K=C+1;K<W.length&&n(w.FullPaths[K])!=n(ae);++K);Q.R=K>=W.length?-1:K,Q.type=1}else n(w.FullPaths[C+1]||"")==n(ae)&&(Q.R=C+1),Q.type=2}}}function B(w,A){var E=A||{};if(E.fileType=="mad")return Dg(w,E);switch(L(w),E.fileType){case"zip":return bg(w,E)}var T=function(fe){for(var te=0,ce=0,_e=0;_e<fe.FileIndex.length;++_e){var Ve=fe.FileIndex[_e];if(Ve.content){var Ke=Ve.content.length;Ke>0&&(Ke<4096?te+=Ke+63>>6:ce+=Ke+511>>9)}}for(var kt=fe.FullPaths.length+3>>2,Ei=te+7>>3,Ti=te+127>>7,ki=Ei+ce+kt+Ti,Hn=ki+127>>7,lc=Hn<=109?0:Math.ceil((Hn-109)/127);ki+Hn+lc+127>>7>Hn;)lc=++Hn<=109?0:Math.ceil((Hn-109)/127);var Hr=[1,lc,Hn,Ti,kt,ce,te,0];return fe.FileIndex[0].size=te<<6,Hr[7]=(fe.FileIndex[0].start=Hr[0]+Hr[1]+Hr[2]+Hr[3]+Hr[4]+Hr[5])+(Hr[6]+7>>3),Hr}(w),C=H(T[7]<<9),b=0,U=0;{for(b=0;b<8;++b)C.write_shift(1,ve[b]);for(b=0;b<8;++b)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),b=0;b<3;++b)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,T[2]),C.write_shift(4,T[0]+T[1]+T[2]+T[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,T[3]?T[0]+T[1]+T[2]-1:se),C.write_shift(4,T[3]),C.write_shift(-4,T[1]?T[0]-1:se),C.write_shift(4,T[1]),b=0;b<109;++b)C.write_shift(-4,b<T[2]?T[1]+b:-1)}if(T[1])for(U=0;U<T[1];++U){for(;b<236+U*127;++b)C.write_shift(-4,b<T[2]?T[1]+b:-1);C.write_shift(-4,U===T[1]-1?se:U+1)}var K=function(fe){for(U+=fe;b<U-1;++b)C.write_shift(-4,b+1);fe&&(++b,C.write_shift(-4,se))};for(U=b=0,U+=T[1];b<U;++b)C.write_shift(-4,ye.DIFSECT);for(U+=T[2];b<U;++b)C.write_shift(-4,ye.FATSECT);K(T[3]),K(T[4]);for(var M=0,W=0,z=w.FileIndex[0];M<w.FileIndex.length;++M)z=w.FileIndex[M],z.content&&(W=z.content.length,!(W<4096)&&(z.start=U,K(W+511>>9)));for(K(T[6]+7>>3);C.l&511;)C.write_shift(-4,ye.ENDOFCHAIN);for(U=b=0,M=0;M<w.FileIndex.length;++M)z=w.FileIndex[M],z.content&&(W=z.content.length,!(!W||W>=4096)&&(z.start=U,K(W+63>>6)));for(;C.l&511;)C.write_shift(-4,ye.ENDOFCHAIN);for(b=0;b<T[4]<<2;++b){var Q=w.FullPaths[b];if(!Q||Q.length===0){for(M=0;M<17;++M)C.write_shift(4,0);for(M=0;M<3;++M)C.write_shift(4,-1);for(M=0;M<12;++M)C.write_shift(4,0);continue}z=w.FileIndex[b],b===0&&(z.start=z.size?z.start-1:se);var ae=b===0&&E.root||z.name;if(W=2*(ae.length+1),C.write_shift(64,ae,"utf16le"),C.write_shift(2,W),C.write_shift(1,z.type),C.write_shift(1,z.color),C.write_shift(-4,z.L),C.write_shift(-4,z.R),C.write_shift(-4,z.C),z.clsid)C.write_shift(16,z.clsid,"hex");else for(M=0;M<4;++M)C.write_shift(4,0);C.write_shift(4,z.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,z.start),C.write_shift(4,z.size),C.write_shift(4,0)}for(b=1;b<w.FileIndex.length;++b)if(z=w.FileIndex[b],z.size>=4096)if(C.l=z.start+1<<9,Fe&&Buffer.isBuffer(z.content))z.content.copy(C,C.l,0,z.size),C.l+=z.size+511&-512;else{for(M=0;M<z.size;++M)C.write_shift(1,z.content[M]);for(;M&511;++M)C.write_shift(1,0)}for(b=1;b<w.FileIndex.length;++b)if(z=w.FileIndex[b],z.size>0&&z.size<4096)if(Fe&&Buffer.isBuffer(z.content))z.content.copy(C,C.l,0,z.size),C.l+=z.size+63&-64;else{for(M=0;M<z.size;++M)C.write_shift(1,z.content[M]);for(;M&63;++M)C.write_shift(1,0)}if(Fe)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function G(w,A){var E=w.FullPaths.map(function(M){return M.toUpperCase()}),T=E.map(function(M){var W=M.split("/");return W[W.length-(M.slice(-1)=="/"?2:1)]}),C=!1;A.charCodeAt(0)===47?(C=!0,A=E[0].slice(0,-1)+A):C=A.indexOf("/")!==-1;var b=A.toUpperCase(),U=C===!0?E.indexOf(b):T.indexOf(b);if(U!==-1)return w.FileIndex[U];var K=!b.match(wl);for(b=b.replace(ea,""),K&&(b=b.replace(wl,"!")),U=0;U<E.length;++U)if((K?E[U].replace(wl,"!"):E[U]).replace(ea,"")==b||(K?T[U].replace(wl,"!"):T[U]).replace(ea,"")==b)return w.FileIndex[U];return null}var q=64,se=-2,de="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Y(w,A,E){c();var T=B(w,E);o.writeFileSync(A,T)}function le(w){for(var A=new Array(w.length),E=0;E<w.length;++E)A[E]=String.fromCharCode(w[E]);return A.join("")}function I(w,A){var E=B(w,A);switch(A&&A.type||"buffer"){case"file":return c(),o.writeFileSync(A.filename,E),E;case"binary":return typeof E=="string"?E:le(E);case"base64":return Aa(typeof E=="string"?E:le(E));case"buffer":if(Fe)return Buffer.isBuffer(E)?E:cn(E);case"array":return typeof E=="string"?kr(E):E}return E}var pe;function O(w){try{var A=w.InflateRaw,E=new A;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)pe=w;else throw new Error("zlib does not expose bytesRead")}catch(T){console.error("cannot use native zlib: "+(T.message||T))}}function P(w,A){if(!pe)return Df(w,A);var E=pe.InflateRaw,T=new E,C=T._processChunk(w.slice(w.l),T._finishFlushFlag);return w.l+=T.bytesRead,C}function R(w){return pe?pe.deflateRawSync(w):Of(w)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(w){var A=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(A>>16|A>>8|A)&255}for(var ue=typeof Uint8Array<"u",ie=ue?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)ie[Ae]=ge(Ae);function Ee(w,A){var E=ie[w&255];return A<=8?E>>>8-A:(E=E<<8|ie[w>>8&255],A<=16?E>>>16-A:(E=E<<8|ie[w>>16&255],E>>>24-A))}function et(w,A){var E=A&7,T=A>>>3;return(w[T]|(E<=6?0:w[T+1]<<8))>>>E&3}function Ce(w,A){var E=A&7,T=A>>>3;return(w[T]|(E<=5?0:w[T+1]<<8))>>>E&7}function Wr(w,A){var E=A&7,T=A>>>3;return(w[T]|(E<=4?0:w[T+1]<<8))>>>E&15}function Ye(w,A){var E=A&7,T=A>>>3;return(w[T]|(E<=3?0:w[T+1]<<8))>>>E&31}function me(w,A){var E=A&7,T=A>>>3;return(w[T]|(E<=1?0:w[T+1]<<8))>>>E&127}function ar(w,A,E){var T=A&7,C=A>>>3,b=(1<<E)-1,U=w[C]>>>T;return E<8-T||(U|=w[C+1]<<8-T,E<16-T)||(U|=w[C+2]<<16-T,E<24-T)||(U|=w[C+3]<<24-T),U&b}function zr(w,A,E){var T=A&7,C=A>>>3;return T<=5?w[C]|=(E&7)<<T:(w[C]|=E<<T&255,w[C+1]=(E&7)>>8-T),A+3}function Wn(w,A,E){var T=A&7,C=A>>>3;return E=(E&1)<<T,w[C]|=E,A+1}function ws(w,A,E){var T=A&7,C=A>>>3;return E<<=T,w[C]|=E&255,E>>>=8,w[C+1]=E,A+8}function bf(w,A,E){var T=A&7,C=A>>>3;return E<<=T,w[C]|=E&255,E>>>=8,w[C+1]=E&255,w[C+2]=E>>>8,A+16}function nc(w,A){var E=w.length,T=2*E>A?2*E:A+5,C=0;if(E>=A)return w;if(Fe){var b=xh(T);if(w.copy)w.copy(b);else for(;C<w.length;++C)b[C]=w[C];return b}else if(ue){var U=new Uint8Array(T);if(U.set)U.set(w);else for(;C<E;++C)U[C]=w[C];return U}return w.length=T,w}function jr(w){for(var A=new Array(w),E=0;E<w;++E)A[E]=0;return A}function Ja(w,A,E){var T=1,C=0,b=0,U=0,K=0,M=w.length,W=ue?new Uint16Array(32):jr(32);for(b=0;b<32;++b)W[b]=0;for(b=M;b<E;++b)w[b]=0;M=w.length;var z=ue?new Uint16Array(M):jr(M);for(b=0;b<M;++b)W[C=w[b]]++,T<C&&(T=C),z[b]=0;for(W[0]=0,b=1;b<=T;++b)W[b+16]=K=K+W[b-1]<<1;for(b=0;b<M;++b)K=w[b],K!=0&&(z[b]=W[K+16]++);var Q=0;for(b=0;b<M;++b)if(Q=w[b],Q!=0)for(K=Ee(z[b],T)>>T-Q,U=(1<<T+4-Q)-1;U>=0;--U)A[K|U<<Q]=Q&15|b<<4;return T}var sc=ue?new Uint16Array(512):jr(512),ic=ue?new Uint16Array(32):jr(32);if(!ue){for(var zn=0;zn<512;++zn)sc[zn]=0;for(zn=0;zn<32;++zn)ic[zn]=0}(function(){for(var w=[],A=0;A<32;A++)w.push(5);Ja(w,ic,32);var E=[];for(A=0;A<=143;A++)E.push(8);for(;A<=255;A++)E.push(9);for(;A<=279;A++)E.push(7);for(;A<=287;A++)E.push(8);Ja(E,sc,288)})();var kg=function(){for(var A=ue?new Uint8Array(32768):[],E=0,T=0;E<oe.length-1;++E)for(;T<oe[E+1];++T)A[T]=E;for(;T<32768;++T)A[T]=29;var C=ue?new Uint8Array(259):[];for(E=0,T=0;E<V.length-1;++E)for(;T<V[E+1];++T)C[T]=E;function b(K,M){for(var W=0;W<K.length;){var z=Math.min(65535,K.length-W),Q=W+z==K.length;for(M.write_shift(1,+Q),M.write_shift(2,z),M.write_shift(2,~z&65535);z-- >0;)M[M.l++]=K[W++]}return M.l}function U(K,M){for(var W=0,z=0,Q=ue?new Uint16Array(32768):[];z<K.length;){var ae=Math.min(65535,K.length-z);if(ae<10){for(W=zr(M,W,+(z+ae==K.length)),W&7&&(W+=8-(W&7)),M.l=W/8|0,M.write_shift(2,ae),M.write_shift(2,~ae&65535);ae-- >0;)M[M.l++]=K[z++];W=M.l*8;continue}W=zr(M,W,+(z+ae==K.length)+2);for(var fe=0;ae-- >0;){var te=K[z];fe=(fe<<5^te)&32767;var ce=-1,_e=0;if((ce=Q[fe])&&(ce|=z&-32768,ce>z&&(ce-=32768),ce<z))for(;K[ce+_e]==K[z+_e]&&_e<250;)++_e;if(_e>2){te=C[_e],te<=22?W=ws(M,W,ie[te+1]>>1)-1:(ws(M,W,3),W+=5,ws(M,W,ie[te-23]>>5),W+=3);var Ve=te<8?0:te-4>>2;Ve>0&&(bf(M,W,_e-V[te]),W+=Ve),te=A[z-ce],W=ws(M,W,ie[te]>>3),W-=3;var Ke=te<4?0:te-2>>1;Ke>0&&(bf(M,W,z-ce-oe[te]),W+=Ke);for(var kt=0;kt<_e;++kt)Q[fe]=z&32767,fe=(fe<<5^K[z])&32767,++z;ae-=_e-1}else te<=143?te=te+48:W=Wn(M,W,1),W=ws(M,W,ie[te]),Q[fe]=z&32767,++z}W=ws(M,W,0)-1}return M.l=(W+7)/8|0,M.l}return function(M,W){return M.length<8?b(M,W):U(M,W)}}();function Of(w){var A=H(50+Math.floor(w.length*1.1)),E=kg(w,A);return A.slice(0,E)}var Ff=ue?new Uint16Array(32768):jr(32768),jf=ue?new Uint16Array(32768):jr(32768),Pf=ue?new Uint16Array(128):jr(128),Rf=1,If=1;function Ng(w,A){var E=Ye(w,A)+257;A+=5;var T=Ye(w,A)+1;A+=5;var C=Wr(w,A)+4;A+=4;for(var b=0,U=ue?new Uint8Array(19):jr(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,W=ue?new Uint8Array(8):jr(8),z=ue?new Uint8Array(8):jr(8),Q=U.length,ae=0;ae<C;++ae)U[D[ae]]=b=Ce(w,A),M<b&&(M=b),W[b]++,A+=3;var fe=0;for(W[0]=0,ae=1;ae<=M;++ae)z[ae]=fe=fe+W[ae-1]<<1;for(ae=0;ae<Q;++ae)(fe=U[ae])!=0&&(K[ae]=z[fe]++);var te=0;for(ae=0;ae<Q;++ae)if(te=U[ae],te!=0){fe=ie[K[ae]]>>8-te;for(var ce=(1<<7-te)-1;ce>=0;--ce)Pf[fe|ce<<te]=te&7|ae<<3}var _e=[];for(M=1;_e.length<E+T;)switch(fe=Pf[me(w,A)],A+=fe&7,fe>>>=3){case 16:for(b=3+et(w,A),A+=2,fe=_e[_e.length-1];b-- >0;)_e.push(fe);break;case 17:for(b=3+Ce(w,A),A+=3;b-- >0;)_e.push(0);break;case 18:for(b=11+me(w,A),A+=7;b-- >0;)_e.push(0);break;default:_e.push(fe),M<fe&&(M=fe);break}var Ve=_e.slice(0,E),Ke=_e.slice(E);for(ae=E;ae<286;++ae)Ve[ae]=0;for(ae=T;ae<30;++ae)Ke[ae]=0;return Rf=Ja(Ve,Ff,286),If=Ja(Ke,jf,30),A}function Ag(w,A){if(w[0]==3&&!(w[1]&3))return[us(A),2];for(var E=0,T=0,C=xh(A||1<<18),b=0,U=C.length>>>0,K=0,M=0;!(T&1);){if(T=Ce(w,E),E+=3,T>>>1)T>>1==1?(K=9,M=5):(E=Ng(w,E),K=Rf,M=If);else{E&7&&(E+=8-(E&7));var W=w[E>>>3]|w[(E>>>3)+1]<<8;if(E+=32,W>0)for(!A&&U<b+W&&(C=nc(C,b+W),U=C.length);W-- >0;)C[b++]=w[E>>>3],E+=8;continue}for(;;){!A&&U<b+32767&&(C=nc(C,b+32767),U=C.length);var z=ar(w,E,K),Q=T>>>1==1?sc[z]:Ff[z];if(E+=Q&15,Q>>>=4,!(Q>>>8&255))C[b++]=Q;else{if(Q==256)break;Q-=257;var ae=Q<8?0:Q-4>>2;ae>5&&(ae=0);var fe=b+V[Q];ae>0&&(fe+=ar(w,E,ae),E+=ae),z=ar(w,E,M),Q=T>>>1==1?ic[z]:jf[z],E+=Q&15,Q>>>=4;var te=Q<4?0:Q-2>>1,ce=oe[Q];for(te>0&&(ce+=ar(w,E,te),E+=te),!A&&U<fe&&(C=nc(C,fe+100),U=C.length);b<fe;)C[b]=C[b-ce],++b}}}return A?[C,E+7>>>3]:[C.slice(0,b),E+7>>>3]}function Df(w,A){var E=w.slice(w.l||0),T=Ag(E,A);return w.l+=T[1],T[0]}function Lf(w,A){if(w)typeof console<"u"&&console.error(A);else throw new Error(A)}function Mf(w,A){var E=w;Jt(E,0);var T=[],C=[],b={FileIndex:T,FullPaths:C};k(b,{root:A.root});for(var U=E.length-4;(E[U]!=80||E[U+1]!=75||E[U+2]!=5||E[U+3]!=6)&&U>=0;)--U;E.l=U+4,E.l+=4;var K=E.read_shift(2);E.l+=6;var M=E.read_shift(4);for(E.l=M,U=0;U<K;++U){E.l+=20;var W=E.read_shift(4),z=E.read_shift(4),Q=E.read_shift(2),ae=E.read_shift(2),fe=E.read_shift(2);E.l+=8;var te=E.read_shift(4),ce=l(E.slice(E.l+Q,E.l+Q+ae));E.l+=Q+ae+fe;var _e=E.l;E.l=te+4,Cg(E,W,z,b,ce),E.l=_e}return b}function Cg(w,A,E,T,C){w.l+=2;var b=w.read_shift(2),U=w.read_shift(2),K=a(w);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var M=w.read_shift(4),W=w.read_shift(4),z=w.read_shift(4),Q=w.read_shift(2),ae=w.read_shift(2),fe="",te=0;te<Q;++te)fe+=String.fromCharCode(w[w.l++]);if(ae){var ce=l(w.slice(w.l,w.l+ae));(ce[21589]||{}).mt&&(K=ce[21589].mt),((C||{})[21589]||{}).mt&&(K=C[21589].mt)}w.l+=ae;var _e=w.slice(w.l,w.l+W);switch(U){case 8:_e=P(w,z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+U)}var Ve=!1;b&8&&(M=w.read_shift(4),M==134695760&&(M=w.read_shift(4),Ve=!0),W=w.read_shift(4),z=w.read_shift(4)),W!=A&&Lf(Ve,"Bad compressed size: "+A+" != "+W),z!=E&&Lf(Ve,"Bad uncompressed size: "+E+" != "+z),ac(T,fe,_e,{unsafe:!0,mt:K})}function bg(w,A){var E=A||{},T=[],C=[],b=H(1),U=E.compression?8:0,K=0,M=0,W=0,z=0,Q=0,ae=w.FullPaths[0],fe=ae,te=w.FileIndex[0],ce=[],_e=0;for(M=1;M<w.FullPaths.length;++M)if(fe=w.FullPaths[M].slice(ae.length),te=w.FileIndex[M],!(!te.size||!te.content||fe=="Sh33tJ5")){var Ve=z,Ke=H(fe.length);for(W=0;W<fe.length;++W)Ke.write_shift(1,fe.charCodeAt(W)&127);Ke=Ke.slice(0,Ke.l),ce[Q]=FS.buf(te.content,0);var kt=te.content;U==8&&(kt=R(kt)),b=H(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,K),b.write_shift(2,U),te.mt?i(b,te.mt):b.write_shift(4,0),b.write_shift(-4,ce[Q]),b.write_shift(4,kt.length),b.write_shift(4,te.content.length),b.write_shift(2,Ke.length),b.write_shift(2,0),z+=b.length,T.push(b),z+=Ke.length,T.push(Ke),z+=kt.length,T.push(kt),b=H(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,K),b.write_shift(2,U),b.write_shift(4,0),b.write_shift(-4,ce[Q]),b.write_shift(4,kt.length),b.write_shift(4,te.content.length),b.write_shift(2,Ke.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,Ve),_e+=b.l,C.push(b),_e+=Ke.length,C.push(Ke),++Q}return b=H(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,Q),b.write_shift(2,Q),b.write_shift(4,_e),b.write_shift(4,z),b.write_shift(2,0),yt([yt(T),yt(C),b])}var Qa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Og(w,A){if(w.ctype)return w.ctype;var E=w.name||"",T=E.match(/\.([^\.]+)$/);return T&&Qa[T[1]]||A&&(T=(E=A).match(/[\.\\]([^\.\\])+$/),T&&Qa[T[1]])?Qa[T[1]]:"application/octet-stream"}function Fg(w){for(var A=Aa(w),E=[],T=0;T<A.length;T+=76)E.push(A.slice(T,T+76));return E.join(`\r
`)+`\r
`}function jg(w){var A=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(W){var z=W.charCodeAt(0).toString(16).toUpperCase();return"="+(z.length==1?"0"+z:z)});A=A.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),A.charAt(0)==`
`&&(A="=0D"+A.slice(1)),A=A.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],T=A.split(`\r
`),C=0;C<T.length;++C){var b=T[C];if(b.length==0){E.push("");continue}for(var U=0;U<b.length;){var K=76,M=b.slice(U,U+K);M.charAt(K-1)=="="?K--:M.charAt(K-2)=="="?K-=2:M.charAt(K-3)=="="&&(K-=3),M=b.slice(U,U+K),U+=K,U<b.length&&(M+="="),E.push(M)}}return E.join(`\r
`)}function Pg(w){for(var A=[],E=0;E<w.length;++E){for(var T=w[E];E<=w.length&&T.charAt(T.length-1)=="=";)T=T.slice(0,T.length-1)+w[++E];A.push(T)}for(var C=0;C<A.length;++C)A[C]=A[C].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return kr(A.join(`\r
`))}function Rg(w,A,E){for(var T="",C="",b="",U,K=0;K<10;++K){var M=A[K];if(!M||M.match(/^\s*$/))break;var W=M.match(/^(.*?):\s*([^\s].*)$/);if(W)switch(W[1].toLowerCase()){case"content-location":T=W[2].trim();break;case"content-type":b=W[2].trim();break;case"content-transfer-encoding":C=W[2].trim();break}}switch(++K,C.toLowerCase()){case"base64":U=kr(an(A.slice(K).join("")));break;case"quoted-printable":U=Pg(A.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var z=ac(w,T.slice(E.length),U,{unsafe:!0});b&&(z.ctype=b)}function Ig(w,A){if(le(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=A&&A.root||"",T=(Fe&&Buffer.isBuffer(w)?w.toString("binary"):le(w)).split(`\r
`),C=0,b="";for(C=0;C<T.length;++C)if(b=T[C],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),E||(E=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),b.slice(0,E.length)!=E););var U=(T[1]||"").match(/boundary="(.*?)"/);if(!U)throw new Error("MAD cannot find boundary");var K="--"+(U[1]||""),M=[],W=[],z={FileIndex:M,FullPaths:W};k(z);var Q,ae=0;for(C=0;C<T.length;++C){var fe=T[C];fe!==K&&fe!==K+"--"||(ae++&&Rg(z,T.slice(Q,C),E),Q=C)}return z}function Dg(w,A){var E=A||{},T=E.boundary||"SheetJS";T="------="+T;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+T.slice(2)+'"',"","",""],b=w.FullPaths[0],U=b,K=w.FileIndex[0],M=1;M<w.FullPaths.length;++M)if(U=w.FullPaths[M].slice(b.length),K=w.FileIndex[M],!(!K.size||!K.content||U=="Sh33tJ5")){U=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_e){return"_x"+_e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_e){return"_u"+_e.charCodeAt(0).toString(16)+"_"});for(var W=K.content,z=Fe&&Buffer.isBuffer(W)?W.toString("binary"):le(W),Q=0,ae=Math.min(1024,z.length),fe=0,te=0;te<=ae;++te)(fe=z.charCodeAt(te))>=32&&fe<128&&++Q;var ce=Q>=ae*4/5;C.push(T),C.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+U),C.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),C.push("Content-Type: "+Og(K,U)),C.push(""),C.push(ce?jg(z):Fg(z))}return C.push(T+`--\r
`),C.join(`\r
`)}function Lg(w){var A={};return k(A,w),A}function ac(w,A,E,T){var C=T&&T.unsafe;C||k(w);var b=!C&&Le.find(w,A);if(!b){var U=w.FullPaths[0];A.slice(0,U.length)==U?U=A:(U.slice(-1)!="/"&&(U+="/"),U=(U+A).replace("//","/")),b={name:s(A),type:2},w.FileIndex.push(b),w.FullPaths.push(U),C||Le.utils.cfb_gc(w)}return b.content=E,b.size=E?E.length:0,T&&(T.CLSID&&(b.clsid=T.CLSID),T.mt&&(b.mt=T.mt),T.ct&&(b.ct=T.ct)),b}function Mg(w,A){k(w);var E=Le.find(w,A);if(E){for(var T=0;T<w.FileIndex.length;++T)if(w.FileIndex[T]==E)return w.FileIndex.splice(T,1),w.FullPaths.splice(T,1),!0}return!1}function Bg(w,A,E){k(w);var T=Le.find(w,A);if(T){for(var C=0;C<w.FileIndex.length;++C)if(w.FileIndex[C]==T)return w.FileIndex[C].name=s(E),w.FullPaths[C]=E,!0}return!1}function Ug(w){L(w,!0)}return t.find=G,t.read=N,t.parse=f,t.write=I,t.writeFile=Y,t.utils={cfb_new:Lg,cfb_add:ac,cfb_del:Mg,cfb_mov:Bg,cfb_gc:Ug,ReadShift:ra,CheckField:Ex,prep_blob:Jt,bconcat:yt,use_zlib:O,_deflateRaw:Of,_inflateRaw:Df,consts:ye},t}();function jS(e){return typeof e=="string"?qo(e):Array.isArray(e)?sS(e):e}function Ka(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=qo(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?ba(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([jS(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Va(t)),l.write(t),l.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function Tt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Th(e,t){for(var r=[],n=Tt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function uf(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Qo(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function PS(e){for(var t=[],r=Tt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var go=new Date(1899,11,30,0,0,0);function Gt(e,t){var r=e.getTime(),n=go.getTime()+(e.getTimezoneOffset()-go.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ax=new Date,RS=go.getTime()+(ax.getTimezoneOffset()-go.getTimezoneOffset())*6e4,kh=ax.getTimezoneOffset();function lx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+RS),t.getTimezoneOffset()!==kh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-kh)*6e4),t}var Nh=new Date("2017-02-19T19:06:09.000Z"),ox=isNaN(Nh.getFullYear())?new Date("2/19/17"):Nh,IS=ox.getFullYear()==2017;function Lt(e,t){var r=new Date(e);if(IS)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(ox.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Zo(e,t){if(Fe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xt(e[r]));return t}function Qe(e,t){for(var r="";r.length<t;)r+=e;return r}function Zr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var DS=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ca(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&DS.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Se(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Fe?n=cn(r):n=iS(r),Le.utils.cfb_add(e,t,n)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function ff(){return Le.utils.cfb_new()}var it=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,LS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},df=uf(LS),hf=/[&<>'"]/g,MS=/[\u0000-\u0008\u000b-\u001f]/g;function Re(e){var t=e+"";return t.replace(hf,function(r){return df[r]}).replace(MS,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ah(e){return Re(e).replace(/ /g,"_x0020_")}var cx=/[\u0000-\u001f]/g;function BS(e){var t=e+"";return t.replace(hf,function(r){return df[r]}).replace(/\n/g,"<br/>").replace(cx,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function US(e){var t=e+"";return t.replace(hf,function(r){return df[r]}).replace(cx,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function $S(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function WS(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Hc(e){for(var t="",r=0,n=0,s=0,i=0,a=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,t+=String.fromCharCode(a);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=e.charCodeAt(r++),l=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function Ch(e){var t=us(2*e.length),r,n,s=1,i=0,a=0,l;for(n=0;n<e.length;n+=s)s=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[i++]=a&255,t[i++]=a>>>8,a=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function bh(e){return cn(e,"binary").toString("utf8")}var El="foo bar baz",ta=Fe&&(bh(El)==Hc(El)&&bh||Ch(El)==Hc(El)&&Ch)||Hc,ba=Fe?function(e){return cn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},zS=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),ux=/(^\s|\s$|\n)/;function _t(e,t){return"<"+e+(t.match(ux)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Oa(e){return Tt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function re(e,t,r){return"<"+e+(r!=null?Oa(r):"")+(t!=null?(t.match(ux)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function n0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HS(e,t){switch(typeof e){case"string":var r=re("vt:lpwstr",Re(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return re((e|0)==e?"vt:i4":"vt:r8",Re(String(e)));case"boolean":return re("vt:bool",e?"true":"false")}if(e instanceof Date)return re("vt:filetime",n0(e));throw new Error("Unable to serialize "+e)}var dt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Qt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function VS(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function KS(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,a=n?-t:t;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|n}var Oh=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,i=e[0][n].length;s<i;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},Fh=Fe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:cn(t)})):Oh(e)}:Oh,jh=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode($i(e,s)));return n.join("").replace(ea,"")},pf=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ea,""):jh(e,t,r)}:jh,Ph=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},fx=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Ph(e,t,r)}:Ph,Rh=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Ps(e,s)));return n.join("")},Ga=Fe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Rh(t,r,n)}:Rh,dx=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},hx=dx,px=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},mx=px,xx=function(e,t){var r=2*Zt(e,t);return r>0?Ga(e,t+4,t+4+r-1):""},gx=xx,vx=function(t,r){var n=Zt(t,r);return n>0?pf(t,r+4,r+4+n):""},yx=vx,_x=function(e,t){var r=Zt(e,t);return r>0?Ga(e,t+4,t+4+r):""},wx=_x,Sx=function(e,t){return VS(e,t)},vo=Sx,mf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Fe&&(hx=function(t,r){if(!Buffer.isBuffer(t))return dx(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mx=function(t,r){if(!Buffer.isBuffer(t))return px(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},gx=function(t,r){if(!Buffer.isBuffer(t))return xx(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},yx=function(t,r){if(!Buffer.isBuffer(t))return vx(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},wx=function(t,r){if(!Buffer.isBuffer(t))return _x(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},vo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Sx(t,r)},mf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ps=function(e,t){return e[t]},$i=function(e,t){return e[t+1]*256+e[t]},GS=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Qn=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},XS=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ra(e,t){var r="",n,s,i=[],a,l,o,c;switch(t){case"dbcs":if(c=this.l,Fe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode($i(this,c)),c+=2;e*=2;break;case"utf8":r=Ga(this,this.l,this.l+e);break;case"utf16le":e*=2,r=pf(this,this.l,this.l+e);break;case"wstr":return ra.call(this,e,"dbcs");case"lpstr-ansi":r=hx(this,this.l),e=4+Zt(this,this.l);break;case"lpstr-cp":r=mx(this,this.l),e=4+Zt(this,this.l);break;case"lpwstr":r=gx(this,this.l),e=4+2*Zt(this,this.l);break;case"lpp4":e=4+Zt(this,this.l),r=yx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zt(this,this.l),r=wx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Ps(this,this.l+e++))!==0;)i.push(_l(a));r=i.join("");break;case"_wstr":for(e=0,r="";(a=$i(this,this.l+e))!==0;)i.push(_l(a)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Ps(this,c),this.l=c+1,l=ra.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(_l($i(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Ps(this,c),this.l=c+1,l=ra.call(this,e-o,a?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(_l(Ps(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=Ps(this,this.l),this.l++,n;case 2:return n=(t==="i"?GS:$i)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Qn:XS)(this,this.l),this.l+=4,n):(s=Zt(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=vo(this,this.l):s=vo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=fx(this,this.l,e);break}}return this.l+=e,r}var qS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},YS=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},JS=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function QS(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)JS(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var a=t.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,qS(this,t,this.l);break;case 8:if(n=8,r==="f"){KS(this,t,this.l);break}case 16:break;case-4:n=4,YS(this,t,this.l);break}return this.l+=n,this}function Ex(e,t){var r=fx(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Jt(e,t){e.l=t,e.read_shift=ra,e.chk=Ex,e.write_shift=QS}function $r(e,t){e.l+=t}function H(e){var t=us(e);return Jt(t,0),t}function Kt(){var e=[],t=Fe?256:2048,r=function(c){var f=H(c);return Jt(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,t)))},a=function(){return s(),yt(e)},l=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:l,end:a,_bufs:e}}function X(e,t,r,n){var s=+t,i;if(!isNaN(s)){n||(n=VN[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&mf(r)&&e.push(r)}}function na(e,t,r){var n=Xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ih(e,t,r){var n=Xt(e);return n.s=na(n.s,t.s,r),n.e=na(n.e,t.s,r),n}function sa(e,t){if(e.cRel&&e.c<0)for(e=Xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=De(e);return!e.cRel&&e.cRel!=null&&(r=tE(r)),!e.rRel&&e.rRel!=null&&(r=ZS(r)),r}function Vc(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+bt(e.s.c)+":"+(e.e.cRel?"":"$")+bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+St(e.s.r)+":"+(e.e.rRel?"":"$")+St(e.e.r):sa(e.s,t.biff)+":"+sa(e.e,t.biff)}function xf(e){return parseInt(eE(e),10)-1}function St(e){return""+(e+1)}function ZS(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eE(e){return e.replace(/\$(\d+)$/,"$1")}function gf(e){for(var t=rE(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tE(e){return e.replace(/^([A-Z])/,"$$$1")}function rE(e){return e.replace(/^\$([A-Z])/,"$1")}function nE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ht(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function De(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function nr(e){var t=e.indexOf(":");return t==-1?{s:ht(e),e:ht(e)}:{s:ht(e.slice(0,t)),e:ht(e.slice(t+1))}}function st(e,t){return typeof t>"u"||typeof t=="number"?st(e.s,e.e):(typeof e!="string"&&(e=De(e)),typeof t!="string"&&(t=De(t)),e==t?e:e+":"+t)}function We(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=e.length;for(r=0;n<i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=i&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function Dh(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Rn(e.z,r?Gt(t):t)}catch{}try{return e.w=Rn((e.XF||{}).numFmtId||(r?14:0),r?Gt(t):t)}catch{return""+t}}function ln(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Xa[e.v]||e.v:t==null?Dh(e,e.v):Dh(e,t))}function xs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Tx(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,i=e||(s?[]:{}),a=0,l=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?ht(n.origin):n.origin;a=o.r,l=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=We(i["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),a==-1&&(c.e.r=a=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var m={v:t[d][h]},x=a+d,p=l+h;if(c.s.r>x&&(c.s.r=x),c.s.c>p&&(c.s.c=p),c.e.r<x&&(c.e.r=x),c.e.c<p&&(c.e.c=p),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))m=t[d][h];else if(Array.isArray(m.v)&&(m.f=t[d][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Ze[14],n.cellDates?(m.t="d",m.w=Rn(m.z,Gt(m.v))):(m.t="n",m.v=Gt(m.v),m.w=Rn(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var _=De({c:p,r:x});i[_]&&i[_].z&&(m.z=i[_].z),i[_]=m}}}return c.s.c<1e7&&(i["!ref"]=st(c)),i}function _i(e,t){return Tx(null,e,t)}function sE(e){return e.read_shift(4,"i")}function br(e,t){return t||(t=H(4)),t.write_shift(4,e),t}function Ot(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function pt(e,t){var r=!1;return t==null&&(r=!0,t=H(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function iE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function aE(e,t){return t||(t=H(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vf(e,t){var r=e.l,n=e.read_shift(1),s=Ot(e),i=[],a={t:s,h:s};if(n&1){for(var l=e.read_shift(4),o=0;o!=l;++o)i.push(iE(e));a.r=i}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function lE(e,t){var r=!1;return t==null&&(r=!0,t=H(15+4*e.t.length)),t.write_shift(1,0),pt(e.t,t),r?t.slice(0,t.l):t}var oE=vf;function cE(e,t){var r=!1;return t==null&&(r=!0,t=H(23+4*e.t.length)),t.write_shift(1,1),pt(e.t,t),t.write_shift(4,1),aE({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function xr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gs(e,t){return t==null&&(t=H(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ys(e,t){return t==null&&(t=H(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var uE=Ot,kx=pt;function yf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function yo(e,t){var r=!1;return t==null&&(r=!0,t=H(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var fE=Ot,s0=yf,_f=yo;function Nx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?vo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Qn(t,0)>>2;return r?s/100:s}function Ax(e,t){t==null&&(t=H(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Cx(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function dE(e,t){return t||(t=H(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var _s=Cx,wi=dE;function Si(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function fs(e,t){return(t||H(8)).write_shift(8,e,"f")}function hE(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),a=e.read_shift(1),l=e.read_shift(1),o=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var c=SE[s];c&&(t.rgb=Gh(c));break;case 2:t.rgb=Gh([a,l,o]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function _o(e,t){if(t||(t=H(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function pE(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function mE(e,t){t||(t=H(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var bx=2,qt=3,Tl=11,wo=19,kl=64,xE=65,gE=71,vE=4108,yE=4126,vt=80,Lh={1:{n:"CodePage",t:bx},2:{n:"Category",t:vt},3:{n:"PresentationFormat",t:vt},4:{n:"ByteCount",t:qt},5:{n:"LineCount",t:qt},6:{n:"ParagraphCount",t:qt},7:{n:"SlideCount",t:qt},8:{n:"NoteCount",t:qt},9:{n:"HiddenCount",t:qt},10:{n:"MultimediaClipCount",t:qt},11:{n:"ScaleCrop",t:Tl},12:{n:"HeadingPairs",t:vE},13:{n:"TitlesOfParts",t:yE},14:{n:"Manager",t:vt},15:{n:"Company",t:vt},16:{n:"LinksUpToDate",t:Tl},17:{n:"CharacterCount",t:qt},19:{n:"SharedDoc",t:Tl},22:{n:"HyperlinksChanged",t:Tl},23:{n:"AppVersion",t:qt,p:"version"},24:{n:"DigSig",t:xE},26:{n:"ContentType",t:vt},27:{n:"ContentStatus",t:vt},28:{n:"Language",t:vt},29:{n:"Version",t:vt},255:{},2147483648:{n:"Locale",t:wo},2147483651:{n:"Behavior",t:wo},1919054434:{}},Mh={1:{n:"CodePage",t:bx},2:{n:"Title",t:vt},3:{n:"Subject",t:vt},4:{n:"Author",t:vt},5:{n:"Keywords",t:vt},6:{n:"Comments",t:vt},7:{n:"Template",t:vt},8:{n:"LastAuthor",t:vt},9:{n:"RevNumber",t:vt},10:{n:"EditTime",t:kl},11:{n:"LastPrinted",t:kl},12:{n:"CreatedDate",t:kl},13:{n:"ModifiedDate",t:kl},14:{n:"PageCount",t:qt},15:{n:"WordCount",t:qt},16:{n:"CharCount",t:qt},17:{n:"Thumbnail",t:gE},18:{n:"Application",t:vt},19:{n:"DocSecurity",t:qt},255:{},2147483648:{n:"Locale",t:wo},2147483651:{n:"Behavior",t:wo},1919054434:{}};function _E(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wE=_E([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),SE=Xt(wE),Xa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},EE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ox(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Fx(e,t){var r=PS(EE),n=[],s;n[n.length]=it,n[n.length]=re("Types",null,{xmlns:dt.CT,"xmlns:xsd":dt.xsd,"xmlns:xsi":dt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return re("Default",null,{Extension:o[0],ContentType:o[1]})}));var i=function(o){e[o]&&e[o].length>0&&(s=e[o][0],n[n.length]=re("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Nl[o][t.bookType]||Nl[o].xlsx}))},a=function(o){(e[o]||[]).forEach(function(c){n[n.length]=re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Nl[o][t.bookType]||Nl[o].xlsx})})},l=function(o){(e[o]||[]).forEach(function(c){n[n.length]=re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[o][0]})})};return i("workbooks"),a("sheets"),a("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),a("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Oe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function ti(e){var t=[it,re("Relationships",null,{xmlns:dt.RELS})];return Tt(e["!id"]).forEach(function(r){t[t.length]=re("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Pe(e,t,r,n,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Oe.HLINK,Oe.XPATH,Oe.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function TE(e){var t=[it];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Bh(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function kE(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function NE(e){var t=[it];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Bh(e[r][0],e[r][1])),t.push(kE("",e[r][0]));return t.push(Bh("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Px(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ho.version+"</meta:generator></office:meta></office:document-meta>"}var ss=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Kc(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Re(t),n[n.length]=r?re(e,t,r):_t(e,t))}function Rx(e,t){var r=t||{},n=[it,re("cp:coreProperties",null,{"xmlns:cp":dt.CORE_PROPS,"xmlns:dc":dt.dc,"xmlns:dcterms":dt.dcterms,"xmlns:dcmitype":dt.dcmitype,"xmlns:xsi":dt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Kc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:n0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Kc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:n0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=ss.length;++i){var a=ss[i],l=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Kc(a[0],l,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ri=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ix=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Dx(e){var t=[],r=re;return e||(e={}),e.Application="SheetJS",t[t.length]=it,t[t.length]=re("Properties",null,{xmlns:dt.EXT_PROPS,"xmlns:vt":dt.vt}),ri.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Re(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Re(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Lx(e){var t=[it,re("Properties",null,{xmlns:dt.CUST_PROPS,"xmlns:vt":dt.vt})];if(!e)return t.join("");var r=1;return Tt(e).forEach(function(s){++r,t[t.length]=re("property",HS(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Re(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Uh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function AE(e,t){var r=[];return Tt(Uh).map(function(n){for(var s=0;s<ss.length;++s)if(ss[s][1]==n)return ss[s];for(s=0;s<ri.length;++s)if(ri[s][1]==n)return ri[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(_t(Uh[n[1]]||n[1],s))}}),re("DocumentProperties",r.join(""),{xmlns:Qt.o})}function CE(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Tt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var a=0;a<ss.length;++a)if(i==ss[a][1])return;for(a=0;a<ri.length;++a)if(i==ri[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var l=e[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l=String(l),s.push(re(Ah(i),l,{"dt:dt":o}))}}),t&&Tt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var a=t[i],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),s.push(re(Ah(i),a,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Qt.o+'">'+s.join("")+"</"+n+">"}function bE(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=H(8);return a.write_shift(4,n),a.write_shift(4,s),a}function $h(e,t){var r=H(4),n=H(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=H(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=bE(t);break;case 31:case 80:for(n=H(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return yt([r,n])}var Mx=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function OE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Wh(e,t,r){var n=H(8),s=[],i=[],a=8,l=0,o=H(8),c=H(8);if(o.write_shift(4,2),o.write_shift(4,1200),c.write_shift(4,1),i.push(o),s.push(c),a+=8+o.length,!t){c=H(8),c.write_shift(4,0),s.unshift(c);var f=[H(4)];for(f[0].write_shift(4,e.length),l=0;l<e.length;++l){var d=e[l][0];for(o=H(8+2*(d.length+1)+(d.length%2?0:2)),o.write_shift(4,l+2),o.write_shift(4,d.length+1),o.write_shift(0,d,"dbcs");o.l!=o.length;)o.write_shift(1,0);f.push(o)}o=yt(f),i.unshift(o),a+=8+o.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(Mx.indexOf(e[l][0])>-1||Ix.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}o=$h(x.t,h)}else{var _=OE(h);_==-1&&(_=31,h=String(h)),o=$h(_,h)}i.push(o),c=H(8),c.write_shift(4,t?m:2+l),s.push(c),a+=8+o.length}var v=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,v),v+=i[l].length;return n.write_shift(4,a),n.write_shift(4,i.length),yt([n].concat(s).concat(i))}function zh(e,t,r,n,s,i){var a=H(s?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Le.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,s?68:48);var o=Wh(e,r,n);if(l.push(o),s){var c=Wh(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+o.length),l.push(c)}return yt(l)}function FE(e,t){t||(t=H(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function jE(e,t){return e.read_shift(t)===1}function It(e,t){return t||(t=H(2)),t.write_shift(2,+!!e),t}function Bx(e){return e.read_shift(2,"u")}function or(e,t){return t||(t=H(2)),t.write_shift(2,e),t}function Ux(e,t,r){return r||(r=H(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $x(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?e.read_shift(n,s):"";return a}function PE(e){var t=e.t||"",r=H(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=H(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return yt(s)}function RE(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function IE(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):RE(e,n,r)}function DE(e,t,r){if(r.biff>5)return IE(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Wx(e,t,r){return r||(r=H(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Hh(e,t){t||(t=H(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function LE(e){var t=H(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(i==28)n=n.slice(1),Hh(n,t);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var l=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&Hh(s>-1?n.slice(s+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var o=0;n.slice(o*3,o*3+3)=="../"||n.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,n.length-3*o+1),r=0;r<n.length-3*o;++r)t.write_shift(1,n.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function ds(e,t,r,n){return n||(n=H(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function ME(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),i=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[s,i,a]}function BE(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function zx(e,t){return t||(t=H(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function wf(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=H(s);return i.write_shift(2,n),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function UE(e,t){var r=!t||t.biff==8,n=H(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function $E(e,t){var r=!t||t.biff>=8?2:1,n=H(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function WE(e,t){var r=H(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=PE(e[s]);var i=yt([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function zE(){var e=H(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function HE(e){var t=H(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function VE(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,i=H(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function KE(e,t,r,n){var s=H(10);return ds(e,t,n,s),s.write_shift(4,r),s}function GE(e,t,r,n,s){var i=!s||s.biff==8,a=H(8+ +i+(1+i)*r.length);return ds(e,t,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function XE(e,t,r,n){var s=r&&r.biff==5;n||(n=H(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function qE(e,t){var r=t.biff==8||!t.biff?4:2,n=H(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Vh(e,t,r,n){var s=r&&r.biff==5;n||(n=H(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function YE(e){var t=H(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function JE(e,t,r,n,s,i){var a=H(8);return ds(e,t,n,a),Ux(r,i,a),a}function QE(e,t,r,n){var s=H(14);return ds(e,t,n,s),fs(r,s),s}function ZE(e,t,r){if(r.biff<8)return eT(e,t,r);for(var n=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(ME(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function eT(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=$x(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tT(e){var t=H(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)zx(e[r],t);return t}function rT(e){var t=H(24),r=ht(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return yt([t,LE(e[1])])}function nT(e){var t=e[1].Tooltip,r=H(10+2*(t.length+1));r.write_shift(2,2048);var n=ht(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function sT(e){return e||(e=H(4)),e.write_shift(2,1),e.write_shift(2,1),e}function iT(e,t,r){if(!r.cellStyles)return $r(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),i=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(n),o=e.read_shift(2);n==2&&(e.l+=2);var c={s,e:i,w:a,ixfe:l,flags:o};return(r.biff>=5||!r.biff)&&(c.level=o>>8&7),c}function aT(e,t){var r=H(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function lT(e){for(var t=H(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function oT(e,t,r){var n=H(15);return Ya(n,e,t),n.write_shift(8,r,"f"),n}function cT(e,t,r){var n=H(9);return Ya(n,e,t),n.write_shift(2,r),n}var uT=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=uf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,o){var c=[],f=us(1);switch(o.type){case"base64":f=kr(an(l));break;case"binary":f=kr(l);break;case"buffer":case"array":f=l;break}Jt(f,0);var d=f.read_shift(1),h=!!(d&136),m=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,_=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(_=f.read_shift(2));var v=f.read_shift(2),y=o.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var g=[],S={},j=Math.min(f.length,d==2?521:_-10-(m?264:0)),N=x?32:11;f.l<j&&f[f.l]!=13;)switch(S={},S.name=Jn.utils.decode(y,f.slice(f.l,f.l+N)).replace(/[\u0000\r\n].*$/g,""),f.l+=N,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&g.push(S),d!=2&&(f.l+=x?13:14),S.type){case"B":(!m||S.len!=8)&&o.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var k=0,F=0;for(c[0]=[],F=0;F!=g.length;++F)c[0][F]=g[F].name;for(;p-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,c[++k]=[],F=0,F=0;F!=g.length;++F){var L=f.slice(f.l,f.l+g[F].len);f.l+=g[F].len,Jt(L,0);var B=Jn.utils.decode(y,L);switch(g[F].type){case"C":B.trim().length&&(c[k][F]=B.replace(/\s+$/,""));break;case"D":B.length===8?c[k][F]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):c[k][F]=B;break;case"F":c[k][F]=parseFloat(B.trim());break;case"+":case"I":c[k][F]=x?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":c[k][F]=!0;break;case"N":case"F":c[k][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[k][F]="##MEMO##"+(x?parseInt(B.trim(),10):L.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(c[k][F]=+B||0);break;case"@":c[k][F]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[k][F]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[k][F]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[k][F]=-L.read_shift(-8,"f");break;case"B":if(m&&g[F].len==8){c[k][F]=L.read_shift(8,"f");break}case"G":case"P":L.l+=g[F].len;break;case"0":if(g[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[F].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(c=c.slice(0,o.sheetRows)),o.DBF=g,c}function n(l,o){var c=o||{};c.dateNF||(c.dateNF="yyyymmdd");var f=_i(r(l,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function s(l,o){try{return xs(n(l,o),o)}catch(c){if(o&&o.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,o){var c=o||{};if(+c.codepage>=0&&Na(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Kt(),d=No(l,{header:1,raw:!0,cellDates:!0}),h=d[0],m=d.slice(1),x=l["!cols"]||[],p=0,_=0,v=0,y=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++v;continue}if(h[p]!=null){if(++v,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(_=0;_<1024;++_)if(h.indexOf(h[p]+"_"+_)==-1){h[p]+="_"+_;break}}}}var g=We(l["!ref"]),S=[],j=[],N=[];for(p=0;p<=g.e.c-g.s.c;++p){var k="",F="",L=0,B=[];for(_=0;_<m.length;++_)m[_][p]!=null&&B.push(m[_][p]);if(B.length==0||h[p]==null){S[p]="?";continue}for(_=0;_<B.length;++_){switch(typeof B[_]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=B[_]instanceof Date?"D":"C";break;default:F="C"}L=Math.max(L,String(B[_]).length),k=k&&k!=F?"C":F}L>250&&(L=250),F=((x[p]||{}).DBF||{}).type,F=="C"&&x[p].DBF.len>L&&(L=x[p].DBF.len),k=="B"&&F=="N"&&(k="N",N[p]=x[p].DBF.dec,L=x[p].DBF.len),j[p]=k=="C"||F=="N"?L:i[k]||0,y+=j[p],S[p]=k}var G=f.next(32);for(G.write_shift(4,318902576),G.write_shift(4,m.length),G.write_shift(2,296+32*v),G.write_shift(2,y),p=0;p<4;++p)G.write_shift(4,0);for(G.write_shift(4,0|(+t[V1]||3)<<8),p=0,_=0;p<h.length;++p)if(h[p]!=null){var q=f.next(32),se=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);q.write_shift(1,se,"sbcs"),q.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),q.write_shift(4,_),q.write_shift(1,j[p]||i[S[p]]||0),q.write_shift(1,N[p]||0),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(1,0),q.write_shift(4,0),q.write_shift(4,0),_+=j[p]||i[S[p]]||0}var de=f.next(264);for(de.write_shift(4,13),p=0;p<65;++p)de.write_shift(4,0);for(p=0;p<m.length;++p){var ve=f.next(y);for(ve.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(S[_]){case"L":ve.write_shift(1,m[p][_]==null?63:m[p][_]?84:70);break;case"B":ve.write_shift(8,m[p][_]||0,"f");break;case"N":var J="0";for(typeof m[p][_]=="number"&&(J=m[p][_].toFixed(N[_]||0)),v=0;v<j[_]-J.length;++v)ve.write_shift(1,32);ve.write_shift(1,J,"sbcs");break;case"D":m[p][_]?(ve.write_shift(4,("0000"+m[p][_].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(m[p][_].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+m[p][_].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(m[p][_]!=null?m[p][_]:"").slice(0,j[_]);for(ve.write_shift(1,ye,"sbcs"),v=0;v<j[_]-ye.length;++v)ve.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),fT=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?mh(x):x},n=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:mh(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return i(an(h),m);case"binary":return i(h,m);case"buffer":return i(Fe&&Buffer.isBuffer(h)?h.toString("binary"):Va(h),m);case"array":return i(Zo(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,_=-1,v=0,y=0,g=[],S=[],j=null,N={},k=[],F=[],L=[],B=0,G;for(+m.codepage>=0&&Na(+m.codepage);v!==x.length;++v){B=0;var q=x[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),se=q.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),de=se[0],ve;if(q.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&S.push(q.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,ye=!1,Y=!1,le=!1,I=-1,pe=-1;for(y=1;y<se.length;++y)switch(se[y].charAt(0)){case"A":break;case"X":_=parseInt(se[y].slice(1))-1,ye=!0;break;case"Y":for(p=parseInt(se[y].slice(1))-1,ye||(_=0),G=g.length;G<=p;++G)g[G]=[];break;case"K":ve=se[y].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(Zr(ve))?isNaN(Ca(ve).getDate())||(ve=Lt(ve)):(ve=Zr(ve),j!==null&&nx(j)&&(ve=lx(ve))),J=!0;break;case"E":le=!0;var O=c4(se[y].slice(1),{r:p,c:_});g[p][_]=[g[p][_],O];break;case"S":Y=!0,g[p][_]=[g[p][_],"S5S"];break;case"G":break;case"R":I=parseInt(se[y].slice(1))-1;break;case"C":pe=parseInt(se[y].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}if(J&&(g[p][_]&&g[p][_].length==2?g[p][_][0]=ve:g[p][_]=ve,j=null),Y){if(le)throw new Error("SYLK shared formula cannot have own formula");var P=I>-1&&g[I][pe];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");g[p][_][1]=u4(P[1],{r:p-I,c:_-pe})}break;case"F":var R=0;for(y=1;y<se.length;++y)switch(se[y].charAt(0)){case"X":_=parseInt(se[y].slice(1))-1,++R;break;case"Y":for(p=parseInt(se[y].slice(1))-1,G=g.length;G<=p;++G)g[G]=[];break;case"M":B=parseInt(se[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=S[parseInt(se[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=se[y].slice(1).split(" "),G=parseInt(L[0],10);G<=parseInt(L[1],10);++G)B=parseInt(L[2],10),F[G-1]=B===0?{hidden:!0}:{wch:B},Sf(F[G-1]);break;case"C":_=parseInt(se[y].slice(1))-1,F[_]||(F[_]={});break;case"R":p=parseInt(se[y].slice(1))-1,k[p]||(k[p]={}),B>0?(k[p].hpt=B,k[p].hpx=Xx(B)):B===0&&(k[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}R<1&&(j=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+q)}}return k.length>0&&(N["!rows"]=k),F.length>0&&(N["!cols"]=F),m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),[g,N]}function a(h,m){var x=s(h,m),p=x[0],_=x[1],v=_i(p,m);return Tt(_).forEach(function(y){v[y]=_[y]}),v}function l(h,m){return xs(a(h,m),m)}function o(h,m,x,p){var _="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+Tf(h.f,{r:x,c:p}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,m){m.forEach(function(x,p){var _="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?_+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=So(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Eo(x.wpx)),typeof x.wch=="number"&&(_+=Math.round(x.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function f(h,m){m.forEach(function(x,p){var _="F;";x.hidden?_+="M0;":x.hpt?_+="M"+20*x.hpt+";":x.hpx&&(_+="M"+20*To(x.hpx)+";"),_.length>2&&h.push(_+"R"+(p+1))})}function d(h,m){var x=["ID;PWXL;N;E"],p=[],_=We(h["!ref"]),v,y=Array.isArray(h),g=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&c(x,h["!cols"]),h["!rows"]&&f(x,h["!rows"]),x.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var S=_.s.r;S<=_.e.r;++S)for(var j=_.s.c;j<=_.e.c;++j){var N=De({r:S,c:j});v=y?(h[S]||[])[j]:h[N],!(!v||v.v==null&&(!v.f||v.F))&&p.push(o(v,h,S,j))}return x.join(g)+g+p.join(g)+g+"E"+g}return{to_workbook:l,to_sheet:a,from_sheet:d}}(),dT=function(){function e(i,a){switch(a.type){case"base64":return t(an(i),a);case"binary":return t(i,a);case"buffer":return t(Fe&&Buffer.isBuffer(i)?i.toString("binary"):Va(i),a);case"array":return t(Zo(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){for(var l=i.split(`
`),o=-1,c=-1,f=0,d=[];f!==l.length;++f){if(l[f].trim()==="BOT"){d[++o]=[],c=0;continue}if(!(o<0)){var h=l[f].trim().split(","),m=h[0],x=h[1];++f;for(var p=l[f]||"";(p.match(/["]/g)||[]).length&1&&f<l.length-1;)p+=`
`+l[++f];switch(p=p.trim(),+m){case-1:if(p==="BOT"){d[++o]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[o][c]=!0:p==="FALSE"?d[o][c]=!1:isNaN(Zr(x))?isNaN(Ca(x).getDate())?d[o][c]=x:d[o][c]=Lt(x):d[o][c]=Zr(x),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[o][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(i,a){return _i(e(i,a),a)}function n(i,a){return xs(r(i,a),a)}var s=function(){var i=function(o,c,f,d,h){o.push(c),o.push(f+","+d),o.push('"'+h.replace(/"/g,'""')+'"')},a=function(o,c,f,d){o.push(c+","+f),o.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(o){var c=[],f=We(o["!ref"]),d,h=Array.isArray(o);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,f.e.r-f.s.r+1,""),i(c,"TUPLES",0,f.e.c-f.s.c+1,""),i(c,"DATA",0,0,"");for(var m=f.s.r;m<=f.e.r;++m){a(c,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var p=De({r:m,c:x});if(d=h?(o[m]||[])[x]:o[p],!d){a(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?a(c,1,0,"="+d.f):a(c,1,0,""):a(c,0,_,"V");break;case"b":a(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Rn(d.z||Ze[14],Gt(Lt(d.v)))),a(c,0,d.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var v=`\r
`,y=c.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),Hx=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var m=d.split(`
`),x=-1,p=-1,_=0,v=[];_!==m.length;++_){var y=m[_].trim().split(":");if(y[0]==="cell"){var g=ht(y[1]);if(v.length<=g.r)for(x=v.length;x<=g.r;++x)v[x]||(v[x]=[]);switch(x=g.r,p=g.c,y[2]){case"t":v[x][p]=e(y[3]);break;case"v":v[x][p]=+y[3];break;case"vtf":var S=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[x][p]=!!+y[4];break;default:v[x][p]=+y[4];break}y[2]=="vtf"&&(v[x][p]=[v[x][p],S])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(d,h){return _i(r(d,h),h)}function s(d,h){return xs(n(d,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],m=[],x,p="",_=nr(d["!ref"]),v=Array.isArray(d),y=_.s.r;y<=_.e.r;++y)for(var g=_.s.c;g<=_.e.c;++g)if(p=De({r:y,c:g}),x=v?(d[y]||[])[g]:d[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=Gt(Lt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+S,m[5]=x.w||Rn(x.z||Ze[14],S);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[i,a,l,a,c(d),o].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),hT=function(){function e(f,d,h,m,x){x.raw?d[h][m]=f:f===""||(f==="TRUE"?d[h][m]=!0:f==="FALSE"?d[h][m]=!1:isNaN(Zr(f))?isNaN(Ca(f).getDate())?d[h][m]=f:d[h][m]=Lt(f):d[h][m]=Zr(f))}function t(f,d){var h=d||{},m=[];if(!f||f.length===0)return m;for(var x=f.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var _=10,v=0,y=0;y<=p;++y)v=x[y].indexOf(" "),v==-1?v=x[y].length:v++,_=Math.max(_,v);for(y=0;y<=p;++y){m[y]=[];var g=0;for(e(x[y].slice(0,_).trim(),m,y,g,h),g=1;g<=(x[y].length-_)/10+1;++g)e(x[y].slice(_+(g-1)*10,_+g*10).trim(),m,y,g,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},h=!1,m=0,x=0;m<f.length;++m)(x=f.charCodeAt(m))==34?h=!h:!h&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&x.push([d[m],m]);if(!x.length){d=n;for(m in d)Object.prototype.hasOwnProperty.call(d,m)&&x.push([d[m],m])}return x.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[x.pop()[1]]||44}function i(f,d){var h=d||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(m=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(m=f.charAt(4),f=f.slice(6)):m=s(f.slice(0,1024)):h&&h.FS?m=h.FS:m=s(f.slice(0,1024));var _=0,v=0,y=0,g=0,S=0,j=m.charCodeAt(0),N=!1,k=0,F=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var L=h.dateNF!=null?bS(h.dateNF):null;function B(){var G=f.slice(g,S),q={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)q.t="z";else if(h.raw)q.t="s",q.v=G;else if(G.trim().length===0)q.t="s",q.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(q.t="s",q.v=G.slice(2,-1).replace(/""/g,'"')):f4(G)?(q.t="n",q.f=G.slice(1)):(q.t="s",q.v=G);else if(G=="TRUE")q.t="b",q.v=!0;else if(G=="FALSE")q.t="b",q.v=!1;else if(!isNaN(y=Zr(G)))q.t="n",h.cellText!==!1&&(q.w=G),q.v=y;else if(!isNaN(Ca(G).getDate())||L&&G.match(L)){q.z=h.dateNF||Ze[14];var se=0;L&&G.match(L)&&(G=OS(G,h.dateNF,G.match(L)||[]),se=1),h.cellDates?(q.t="d",q.v=Lt(G,se)):(q.t="n",q.v=Gt(Lt(G,se))),h.cellText!==!1&&(q.w=Rn(q.z,q.v instanceof Date?Gt(q.v):q.v)),h.cellNF||delete q.z}else q.t="s",q.v=G;if(q.t=="z"||(h.dense?(x[_]||(x[_]=[]),x[_][v]=q):x[De({c:v,r:_})]=q),g=S+1,F=f.charCodeAt(g),p.e.c<v&&(p.e.c=v),p.e.r<_&&(p.e.r=_),k==j)++v;else if(v=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;S<f.length;++S)switch(k=f.charCodeAt(S)){case 34:F===34&&(N=!N);break;case j:case 10:case 13:if(!N&&B())break e;break}return S-g>0&&B(),x["!ref"]=st(p),x}function a(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):_i(t(f,d),d)}function l(f,d){var h="",m=d.type=="string"?[0,0,0,0]:kA(f,d);switch(d.type){case"base64":h=an(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Jn<"u"?h=Jn.utils.decode(d.codepage,f):h=Fe&&Buffer.isBuffer(f)?f.toString("binary"):Va(f);break;case"array":h=Zo(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=ta(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ta(h):d.type=="binary"&&typeof Jn<"u"&&d.codepage&&(h=Jn.utils.decode(d.codepage,Jn.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?Hx.to_sheet(d.type=="string"?h:ta(h),d):a(h,d)}function o(f,d){return xs(l(f,d),d)}function c(f){for(var d=[],h=We(f["!ref"]),m,x=Array.isArray(f),p=h.s.r;p<=h.e.r;++p){for(var _=[],v=h.s.c;v<=h.e.c;++v){var y=De({r:p,c:v});if(m=x?(f[p]||[])[v]:f[y],!m||m.v==null){_.push("          ");continue}for(var g=(m.w||(ln(m),m.w)||"").slice(0,10);g.length<10;)g+=" ";_.push(g+(v===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:o,to_sheet:l,from_sheet:c}}(),Kh=function(){function e(O,P,R){if(O){Jt(O,O.l||0);for(var D=R.Enum||I;O.l<O.length;){var V=O.read_shift(2),oe=D[V]||D[65535],ge=O.read_shift(2),ue=O.l+ge,ie=oe.f&&oe.f(O,ge,R);if(O.l=ue,P(ie,oe,V))return}}}function t(O,P){switch(P.type){case"base64":return r(kr(an(O)),P);case"binary":return r(kr(O),P);case"buffer":case"array":return r(O,P)}throw"Unsupported type "+P.type}function r(O,P){if(!O)return O;var R=P||{},D=R.dense?[]:{},V="Sheet1",oe="",ge=0,ue={},ie=[],Ae=[],Ee={s:{r:0,c:0},e:{r:0,c:0}},et=R.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)R.Enum=I,e(O,function(me,ar,zr){switch(zr){case 0:R.vers=me,me>=4096&&(R.qpro=!0);break;case 6:Ee=me;break;case 204:me&&(oe=me);break;case 222:oe=me;break;case 15:case 51:R.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:zr==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=R.dateNF||Ze[14],R.cellDates&&(me[1].t="d",me[1].v=lx(me[1].v))),R.qpro&&me[3]>ge&&(D["!ref"]=st(Ee),ue[V]=D,ie.push(V),D=R.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},ge=me[3],V=oe||"Sheet"+(ge+1),oe="");var Wn=R.dense?(D[me[0].r]||[])[me[0].c]:D[De(me[0])];if(Wn){Wn.t=me[1].t,Wn.v=me[1].v,me[1].z!=null&&(Wn.z=me[1].z),me[1].f!=null&&(Wn.f=me[1].f);break}R.dense?(D[me[0].r]||(D[me[0].r]=[]),D[me[0].r][me[0].c]=me[1]):D[De(me[0])]=me[1];break}},R);else if(O[2]==26||O[2]==14)R.Enum=pe,O[2]==14&&(R.qpro=!0,O.l=0),e(O,function(me,ar,zr){switch(zr){case 204:V=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>ge&&(D["!ref"]=st(Ee),ue[V]=D,ie.push(V),D=R.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},ge=me[3],V="Sheet"+(ge+1)),et>0&&me[0].r>=et)break;R.dense?(D[me[0].r]||(D[me[0].r]=[]),D[me[0].r][me[0].c]=me[1]):D[De(me[0])]=me[1],Ee.e.c<me[0].c&&(Ee.e.c=me[0].c),Ee.e.r<me[0].r&&(Ee.e.r=me[0].r);break;case 27:me[14e3]&&(Ae[me[14e3][0]]=me[14e3][1]);break;case 1537:Ae[me[0]]=me[1],me[0]==ge&&(V=me[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(D["!ref"]=st(Ee),ue[oe||V]=D,ie.push(oe||V),!Ae.length)return{SheetNames:ie,Sheets:ue};for(var Ce={},Wr=[],Ye=0;Ye<Ae.length;++Ye)ue[ie[Ye]]?(Wr.push(Ae[Ye]||ie[Ye]),Ce[Ae[Ye]]=ue[Ae[Ye]]||ue[ie[Ye]]):(Wr.push(Ae[Ye]),Ce[Ae[Ye]]={"!ref":"A1"});return{SheetNames:Wr,Sheets:Ce}}function n(O,P){var R=P||{};if(+R.codepage>=0&&Na(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Kt(),V=We(O["!ref"]),oe=Array.isArray(O),ge=[];ne(D,0,i(1030)),ne(D,6,o(V));for(var ue=Math.min(V.e.r,8191),ie=V.s.r;ie<=ue;++ie)for(var Ae=St(ie),Ee=V.s.c;Ee<=V.e.c;++Ee){ie===V.s.r&&(ge[Ee]=bt(Ee));var et=ge[Ee]+Ae,Ce=oe?(O[ie]||[])[Ee]:O[et];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?ne(D,13,m(ie,Ee,Ce.v)):ne(D,14,p(ie,Ee,Ce.v));else{var Wr=ln(Ce);ne(D,15,d(ie,Ee,Wr.slice(0,239)))}}return ne(D,1),D.end()}function s(O,P){var R=P||{};if(+R.codepage>=0&&Na(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Kt();ne(D,0,a(O));for(var V=0,oe=0;V<O.SheetNames.length;++V)(O.Sheets[O.SheetNames[V]]||{})["!ref"]&&ne(D,27,le(O.SheetNames[V],oe++));var ge=0;for(V=0;V<O.SheetNames.length;++V){var ue=O.Sheets[O.SheetNames[V]];if(!(!ue||!ue["!ref"])){for(var ie=We(ue["!ref"]),Ae=Array.isArray(ue),Ee=[],et=Math.min(ie.e.r,8191),Ce=ie.s.r;Ce<=et;++Ce)for(var Wr=St(Ce),Ye=ie.s.c;Ye<=ie.e.c;++Ye){Ce===ie.s.r&&(Ee[Ye]=bt(Ye));var me=Ee[Ye]+Wr,ar=Ae?(ue[Ce]||[])[Ye]:ue[me];if(!(!ar||ar.t=="z"))if(ar.t=="n")ne(D,23,B(Ce,Ye,ge,ar.v));else{var zr=ln(ar);ne(D,22,k(Ce,Ye,ge,zr.slice(0,239)))}}++ge}}return ne(D,1),D.end()}function i(O){var P=H(2);return P.write_shift(2,O),P}function a(O){var P=H(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var R=0,D=0,V=0,oe=0;oe<O.SheetNames.length;++oe){var ge=O.SheetNames[oe],ue=O.Sheets[ge];if(!(!ue||!ue["!ref"])){++V;var ie=nr(ue["!ref"]);R<ie.e.r&&(R=ie.e.r),D<ie.e.c&&(D=ie.e.c)}}return R>8191&&(R=8191),P.write_shift(2,R),P.write_shift(1,V),P.write_shift(1,D),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function l(O,P,R){var D={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&R.qpro?(D.s.c=O.read_shift(1),O.l++,D.s.r=O.read_shift(2),D.e.c=O.read_shift(1),O.l++,D.e.r=O.read_shift(2),D):(D.s.c=O.read_shift(2),D.s.r=O.read_shift(2),P==12&&R.qpro&&(O.l+=2),D.e.c=O.read_shift(2),D.e.r=O.read_shift(2),P==12&&R.qpro&&(O.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function o(O){var P=H(8);return P.write_shift(2,O.s.c),P.write_shift(2,O.s.r),P.write_shift(2,O.e.c),P.write_shift(2,O.e.r),P}function c(O,P,R){var D=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(D[0].c=O.read_shift(1),D[3]=O.read_shift(1),D[0].r=O.read_shift(2),O.l+=2):(D[2]=O.read_shift(1),D[0].c=O.read_shift(2),D[0].r=O.read_shift(2)),D}function f(O,P,R){var D=O.l+P,V=c(O,P,R);if(V[1].t="s",R.vers==20768){O.l++;var oe=O.read_shift(1);return V[1].v=O.read_shift(oe,"utf8"),V}return R.qpro&&O.l++,V[1].v=O.read_shift(D-O.l,"cstr"),V}function d(O,P,R){var D=H(7+R.length);D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,O),D.write_shift(1,39);for(var V=0;V<D.length;++V){var oe=R.charCodeAt(V);D.write_shift(1,oe>=128?95:oe)}return D.write_shift(1,0),D}function h(O,P,R){var D=c(O,P,R);return D[1].v=O.read_shift(2,"i"),D}function m(O,P,R){var D=H(7);return D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,O),D.write_shift(2,R,"i"),D}function x(O,P,R){var D=c(O,P,R);return D[1].v=O.read_shift(8,"f"),D}function p(O,P,R){var D=H(13);return D.write_shift(1,255),D.write_shift(2,P),D.write_shift(2,O),D.write_shift(8,R,"f"),D}function _(O,P,R){var D=O.l+P,V=c(O,P,R);if(V[1].v=O.read_shift(8,"f"),R.qpro)O.l=D;else{var oe=O.read_shift(2);S(O.slice(O.l,O.l+oe),V),O.l+=oe}return V}function v(O,P,R){var D=P&32768;return P&=-32769,P=(D?O:0)+(P>=8192?P-16384:P),(D?"":"$")+(R?bt(P):St(P))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(O,P){Jt(O,0);for(var R=[],D=0,V="",oe="",ge="",ue="";O.l<O.length;){var ie=O[O.l++];switch(ie){case 0:R.push(O.read_shift(8,"f"));break;case 1:oe=v(P[0].c,O.read_shift(2),!0),V=v(P[0].r,O.read_shift(2),!1),R.push(oe+V);break;case 2:{var Ae=v(P[0].c,O.read_shift(2),!0),Ee=v(P[0].r,O.read_shift(2),!1);oe=v(P[0].c,O.read_shift(2),!0),V=v(P[0].r,O.read_shift(2),!1),R.push(Ae+Ee+":"+oe+V)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(O.read_shift(2));break;case 6:{for(var et="";ie=O[O.l++];)et+=String.fromCharCode(ie);R.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:ue=R.pop(),ge=R.pop(),R.push(["AND","OR"][ie-20]+"("+ge+","+ue+")");break;default:if(ie<32&&g[ie])ue=R.pop(),ge=R.pop(),R.push(ge+g[ie]+ue);else if(y[ie]){if(D=y[ie][1],D==69&&(D=O[O.l++]),D>R.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+R.join("|")+"|");return}var Ce=R.slice(-D);R.length-=D,R.push(y[ie][0]+"("+Ce.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}R.length==1?P[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function j(O){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=O.read_shift(2),P[3]=O[O.l++],P[0].c=O[O.l++],P}function N(O,P){var R=j(O);return R[1].t="s",R[1].v=O.read_shift(P-4,"cstr"),R}function k(O,P,R,D){var V=H(6+D.length);V.write_shift(2,O),V.write_shift(1,R),V.write_shift(1,P),V.write_shift(1,39);for(var oe=0;oe<D.length;++oe){var ge=D.charCodeAt(oe);V.write_shift(1,ge>=128?95:ge)}return V.write_shift(1,0),V}function F(O,P){var R=j(O);R[1].v=O.read_shift(2);var D=R[1].v>>1;if(R[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return R[1].v=D,R}function L(O,P){var R=j(O),D=O.read_shift(4),V=O.read_shift(4),oe=O.read_shift(2);if(oe==65535)return D===0&&V===3221225472?(R[1].t="e",R[1].v=15):D===0&&V===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var ge=oe&32768;return oe=(oe&32767)-16446,R[1].v=(1-ge*2)*(V*Math.pow(2,oe+32)+D*Math.pow(2,oe)),R}function B(O,P,R,D){var V=H(14);if(V.write_shift(2,O),V.write_shift(1,R),V.write_shift(1,P),D==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var oe=0,ge=0,ue=0,ie=0;return D<0&&(oe=1,D=-D),ge=Math.log2(D)|0,D/=Math.pow(2,ge-31),ie=D>>>0,ie&2147483648||(D/=2,++ge,ie=D>>>0),D-=ie,ie|=2147483648,ie>>>=0,D*=Math.pow(2,32),ue=D>>>0,V.write_shift(4,ue),V.write_shift(4,ie),ge+=16383+(oe?32768:0),V.write_shift(2,ge),V}function G(O,P){var R=L(O);return O.l+=P-14,R}function q(O,P){var R=j(O),D=O.read_shift(4);return R[1].v=D>>6,R}function se(O,P){var R=j(O),D=O.read_shift(8,"f");return R[1].v=D,R}function de(O,P){var R=se(O);return O.l+=P-10,R}function ve(O,P){return O[O.l+P-1]==0?O.read_shift(P,"cstr"):""}function J(O,P){var R=O[O.l++];R>P-1&&(R=P-1);for(var D="";D.length<R;)D+=String.fromCharCode(O[O.l++]);return D}function ye(O,P,R){if(!(!R.qpro||P<21)){var D=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var V=O.read_shift(P-21,"cstr");return[D,V]}}function Y(O,P){for(var R={},D=O.l+P;O.l<D;){var V=O.read_shift(2);if(V==14e3){for(R[V]=[0,""],R[V][0]=O.read_shift(2);O[O.l];)R[V][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return R}function le(O,P){var R=H(5+O.length);R.write_shift(2,14e3),R.write_shift(2,P);for(var D=0;D<O.length;++D){var V=O.charCodeAt(D);R[R.l++]=V>127?95:V}return R[R.l++]=0,R}var I={0:{n:"BOF",f:Bx},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Y},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:q},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),pT=/^\s|\s$|[\t\n\r]/;function Vx(e,t){if(!t.bookSST)return"";var r=[it];r[r.length]=re("sst",null,{xmlns:yi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(pT)&&(i+=' xml:space="preserve"'),i+=">"+Re(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function mT(e){return[e.read_shift(4),e.read_shift(4)]}function xT(e,t){return t||(t=H(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var gT=lE;function vT(e){var t=Kt();X(t,159,xT(e));for(var r=0;r<e.length;++r)X(t,19,gT(e[r]));return X(t,160),t.end()}function yT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Kx(e){var t=0,r,n=yT(e),s=n.length+1,i,a,l,o,c;for(r=us(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],l=t&16384?1:0,o=t<<1&32767,c=l|o,t=c^a;return t^52811}var _T=function(){function e(s,i){switch(i.type){case"base64":return t(an(s),i);case"binary":return t(s,i);case"buffer":return t(Fe&&Buffer.isBuffer(s)?s.toString("binary"):Va(s),i);case"array":return t(Zo(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var a=i||{},l=a.dense?[]:{},o=s.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,d){Array.isArray(l)&&(l[d]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(f);){switch(x[0]){case"\\cell":var _=f.slice(m,h.lastIndex-x[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var v={v:_,t:"s"};Array.isArray(l)?l[d][p]=v:l[De({r:d,c:p})]=v}break}m=h.lastIndex}p>c.e.c&&(c.e.c=p)}),l["!ref"]=st(c),l}function r(s,i){return xs(e(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=We(s["!ref"]),l,o=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var f=a.s.c;f<=a.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=a.s.c;f<=a.e.c;++f){var d=De({r:c,c:f});l=o?(s[c]||[])[f]:s[d],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ln(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Gh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var wT=6,en=wT;function So(e){return Math.floor((e+Math.round(128/en)/256)*en)}function Eo(e){return Math.floor((e-5)/en*100+.5)/100}function i0(e){return Math.round((e*en+5)/en*256)/256}function Sf(e){e.width?(e.wpx=So(e.width),e.wch=Eo(e.wpx),e.MDW=en):e.wpx?(e.wch=Eo(e.wpx),e.width=i0(e.wch),e.MDW=en):typeof e.wch=="number"&&(e.width=i0(e.wch),e.wpx=So(e.width),e.MDW=en),e.customWidth&&delete e.customWidth}var ST=96,Gx=ST;function To(e){return e*96/Gx}function Xx(e){return e*Gx/96}function ET(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=re("numFmt",null,{numFmtId:n,formatCode:Re(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=re("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function TT(e){var t=[];return t[t.length]=re("cellXfs",null),e.forEach(function(r){t[t.length]=re("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=re("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function qx(e,t){var r=[it,re("styleSheet",null,{xmlns:yi[0],"xmlns:vt":dt.vt})],n;return e.SSF&&(n=ET(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=TT(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function kT(e,t){var r=e.read_shift(2),n=Ot(e);return[r,n]}function NT(e,t,r){r||(r=H(6+4*t.length)),r.write_shift(2,e),pt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function AT(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=pE(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var l=e.read_shift(1);l>0&&(n.family=l);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=hE(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ot(e),n}function CT(e,t){t||(t=H(25+4*32)),t.write_shift(2,e.sz*20),mE(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_o(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),pt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bT=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Gc,OT=$r;function Xh(e,t){t||(t=H(4*3+8*7+16*1)),Gc||(Gc=uf(bT));var r=Gc[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_o({auto:1},t),_o({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function FT(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function Yx(e,t,r){r||(r=H(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ii(e,t){return t||(t=H(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var jT=$r;function PT(e,t){return t||(t=H(51)),t.write_shift(1,0),Ii(null,t),Ii(null,t),Ii(null,t),Ii(null,t),Ii(null,t),t.length>t.l?t.slice(0,t.l):t}function RT(e,t){return t||(t=H(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),yo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function IT(e,t,r){var n=H(2052);return n.write_shift(4,e),yo(t,n),yo(r,n),n.length>n.l?n.slice(0,n.l):n}function DT(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(X(e,615,br(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&X(e,44,NT(s,t[s]))}),X(e,616))}}function LT(e){var t=1;X(e,611,br(t)),X(e,43,CT({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),X(e,612)}function MT(e){var t=2;X(e,603,br(t)),X(e,45,Xh({patternType:"none"})),X(e,45,Xh({patternType:"gray125"})),X(e,604)}function BT(e){var t=1;X(e,613,br(t)),X(e,46,PT()),X(e,614)}function UT(e){var t=1;X(e,626,br(t)),X(e,47,Yx({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),X(e,627)}function $T(e,t){X(e,617,br(t.length)),t.forEach(function(r){X(e,47,Yx(r,0))}),X(e,618)}function WT(e){var t=1;X(e,619,br(t)),X(e,48,RT({xfId:0,builtinId:0,name:"Normal"})),X(e,620)}function zT(e){var t=0;X(e,505,br(t)),X(e,506)}function HT(e){var t=0;X(e,508,IT(t,"TableStyleMedium9","PivotStyleMedium4")),X(e,509)}function VT(e,t){var r=Kt();return X(r,278),DT(r,e.SSF),LT(r),MT(r),BT(r),UT(r),$T(r,t.cellXfs),WT(r),zT(r),HT(r),X(r,279),r.end()}function Jx(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[it];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function KT(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ot(e)}}function GT(e){var t=H(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),pt(e.name,t),t.slice(0,t.l)}function XT(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function qT(e){var t=H(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function YT(e,t){var r=H(8+2*t.length);return r.write_shift(4,e),pt(t,r),r.slice(0,r.l)}function JT(e){return e.l+=4,e.read_shift(4)!=0}function QT(e,t){var r=H(8);return r.write_shift(4,e),r.write_shift(4,1),r}function ZT(){var e=Kt();return X(e,332),X(e,334,br(1)),X(e,335,GT({name:"XLDAPR",version:12e4,flags:3496657072})),X(e,336),X(e,339,YT(1,"XLDAPR")),X(e,52),X(e,35,br(514)),X(e,4096,br(0)),X(e,4097,or(1)),X(e,36),X(e,53),X(e,340),X(e,337,QT(1)),X(e,51,qT([[1,0]])),X(e,338),X(e,333),e.end()}function Qx(){var e=[it];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function e4(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=De(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ks=1024;function Zx(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[re("xml",null,{"xmlns:v":Qt.v,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:mv":Qt.mv}).replace(/\/>/,">"),re("o:shapelayout",re("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),re("v:shapetype",[re("v:stroke",null,{joinstyle:"miter"}),re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ks<e*1e3;)Ks+=1e3;return t.forEach(function(i){var a=ht(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var o=l.type=="gradient"?re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=re("v:fill",o,l),f={on:"t",obscured:"t"};++Ks,s=s.concat(["<v:shape"+Oa({id:"_x0000_s"+Ks,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,re("v:shadow",null,f),re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_t("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),_t("x:AutoFill","False"),_t("x:Row",String(a.r)),_t("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function eg(e){var t=[it,re("comments",null,{xmlns:yi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var i=Re(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(o){o.a&&(s=r.indexOf(Re(o.a))),i.push(o.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(_t("t",Re(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)a+=`Reply:
    `+i[l]+`
`;t.push(_t("t",Re(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function t4(e,t,r){var n=[it,re("ThreadedComments",null,{xmlns:dt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var o={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=o.id:o.parentId=i,a.ID=o.id,a.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(re("threadedComment",_t("text",a.t||""),o))})}),n.push("</ThreadedComments>"),n.join("")}function r4(e){var t=[it,re("personList",null,{xmlns:dt.TCMNT,"xmlns:x":yi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(re("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function n4(e){var t={};t.iauthor=e.read_shift(4);var r=_s(e);return t.rfx=r.s,t.ref=De(r.s),e.l+=16,t}function s4(e,t){return t==null&&(t=H(36)),t.write_shift(4,e[1].iauthor),wi(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var i4=Ot;function a4(e){return pt(e.slice(0,54))}function l4(e){var t=Kt(),r=[];return X(t,628),X(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),X(t,632,a4(s.a)))})}),X(t,631),X(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:ht(n[0]),e:ht(n[0])};X(t,635,s4([i,s])),s.t&&s.t.length>0&&X(t,637,cE(s)),X(t,636),delete s.iauthor})}),X(t,634),X(t,629),t.end()}function o4(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Le.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var tg=["xlsb","xlsm","xlam","biff8","xla"],c4=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,i,a){var l=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,f=a.length>0?parseInt(a,10)|0:0;return l?f+=t.c:--f,o?c+=t.r:--c,s+(l?"":"$")+bt(f)+(o?"":"$")+St(c)}return function(s,i){return t=i,s.replace(e,r)}}(),Ef=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Tf=function(){return function(t,r){return t.replace(Ef,function(n,s,i,a,l,o){var c=gf(a)-(i?0:r.c),f=xf(o)-(l?0:r.r),d=f==0?"":l?f+1:"["+f+"]",h=c==0?"":i?c+1:"["+c+"]";return s+"R"+d+"C"+h})}}();function u4(e,t){return e.replace(Ef,function(r,n,s,i,a,l){return n+(s=="$"?s+i:bt(gf(i)+t.c))+(a=="$"?a+l:St(xf(l)+t.r))})}function f4(e){return e.length!=1}function rt(e){e.l+=1}function In(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function rg(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ng(e);r.biff==12&&(n=4)}var s=e.read_shift(n),i=e.read_shift(n),a=In(e),l=In(e);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function ng(e){var t=In(e),r=In(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function d4(e,t,r){if(r.biff<8)return ng(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=In(e),a=In(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function sg(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return h4(e);var n=e.read_shift(r&&r.biff==12?4:2),s=In(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function h4(e){var t=In(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function p4(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function m4(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return x4(e);var s=e.read_shift(n>=12?4:2),i=e.read_shift(2),a=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:l}}function x4(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function g4(e,t,r){var n=(e[e.l++]&96)>>5,s=rg(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function v4(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var a=rg(e,i,r);return[n,s,a]}function y4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _4(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,s]}function w4(e,t,r){var n=(e[e.l++]&96)>>5,s=d4(e,t-1,r);return[n,s]}function S4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function qh(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function E4(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function T4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function k4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function N4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function A4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function ig(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function C4(e){return e.read_shift(2),ig(e)}function b4(e){return e.read_shift(2),ig(e)}function O4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=sg(e,0,r);return[n,s]}function F4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=m4(e,0,r);return[n,s]}function j4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=sg(e,0,r);return[n,s,i]}function P4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Pk[s],og[s],n]}function R4(e,t,r){var n=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:I4(e);return[s,(i[0]===0?og:jk)[i[1]]]}function I4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function D4(e,t,r){e.l+=r&&r.biff==2?3:4}function L4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function M4(e){return e.l++,Xa[e.read_shift(1)]}function B4(e){return e.l++,e.read_shift(2)}function U4(e){return e.l++,e.read_shift(1)!==0}function $4(e){return e.l++,Si(e)}function W4(e,t,r){return e.l++,$x(e,t-1,r)}function z4(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jE(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Xa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Si(e);break;case 2:r[1]=DE(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function H4(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?_s:BE)(e));return s}function V4(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var l=0;l!=s;++l)a[i][l]=z4(e,r.biff);return a}function K4(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function G4(e,t,r){if(r.biff==5)return X4(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[n,s,i]}function X4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function q4(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Y4(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function J4(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Q4(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,s]}var Z4=$r,ek=$r,tk=$r;function qa(e,t,r){return e.l+=2,[p4(e)]}function kf(e){return e.l+=6,[]}var rk=qa,nk=kf,sk=kf,ik=qa;function ag(e){return e.l+=2,[Bx(e),e.read_shift(2)&1]}var ak=qa,lk=ag,ok=kf,ck=qa,uk=qa,fk=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function dk(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),a=fk[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:s,C:i}}function hk(e){return e.l+=2,[e.read_shift(4)]}function pk(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function mk(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function xk(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gk(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vk(e){return e.l+=4,[0,0]}var Yh={1:{n:"PtgExp",f:L4},2:{n:"PtgTbl",f:tk},3:{n:"PtgAdd",f:rt},4:{n:"PtgSub",f:rt},5:{n:"PtgMul",f:rt},6:{n:"PtgDiv",f:rt},7:{n:"PtgPower",f:rt},8:{n:"PtgConcat",f:rt},9:{n:"PtgLt",f:rt},10:{n:"PtgLe",f:rt},11:{n:"PtgEq",f:rt},12:{n:"PtgGe",f:rt},13:{n:"PtgGt",f:rt},14:{n:"PtgNe",f:rt},15:{n:"PtgIsect",f:rt},16:{n:"PtgUnion",f:rt},17:{n:"PtgRange",f:rt},18:{n:"PtgUplus",f:rt},19:{n:"PtgUminus",f:rt},20:{n:"PtgPercent",f:rt},21:{n:"PtgParen",f:rt},22:{n:"PtgMissArg",f:rt},23:{n:"PtgStr",f:W4},26:{n:"PtgSheet",f:pk},27:{n:"PtgEndSheet",f:mk},28:{n:"PtgErr",f:M4},29:{n:"PtgBool",f:U4},30:{n:"PtgInt",f:B4},31:{n:"PtgNum",f:$4},32:{n:"PtgArray",f:S4},33:{n:"PtgFunc",f:P4},34:{n:"PtgFuncVar",f:R4},35:{n:"PtgName",f:K4},36:{n:"PtgRef",f:O4},37:{n:"PtgArea",f:g4},38:{n:"PtgMemArea",f:q4},39:{n:"PtgMemErr",f:Z4},40:{n:"PtgMemNoMem",f:ek},41:{n:"PtgMemFunc",f:Y4},42:{n:"PtgRefErr",f:J4},43:{n:"PtgAreaErr",f:y4},44:{n:"PtgRefN",f:F4},45:{n:"PtgAreaN",f:w4},46:{n:"PtgMemAreaN",f:xk},47:{n:"PtgMemNoMemN",f:gk},57:{n:"PtgNameX",f:G4},58:{n:"PtgRef3d",f:j4},59:{n:"PtgArea3d",f:v4},60:{n:"PtgRefErr3d",f:Q4},61:{n:"PtgAreaErr3d",f:_4},255:{}},yk={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_k={1:{n:"PtgElfLel",f:ag},2:{n:"PtgElfRw",f:ck},3:{n:"PtgElfCol",f:rk},6:{n:"PtgElfRwV",f:uk},7:{n:"PtgElfColV",f:ik},10:{n:"PtgElfRadical",f:ak},11:{n:"PtgElfRadicalS",f:ok},13:{n:"PtgElfColS",f:nk},15:{n:"PtgElfColSV",f:sk},16:{n:"PtgElfRadicalLel",f:lk},25:{n:"PtgList",f:dk},29:{n:"PtgSxName",f:hk},255:{}},wk={0:{n:"PtgAttrNoop",f:vk},1:{n:"PtgAttrSemi",f:A4},2:{n:"PtgAttrIf",f:k4},4:{n:"PtgAttrChoose",f:E4},8:{n:"PtgAttrGoto",f:T4},16:{n:"PtgAttrSum",f:D4},32:{n:"PtgAttrBaxcel",f:qh},33:{n:"PtgAttrBaxcel",f:qh},64:{n:"PtgAttrSpace",f:C4},65:{n:"PtgAttrSpaceSemi",f:b4},128:{n:"PtgAttrIfError",f:N4},255:{}};function Sk(e,t,r,n){if(n.biff<8)return $r(e,t);for(var s=e.l+t,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=V4(e,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=H4(e,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=s-e.l,t!==0&&i.push($r(e,t)),i}function Ek(e,t,r){for(var n=e.l+t,s,i,a=[];n!=e.l;)t=n-e.l,i=e[e.l],s=Yh[i]||Yh[yk[i]],(i===24||i===25)&&(s=(i===24?_k:wk)[e[e.l+1]]),!s||!s.f?$r(e,t):a.push([s.n,s.f(e,t,r)]);return a}function Tk(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var kk={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Nk(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function lg(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Jh(e,t,r){var n=lg(e,t,r);return n=="#REF"?n:Nk(n,r)}function di(e,t,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},l=[],o,c,f,d=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,_="",v=0,y=e[0].length;v<y;++v){var g=e[0][v];switch(g[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=l.pop(),c=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:_=Qe(" ",e[0][p][1][1]);break;case 1:_=Qe("\r",e[0][p][1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+_,p=-1}l.push(c+kk[g[0]]+o);break;case"PtgIsect":o=l.pop(),c=l.pop(),l.push(c+" "+o);break;case"PtgUnion":o=l.pop(),c=l.pop(),l.push(c+","+o);break;case"PtgRange":o=l.pop(),c=l.pop(),l.push(c+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=na(g[1][1],a,s),l.push(sa(f,i));break;case"PtgRefN":f=r?na(g[1][1],r,s):g[1][1],l.push(sa(f,i));break;case"PtgRef3d":d=g[1][1],f=na(g[1][2],a,s),x=Jh(n,d,s),l.push(x+"!"+sa(f,i));break;case"PtgFunc":case"PtgFuncVar":var S=g[1][0],j=g[1][1];S||(S=0),S&=127;var N=S==0?[]:l.slice(-S);l.length-=S,j==="User"&&(j=N.shift()),l.push(j+"("+N.join(",")+")");break;case"PtgBool":l.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(g[1]);break;case"PtgNum":l.push(String(g[1]));break;case"PtgStr":l.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(g[1]);break;case"PtgAreaN":m=Ih(g[1][1],r?{s:r}:a,s),l.push(Vc(m,s));break;case"PtgArea":m=Ih(g[1][1],a,s),l.push(Vc(m,s));break;case"PtgArea3d":d=g[1][1],m=g[1][2],x=Jh(n,d,s),l.push(x+"!"+Vc(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],F=k?k.Name:"SH33TJSNAME"+String(h);F&&F.slice(0,6)=="_xlfn."&&!s.xlfn&&(F=F.slice(6)),l.push(F);break;case"PtgNameX":var L=g[1][1];h=g[1][2];var B;if(s.biff<=5)L<0&&(L=-L),n[L]&&(B=n[L][h]);else{var G="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][h]&&n[L][h].itab>0&&(G=n.SheetNames[n[L][h].itab-1]+"!"):G=n.SheetNames[h-1]+"!"),n[L]&&n[L][h])G+=n[L][h].Name;else if(n[0]&&n[0][h])G+=n[0][h].Name;else{var q=(lg(n,L,s)||"").split(";;");q[h-1]?G=q[h-1]:G+="SH33TJSERRX"}l.push(G);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var se="(",de=")";if(p>=0){switch(_="",e[0][p][1][0]){case 2:se=Qe(" ",e[0][p][1][1])+se;break;case 3:se=Qe("\r",e[0][p][1][1])+se;break;case 4:de=Qe(" ",e[0][p][1][1])+de;break;case 5:de=Qe("\r",e[0][p][1][1])+de;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(se+l.pop()+de);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":f={c:g[1][1],r:g[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[De(f)]){var J=n.sharedf[De(f)];l.push(di(J,a,ve,n,s))}else{var ye=!1;for(o=0;o!=n.arrayf.length;++o)if(c=n.arrayf[o],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){l.push(di(c[1],a,ve,n,s)),ye=!0;break}ye||l.push(g[1])}break;case"PtgArray":l.push("{"+Tk(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var Y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&Y.indexOf(e[0][v][0])==-1){g=e[0][p];var le=!0;switch(g[1][0]){case 4:le=!1;case 0:_=Qe(" ",g[1][1]);break;case 5:le=!1;case 1:_=Qe("\r",g[1][1]);break;default:if(_="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}l.push((le?_:"")+l.pop()+(le?"":_)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function Ak(e){if(e==null){var t=H(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return fs(e);return fs(0)}function Ck(e,t,r,n,s){var i=ds(t,r,s),a=Ak(e.v),l=H(6),o=33;l.write_shift(2,o),l.write_shift(4,0);for(var c=H(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var d=yt([i,a,l,c]);return d}function ec(e,t,r){var n=e.read_shift(4),s=Ek(e,n,r),i=e.read_shift(4),a=i>0?Sk(e,i,s,r):null;return[s,a]}var bk=ec,tc=ec,Ok=ec,Fk=ec,jk={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},og={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Pk={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Rk(e){var t="of:="+e.replace(Ef,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ik(e){return e.replace(/\./,"!")}var ia=typeof Map<"u";function Nf(e,t,r){var n=0,s=e.length;if(r){if(ia?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=ia?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ia?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function rc(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(en=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Eo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=i0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function cg(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $n(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){sx(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===n)return s;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Dk(e,t,r){if(e&&e["!ref"]){var n=We(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Lk(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+st(e[r])+'"/>';return t+"</mergeCells>"}function Mk(e,t,r,n,s){var i=!1,a={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}i=!0,a.codeName=ba(Re(o))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),l=(l||"")+re("outlinePr",null,c)}!i&&!l||(s[s.length]=re("sheetPr",l,a))}var Bk=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Uk=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $k(e){var t={sheet:1};return Bk.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Uk.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Kx(e.password).toString(16).toUpperCase()),re("sheetProtection",null,t)}function Wk(e){return cg(e),re("pageMargins",null,e)}function zk(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=re("col",null,rc(s,n)));return r[r.length]="</cols>",r.join("")}function Hk(e,t,r,n){var s=typeof e.ref=="string"?e.ref:st(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=nr(s);a.s.r==a.e.r&&(a.e.r=nr(t["!ref"]).e.r,s=st(a));for(var l=0;l<i.length;++l){var o=i[l];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==n){o.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),re("autoFilter",null,{ref:s})}function Vk(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),re("sheetViews",re("sheetView",null,s),{})}function Kk(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Xa[e.v];break;case"d":n&&n.cellDates?s=Lt(e.v,-1).toISOString():(e=Xt(e),e.t="n",s=""+(e.v=Gt(Lt(e.v)))),typeof e.z>"u"&&(e.z=Ze[14]);break;default:s=e.v;break}var l=_t("v",Re(s)),o={r:t},c=$n(n.cellXfs,e,n);switch(c!==0&&(o.s=c),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=_t("v",""+Nf(n.Strings,e.v,n.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=i&&(e.t=i,e.v=a),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=re("f",Re(e.f),f)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),re("c",l,o)}function Gk(e,t,r,n){var s=[],i=[],a=We(e["!ref"]),l="",o,c="",f=[],d=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:c},_,v=-1;for(h=a.s.c;h<=a.e.c;++h)f[h]=bt(h);for(d=a.s.r;d<=a.e.r;++d){for(i=[],c=St(d),h=a.s.c;h<=a.e.c;++h){o=f[h]+c;var y=x?(e[d]||[])[h]:e[o];y!==void 0&&(l=Kk(y,o,e,t))!=null&&i.push(l)}(i.length>0||m&&m[d])&&(p={r:c},m&&m[d]&&(_=m[d],_.hidden&&(p.hidden=1),v=-1,_.hpx?v=To(_.hpx):_.hpt&&(v=_.hpt),v>-1&&(p.ht=v,p.customHeight=1),_.level&&(p.outlineLevel=_.level)),s[s.length]=re("row",i.join(""),p))}if(m)for(;d<m.length;++d)m&&m[d]&&(p={r:d+1},_=m[d],_.hidden&&(p.hidden=1),v=-1,_.hpx?v=To(_.hpx):_.hpt&&(v=_.hpt),v>-1&&(p.ht=v,p.customHeight=1),_.level&&(p.outlineLevel=_.level),s[s.length]=re("row","",p));return s.join("")}function ug(e,t,r,n){var s=[it,re("worksheet",null,{xmlns:yi[0],"xmlns:r":dt.r})],i=r.SheetNames[e],a=0,l="",o=r.Sheets[i];o==null&&(o={});var c=o["!ref"]||"A1",f=We(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=st(f)}n||(n={}),o["!comments"]=[];var d=[];Mk(o,r,e,t,s),s[s.length]=re("dimension",null,{ref:c}),s[s.length]=Vk(o,t,e,r),t.sheetFormat&&(s[s.length]=re("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(s[s.length]=zk(o,o["!cols"])),s[a=s.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(l=Gk(o,t),l.length>0&&(s[s.length]=l)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),o["!protect"]&&(s[s.length]=$k(o["!protect"])),o["!autofilter"]!=null&&(s[s.length]=Hk(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(s[s.length]=Lk(o["!merges"]));var h=-1,m,x=-1;return o["!links"].length>0&&(s[s.length]="<hyperlinks>",o["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=Pe(n,-1,Re(p[1].Target).replace(/#.*$/,""),Oe.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=Re(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=Re(p[1].Tooltip)),s[s.length]=re("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(s[s.length]=Wk(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=_t("ignoredErrors",re("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(x=Pe(n,-1,"../drawings/drawing"+(e+1)+".xml",Oe.DRAW),s[s.length]=re("drawing",null,{"r:id":"rId"+x}),o["!drawing"]=d),o["!comments"].length>0&&(x=Pe(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Oe.VML),s[s.length]=re("legacyDrawing",null,{"r:id":"rId"+x}),o["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Xk(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function qk(e,t,r){var n=H(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;s.hpx?i=To(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var l=0,o=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,m=f<<10;m<f+1<<10;++m){c.c=m;var x=Array.isArray(r)?(r[c.r]||[])[c.c]:r[De(c)];x&&(d<0&&(d=m),h=m)}d<0||(++l,n.write_shift(4,d),n.write_shift(4,h))}var p=n.l;return n.l=o,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}function Yk(e,t,r,n){var s=qk(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&X(e,0,s)}var Jk=_s,Qk=wi;function Zk(){}function e3(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=uE(e),r}function t3(e,t,r){r==null&&(r=H(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return _o({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kx(e,r),r.slice(0,r.l)}function r3(e){var t=xr(e);return[t]}function n3(e,t,r){return r==null&&(r=H(8)),gs(t,r)}function s3(e){var t=vs(e);return[t]}function i3(e,t,r){return r==null&&(r=H(4)),ys(t,r)}function a3(e){var t=xr(e),r=e.read_shift(1);return[t,r,"b"]}function l3(e,t,r){return r==null&&(r=H(9)),gs(t,r),r.write_shift(1,e.v?1:0),r}function o3(e){var t=vs(e),r=e.read_shift(1);return[t,r,"b"]}function c3(e,t,r){return r==null&&(r=H(5)),ys(t,r),r.write_shift(1,e.v?1:0),r}function u3(e){var t=xr(e),r=e.read_shift(1);return[t,r,"e"]}function f3(e,t,r){return r==null&&(r=H(9)),gs(t,r),r.write_shift(1,e.v),r}function d3(e){var t=vs(e),r=e.read_shift(1);return[t,r,"e"]}function h3(e,t,r){return r==null&&(r=H(8)),ys(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function p3(e){var t=xr(e),r=e.read_shift(4);return[t,r,"s"]}function m3(e,t,r){return r==null&&(r=H(12)),gs(t,r),r.write_shift(4,t.v),r}function x3(e){var t=vs(e),r=e.read_shift(4);return[t,r,"s"]}function g3(e,t,r){return r==null&&(r=H(8)),ys(t,r),r.write_shift(4,t.v),r}function v3(e){var t=xr(e),r=Si(e);return[t,r,"n"]}function y3(e,t,r){return r==null&&(r=H(16)),gs(t,r),fs(e.v,r),r}function _3(e){var t=vs(e),r=Si(e);return[t,r,"n"]}function w3(e,t,r){return r==null&&(r=H(12)),ys(t,r),fs(e.v,r),r}function S3(e){var t=xr(e),r=Nx(e);return[t,r,"n"]}function E3(e,t,r){return r==null&&(r=H(12)),gs(t,r),Ax(e.v,r),r}function T3(e){var t=vs(e),r=Nx(e);return[t,r,"n"]}function k3(e,t,r){return r==null&&(r=H(8)),ys(t,r),Ax(e.v,r),r}function N3(e){var t=xr(e),r=vf(e);return[t,r,"is"]}function A3(e){var t=xr(e),r=Ot(e);return[t,r,"str"]}function C3(e,t,r){return r==null&&(r=H(12+4*e.v.length)),gs(t,r),pt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function b3(e){var t=vs(e),r=Ot(e);return[t,r,"str"]}function O3(e,t,r){return r==null&&(r=H(8+4*e.v.length)),ys(t,r),pt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function F3(e,t,r){var n=e.l+t,s=xr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=tc(e,n-e.l,r);a[3]=di(l,null,s,r.supbooks,r)}else e.l=n;return a}function j3(e,t,r){var n=e.l+t,s=xr(e);s.r=r["!row"];var i=e.read_shift(1),a=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=tc(e,n-e.l,r);a[3]=di(l,null,s,r.supbooks,r)}else e.l=n;return a}function P3(e,t,r){var n=e.l+t,s=xr(e);s.r=r["!row"];var i=Si(e),a=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=tc(e,n-e.l,r);a[3]=di(l,null,s,r.supbooks,r)}else e.l=n;return a}function R3(e,t,r){var n=e.l+t,s=xr(e);s.r=r["!row"];var i=Ot(e),a=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=tc(e,n-e.l,r);a[3]=di(l,null,s,r.supbooks,r)}else e.l=n;return a}var I3=_s,D3=wi;function L3(e,t){return t==null&&(t=H(4)),t.write_shift(4,e),t}function M3(e,t){var r=e.l+t,n=_s(e),s=yf(e),i=Ot(e),a=Ot(e),l=Ot(e);e.l=r;var o={rfx:n,relId:s,loc:i,display:l};return a&&(o.Tooltip=a),o}function B3(e,t){var r=H(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));wi({s:ht(e[0]),e:ht(e[0])},r),_f("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return pt(s||"",r),pt(e[1].Tooltip||"",r),pt("",r),r.slice(0,r.l)}function U3(){}function $3(e,t,r){var n=e.l+t,s=Cx(e),i=e.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var l=bk(e,n-e.l,r);a[1]=l}else e.l=n;return a}function W3(e,t,r){var n=e.l+t,s=_s(e),i=[s];if(r.cellFormula){var a=Fk(e,n-e.l,r);i[1]=a,e.l=n}else e.l=n;return i}function z3(e,t,r){r==null&&(r=H(18));var n=rc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var fg=["left","right","top","bottom","header","footer"];function H3(e){var t={};return fg.forEach(function(r){t[r]=Si(e)}),t}function V3(e,t){return t==null&&(t=H(6*8)),cg(e),fg.forEach(function(r){fs(e[r],t)}),t}function K3(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function G3(e,t,r){r==null&&(r=H(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function X3(e){var t=H(24);return t.write_shift(4,4),t.write_shift(4,1),wi(e,t),t}function q3(e,t){return t==null&&(t=H(16*4+2)),t.write_shift(2,e.password?Kx(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Y3(){}function J3(){}function Q3(e,t,r,n,s,i,a){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Xt(t),t.z=t.z||Ze[14],t.v=Gt(Lt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var o={r,c:n};switch(o.s=$n(s.cellXfs,t,s),t.l&&i["!links"].push([De(o),t.l]),t.c&&i["!comments"].push([De(o),t.c]),t.t){case"s":case"str":return s.bookSST?(l=Nf(s.Strings,t.v,s.revStrings),o.t="s",o.v=l,a?X(e,18,g3(t,o)):X(e,7,m3(t,o))):(o.t="str",a?X(e,17,O3(t,o)):X(e,6,C3(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?X(e,13,k3(t,o)):X(e,2,E3(t,o)):a?X(e,16,w3(t,o)):X(e,5,y3(t,o)),!0;case"b":return o.t="b",a?X(e,15,c3(t,o)):X(e,4,l3(t,o)),!0;case"e":return o.t="e",a?X(e,14,h3(t,o)):X(e,3,f3(t,o)),!0}return a?X(e,12,i3(t,o)):X(e,1,n3(t,o)),!0}function Z3(e,t,r,n){var s=We(t["!ref"]||"A1"),i,a="",l=[];X(e,145);var o=Array.isArray(t),c=s.e.r;t["!rows"]&&(c=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=c;++f){a=St(f),Yk(e,t,s,f);var d=!1;if(f<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){f===s.s.r&&(l[h]=bt(h)),i=l[h]+a;var m=o?(t[f]||[])[h]:t[i];if(!m){d=!1;continue}d=Q3(e,m,f,h,n,t,d)}}X(e,146)}function eN(e,t){!t||!t["!merges"]||(X(e,177,L3(t["!merges"].length)),t["!merges"].forEach(function(r){X(e,176,D3(r))}),X(e,178))}function tN(e,t){!t||!t["!cols"]||(X(e,390),t["!cols"].forEach(function(r,n){r&&X(e,60,z3(n,r))}),X(e,391))}function rN(e,t){!t||!t["!ref"]||(X(e,648),X(e,649,X3(We(t["!ref"]))),X(e,650))}function nN(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Pe(r,-1,n[1].Target.replace(/#.*$/,""),Oe.HLINK);X(e,494,B3(n,s))}}),delete t["!links"]}function sN(e,t,r,n){if(t["!comments"].length>0){var s=Pe(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Oe.VML);X(e,551,_f("rId"+s)),t["!legacy"]=s}}function iN(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:st(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,l=nr(i);l.s.r==l.e.r&&(l.e.r=nr(t["!ref"]).e.r,i=st(l));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),X(e,161,wi(We(i))),X(e,162)}}function aN(e,t,r){X(e,133),X(e,137,G3(t,r)),X(e,138),X(e,134)}function lN(e,t){t["!protect"]&&X(e,535,q3(t["!protect"]))}function oN(e,t,r,n){var s=Kt(),i=r.SheetNames[e],a=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var o=We(a["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],X(s,129),(r.vbaraw||a["!outline"])&&X(s,147,t3(l,a["!outline"])),X(s,148,Qk(o)),aN(s,a,r.Workbook),tN(s,a),Z3(s,a,e,t),lN(s,a),iN(s,a,r,e),eN(s,a),nN(s,a,n),a["!margins"]&&X(s,476,V3(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&rN(s,a),sN(s,a,e,n),X(s,130),s.end()}function cN(e,t){e.l+=10;var r=Ot(e);return{name:r}}var uN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function fN(e){return!e.Workbook||!e.Workbook.WBProps?"false":WS(e.Workbook.WBProps.date1904)?"true":"false"}var dN="][*?/\\".split("");function dg(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return dN.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function hN(e,t,r){e.forEach(function(n,s){dg(n);for(var i=0;i<s;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[s]&&t[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function pN(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];hN(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Dk(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function hg(e){var t=[it];t[t.length]=re("workbook",null,{xmlns:yi[0],"xmlns:r":dt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(uN.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=re("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var a={name:Re(e.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=re("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var o={name:l.Name};l.Comment&&(o.comment=l.Comment),l.Sheet!=null&&(o.localSheetId=""+l.Sheet),l.Hidden&&(o.hidden="1"),l.Ref&&(t[t.length]=re("definedName",Re(l.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function mN(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=s0(e),r.name=Ot(e),r}function xN(e,t){return t||(t=H(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),_f(e.strRelID,t),pt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function gN(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ot(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vN(e,t){t||(t=H(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kx(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function yN(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=fE(e),a=Ok(e,0,r),l=yf(e);e.l=n;var o={Name:i,Ptg:a};return s<268435455&&(o.Sheet=s),l&&(o.Comment=l),o}function _N(e,t){X(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};X(e,156,xN(s))}X(e,144)}function wN(e,t){t||(t=H(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return pt("SheetJS",t),pt(ho.version,t),pt(ho.version,t),pt("7262",t),t.length>t.l?t.slice(0,t.l):t}function SN(e,t){t||(t=H(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function EN(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(X(e,135),X(e,158,SN(s)),X(e,136))}}function TN(e,t){var r=Kt();return X(r,131),X(r,128,wN()),X(r,153,vN(e.Workbook&&e.Workbook.WBProps||null)),EN(r,e),_N(r,e),X(r,132),r.end()}function kN(e,t,r){return(t.slice(-4)===".bin"?TN:hg)(e)}function NN(e,t,r,n,s){return(t.slice(-4)===".bin"?oN:ug)(e,r,n,s)}function AN(e,t,r){return(t.slice(-4)===".bin"?VT:qx)(e,r)}function CN(e,t,r){return(t.slice(-4)===".bin"?vT:Vx)(e,r)}function bN(e,t,r){return(t.slice(-4)===".bin"?l4:eg)(e)}function ON(e){return(e.slice(-4)===".bin"?ZT:Qx)()}function FN(e,t){var r=[];return e.Props&&r.push(AE(e.Props,t)),e.Custprops&&r.push(CE(e.Props,e.Custprops)),r.join("")}function jN(){return""}function PN(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var i=[];i.push(re("NumberFormat",null,{"ss:Format":Re(Ze[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(re("Style",i.join(""),a))}),re("Styles",r.join(""))}function pg(e){return re("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Tf(e.Ref,{r:0,c:0})})}function RN(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(pg(s)))}return re("Names",r.join(""))}function IN(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var l=s[a];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(pg(l)))}return i.join("")}function DN(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(re("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(re("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(re("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(re("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(_t("ProtectContents","True")),e["!protect"].objects&&s.push(_t("ProtectObjects","True")),e["!protect"].scenarios&&s.push(_t("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(_t("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(_t("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":re("WorksheetOptions",s.join(""),{xmlns:Qt.x})}function LN(e){return e.map(function(t){var r=$S(t.t||""),n=re("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return re("Comment",n,{"ss:Author":t.a})}).join("")}function MN(e,t,r,n,s,i,a){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Re(Tf(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var o=ht(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(o.r==a.r?"":"["+(o.r-a.r)+"]")+"C"+(o.c==a.c?"":"["+(o.c-a.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Re(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Re(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=a.c||c[f].s.r!=a.r||(c[f].e.c>c[f].s.c&&(l["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(l["ss:MergeDown"]=c[f].e.r-c[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Xa[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ze[14]);break;case"s":d="String",h=US(e.v||"");break}var m=$n(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=a.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+d+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=LN(e.c)),re("Cell",p,l)}function BN(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xx(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function UN(e,t,r,n){if(!e["!ref"])return"";var s=We(e["!ref"]),i=e["!merges"]||[],a=0,l=[];e["!cols"]&&e["!cols"].forEach(function(_,v){Sf(_);var y=!!_.width,g=rc(v,_),S={"ss:Index":v+1};y&&(S["ss:Width"]=So(g.width)),_.hidden&&(S["ss:Hidden"]="1"),l.push(re("Column",null,S))});for(var o=Array.isArray(e),c=s.s.r;c<=s.e.r;++c){for(var f=[BN(c,(e["!rows"]||[])[c])],d=s.s.c;d<=s.e.c;++d){var h=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>d)&&!(i[a].s.r>c)&&!(i[a].e.c<d)&&!(i[a].e.r<c)){(i[a].s.c!=d||i[a].s.r!=c)&&(h=!0);break}if(!h){var m={r:c,c:d},x=De(m),p=o?(e[c]||[])[d]:e[x];f.push(MN(p,x,e,t,r,n,m))}}f.push("</Row>"),f.length>2&&l.push(f.join(""))}return l.join("")}function $N(e,t,r){var n=[],s=r.SheetNames[e],i=r.Sheets[s],a=i?IN(i,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?UN(i,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(DN(i,t,e,r)),n.join("")}function WN(e,t){t||(t={}),e.SSF||(e.SSF=Xt(Ze)),e.SSF&&(Jo(),Yo(e.SSF),t.revssf=Qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$n(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(FN(e,t)),r.push(jN()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(re("Worksheet",$N(n,t,e),{"ss:Name":Re(e.SheetNames[n])}));return r[2]=PN(e,t),r[3]=RN(e),it+re("Workbook",r.join(""),{xmlns:Qt.ss,"xmlns:o":Qt.o,"xmlns:x":Qt.x,"xmlns:ss":Qt.ss,"xmlns:dt":Qt.dt,"xmlns:html":Qt.html})}var Xc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zN(e,t){var r=[],n=[],s=[],i=0,a,l=Th(Lh,"n"),o=Th(Mh,"n");if(e.Props)for(a=Tt(e.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(l,a[i])?r:Object.prototype.hasOwnProperty.call(o,a[i])?n:s).push([a[i],e.Props[a[i]]]);if(e.Custprops)for(a=Tt(e.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(l,a[i])?r:Object.prototype.hasOwnProperty.call(o,a[i])?n:s).push([a[i],e.Custprops[a[i]]]);var c=[];for(i=0;i<s.length;++i)Mx.indexOf(s[i][0])>-1||Ix.indexOf(s[i][0])>-1||s[i][1]!=null&&c.push(s[i]);n.length&&Le.utils.cfb_add(t,"/SummaryInformation",zh(n,Xc.SI,o,Mh)),(r.length||c.length)&&Le.utils.cfb_add(t,"/DocumentSummaryInformation",zh(r,Xc.DSI,l,Lh,c.length?c:null,Xc.UDI))}function HN(e,t){var r=t||{},n=Le.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Le.utils.cfb_add(n,s,mg(e,r)),r.biff==8&&(e.Props||e.Custprops)&&zN(e,n),r.biff==8&&e.vbaraw&&o4(n,Le.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var VN={0:{f:Xk},1:{f:r3},2:{f:S3},3:{f:u3},4:{f:a3},5:{f:v3},6:{f:A3},7:{f:p3},8:{f:R3},9:{f:P3},10:{f:F3},11:{f:j3},12:{f:s3},13:{f:T3},14:{f:d3},15:{f:o3},16:{f:_3},17:{f:b3},18:{f:x3},19:{f:vf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yN},40:{},42:{},43:{f:AT},44:{f:kT},45:{f:OT},46:{f:jT},47:{f:FT},48:{},49:{f:sE},50:{},51:{f:XT},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iT},62:{f:N3},63:{f:e4},64:{f:Y3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:e3},148:{f:Jk,p:16},151:{f:U3},152:{},153:{f:gN},154:{},155:{},156:{f:mN},157:{},158:{},159:{T:1,f:mT},160:{T:-1},161:{T:1,f:_s},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:I3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:KT},336:{T:-1},337:{f:JT,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:s0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ZE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$3},427:{f:W3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:H3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Zk},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:M3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:s0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:i4},633:{T:1},634:{T:-1},635:{T:1,f:n4},636:{T:-1},637:{f:oE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:cN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:J3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ne(e,t,r,n){var s=t;if(!isNaN(s)){var i=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&mf(r)&&e.push(r)}}function KN(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return ne(e,t,r,s);var i=t;if(!isNaN(i)){for(var a=r.parts||[],l=0,o=0,c=0;c+(a[l]||8224)<=8224;)c+=a[l]||8224,l++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c;o<s;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(a[l]||8224)<=8224;)c+=a[l]||8224,l++;f.write_shift(2,c),e.push(r.slice(o,o+c)),o+=c}}}function Ya(e,t,r){return e||(e=H(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function GN(e,t,r,n){var s=H(9);return Ya(s,e,t),Ux(r,n||"b",s),s}function XN(e,t,r){var n=H(8+2*r.length);return Ya(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function qN(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Gt(Lt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?ne(e,2,cT(r,n,s)):ne(e,3,oT(r,n,s));return;case"b":case"e":ne(e,5,GN(r,n,t.v,t.t));return;case"s":case"str":ne(e,4,XN(r,n,(t.v||"").slice(0,255)));return}ne(e,1,Ya(null,r,n))}function YN(e,t,r,n){var s=Array.isArray(t),i=We(t["!ref"]||"A1"),a,l="",o=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=st(i)}for(var c=i.s.r;c<=i.e.r;++c){l=St(c);for(var f=i.s.c;f<=i.e.c;++f){c===i.s.r&&(o[f]=bt(f)),a=o[f]+l;var d=s?(t[c]||[])[f]:t[a];d&&qN(e,d,c,f)}}}function JN(e,t){for(var r=t||{},n=Kt(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ne(n,r.biff==4?1033:r.biff==3?521:9,wf(e,16,r)),YN(n,e.Sheets[e.SheetNames[s]],s,r),ne(n,10),n.end()}function QN(e,t,r){ne(e,49,VE({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function ZN(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ne(e,1054,XE(s,t[s],r))})}function eA(e,t){var r=H(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ne(e,2151,r),r=H(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),zx(We(t["!ref"]||"A1"),r),r.write_shift(4,4),ne(e,2152,r)}function tA(e,t){for(var r=0;r<16;++r)ne(e,224,Vh({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ne(e,224,Vh(n,0,t))})}function rA(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ne(e,440,rT(n)),n[1].Tooltip&&ne(e,2048,nT(n))}delete t["!links"]}function nA(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&ne(e,125,aT(rc(s,n),s))})}}function sA(e,t,r,n,s){var i=16+$n(s.cellXfs,t,s);if(t.v==null&&!t.bf){ne(e,513,ds(r,n,i));return}if(t.bf)ne(e,6,Ck(t,r,n,s,i));else switch(t.t){case"d":case"n":var a=t.t=="d"?Gt(Lt(t.v)):t.v;ne(e,515,QE(r,n,a,i));break;case"b":case"e":ne(e,517,JE(r,n,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=Nf(s.Strings,t.v,s.revStrings);ne(e,253,KE(r,n,l,i))}else ne(e,516,GE(r,n,(t.v||"").slice(0,255),i,s));break;default:ne(e,513,ds(r,n,i))}}function iA(e,t,r){var n=Kt(),s=r.SheetNames[e],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},l=(a.Sheets||[])[e]||{},o=Array.isArray(i),c=t.biff==8,f,d="",h=[],m=We(i["!ref"]||"A1"),x=c?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}ne(n,2057,wf(r,16,t)),ne(n,13,or(1)),ne(n,12,or(100)),ne(n,15,It(!0)),ne(n,17,It(!1)),ne(n,16,fs(.001)),ne(n,95,It(!0)),ne(n,42,It(!1)),ne(n,43,It(!1)),ne(n,130,or(1)),ne(n,128,YE()),ne(n,131,It(!1)),ne(n,132,It(!1)),c&&nA(n,i["!cols"]),ne(n,512,qE(m,t)),c&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){d=St(p);for(var _=m.s.c;_<=m.e.c;++_){p===m.s.r&&(h[_]=bt(_)),f=h[_]+d;var v=o?(i[p]||[])[_]:i[f];v&&(sA(n,v,p,_,t),c&&v.l&&i["!links"].push([f,v.l]))}}var y=l.CodeName||l.name||s;return c&&ne(n,574,HE((a.Views||[])[0])),c&&(i["!merges"]||[]).length&&ne(n,229,tT(i["!merges"])),c&&rA(n,i),ne(n,442,Wx(y)),c&&eA(n,i),ne(n,10),n.end()}function aA(e,t,r){var n=Kt(),s=(e||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},l=r.biff==8,o=r.biff==5;if(ne(n,2057,wf(e,5,r)),r.bookType=="xla"&&ne(n,135),ne(n,225,l?or(1200):null),ne(n,193,FE(2)),o&&ne(n,191),o&&ne(n,192),ne(n,226),ne(n,92,UE("SheetJS",r)),ne(n,66,or(l?1200:1252)),l&&ne(n,353,or(0)),l&&ne(n,448),ne(n,317,lT(e.SheetNames.length)),l&&e.vbaraw&&ne(n,211),l&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";ne(n,442,Wx(c))}ne(n,156,or(17)),ne(n,25,It(!1)),ne(n,18,It(!1)),ne(n,19,or(0)),l&&ne(n,431,It(!1)),l&&ne(n,444,or(0)),ne(n,61,zE()),ne(n,64,It(!1)),ne(n,141,or(0)),ne(n,34,It(fN(e)=="true")),ne(n,14,It(!0)),l&&ne(n,439,It(!1)),ne(n,218,or(0)),QN(n,e,r),ZN(n,e.SSF,r),tA(n,r),l&&ne(n,352,It(!1));var f=n.end(),d=Kt();l&&ne(d,140,sT()),l&&r.Strings&&KN(d,252,WE(r.Strings)),ne(d,10);var h=d.end(),m=Kt(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var _=f.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var v=i[p]||{};ne(m,133,$E({pos:_,hs:v.Hidden||0,dt:0,name:e.SheetNames[p]},r)),_+=t[p].length}var y=m.end();if(x!=y.length)throw new Error("BS8 "+x+" != "+y.length);var g=[];return f.length&&g.push(f),y.length&&g.push(y),h.length&&g.push(h),yt(g)}function lA(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(Jo(),Yo(e.SSF),r.revssf=Qo(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Af(r),r.cellXfs=[],$n(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=iA(s,r,e);return n.unshift(aA(e,n,r)),yt(n)}function mg(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=nr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return lA(e,t);case 4:case 3:case 2:return JN(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function oA(e,t,r,n){for(var s=e["!merges"]||[],i=[],a=t.s.c;a<=t.e.c;++a){for(var l=0,o=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){l=-1;break}l=s[c].e.r-s[c].s.r+1,o=s[c].e.c-s[c].s.c+1;break}if(!(l<0)){var f=De({r,c:a}),d=n.dense?(e[r]||[])[a]:e[f],h=d&&d.v!=null&&(d.h||BS(d.w||(ln(d),d.w)||""))||"",m={};l>1&&(m.rowspan=l),o>1&&(m.colspan=o),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(m["data-t"]=d&&d.t||"z",d.v!=null&&(m["data-v"]=d.v),d.z!=null&&(m["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+f,i.push(re("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var cA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',uA="</body></html>";function fA(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xg(e,t){var r=t||{},n=r.header!=null?r.header:cA,s=r.footer!=null?r.footer:uA,i=[n],a=nr(e["!ref"]);r.dense=Array.isArray(e),i.push(fA(e,a,r));for(var l=a.s.r;l<=a.e.r;++l)i.push(oA(e,a,l,r));return i.push("</table>"+s),i.join("")}function gg(e,t,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?ht(n.origin):n.origin;s=a.r,i=a.c}var l=t.getElementsByTagName("tr"),o=Math.min(n.sheetRows||1e7,l.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var f=nr(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),s==-1&&(c.e.r=s=f.e.r+1)}var d=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,_=0,v=0,y=0,g=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<o;++x){var S=l[x];if(Qh(S)){if(n.display)continue;m[p]={hidden:!0}}var j=S.children;for(_=v=0;_<j.length;++_){var N=j[_];if(!(n.display&&Qh(N))){var k=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):zS(N.innerHTML),F=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<d.length;++h){var L=d[h];L.s.c==v+i&&L.s.r<p+s&&p+s<=L.e.r&&(v=L.e.c+1-i,h=-1)}g=+N.getAttribute("colspan")||1,((y=+N.getAttribute("rowspan")||1)>1||g>1)&&d.push({s:{r:p+s,c:v+i},e:{r:p+s+(y||1)-1,c:v+i+(g||1)-1}});var B={t:"s",v:k},G=N.getAttribute("data-t")||N.getAttribute("t")||"";k!=null&&(k.length==0?B.t=G||"z":n.raw||k.trim().length==0||G=="s"||(k==="TRUE"?B={t:"b",v:!0}:k==="FALSE"?B={t:"b",v:!1}:isNaN(Zr(k))?isNaN(Ca(k).getDate())||(B={t:"d",v:Lt(k)},n.cellDates||(B={t:"n",v:Gt(B.v)}),B.z=n.dateNF||Ze[14]):B={t:"n",v:Zr(k)})),B.z===void 0&&F!=null&&(B.z=F);var q="",se=N.getElementsByTagName("A");if(se&&se.length)for(var de=0;de<se.length&&!(se[de].hasAttribute("href")&&(q=se[de].getAttribute("href"),q.charAt(0)!="#"));++de);q&&q.charAt(0)!="#"&&(B.l={Target:q}),n.dense?(e[p+s]||(e[p+s]=[]),e[p+s][v+i]=B):e[De({c:v+i,r:p+s})]=B,c.e.c<v+i&&(c.e.c=v+i),v+=g}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,p-1+s),e["!ref"]=st(c),p>=o&&(e["!fullref"]=st((c.e.r=l.length-x+p-1+s,c))),e}function vg(e,t){var r=t||{},n=r.dense?[]:{};return gg(n,e,t)}function dA(e,t){return xs(vg(e,t),t)}function Qh(e){var t="",r=hA(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function hA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var pA=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Oa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return it+t}}(),Zh=function(){var e=function(i){return Re(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,l){var o=[];o.push('      <table:table table:name="'+Re(a.SheetNames[l])+`" table:style-name="ta1">
`);var c=0,f=0,d=nr(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)o.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",_=i["!rows"]||[];for(c=0;c<d.s.r;++c)p=_[c]?' table:style-name="ro'+_[c].ods+'"':"",o.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=d.e.r;++c){for(p=_[c]?' table:style-name="ro'+_[c].ods+'"':"",o.push("        <table:table-row"+p+`>
`),f=0;f<d.s.c;++f)o.push(t);for(;f<=d.e.c;++f){var v=!1,y={},g="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>f)&&!(h[m].s.r>c)&&!(h[m].e.c<f)&&!(h[m].e.r<c)){(h[m].s.c!=f||h[m].s.r!=c)&&(v=!0),y["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,y["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(v){o.push(r);continue}var S=De({r:c,c:f}),j=x?(i[c]||[])[f]:i[S];if(j&&j.f&&(y["table:formula"]=Re(Rk(j.f)),j.F&&j.F.slice(0,S.length)==S)){var N=nr(j.F);y["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,y["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!j){o.push(t);continue}switch(j.t){case"b":g=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":g=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":g=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":g=j.w||Lt(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Lt(j.v).toISOString(),y["table:style-name"]="ce1";break;default:o.push(t);continue}var k=e(g);if(j.l&&j.l.Target){var F=j.l.Target;F=F.charAt(0)=="#"?"#"+Ik(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),k=re("text:a",k,{"xlink:href":F.replace(/&/g,"&amp;")})}o.push("          "+re("table:table-cell",re("text:p",k,{}),y)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var d=c["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Sf(d),d.ods=l;var h=c["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=o;var d=c["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,l){var o=[it],c=Oa({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Oa({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(o.push("<office:document"+c+f+`>
`),o.push(Px().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+c+`>
`),s(o,a),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)o.push(n(a.Sheets[a.SheetNames[d]],a,d));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),l.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function yg(e,t){if(t.bookType=="fods")return Zh(e,t);var r=ff(),n="",s=[],i=[];return n="mimetype",Se(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Se(r,n,Zh(e,t)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Se(r,n,pA(e,t)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Se(r,n,it+Px()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Se(r,n,NE(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Se(r,n,TE(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ko(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function mA(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):kr(ba(e))}function xA(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Dn(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function gA(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Fa(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function je(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ni(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function lt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Fa(e,r),i=s&7;s=Math.floor(s/8);var a=0,l;if(s==0)break;switch(i){case 0:{for(var o=r[0];e[r[0]++]>=128;);l=e.slice(o,r[0])}break;case 5:a=4,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Fa(e,r),l=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:l,type:i};t[s]==null?t[s]=[c]:t[s].push(c)}return t}function xt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(je(n*8+s.type)),s.type==2&&t.push(je(s.data.length)),t.push(s.data))})}),Dn(t)}function vr(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Fa(e,n),i=lt(e.slice(n[0],n[0]+s));n[0]+=s;var a={id:ni(i[1][0].data),messages:[]};i[2].forEach(function(l){var o=lt(l.data),c=ni(o[3][0].data);a.messages.push({meta:o,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(a.merge=ni(i[3][0].data)>>>0>0),r.push(a)}return r}function bs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:je(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:je(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:je(a.data.length)}],n[2].push({data:xt(a.meta),type:2})});var i=xt(n);t.push(je(i.length)),t.push(i),s.forEach(function(a){return t.push(a)})}),Dn(t)}function vA(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Fa(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var l=a-59;a=t[r[0]],l>1&&(a|=t[r[0]+1]<<8),l>2&&(a|=t[r[0]+2]<<16),l>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=l}s.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var o=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Dn(s)],o==0)throw new Error("Invalid offset 0");if(o>s[0].length)throw new Error("Invalid offset beyond length");if(c>=o)for(s.push(s[0].slice(-o)),c-=o;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-o,-o+c))}}var f=Dn(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function yr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(vA(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Dn(t)}function Os(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=je(n),a=i.length;t.push(i),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Dn(t)}function qc(e,t){var r=new Uint8Array(32),n=ko(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,gA(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,s)}function Yc(e,t){var r=new Uint8Array(32),n=ko(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,s)}function dn(e){var t=lt(e);return Fa(t[1][0].data)}function yA(e,t,r){var n,s,i,a;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((a=(i=e[8])==null?void 0:i[0])==null?void 0:a.data)&&ni(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var o=0,c=ko(e[7][0].data),f=0,d=[],h=ko(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}c.setUint16(p*2,f,!0),h.setUint16(p*2,m,!0);var _,v;switch(typeof t[p]){case"string":_=qc({t:"s",v:t[p]},r),v=Yc({t:"s",v:t[p]},r);break;case"number":_=qc({t:"n",v:t[p]},r),v=Yc({t:"n",v:t[p]},r);break;case"boolean":_=qc({t:"b",v:t[p]},r),v=Yc({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}d.push(_),f+=_.length,x.push(v),m+=v.length,++o}for(e[2][0].data=je(o);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Dn(d),e[3][0].data=Dn(x),o}function _A(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=nr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(st(n)));var i=No(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(P){return P.forEach(function(R){typeof R=="string"&&a.push(R)})});var l={},o=[],c=Le.read(t.numbers,{type:"base64"});c.FileIndex.map(function(P,R){return[P,c.FullPaths[R]]}).forEach(function(P){var R=P[0],D=P[1];if(R.type==2&&R.name.match(/\.iwa/)){var V=R.content,oe=yr(V),ge=vr(oe);ge.forEach(function(ue){o.push(ue.id),l[ue.id]={deps:[],location:D,type:ni(ue.messages[0].meta[1][0].data)}})}}),o.sort(function(P,R){return P-R});var f=o.filter(function(P){return P>1}).map(function(P){return[P,je(P)]});c.FileIndex.map(function(P,R){return[P,c.FullPaths[R]]}).forEach(function(P){var R=P[0];if(P[1],!!R.name.match(/\.iwa/)){var D=vr(yr(R.content));D.forEach(function(V){V.messages.forEach(function(oe){f.forEach(function(ge){V.messages.some(function(ue){return ni(ue.meta[1][0].data)!=11006&&xA(ue.data,ge[1])})&&l[ge[0]].deps.push(V.id)})})})}});for(var d=Le.find(c,l[1].location),h=vr(yr(d.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var _=dn(lt(m.messages[0].data)[1][0].data);for(d=Le.find(c,l[_].location),h=vr(yr(d.content)),x=0;x<h.length;++x)p=h[x],p.id==_&&(m=p);for(_=dn(lt(m.messages[0].data)[2][0].data),d=Le.find(c,l[_].location),h=vr(yr(d.content)),x=0;x<h.length;++x)p=h[x],p.id==_&&(m=p);for(_=dn(lt(m.messages[0].data)[2][0].data),d=Le.find(c,l[_].location),h=vr(yr(d.content)),x=0;x<h.length;++x)p=h[x],p.id==_&&(m=p);var v=lt(m.messages[0].data);{v[6][0].data=je(n.e.r+1),v[7][0].data=je(n.e.c+1);var y=dn(v[46][0].data),g=Le.find(c,l[y].location),S=vr(yr(g.content));{for(var j=0;j<S.length&&S[j].id!=y;++j);if(S[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var N=lt(S[j].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var k=0;k<=n.e.c;++k){var F=[];F[1]=F[2]=[{type:0,data:je(k+420690)}],N[1].push({type:2,data:xt(F)}),N[2].push({type:0,data:je(k)}),N[3].push({type:0,data:je(k)})}N[4]=[],N[5]=[],N[6]=[];for(var L=0;L<=n.e.r;++L)F=[],F[1]=F[2]=[{type:0,data:je(L+726270)}],N[4].push({type:2,data:xt(F)}),N[5].push({type:0,data:je(L)}),N[6].push({type:0,data:je(L)});S[j].messages[0].data=xt(N)}g.content=Os(bs(S)),g.size=g.content.length,delete v[46];var B=lt(v[4][0].data);{B[7][0].data=je(n.e.r+1);var G=lt(B[1][0].data),q=dn(G[2][0].data);g=Le.find(c,l[q].location),S=vr(yr(g.content));{if(S[0].id!=q)throw"Bad HeaderStorageBucket";var se=lt(S[0].messages[0].data);for(L=0;L<i.length;++L){var de=lt(se[2][0].data);de[1][0].data=je(L),de[4][0].data=je(i[L].length),se[2][L]={type:se[2][0].type,data:xt(de)}}S[0].messages[0].data=xt(se)}g.content=Os(bs(S)),g.size=g.content.length;var ve=dn(B[2][0].data);g=Le.find(c,l[ve].location),S=vr(yr(g.content));{if(S[0].id!=ve)throw"Bad HeaderStorageBucket";for(se=lt(S[0].messages[0].data),k=0;k<=n.e.c;++k)de=lt(se[2][0].data),de[1][0].data=je(k),de[4][0].data=je(n.e.r+1),se[2][k]={type:se[2][0].type,data:xt(de)};S[0].messages[0].data=xt(se)}g.content=Os(bs(S)),g.size=g.content.length;var J=dn(B[4][0].data);(function(){for(var P=Le.find(c,l[J].location),R=vr(yr(P.content)),D,V=0;V<R.length;++V){var oe=R[V];oe.id==J&&(D=oe)}var ge=lt(D.messages[0].data);{ge[3]=[];var ue=[];a.forEach(function(Ee,et){ue[1]=[{type:0,data:je(et)}],ue[2]=[{type:0,data:je(1)}],ue[3]=[{type:2,data:mA(Ee)}],ge[3].push({type:2,data:xt(ue)})})}D.messages[0].data=xt(ge);var ie=bs(R),Ae=Os(ie);P.content=Ae,P.size=P.content.length})();var ye=lt(B[3][0].data);{var Y=ye[1][0];delete ye[2];var le=lt(Y.data);{var I=dn(le[2][0].data);(function(){for(var P=Le.find(c,l[I].location),R=vr(yr(P.content)),D,V=0;V<R.length;++V){var oe=R[V];oe.id==I&&(D=oe)}var ge=lt(D.messages[0].data);{delete ge[6],delete ye[7];var ue=new Uint8Array(ge[5][0].data);ge[5]=[];for(var ie=0,Ae=0;Ae<=n.e.r;++Ae){var Ee=lt(ue);ie+=yA(Ee,i[Ae],a),Ee[1][0].data=je(Ae),ge[5].push({data:xt(Ee),type:2})}ge[1]=[{type:0,data:je(n.e.c+1)}],ge[2]=[{type:0,data:je(n.e.r+1)}],ge[3]=[{type:0,data:je(ie)}],ge[4]=[{type:0,data:je(n.e.r+1)}]}D.messages[0].data=xt(ge);var et=bs(R),Ce=Os(et);P.content=Ce,P.size=P.content.length})()}Y.data=xt(le)}B[3][0].data=xt(ye)}v[4][0].data=xt(B)}m.messages[0].data=xt(v);var pe=bs(h),O=Os(pe);return d.content=O,d.size=d.content.length,c}function wA(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Af(e){wA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function SA(e,t){return t.bookType=="ods"?yg(e,t):t.bookType=="numbers"?_A(e,t):t.bookType=="xlsb"?EA(e,t):TA(e,t)}function EA(e,t){Ks=1024,e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(Jo(),Yo(e.SSF),t.revssf=Qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ia?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=tg.indexOf(t.bookType)>-1,s=Ox();Af(t=t||{});var i=ff(),a="",l=0;if(t.cellXfs=[],$n(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Se(i,a,Rx(e.Props,t)),s.coreprops.push(a),Pe(t.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,Se(i,a,Dx(e.Props)),s.extprops.push(a),Pe(t.rels,3,a,Oe.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Se(i,a,Lx(e.Custprops)),s.custprops.push(a),Pe(t.rels,4,a,Oe.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},d=e.Sheets[e.SheetNames[l-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Se(i,a,NN(l-1,a,t,e,f)),s.sheets.push(a),Pe(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Oe.WS[0])}if(d){var m=d["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Se(i,p,bN(m,p)),s.comments.push(p),Pe(f,-1,"../comments"+l+"."+r,Oe.CMNT),x=!0),d["!legacy"]&&x&&Se(i,"xl/drawings/vmlDrawing"+l+".vml",Zx(l,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Se(i,jx(a),ti(f))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Se(i,a,CN(t.Strings,a,t)),s.strs.push(a),Pe(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Se(i,a,kN(e,a)),s.workbooks.push(a),Pe(t.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Se(i,a,Jx(e.Themes,t)),s.themes.push(a),Pe(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Se(i,a,AN(e,a,t)),s.styles.push(a),Pe(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Se(i,a,e.vbaraw),s.vba.push(a),Pe(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Se(i,a,ON(a)),s.metadata.push(a),Pe(t.wbrels,-1,"metadata."+r,Oe.XLMETA),Se(i,"[Content_Types].xml",Fx(s,t)),Se(i,"_rels/.rels",ti(t.rels)),Se(i,"xl/_rels/workbook."+r+".rels",ti(t.wbrels)),delete t.revssf,delete t.ssf,i}function TA(e,t){Ks=1024,e&&!e.SSF&&(e.SSF=Xt(Ze)),e&&e.SSF&&(Jo(),Yo(e.SSF),t.revssf=Qo(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ia?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=tg.indexOf(t.bookType)>-1,s=Ox();Af(t=t||{});var i=ff(),a="",l=0;if(t.cellXfs=[],$n(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Se(i,a,Rx(e.Props,t)),s.coreprops.push(a),Pe(t.rels,2,a,Oe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&o.push(e.SheetNames[c]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,Se(i,a,Dx(e.Props)),s.extprops.push(a),Pe(t.rels,3,a,Oe.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Se(i,a,Lx(e.Custprops)),s.custprops.push(a),Pe(t.rels,4,a,Oe.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+l+"."+r,Se(i,a,ug(l-1,t,e,d)),s.sheets.push(a),Pe(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Oe.WS[0])}if(h){var x=h["!comments"],p=!1,_="";if(x&&x.length>0){var v=!1;x.forEach(function(y){y[1].forEach(function(g){g.T==!0&&(v=!0)})}),v&&(_="xl/threadedComments/threadedComment"+l+"."+r,Se(i,_,t4(x,f,t)),s.threadedcomments.push(_),Pe(d,-1,"../threadedComments/threadedComment"+l+"."+r,Oe.TCMNT)),_="xl/comments"+l+"."+r,Se(i,_,eg(x)),s.comments.push(_),Pe(d,-1,"../comments"+l+"."+r,Oe.CMNT),p=!0}h["!legacy"]&&p&&Se(i,"xl/drawings/vmlDrawing"+l+".vml",Zx(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Se(i,jx(a),ti(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Se(i,a,Vx(t.Strings,t)),s.strs.push(a),Pe(t.wbrels,-1,"sharedStrings."+r,Oe.SST)),a="xl/workbook."+r,Se(i,a,hg(e)),s.workbooks.push(a),Pe(t.rels,1,a,Oe.WB),a="xl/theme/theme1.xml",Se(i,a,Jx(e.Themes,t)),s.themes.push(a),Pe(t.wbrels,-1,"theme/theme1.xml",Oe.THEME),a="xl/styles."+r,Se(i,a,qx(e,t)),s.styles.push(a),Pe(t.wbrels,-1,"styles."+r,Oe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Se(i,a,e.vbaraw),s.vba.push(a),Pe(t.wbrels,-1,"vbaProject.bin",Oe.VBA)),a="xl/metadata."+r,Se(i,a,Qx()),s.metadata.push(a),Pe(t.wbrels,-1,"metadata."+r,Oe.XLMETA),f.length>1&&(a="xl/persons/person.xml",Se(i,a,r4(f)),s.people.push(a),Pe(t.wbrels,-1,"persons/person.xml",Oe.PEOPLE)),Se(i,"[Content_Types].xml",Fx(s,t)),Se(i,"_rels/.rels",ti(t.rels)),Se(i,"xl/_rels/workbook."+r+".rels",ti(t.wbrels)),delete t.revssf,delete t.ssf,i}function kA(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=an(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _g(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Ka(t.file,Le.write(e,{type:Fe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Le.write(e,t)}function NA(e,t){var r=Xt(t||{}),n=SA(e,r);return AA(n,r)}function AA(e,t){var r={},n=Fe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Le.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(qo(s))}return t.password&&typeof encrypt_agile<"u"?_g(encrypt_agile(s,t.password),t):t.type==="file"?Ka(t.file,s):t.type=="string"?ta(s):s}function CA(e,t){var r=t||{},n=HN(e,r);return _g(n,r)}function Ir(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Aa(ba(n));case"binary":return ba(n);case"string":return e;case"file":return Ka(t.file,n,"utf8");case"buffer":return Fe?cn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ir(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bA(e,t){switch(t.type){case"base64":return Aa(e);case"binary":return e;case"string":return e;case"file":return Ka(t.file,e,"binary");case"buffer":return Fe?cn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Al(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Aa(r):t.type=="string"?ta(r):r;case"file":return Ka(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function wg(e,t){nS(),pN(e);var r=Xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=wg(e,r);return r.type="array",qo(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ir(WN(e,r),r);case"slk":case"sylk":return Ir(fT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ir(xg(e.Sheets[e.SheetNames[s]],r),r);case"txt":return bA(Sg(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ir(Cf(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ir(dT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Al(uT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ir(hT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ir(_T.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ir(Hx.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ir(yg(e,r),r);case"wk1":return Al(Kh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Al(Kh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Al(mg(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),CA(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return NA(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function OA(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Gs(e,t,r){var n={};return n.type="file",n.file=t,OA(n),wg(e,n)}function FA(e,t,r,n,s,i,a,l){var o=St(r),c=l.defval,f=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=a?e[r][m]:e[n[m]+o];if(x===void 0||x.t===void 0){if(c===void 0)continue;i[m]!=null&&(h[i[m]]=c);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(c!==void 0)h[i[m]]=c;else if(f&&p===null)h[i[m]]=null;else continue;else h[i[m]]=f&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:ln(x,p,l);p!=null&&(d=!1)}}return{row:h,isempty:d}}function No(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,l="",o={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":o=We(f);break;case"number":o=We(e["!ref"]),o.s.r=f;break;default:o=f}n>0&&(s=0);var d=St(o.s.r),h=[],m=[],x=0,p=0,_=Array.isArray(e),v=o.s.r,y=0,g={};_&&!e[v]&&(e[v]=[]);var S=c.skipHidden&&e["!cols"]||[],j=c.skipHidden&&e["!rows"]||[];for(y=o.s.c;y<=o.e.c;++y)if(!(S[y]||{}).hidden)switch(h[y]=bt(y),r=_?e[v][y]:e[h[y]+d],n){case 1:i[y]=y-o.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=c.header[y-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=a=ln(r,null,c),p=g[a]||0,!p)g[a]=1;else{do l=a+"_"+p++;while(g[l]);g[a]=p,g[l]=1}i[y]=l}for(v=o.s.r+s;v<=o.e.r;++v)if(!(j[v]||{}).hidden){var N=FA(e,o,v,h,n,i,_,c);(N.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[x++]=N.row)}return m.length=x,m}var ep=/"/g;function jA(e,t,r,n,s,i,a,l){for(var o=!0,c=[],f="",d=St(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=l.dense?(e[r]||[])[h]:e[n[h]+d];if(m==null)f="";else if(m.v!=null){o=!1,f=""+(l.rawNumbers&&m.t=="n"?m.v:ln(m,null,l));for(var x=0,p=0;x!==f.length;++x)if((p=f.charCodeAt(x))===s||p===i||p===34||l.forceQuotes){f='"'+f.replace(ep,'""')+'"';break}f=="ID"&&(f='"ID"')}else m.f!=null&&!m.F?(o=!1,f="="+m.f,f.indexOf(",")>=0&&(f='"'+f.replace(ep,'""')+'"')):f="";c.push(f)}return l.blankrows===!1&&o?null:c.join(a)}function Cf(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=We(e["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,o=l.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(d[x]=bt(x));for(var p=0,_=s.s.r;_<=s.e.r;++_)(m[_]||{}).hidden||(f=jA(e,s,_,d,a,o,i,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((p++?l:"")+f)));return delete n.dense,r.join("")}function Sg(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Cf(e,t);return r}function PA(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=We(e["!ref"]),i="",a=[],l,o=[],c=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)a[l]=bt(l);for(var f=s.s.r;f<=s.e.r;++f)for(i=St(f),l=s.s.c;l<=s.e.c;++l)if(t=a[l]+i,r=c?(e[f]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}o[o.length]=t+"="+n}return o}function Eg(e,t,r){var n=r||{},s=+!n.skipHeader,i=e||{},a=0,l=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?ht(n.origin):n.origin;a=o.r,l=o.c}var c,f={s:{c:0,r:0},e:{c:l,r:a+t.length-1+s}};if(i["!ref"]){var d=We(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),a==-1&&(a=d.e.r+1,f.e.r=a+t.length-1+s)}else a==-1&&(a=0,f.e.r=t.length-1+s);var h=n.header||[],m=0;t.forEach(function(p,_){Tt(p).forEach(function(v){(m=h.indexOf(v))==-1&&(h[m=h.length]=v);var y=p[v],g="z",S="",j=De({c:l+m,r:a+_+s});c=ja(i,j),y&&typeof y=="object"&&!(y instanceof Date)?i[j]=y:(typeof y=="number"?g="n":typeof y=="boolean"?g="b":typeof y=="string"?g="s":y instanceof Date?(g="d",n.cellDates||(g="n",y=Gt(y)),S=n.dateNF||Ze[14]):y===null&&n.nullError&&(g="e",y=0),c?(c.t=g,c.v=y,delete c.w,delete c.R,S&&(c.z=S)):i[j]=c={t:g,v:y},S&&(c.z=S))})}),f.e.c=Math.max(f.e.c,l+h.length-1);var x=St(a);if(s)for(m=0;m<h.length;++m)i[bt(m+l)+x]={t:"s",v:h[m]};return i["!ref"]=st(f),i}function RA(e,t){return Eg(null,e,t)}function ja(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ht(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ja(e,De(t)):ja(e,De({r:t,c:r||0}))}function IA(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function DA(){return{SheetNames:[],Sheets:{}}}function LA(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=a+s)!=-1;++s);}if(dg(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function MA(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=IA(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function BA(e,t){return e.z=t,e}function Tg(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function UA(e,t,r){return Tg(e,"#"+t,r)}function $A(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function WA(e,t,r,n){for(var s=typeof t!="string"?t:We(t),i=typeof t=="string"?t:st(t),a=s.s.r;a<=s.e.r;++a)for(var l=s.s.c;l<=s.e.c;++l){var o=ja(e,a,l);o.t="n",o.F=i,delete o.v,a==s.s.r&&l==s.s.c&&(o.f=r,n&&(o.D=!0))}return e}var ze={encode_col:bt,encode_row:St,encode_cell:De,encode_range:st,decode_col:gf,decode_row:xf,split_cell:nE,decode_cell:ht,decode_range:nr,format_cell:ln,sheet_add_aoa:Tx,sheet_add_json:Eg,sheet_add_dom:gg,aoa_to_sheet:_i,json_to_sheet:RA,table_to_sheet:vg,table_to_book:dA,sheet_to_csv:Cf,sheet_to_txt:Sg,sheet_to_json:No,sheet_to_html:xg,sheet_to_formulae:PA,sheet_to_row_object_array:No,sheet_get_cell:ja,book_new:DA,book_append_sheet:LA,book_set_sheet_visibility:MA,cell_set_number_format:BA,cell_set_hyperlink:Tg,cell_set_internal_link:UA,cell_add_comment:$A,sheet_set_array_formula:WA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function zA(){const{profile:e}=Fr(),{logAction:t}=Ha(),[r,n]=ee.useState([]),[s,i]=ee.useState([]),[a,l]=ee.useState([]),[o,c]=ee.useState([]),[f,d]=ee.useState(!0),[h,m]=ee.useState(""),[x,p]=ee.useState(""),[_,v]=ee.useState(""),[y,g]=ee.useState("all"),[S,j]=ee.useState(!1),[N,k]=ee.useState(null),[F,L]=ee.useState({key_system_id:"",key_code:"",room_number:"",building_id:"",notes:"",bitting:"",core_code:"",status:"available",top_pins:Array(7).fill(""),control_pins:Array(7).fill(""),master_pins:Array(7).fill(""),bottom_pins:Array(7).fill("")}),B=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="super_administrator";ee.useEffect(()=>{G()},[]);const G=async()=>{try{const[I,pe,O,P]=await Promise.all([xe.from("keys").select("*, key_system:key_systems(name, brand, campus_id, campus:campuses(name)), building:buildings(name, campus_id, campus:campuses(name))").order("key_code"),xe.from("buildings").select("id, name, campus_id").eq("active",!0).order("name"),xe.from("key_systems").select("id, name, brand, campus_id").eq("active",!0).order("name"),xe.from("campuses").select("id, name").eq("active",!0).order("name")]);I.data&&n(I.data),pe.data&&i(pe.data),O.data&&l(O.data),P.data&&c(P.data)}catch(I){console.error("Error:",I)}finally{d(!1)}},q=async I=>{I.preventDefault();try{const pe={top_pins:F.top_pins.map(P=>P===""?null:parseInt(P)).filter(P=>P!==null&&!isNaN(P)),control_pins:F.control_pins.map(P=>P===""?null:parseInt(P)).filter(P=>P!==null&&!isNaN(P)),master_pins:F.master_pins.map(P=>P===""?null:parseInt(P)).filter(P=>P!==null&&!isNaN(P)),bottom_pins:F.bottom_pins.map(P=>P===""?null:parseInt(P)).filter(P=>P!==null&&!isNaN(P))},O={key_system_id:F.key_system_id,key_code:F.key_code,room_number:F.room_number||null,building_id:F.building_id||null,notes:F.notes,bitting:F.bitting,core_code:F.core_code,status:F.status,top_pins:pe.top_pins.length>0?pe.top_pins:null,control_pins:pe.control_pins.length>0?pe.control_pins:null,master_pins:pe.master_pins.length>0?pe.master_pins:null,bottom_pins:pe.bottom_pins.length>0?pe.bottom_pins:null};if(N)await xe.from("keys").update({...O,updated_at:new Date().toISOString()}).eq("id",N.id),await t("update","key","Updated key: "+F.key_code,{entityId:N.id});else{const{data:P}=await xe.from("keys").insert([O]).select().single();await t("create","key","Created key: "+F.key_code,{entityId:P==null?void 0:P.id})}j(!1),k(null),se(),G()}catch(pe){console.error("Error saving key:",pe),alert("Error saving key")}},se=()=>{L({key_system_id:"",key_code:"",room_number:"",building_id:"",notes:"",bitting:"",core_code:"",status:"available",top_pins:Array(7).fill(""),control_pins:Array(7).fill(""),master_pins:Array(7).fill(""),bottom_pins:Array(7).fill("")})},de=I=>{k(I),L({key_system_id:I.key_system_id,key_code:I.key_code,room_number:I.room_number||"",building_id:I.building_id||"",notes:I.notes||"",bitting:I.bitting||"",core_code:I.core_code||"",status:I.status,top_pins:I.top_pins?[...I.top_pins,...Array(7-I.top_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),control_pins:I.control_pins?[...I.control_pins,...Array(7-I.control_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),master_pins:I.master_pins?[...I.master_pins,...Array(7-I.master_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),bottom_pins:I.bottom_pins?[...I.bottom_pins,...Array(7-I.bottom_pins.length).fill("")].slice(0,7).map(String):Array(7).fill("")}),j(!0)},ve=async I=>{if(confirm("Delete this key?"))try{await xe.from("keys").delete().eq("id",I.id),await t("delete","key","Deleted key "+I.key_code,{entityId:I.id}),G()}catch{alert("Error deleting key")}},J=I=>{var pe,O,P,R,D,V,oe;eS({key_code:I.key_code,bitting:I.bitting,core_code:I.core_code,campus:((O=(pe=I.building)==null?void 0:pe.campus)==null?void 0:O.name)||((R=(P=I.key_system)==null?void 0:P.campus)==null?void 0:R.name),building:(D=I.building)==null?void 0:D.name,room_number:I.room_number||void 0,system:(V=I.key_system)==null?void 0:V.name,brand:(oe=I.key_system)==null?void 0:oe.brand,notes:I.notes,top_pins:I.top_pins||void 0,control_pins:I.control_pins||void 0,master_pins:I.master_pins||void 0,bottom_pins:I.bottom_pins||void 0})},ye=async()=>{const I=r.map(P=>{var R,D,V,oe,ge,ue,ie,Ae,Ee,et,Ce;return{Campus:((D=(R=P.building)==null?void 0:R.campus)==null?void 0:D.name)||((oe=(V=P.key_system)==null?void 0:V.campus)==null?void 0:oe.name)||"",Building:((ge=P.building)==null?void 0:ge.name)||"","Key System":((ue=P.key_system)==null?void 0:ue.name)||"",Brand:((ie=P.key_system)==null?void 0:ie.brand)||"","Key Code":P.key_code,Bitting:P.bitting||"","Core Code":P.core_code||"",Room:P.room_number||"",Status:P.status,Notes:P.notes||"","Top Pins":((Ae=P.top_pins)==null?void 0:Ae.join(","))||"","Control Pins":((Ee=P.control_pins)==null?void 0:Ee.join(","))||"","Master Pins":((et=P.master_pins)==null?void 0:et.join(","))||"","Bottom Pins":((Ce=P.bottom_pins)==null?void 0:Ce.join(","))||""}}),pe=ze.json_to_sheet(I),O=ze.book_new();ze.book_append_sheet(O,pe,"Keys"),Gs(O,"keys-"+new Date().toISOString().split("T")[0]+".xlsx")},Y=()=>{const I={};r.forEach(R=>{var ge,ue,ie,Ae,Ee,et;const D=((ue=(ge=R.building)==null?void 0:ge.campus)==null?void 0:ue.name)||((Ae=(ie=R.key_system)==null?void 0:ie.campus)==null?void 0:Ae.name)||"Unknown Campus",V=((Ee=R.building)==null?void 0:Ee.name)||"No Building",oe=((et=R.key_system)==null?void 0:et.name)||"Unknown System";I[D]||(I[D]={}),I[D][V]||(I[D][V]={}),I[D][V][oe]||(I[D][V][oe]=[]),I[D][V][oe].push({key_code:R.key_code,bitting:R.bitting,core_code:R.core_code,room_number:R.room_number,status:R.status,notes:R.notes,medeco_pins:{top:R.top_pins,control:R.control_pins,master:R.master_pins,bottom:R.bottom_pins}})});const pe=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),O=URL.createObjectURL(pe),P=document.createElement("a");P.href=O,P.download="keys-organized-"+new Date().toISOString().split("T")[0]+".json",P.click()},le=r.filter(I=>{var D,V;const pe=I.key_code.toLowerCase().includes(h.toLowerCase())||I.room_number&&I.room_number.toLowerCase().includes(h.toLowerCase())||I.bitting&&I.bitting.toLowerCase().includes(h.toLowerCase()),O=!x||((D=I.building)==null?void 0:D.campus_id)===x||((V=I.key_system)==null?void 0:V.campus_id)===x,P=!_||I.building_id===_,R=y==="all"||I.status===y;return pe&&O&&P&&R});return f?u.jsx("div",{className:"text-center py-12",children:"Loading..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Keys"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage keys inventory"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:ye,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Excel"})]}),u.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"JSON"})]}),B&&u.jsxs("button",{onClick:()=>{k(null),se(),j(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[u.jsx(Wa,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Key"})]})]})]}),S&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:u.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full my-8",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:N?"Edit Key":"Add Key"}),u.jsxs("form",{onSubmit:q,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Key System *"}),u.jsxs("select",{value:F.key_system_id,onChange:I=>L({...F,key_system_id:I.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:[u.jsx("option",{value:"",children:"Select"}),a.map(I=>u.jsxs("option",{value:I.id,children:[I.name," - ",I.brand]},I.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Key Code *"}),u.jsx("input",{type:"text",value:F.key_code,onChange:I=>L({...F,key_code:I.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Building"}),u.jsxs("select",{value:F.building_id,onChange:I=>L({...F,building_id:I.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[u.jsx("option",{value:"",children:"Select"}),s.map(I=>u.jsx("option",{value:I.id,children:I.name},I.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room Number"}),u.jsx("input",{type:"text",value:F.room_number,onChange:I=>L({...F,room_number:I.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bitting Code"}),u.jsx("input",{type:"text",value:F.bitting,onChange:I=>L({...F,bitting:I.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Core Code"}),u.jsx("input",{type:"text",value:F.core_code,onChange:I=>L({...F,core_code:I.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status *"}),u.jsxs("select",{value:F.status,onChange:I=>L({...F,status:I.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:[u.jsx("option",{value:"available",children:"Available"}),u.jsx("option",{value:"in_use",children:"In Use"}),u.jsx("option",{value:"lost",children:"Lost"}),u.jsx("option",{value:"retired",children:"Retired"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),u.jsx("textarea",{value:F.notes,onChange:I=>L({...F,notes:I.target.value}),className:"w-full px-3 py-2 border rounded-lg",rows:2})]}),u.jsxs("div",{className:"border-t pt-4",children:[u.jsx("h3",{className:"font-semibold mb-3",children:"Medeco Pin Configuration (Optional)"}),u.jsx("div",{className:"space-y-3",children:["top_pins","control_pins","master_pins","bottom_pins"].map(I=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-medium mb-1 uppercase text-slate-600",children:I.replace("_"," ")}),u.jsx("div",{className:"grid grid-cols-7 gap-2",children:Array.from({length:7},(pe,O)=>u.jsx("input",{type:"number",min:"0",max:"9",value:F[I][O],onChange:P=>{const R=[...F[I]];R[O]=P.target.value,L({...F,[I]:R})},className:"w-full px-2 py-1 border rounded text-center",placeholder:"-"},O))})]},I))})]}),u.jsxs("div",{className:"flex gap-2 pt-2",children:[u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg",children:"Save"}),u.jsx("button",{type:"button",onClick:()=>{j(!1),k(null)},className:"flex-1 px-4 py-2 bg-slate-200 rounded-lg",children:"Cancel"})]})]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"p-4 border-b space-y-4",children:[u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search by key code, room, or bitting...",value:h,onChange:I=>m(I.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),o.length>1&&u.jsxs("select",{value:x,onChange:I=>{p(I.target.value),v("")},className:"px-4 py-2 border rounded-lg",children:[u.jsx("option",{value:"",children:"All Campuses"}),o.map(I=>u.jsx("option",{value:I.id,children:I.name},I.id))]}),u.jsxs("select",{value:_,onChange:I=>v(I.target.value),className:"px-4 py-2 border rounded-lg",children:[u.jsx("option",{value:"",children:"All Buildings"}),s.filter(I=>!x||I.campus_id===x).map(I=>u.jsx("option",{value:I.id,children:I.name},I.id))]}),u.jsxs("select",{value:y,onChange:I=>g(I.target.value),className:"px-4 py-2 border rounded-lg",children:[u.jsx("option",{value:"all",children:"All Status"}),u.jsx("option",{value:"available",children:"Available"}),u.jsx("option",{value:"in_use",children:"In Use"}),u.jsx("option",{value:"lost",children:"Lost"}),u.jsx("option",{value:"retired",children:"Retired"})]})]}),u.jsxs("div",{className:"flex gap-4 text-sm",children:[u.jsxs("div",{children:["Total: ",u.jsx("strong",{children:r.length})]}),u.jsxs("div",{children:["Available: ",u.jsx("strong",{className:"text-emerald-600",children:r.filter(I=>I.status==="available").length})]}),u.jsxs("div",{children:["In Use: ",u.jsx("strong",{className:"text-blue-600",children:r.filter(I=>I.status==="in_use").length})]})]})]}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Key Code"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"System / Brand"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Location"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Bitting / Core"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y",children:[le.map(I=>{var pe,O,P;return u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:u.jsx(ka,{className:"w-5 h-5 text-slate-600"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium",children:I.key_code}),I.notes&&u.jsx("div",{className:"text-xs text-slate-500",children:I.notes})]})]})}),u.jsxs("td",{className:"px-6 py-4 text-sm",children:[u.jsx("div",{children:(pe=I.key_system)==null?void 0:pe.name}),u.jsx("div",{className:"text-xs text-slate-500",children:(O=I.key_system)==null?void 0:O.brand})]}),u.jsxs("td",{className:"px-6 py-4 text-sm",children:[u.jsx("div",{children:((P=I.building)==null?void 0:P.name)||"-"}),I.room_number&&u.jsxs("div",{className:"text-xs text-slate-500",children:["Room ",I.room_number]})]}),u.jsxs("td",{className:"px-6 py-4 text-sm font-mono",children:[u.jsx("div",{children:I.bitting||"-"}),I.core_code&&u.jsx("div",{className:"text-xs text-slate-500",children:I.core_code})]}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+(I.status==="available"?"bg-emerald-100 text-emerald-700":I.status==="in_use"?"bg-blue-100 text-blue-700":I.status==="lost"?"bg-red-100 text-red-700":"bg-slate-100 text-slate-700"),children:I.status.replace("_"," ")})}),u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>J(I),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg",title:"Print",children:u.jsx(zw,{className:"w-4 h-4"})}),B&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>de(I),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg",title:"Edit",children:u.jsx($a,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>ve(I),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:u.jsx(za,{className:"w-4 h-4"})})]})]})})]},I.id)}),le.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-500",children:"No keys found"})})]})]})})]})]})}function HA(){const[e,t]=ee.useState({totalKeys:0,availableKeys:0,inUseKeys:0,lostKeys:0,retiredKeys:0,totalCampuses:0,totalBuildings:0,totalKeySystems:0,recentActivities:0}),[r,n]=ee.useState(!0),[s,i]=ee.useState("inventory");ee.useEffect(()=>{a()},[]);const a=async()=>{var d,h,m,x;try{const[p,_,v,y,g]=await Promise.all([xe.from("keys").select("status"),xe.from("campuses").select("id").eq("active",!0),xe.from("buildings").select("id").eq("active",!0),xe.from("key_systems").select("id").eq("active",!0),xe.from("audit_logs").select("id").gte("created_at",new Date(Date.now()-6048e5).toISOString())]),S=p.data||[];t({totalKeys:S.length,availableKeys:S.filter(j=>j.status==="available").length,inUseKeys:S.filter(j=>j.status==="in_use").length,lostKeys:S.filter(j=>j.status==="lost").length,retiredKeys:S.filter(j=>j.status==="retired").length,totalCampuses:((d=_.data)==null?void 0:d.length)||0,totalBuildings:((h=v.data)==null?void 0:h.length)||0,totalKeySystems:((m=y.data)==null?void 0:m.length)||0,recentActivities:((x=g.data)==null?void 0:x.length)||0})}catch(p){console.error("Error fetching stats:",p)}finally{n(!1)}},l=async()=>{try{const{data:d}=await xe.from("keys").select("*, key_system:key_systems(name, brand, campus:campuses(name)), building:buildings(name, campus:campuses(name))"),h=(d||[]).map(p=>{var _,v,y,g,S,j,N;return{Campus:((v=(_=p.building)==null?void 0:_.campus)==null?void 0:v.name)||((g=(y=p.key_system)==null?void 0:y.campus)==null?void 0:g.name)||"N/A",Building:((S=p.building)==null?void 0:S.name)||"N/A","Key System":((j=p.key_system)==null?void 0:j.name)||"N/A",Brand:((N=p.key_system)==null?void 0:N.brand)||"N/A","Key Code":p.key_code,Bitting:p.bitting||"","Core Code":p.core_code||"",Room:p.room_number||"",Status:p.status,Notes:p.notes||""}}),m=ze.json_to_sheet(h),x=ze.book_new();ze.book_append_sheet(x,m,"Inventory Report"),Gs(x,`inventory-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(d){console.error("Error generating report:",d),alert("Error generating report")}},o=async()=>{try{const{data:d}=await xe.from("keys").select("*, key_system:key_systems(name, campus:campuses(name)), building:buildings(name)"),h={},m={},x={},p={available:0,in_use:0,lost:0,retired:0};(d||[]).forEach(g=>{var k,F,L,B;const S=((F=(k=g.key_system)==null?void 0:k.campus)==null?void 0:F.name)||"Unknown",j=((L=g.building)==null?void 0:L.name)||"No Building",N=((B=g.key_system)==null?void 0:B.name)||"Unknown System";h[S]=(h[S]||0)+1,m[j]=(m[j]||0)+1,x[N]=(x[N]||0)+1,p[g.status]=(p[g.status]||0)+1});const _=[{"Report Type":"Summary"},{"Total Keys":(d==null?void 0:d.length)||0},{"":""},{"Report Type":"By Campus"},...Object.entries(h).map(([g,S])=>({Campus:g,Keys:S})),{"":""},{"Report Type":"By Building"},...Object.entries(m).map(([g,S])=>({Building:g,Keys:S})),{"":""},{"Report Type":"By Key System"},...Object.entries(x).map(([g,S])=>({System:g,Keys:S})),{"":""},{"Report Type":"By Status"},...Object.entries(p).map(([g,S])=>({Status:g,Keys:S}))],v=ze.json_to_sheet(_),y=ze.book_new();ze.book_append_sheet(y,v,"Usage Report"),Gs(y,`usage-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(d){console.error("Error generating report:",d),alert("Error generating report")}},c=async()=>{try{const{data:d}=await xe.from("audit_logs").select("*, user:user_profiles(full_name, net_id)").order("created_at",{ascending:!1}).limit(1e3),h=(d||[]).map(p=>{var _,v;return{Date:new Date(p.created_at).toLocaleString(),User:((_=p.user)==null?void 0:_.full_name)||"System",NetID:((v=p.user)==null?void 0:v.net_id)||"N/A",Action:p.action_type,Entity:p.entity_type,Description:p.description,"IP Address":p.ip_address||"N/A"}}),m=ze.json_to_sheet(h),x=ze.book_new();ze.book_append_sheet(x,m,"Audit Trail"),Gs(x,`audit-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(d){console.error("Error generating report:",d),alert("Error generating report")}},f=async()=>{var d,h,m;try{const[x,p,_,v,y]=await Promise.all([xe.from("campuses").select("*").eq("active",!0),xe.from("buildings").select("*, campus:campuses(name)").eq("active",!0),xe.from("key_systems").select("*, campus:campuses(name)").eq("active",!0),xe.from("keys").select("status"),xe.from("user_profiles").select("role, active")]),g=ze.book_new(),S=(x.data||[]).map(de=>({"Campus Name":de.name,Code:de.code,Address:de.address||"",Active:de.active?"Yes":"No"})),j=ze.json_to_sheet(S);ze.book_append_sheet(g,j,"Campuses");const N=(p.data||[]).map(de=>{var ve;return{Campus:((ve=de.campus)==null?void 0:ve.name)||"","Building Name":de.name,Code:de.code,Address:de.address||"",Active:de.active?"Yes":"No"}}),k=ze.json_to_sheet(N);ze.book_append_sheet(g,k,"Buildings");const F=(_.data||[]).map(de=>{var ve;return{Campus:((ve=de.campus)==null?void 0:ve.name)||"","System Name":de.name,Brand:de.brand,Description:de.description||"",Active:de.active?"Yes":"No"}}),L=ze.json_to_sheet(F);ze.book_append_sheet(g,L,"Key Systems");const B=v.data||[],G=y.data||[],q=[{Metric:"Total Campuses",Value:((d=x.data)==null?void 0:d.length)||0},{Metric:"Total Buildings",Value:((h=p.data)==null?void 0:h.length)||0},{Metric:"Total Key Systems",Value:((m=_.data)==null?void 0:m.length)||0},{Metric:"Total Keys",Value:B.length},{Metric:"Available Keys",Value:B.filter(de=>de.status==="available").length},{Metric:"In Use Keys",Value:B.filter(de=>de.status==="in_use").length},{Metric:"Lost Keys",Value:B.filter(de=>de.status==="lost").length},{Metric:"Retired Keys",Value:B.filter(de=>de.status==="retired").length},{Metric:"Total Users",Value:G.length},{Metric:"Active Users",Value:G.filter(de=>de.active).length},{Metric:"Super Administrators",Value:G.filter(de=>de.role==="super_administrator").length},{Metric:"Administrators",Value:G.filter(de=>de.role==="administrator").length}],se=ze.json_to_sheet(q);ze.book_append_sheet(g,se,"Summary"),Gs(g,`system-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(x){console.error("Error generating report:",x),alert("Error generating report")}};return r?u.jsx("div",{className:"text-center py-12",children:"Loading..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Reports & Analytics"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Comprehensive reports on key usage, assignments, and system activity"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Total Keys"}),u.jsx(ka,{className:"w-5 h-5 text-slate-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:e.totalKeys}),u.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.availableKeys," available"]})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Buildings"}),u.jsx(Xo,{className:"w-5 h-5 text-slate-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:e.totalBuildings}),u.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.totalCampuses," campuses"]})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"In Use"}),u.jsx(t0,{className:"w-5 h-5 text-blue-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-blue-600",children:e.inUseKeys}),u.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[Math.round(e.inUseKeys/e.totalKeys*100)||0,"% of total"]})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Recent Activity"}),u.jsx(fh,{className:"w-5 h-5 text-green-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-green-600",children:e.recentActivities}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 7 days"})]})]}),e.lostKeys>0&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[u.jsx(B1,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-red-900",children:"Alert: Lost Keys"}),u.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["There are ",e.lostKeys," keys marked as lost. Please review and take appropriate action."]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"p-6 border-b",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Generate Reports"}),u.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Export comprehensive reports in Excel format"})]}),u.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("inventory"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:u.jsx(Rw,{className:"w-6 h-6 text-blue-600"})}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Inventory Report"})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete list of all keys with campus, building, system, and status information."}),u.jsxs("button",{onClick:l,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Generate Excel Report"})]})]}),u.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("usage"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:u.jsx(t0,{className:"w-6 h-6 text-green-600"})}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Usage Analytics"})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Key distribution by campus, building, system, and status with usage statistics."}),u.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Generate Excel Report"})]})]}),u.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("audit"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"bg-amber-100 p-3 rounded-lg",children:u.jsx(fh,{className:"w-6 h-6 text-amber-600"})}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"Audit Trail Report"})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete history of all system actions, user activities, and changes (last 1000 entries)."}),u.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Generate Excel Report"})]})]}),u.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("system"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[u.jsx("div",{className:"bg-slate-100 p-3 rounded-lg",children:u.jsx(U1,{className:"w-6 h-6 text-slate-600"})}),u.jsx("h3",{className:"font-semibold text-slate-900",children:"System Overview"})]}),u.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete system information including campuses, buildings, key systems, and users."}),u.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Generate Excel Report"})]})]})]})]})]})}function VA(){const{user:e}=Fr();return{logError:async(r,n,s)=>{try{await xe.from("error_logs").insert({error_type:r,severity:(s==null?void 0:s.severity)||"medium",user_id:(e==null?void 0:e.id)||null,message:n,stack_trace:(s==null?void 0:s.stackTrace)||"",context:(s==null?void 0:s.context)||{},resolved:!1})}catch(i){console.error("Failed to log error:",i)}}}}const tp=[{value:"basic_user",label:"Basic User",description:"View-only access to assigned campuses"},{value:"standard_user",label:"Standard User",description:"Can manage keys in assigned campuses"},{value:"administrator",label:"Administrator",description:"Full access to all campuses"},{value:"super_administrator",label:"Super Administrator",description:"Full system access including configuration"}];function KA(){const{profile:e}=Fr(),{logAction:t}=Ha(),{logError:r}=VA(),[n,s]=ee.useState([]),[i,a]=ee.useState([]),[l,o]=ee.useState({}),[c,f]=ee.useState(!0),[d,h]=ee.useState(""),[m,x]=ee.useState(!1),[p,_]=ee.useState(null),[v,y]=ee.useState(!1),[g,S]=ee.useState({netId:"",fullName:"",email:"",role:"basic_user",password:"",active:!0,selectedCampuses:[]});ee.useEffect(()=>{j()},[]);const j=async()=>{try{f(!0);const[J,ye,Y]=await Promise.all([xe.from("user_profiles").select("*").order("full_name"),xe.from("campuses").select("*").order("name"),xe.from("user_campus_permissions").select("*")]);if(J.error)throw J.error;if(ye.error)throw ye.error;if(Y.error)throw Y.error;s(J.data||[]),a(ye.data||[]);const le={};(Y.data||[]).forEach(I=>{le[I.user_id]||(le[I.user_id]=[]),le[I.user_id].push(I.campus_id)}),o(le)}catch(J){await r("database","high","Failed to load users",J)}finally{f(!1)}},N=()=>{_(null),S({netId:"",fullName:"",email:"",role:"basic_user",password:"",active:!0,selectedCampuses:[]}),y(!1),x(!0)},k=J=>{_(J),S({netId:J.net_id,fullName:J.full_name,email:J.email,role:J.role,password:"",active:J.active,selectedCampuses:l[J.id]||[]}),y(!1),x(!0)},F=async J=>{J.preventDefault();try{p?await B():await L(),x(!1),await j()}catch(ye){await r("validation","medium","User form submission failed",ye),alert(ye instanceof Error?ye.message:"Failed to save user")}},L=async()=>{if(!g.password)throw new Error("Password is required for new users");const{data:{session:J}}=await xe.auth.getSession();if(!J)throw new Error("Not authenticated");const Y=await fetch("https://ddqayedrbldmaqkbkuro.supabase.co/functions/v1/manage-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J.access_token}`},body:JSON.stringify({action:"create",data:{netId:g.netId,email:g.email,fullName:g.fullName,password:g.password,role:g.role,active:g.active,selectedCampuses:g.selectedCampuses}})}),le=await Y.json();if(!Y.ok)throw new Error(le.error||"Failed to create user");await t("create","user",le.userId,`Created user: ${g.fullName} (${g.netId})`)},B=async()=>{if(!p)return;const{data:{session:J}}=await xe.auth.getSession();if(!J)throw new Error("Not authenticated");const Y=await fetch("https://ddqayedrbldmaqkbkuro.supabase.co/functions/v1/manage-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${J.access_token}`},body:JSON.stringify({action:"update",data:{userId:p.id,netId:g.netId,email:g.email,fullName:g.fullName,password:g.password||void 0,role:g.role,active:g.active,selectedCampuses:g.selectedCampuses}})}),le=await Y.json();if(!Y.ok)throw new Error(le.error||"Failed to update user");await t("update","user",p.id,`Updated user: ${g.fullName} (${g.netId})`)},G=async J=>{if(confirm(`Are you sure you want to delete user "${J.full_name}"?

This will permanently remove the user and all associated data.`))try{const{error:ye}=await xe.from("user_profiles").delete().eq("id",J.id);if(ye)throw ye;await t("delete","user",J.id,`Deleted user: ${J.full_name} (${J.net_id})`),await j()}catch(ye){await r("database","high","Failed to delete user",ye),alert("Failed to delete user")}},q=n.filter(J=>J.full_name.toLowerCase().includes(d.toLowerCase())||J.net_id.toLowerCase().includes(d.toLowerCase())||J.email.toLowerCase().includes(d.toLowerCase())),se=J=>{var ye;return((ye=tp.find(Y=>Y.value===J))==null?void 0:ye.label)||J},de=J=>{const ye=l[J]||[];return i.filter(Y=>ye.includes(Y.id)).map(Y=>Y.name)},ve=(e==null?void 0:e.role)==="administrator"||(e==null?void 0:e.role)==="super_administrator";return c?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-slate-600",children:"Loading users..."})]})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"User Management"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage system users and their permissions"})]}),ve&&u.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-800 transition",children:[u.jsx(Wa,{className:"w-5 h-5"}),"Add User"]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[u.jsx("div",{className:"p-4 border-b border-slate-200",children:u.jsxs("div",{className:"relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search users by name, NetID, or email...",value:d,onChange:J=>h(J.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"User"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"NetID"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Campus Access"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),ve&&u.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-slate-200",children:q.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-slate-500",children:"No users found"})}):q.map(J=>{const ye=de(J.id),Y=J.role==="administrator"||J.role==="super_administrator";return u.jsxs("tr",{className:"hover:bg-slate-50",children:[u.jsx("td",{className:"px-6 py-4",children:u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-900",children:J.full_name}),u.jsx("div",{className:"text-sm text-slate-500",children:J.email})]})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"font-mono text-sm text-slate-700",children:J.net_id})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:"text-sm text-slate-900",children:se(J.role)})}),u.jsx("td",{className:"px-6 py-4",children:Y?u.jsx("span",{className:"text-sm text-slate-500 italic",children:"All Campuses"}):ye.length>0?u.jsx("div",{className:"flex flex-wrap gap-1",children:ye.map((le,I)=>u.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-slate-100 text-slate-700 rounded",children:le},I))}):u.jsx("span",{className:"text-sm text-slate-400",children:"No access"})}),u.jsx("td",{className:"px-6 py-4",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:J.active?"Active":"Inactive"})}),ve&&u.jsx("td",{className:"px-6 py-4 text-right",children:u.jsxs("div",{className:"flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>k(J),className:"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition",title:"Edit user",children:u.jsx($a,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>G(J),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:u.jsx(za,{className:"w-4 h-4"})})]})})]},J.id)})})]})})]}),m&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-900",children:p?"Edit User":"Add New User"}),u.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition",children:u.jsx(H1,{className:"w-5 h-5"})})]}),u.jsxs("form",{onSubmit:F,className:"p-6 space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name *"}),u.jsx("input",{type:"text",value:g.fullName,onChange:J=>S({...g,fullName:J.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID *"}),u.jsx("input",{type:"text",value:g.netId,onChange:J=>S({...g,netId:J.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email *"}),u.jsx("input",{type:"email",value:g.email,onChange:J=>S({...g,email:J.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Password ",p?"(leave blank to keep current)":"*"]}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:v?"text":"password",value:g.password,onChange:J=>S({...g,password:J.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none pr-12",required:!p,minLength:8}),u.jsx("button",{type:"button",onClick:()=>y(!v),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:v?u.jsx(Dw,{className:"w-5 h-5"}):u.jsx(Lw,{className:"w-5 h-5"})})]}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:p?"User will be required to change password on next login if updated":"Minimum 8 characters. User will be required to change on first login."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Role *"}),u.jsx("div",{className:"space-y-2",children:tp.map(J=>u.jsxs("label",{className:"flex items-start gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"role",value:J.value,checked:g.role===J.value,onChange:ye=>S({...g,role:ye.target.value}),className:"mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-slate-900",children:J.label}),u.jsx("div",{className:"text-xs text-slate-500",children:J.description})]})]},J.value))})]}),!["administrator","super_administrator"].includes(g.role)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Campus Access"}),u.jsx("div",{className:"border border-slate-200 rounded-lg p-3 space-y-2 max-h-48 overflow-y-auto",children:i.length===0?u.jsx("p",{className:"text-sm text-slate-500",children:"No campuses available"}):i.map(J=>u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:g.selectedCampuses.includes(J.id),onChange:ye=>{ye.target.checked?S({...g,selectedCampuses:[...g.selectedCampuses,J.id]}):S({...g,selectedCampuses:g.selectedCampuses.filter(Y=>Y!==J.id)})},className:"rounded"}),u.jsx("span",{className:"text-sm text-slate-900",children:J.name})]},J.id))})]}),u.jsx("div",{children:u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[u.jsx("input",{type:"checkbox",checked:g.active,onChange:J=>S({...g,active:J.target.checked}),className:"rounded"}),u.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Active User"})]})}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[u.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:p?"Update User":"Create User"})]})]})]})})]})}function GA(){return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Audit Logs"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"View system activity and audit trail"})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-slate-100 rounded-full mb-4",children:u.jsx($1,{className:"w-8 h-8 text-slate-600"})}),u.jsx("h2",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Audit Trail"}),u.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"Complete history of all system actions, user activities, and changes for compliance and security."})]})})]})}function XA(){const[e,t]=ee.useState([]),[r,n]=ee.useState(!0),[s,i]=ee.useState(""),[a,l]=ee.useState("all");ee.useEffect(()=>{o();const x=xe.channel("error_logs_channel").on("postgres_changes",{event:"*",schema:"public",table:"error_logs"},o).subscribe();return()=>{x.unsubscribe()}},[]);const o=async()=>{try{const{data:x}=await xe.from("error_logs").select("*, user:user_profiles(full_name, net_id)").order("created_at",{ascending:!1}).limit(100);x&&t(x)}catch(x){console.error("Error fetching error logs:",x)}finally{n(!1)}},c=async x=>{try{await xe.from("error_logs").update({resolved:!0,resolved_at:new Date().toISOString()}).eq("id",x),o()}catch(p){console.error("Error resolving error:",p),alert("Error updating status")}},f=()=>{const x=d.map(v=>{var y,g;return{Date:new Date(v.created_at).toLocaleString(),Type:v.error_type,Message:v.error_message,User:((y=v.user)==null?void 0:y.full_name)||"N/A",NetID:((g=v.user)==null?void 0:g.net_id)||"N/A",Status:v.resolved?"Resolved":"Unresolved","Resolved At":v.resolved_at?new Date(v.resolved_at).toLocaleString():""}}),p=ze.json_to_sheet(x),_=ze.book_new();ze.book_append_sheet(_,p,"Error Logs"),Gs(_,`error-logs-${new Date().toISOString().split("T")[0]}.xlsx`)},d=e.filter(x=>{const p=x.error_type.toLowerCase().includes(s.toLowerCase())||x.error_message.toLowerCase().includes(s.toLowerCase()),_=a==="all"||a==="resolved"&&x.resolved||a==="unresolved"&&!x.resolved;return p&&_}),h=e.filter(x=>!x.resolved).length,m=e.filter(x=>x.resolved&&x.resolved_at&&new Date(x.resolved_at).toDateString()===new Date().toDateString()).length;return r?u.jsx("div",{className:"text-center py-12",children:"Loading..."}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Error Reports"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Monitor and resolve system errors for optimal health"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Total Errors"}),u.jsx(e0,{className:"w-5 h-5 text-slate-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-slate-900",children:e.length}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 100 entries"})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Unresolved"}),u.jsx(hh,{className:"w-5 h-5 text-red-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-red-600",children:h}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Needs attention"})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Resolved Today"}),u.jsx(Wc,{className:"w-5 h-5 text-green-400"})]}),u.jsx("p",{className:"text-3xl font-bold text-green-600",children:m}),u.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Issues fixed"})]})]}),h>0&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[u.jsx(e0,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-red-900",children:"Action Required"}),u.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["There are ",h," unresolved errors that need attention."]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[u.jsx("div",{className:"p-4 border-b",children:u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(vi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),u.jsx("input",{type:"text",placeholder:"Search error type or message...",value:s,onChange:x=>i(x.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),u.jsxs("select",{value:a,onChange:x=>l(x.target.value),className:"px-4 py-2 border rounded-lg",children:[u.jsx("option",{value:"all",children:"All Errors"}),u.jsx("option",{value:"unresolved",children:"Unresolved"}),u.jsx("option",{value:"resolved",children:"Resolved"})]}),u.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[u.jsx(wn,{className:"w-4 h-4"}),u.jsx("span",{children:"Export"})]})]})}),u.jsx("div",{className:"divide-y",children:d.length===0?u.jsx("div",{className:"p-12 text-center text-slate-500",children:e.length===0?u.jsxs("div",{children:[u.jsx(Wc,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),u.jsx("p",{className:"font-medium",children:"No Errors!"}),u.jsx("p",{className:"text-sm mt-1",children:"System is running smoothly"})]}):u.jsx("p",{children:"No errors match your filters"})}):d.map(x=>u.jsx("div",{className:"p-6 hover:bg-slate-50",children:u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("div",{className:`p-2 rounded-lg ${x.resolved?"bg-green-100":"bg-red-100"}`,children:x.resolved?u.jsx(Wc,{className:"w-5 h-5 text-green-600"}):u.jsx(hh,{className:"w-5 h-5 text-red-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h3",{className:"font-semibold text-slate-900",children:x.error_type}),u.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-medium rounded-full ${x.resolved?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:x.resolved?"Resolved":"Unresolved"})]}),u.jsx("p",{className:"text-sm text-slate-600 mt-1",children:x.error_message})]})]}),u.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-3",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Iw,{className:"w-3 h-3"}),u.jsx("span",{children:new Date(x.created_at).toLocaleString()})]}),x.user&&u.jsxs("div",{children:["User: ",x.user.full_name," (",x.user.net_id,")"]}),x.resolved_at&&u.jsxs("div",{children:["Resolved: ",new Date(x.resolved_at).toLocaleString()]})]}),x.stack_trace&&u.jsxs("details",{className:"mt-3",children:[u.jsx("summary",{className:"text-xs text-slate-600 cursor-pointer hover:text-slate-900",children:"View Stack Trace"}),u.jsx("pre",{className:"mt-2 text-xs bg-slate-50 p-3 rounded border overflow-x-auto",children:x.stack_trace})]})]}),!x.resolved&&u.jsx("button",{onClick:()=>c(x.id),className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Mark Resolved"})]})},x.id))})]})]})}function qA(){const[e,t]=ee.useState(!1),r=async i=>{t(!0);try{const[a,l,o,c,f,d]=await Promise.all([xe.from("campuses").select("*"),xe.from("buildings").select("*"),xe.from("key_systems").select("*"),xe.from("keys").select("*"),xe.from("user_profiles").select("id, net_id, full_name, email, role, active, created_at"),xe.from("audit_logs").select("*").order("created_at",{ascending:!1}).limit(1e3)]),h={export_date:new Date().toISOString(),campuses:a.data||[],buildings:l.data||[],key_systems:o.data||[],keys:c.data||[],users:f.data||[],audit_logs:d.data||[]};if(i==="json"){const m=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),x=URL.createObjectURL(m),p=document.createElement("a");p.href=x,p.download=`database-export-${new Date().toISOString().split("T")[0]}.json`,p.click(),URL.revokeObjectURL(x)}else n("campuses",a.data||[]),n("buildings",l.data||[]),n("key_systems",o.data||[]),n("keys",c.data||[]),n("users",f.data||[]),n("audit_logs",d.data||[]);alert(`Database exported successfully as ${i.toUpperCase()}!`)}catch(a){console.error("Error exporting data:",a),alert("Error exporting data. Please try again.")}finally{t(!1)}},n=(i,a)=>{if(a.length===0)return;const l=Object.keys(a[0]),o=a.map(m=>l.map(x=>{const p=m[x];return p==null?"":typeof p=="object"?JSON.stringify(p):String(p)})),c=[l,...o].map(m=>m.map(x=>`"${String(x).replace(/"/g,'""')}"`).join(",")).join(`
`),f=new Blob([c],{type:"text/csv"}),d=URL.createObjectURL(f),h=document.createElement("a");h.href=d,h.download=`${i}-${new Date().toISOString().split("T")[0]}.csv`,h.click(),URL.revokeObjectURL(d)},s=async(i,a)=>{try{const{data:l,error:o}=await xe.from(i).select("*");if(o)throw o;const c=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),f=URL.createObjectURL(c),d=document.createElement("a");d.href=f,d.download=`${i}-${new Date().toISOString().split("T")[0]}.json`,d.click(),URL.revokeObjectURL(f),alert(`${a} exported successfully!`)}catch(l){console.error("Error exporting table:",l),alert(`Error exporting ${a}. Please try again.`)}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Backup & Export"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Manage data backups and exports"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"bg-slate-900 p-3 rounded-lg",children:u.jsx(wn,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Full Database Export"}),u.jsx("p",{className:"text-sm text-slate-600",children:"Export all data in JSON or CSV format"})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:()=>r("json"),disabled:e,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(Mw,{className:"w-5 h-5"}),u.jsx("span",{children:e?"Exporting...":"Export All Data (JSON)"})]}),u.jsxs("button",{onClick:()=>r("csv"),disabled:e,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(Bw,{className:"w-5 h-5"}),u.jsx("span",{children:e?"Exporting...":"Export All Data (CSV)"})]})]}),u.jsx("div",{className:"mt-4 p-3 bg-slate-50 rounded-lg",children:u.jsxs("p",{className:"text-xs text-slate-600",children:[u.jsx("strong",{children:"Note:"})," JSON export creates a single file with all tables. CSV export creates separate files for each table."]})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"bg-blue-600 p-3 rounded-lg",children:u.jsx(Ta,{className:"w-6 h-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Individual Table Export"}),u.jsx("p",{className:"text-sm text-slate-600",children:"Export specific tables as JSON"})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("button",{onClick:()=>s("campuses","Campuses"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Campuses"}),u.jsx("button",{onClick:()=>s("buildings","Buildings"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Buildings"}),u.jsx("button",{onClick:()=>s("key_systems","Key Systems"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Key Systems"}),u.jsx("button",{onClick:()=>s("keys","Keys"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Keys"}),u.jsx("button",{onClick:()=>s("user_profiles","Users"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Users"}),u.jsx("button",{onClick:()=>s("audit_logs","Audit Logs"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Audit Logs"})]})]})]}),u.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(Hw,{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-amber-900 mb-2",children:"Data Import"}),u.jsx("p",{className:"text-sm text-amber-800 mb-3",children:"To import data, use the individual management pages (Campuses, Buildings, Keys, etc.) where you can add items one by one."}),u.jsxs("p",{className:"text-xs text-amber-700",children:[u.jsx("strong",{children:"For keys:"})," Use the Keys page where you can add individual keys with all required information."]})]})]})}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Export Information"}),u.jsxs("div",{className:"space-y-3 text-sm text-slate-600",children:[u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"JSON Format:"}),u.jsx("span",{children:"Complete data export with all relationships and metadata. Best for backups and data migration."})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"CSV Format:"}),u.jsx("span",{children:"Spreadsheet-compatible format. Best for analysis in Excel, Google Sheets, or other tools."})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"Data Included:"}),u.jsx("span",{children:"Campuses, Buildings, Key Systems, Keys, Users (without passwords), and recent Audit Logs."})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"Security:"}),u.jsx("span",{children:"Password hashes and sensitive authentication data are never included in exports."})]})]})]})]})}function YA(){return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"System Configuration"}),u.jsx("p",{className:"text-slate-600 mt-1",children:"Configure system settings and preferences"})]}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-slate-100 rounded-full mb-4",children:u.jsx(W1,{className:"w-8 h-8 text-slate-600"})}),u.jsx("h2",{className:"text-xl font-semibold text-slate-900 mb-2",children:"System Settings"}),u.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"Configure system-wide settings, preferences, and customization options."})]})})]})}function JA(){const{user:e,profile:t,loading:r}=Fr(),[n,s]=ee.useState("dashboard"),[i,a]=ee.useState(!1),[l,o]=ee.useState(!0);ee.useEffect(()=>{c()},[]);const c=async()=>{try{const h=await fetch("https://ddqayedrbldmaqkbkuro.supabase.co/functions/v1/check-setup",{method:"GET",headers:{"Content-Type":"application/json"}}),m=await h.json();h.ok?a(m.needsSetup):(console.error("Error checking setup:",m.error),a(!1))}catch(d){console.error("Error checking setup:",d),a(!1)}finally{o(!1)}};if(r||l)return u.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-slate-600",children:"Loading..."})]})});if(i)return u.jsx(Kw,{});if(!e||!t)return u.jsx(Gw,{});if(t.temporary_password)return u.jsx(Xw,{});const f=()=>{switch(n){case"dashboard":return u.jsx(ph,{});case"campuses":return u.jsx(Yw,{});case"buildings":return u.jsx(Jw,{});case"key-systems":return u.jsx(Qw,{});case"keys":return u.jsx(zA,{});case"reports":return u.jsx(HA,{});case"users":return u.jsx(KA,{});case"audit-logs":return u.jsx(GA,{});case"error-reports":return u.jsx(XA,{});case"backup":return u.jsx(qA,{});case"system-config":return u.jsx(YA,{});default:return u.jsx(ph,{})}};return u.jsx(qw,{currentView:n,onNavigate:s,children:f()})}function QA(){return u.jsx(Fw,{children:u.jsx(JA,{})})}p1(document.getElementById("root")).render(u.jsx(ee.StrictMode,{children:u.jsx(QA,{})}));
