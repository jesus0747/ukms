(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function HT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var mx={exports:{}},Pu={},gx={exports:{}},De={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pl=Symbol.for("react.element"),$T=Symbol.for("react.portal"),KT=Symbol.for("react.fragment"),GT=Symbol.for("react.strict_mode"),WT=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),qT=Symbol.for("react.context"),YT=Symbol.for("react.forward_ref"),QT=Symbol.for("react.suspense"),XT=Symbol.for("react.memo"),JT=Symbol.for("react.lazy"),pm=Symbol.iterator;function ZT(t){return t===null||typeof t!="object"?null:(t=pm&&t[pm]||t["@@iterator"],typeof t=="function"?t:null)}var vx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xx=Object.assign,yx={};function Ha(t,e,r){this.props=t,this.context=e,this.refs=yx,this.updater=r||vx}Ha.prototype.isReactComponent={};Ha.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ha.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function wx(){}wx.prototype=Ha.prototype;function Yf(t,e,r){this.props=t,this.context=e,this.refs=yx,this.updater=r||vx}var Qf=Yf.prototype=new wx;Qf.constructor=Yf;xx(Qf,Ha.prototype);Qf.isPureReactComponent=!0;var mm=Array.isArray,_x=Object.prototype.hasOwnProperty,Xf={current:null},Ex={key:!0,ref:!0,__self:!0,__source:!0};function Tx(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)_x.call(e,n)&&!Ex.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:pl,type:t,key:i,ref:a,props:s,_owner:Xf.current}}function eC(t,e){return{$$typeof:pl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jf(t){return typeof t=="object"&&t!==null&&t.$$typeof===pl}function tC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var gm=/\/+/g;function Ad(t,e){return typeof t=="object"&&t!==null&&t.key!=null?tC(""+t.key):e.toString(36)}function yc(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case pl:case $T:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+Ad(a,0):n,mm(s)?(r="",t!=null&&(r=t.replace(gm,"$&/")+"/"),yc(s,e,r,"",function(u){return u})):s!=null&&(Jf(s)&&(s=eC(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(gm,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",mm(t))for(var o=0;o<t.length;o++){i=t[o];var l=n+Ad(i,o);a+=yc(i,e,r,l,s)}else if(l=ZT(t),typeof l=="function")for(t=l.call(t),o=0;!(i=t.next()).done;)i=i.value,l=n+Ad(i,o++),a+=yc(i,e,r,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ml(t,e,r){if(t==null)return t;var n=[],s=0;return yc(t,n,"","",function(i){return e.call(r,i,s++)}),n}function rC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pr={current:null},wc={transition:null},nC={ReactCurrentDispatcher:pr,ReactCurrentBatchConfig:wc,ReactCurrentOwner:Xf};function Cx(){throw Error("act(...) is not supported in production builds of React.")}De.Children={map:Ml,forEach:function(t,e,r){Ml(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ml(t,function(){e++}),e},toArray:function(t){return Ml(t,function(e){return e})||[]},only:function(t){if(!Jf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};De.Component=Ha;De.Fragment=KT;De.Profiler=WT;De.PureComponent=Yf;De.StrictMode=GT;De.Suspense=QT;De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nC;De.act=Cx;De.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=xx({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=Xf.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)_x.call(e,l)&&!Ex.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:pl,type:t.type,key:s,ref:i,props:n,_owner:a}};De.createContext=function(t){return t={$$typeof:qT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VT,_context:t},t.Consumer=t};De.createElement=Tx;De.createFactory=function(t){var e=Tx.bind(null,t);return e.type=t,e};De.createRef=function(){return{current:null}};De.forwardRef=function(t){return{$$typeof:YT,render:t}};De.isValidElement=Jf;De.lazy=function(t){return{$$typeof:JT,_payload:{_status:-1,_result:t},_init:rC}};De.memo=function(t,e){return{$$typeof:XT,type:t,compare:e===void 0?null:e}};De.startTransition=function(t){var e=wc.transition;wc.transition={};try{t()}finally{wc.transition=e}};De.unstable_act=Cx;De.useCallback=function(t,e){return pr.current.useCallback(t,e)};De.useContext=function(t){return pr.current.useContext(t)};De.useDebugValue=function(){};De.useDeferredValue=function(t){return pr.current.useDeferredValue(t)};De.useEffect=function(t,e){return pr.current.useEffect(t,e)};De.useId=function(){return pr.current.useId()};De.useImperativeHandle=function(t,e,r){return pr.current.useImperativeHandle(t,e,r)};De.useInsertionEffect=function(t,e){return pr.current.useInsertionEffect(t,e)};De.useLayoutEffect=function(t,e){return pr.current.useLayoutEffect(t,e)};De.useMemo=function(t,e){return pr.current.useMemo(t,e)};De.useReducer=function(t,e,r){return pr.current.useReducer(t,e,r)};De.useRef=function(t){return pr.current.useRef(t)};De.useState=function(t){return pr.current.useState(t)};De.useSyncExternalStore=function(t,e,r){return pr.current.useSyncExternalStore(t,e,r)};De.useTransition=function(){return pr.current.useTransition()};De.version="18.3.1";gx.exports=De;var Y=gx.exports;const sC=HT(Y);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iC=Y,aC=Symbol.for("react.element"),oC=Symbol.for("react.fragment"),lC=Object.prototype.hasOwnProperty,cC=iC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uC={key:!0,ref:!0,__self:!0,__source:!0};function Sx(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)lC.call(e,n)&&!uC.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:aC,type:t,key:i,ref:a,props:s,_owner:cC.current}}Pu.Fragment=oC;Pu.jsx=Sx;Pu.jsxs=Sx;mx.exports=Pu;var c=mx.exports,Ax={exports:{}},Br={},bx={exports:{}},kx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(se,fe){var Ee=se.length;se.push(fe);e:for(;0<Ee;){var X=Ee-1>>>1,N=se[X];if(0<s(N,fe))se[X]=fe,se[Ee]=N,Ee=X;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var fe=se[0],Ee=se.pop();if(Ee!==fe){se[0]=Ee;e:for(var X=0,N=se.length,F=N>>>1;X<F;){var D=2*(X+1)-1,M=se[D],J=D+1,xe=se[J];if(0>s(M,Ee))J<N&&0>s(xe,M)?(se[X]=xe,se[J]=Ee,X=J):(se[X]=M,se[D]=Ee,X=D);else if(J<N&&0>s(xe,Ee))se[X]=xe,se[J]=Ee,X=J;else break e}}return fe}function s(se,fe){var Ee=se.sortIndex-fe.sortIndex;return Ee!==0?Ee:se.id-fe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(se){for(var fe=r(u);fe!==null;){if(fe.callback===null)n(u);else if(fe.startTime<=se)n(u),fe.sortIndex=fe.expirationTime,e(l,fe);else break;fe=r(u)}}function _(se){if(m=!1,x(se),!g)if(r(l)!==null)g=!0,ne(P);else{var fe=r(u);fe!==null&&Ce(_,fe.startTime-se)}}function P(se,fe){g=!1,m&&(m=!1,v(O),O=-1),p=!0;var Ee=f;try{for(x(fe),h=r(l);h!==null&&(!(h.expirationTime>fe)||se&&!G());){var X=h.callback;if(typeof X=="function"){h.callback=null,f=h.priorityLevel;var N=X(h.expirationTime<=fe);fe=t.unstable_now(),typeof N=="function"?h.callback=N:h===r(l)&&n(l),x(fe)}else n(l);h=r(l)}if(h!==null)var F=!0;else{var D=r(u);D!==null&&Ce(_,D.startTime-fe),F=!1}return F}finally{h=null,f=Ee,p=!1}}var S=!1,T=null,O=-1,L=5,j=-1;function G(){return!(t.unstable_now()-j<L)}function W(){if(T!==null){var se=t.unstable_now();j=se;var fe=!0;try{fe=T(!0,se)}finally{fe?re():(S=!1,T=null)}}else S=!1}var re;if(typeof y=="function")re=function(){y(W)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,me=te.port2;te.port1.onmessage=W,re=function(){me.postMessage(null)}}else re=function(){w(W,0)};function ne(se){T=se,S||(S=!0,re())}function Ce(se,fe){O=w(function(){se(t.unstable_now())},fe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,ne(P))},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(se){switch(f){case 1:case 2:case 3:var fe=3;break;default:fe=f}var Ee=f;f=fe;try{return se()}finally{f=Ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(se,fe){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Ee=f;f=se;try{return fe()}finally{f=Ee}},t.unstable_scheduleCallback=function(se,fe,Ee){var X=t.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?X+Ee:X):Ee=X,se){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=Ee+N,se={id:d++,callback:fe,priorityLevel:se,startTime:Ee,expirationTime:N,sortIndex:-1},Ee>X?(se.sortIndex=Ee,e(u,se),r(l)===null&&se===r(u)&&(m?(v(O),O=-1):m=!0,Ce(_,Ee-X))):(se.sortIndex=N,e(l,se),g||p||(g=!0,ne(P))),se},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(se){var fe=f;return function(){var Ee=f;f=fe;try{return se.apply(this,arguments)}finally{f=Ee}}}})(kx);bx.exports=kx;var dC=bx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hC=Y,Fr=dC;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ix=new Set,Bo={};function Ci(t,e){Aa(t,e),Aa(t+"Capture",e)}function Aa(t,e){for(Bo[t]=e,t=0;t<e.length;t++)Ix.add(e[t])}var rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eh=Object.prototype.hasOwnProperty,fC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vm={},xm={};function pC(t){return Eh.call(xm,t)?!0:Eh.call(vm,t)?!1:fC.test(t)?xm[t]=!0:(vm[t]=!0,!1)}function mC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gC(t,e,r,n){if(e===null||typeof e>"u"||mC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mr(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new mr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new mr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new mr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new mr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new mr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new mr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new mr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new mr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new mr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zf=/[\-:]([a-z])/g;function e0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zf,e0);Yt[e]=new mr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zf,e0);Yt[e]=new mr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zf,e0);Yt[e]=new mr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new mr(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new mr(t,1,!1,t.toLowerCase(),null,!0,!0)});function t0(t,e,r,n){var s=Yt.hasOwnProperty(e)?Yt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gC(e,r,s,n)&&(r=null),n||s===null?pC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var cs=hC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dl=Symbol.for("react.element"),Ji=Symbol.for("react.portal"),Zi=Symbol.for("react.fragment"),r0=Symbol.for("react.strict_mode"),Th=Symbol.for("react.profiler"),Nx=Symbol.for("react.provider"),Rx=Symbol.for("react.context"),n0=Symbol.for("react.forward_ref"),Ch=Symbol.for("react.suspense"),Sh=Symbol.for("react.suspense_list"),s0=Symbol.for("react.memo"),vs=Symbol.for("react.lazy"),Ox=Symbol.for("react.offscreen"),ym=Symbol.iterator;function to(t){return t===null||typeof t!="object"?null:(t=ym&&t[ym]||t["@@iterator"],typeof t=="function"?t:null)}var pt=Object.assign,bd;function ho(t){if(bd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);bd=e&&e[1]||""}return`
`+bd+t}var kd=!1;function Id(t,e){if(!t||kd)return"";kd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{kd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ho(t):""}function vC(t){switch(t.tag){case 5:return ho(t.type);case 16:return ho("Lazy");case 13:return ho("Suspense");case 19:return ho("SuspenseList");case 0:case 2:case 15:return t=Id(t.type,!1),t;case 11:return t=Id(t.type.render,!1),t;case 1:return t=Id(t.type,!0),t;default:return""}}function Ah(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zi:return"Fragment";case Ji:return"Portal";case Th:return"Profiler";case r0:return"StrictMode";case Ch:return"Suspense";case Sh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Rx:return(t.displayName||"Context")+".Consumer";case Nx:return(t._context.displayName||"Context")+".Provider";case n0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case s0:return e=t.displayName||null,e!==null?e:Ah(t.type)||"Memo";case vs:e=t._payload,t=t._init;try{return Ah(t(e))}catch{}}return null}function xC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ah(e);case 8:return e===r0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function js(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Px(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yC(t){var e=Px(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fl(t){t._valueTracker||(t._valueTracker=yC(t))}function Lx(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Px(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Oc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bh(t,e){var r=e.checked;return pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function wm(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=js(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jx(t,e){e=e.checked,e!=null&&t0(t,"checked",e,!1)}function kh(t,e){jx(t,e);var r=js(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ih(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ih(t,e.type,js(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _m(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ih(t,e,r){(e!=="number"||Oc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var fo=Array.isArray;function pa(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+js(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Nh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Em(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(le(92));if(fo(r)){if(1<r.length)throw Error(le(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:js(r)}}function Mx(t,e){var r=js(e.value),n=js(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Tm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Dx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Dx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ul,Fx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ul=Ul||document.createElement("div"),Ul.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ul.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ho(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var yo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wC=["Webkit","ms","Moz","O"];Object.keys(yo).forEach(function(t){wC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),yo[e]=yo[t]})});function Ux(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||yo.hasOwnProperty(t)&&yo[t]?(""+e).trim():e+"px"}function Bx(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Ux(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var _C=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oh(t,e){if(e){if(_C[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function Ph(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function i0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jh=null,ma=null,ga=null;function Cm(t){if(t=vl(t)){if(typeof jh!="function")throw Error(le(280));var e=t.stateNode;e&&(e=Fu(e),jh(t.stateNode,t.type,e))}}function Hx(t){ma?ga?ga.push(t):ga=[t]:ma=t}function zx(){if(ma){var t=ma,e=ga;if(ga=ma=null,Cm(t),e)for(t=0;t<e.length;t++)Cm(e[t])}}function $x(t,e){return t(e)}function Kx(){}var Nd=!1;function Gx(t,e,r){if(Nd)return t(e,r);Nd=!0;try{return $x(t,e,r)}finally{Nd=!1,(ma!==null||ga!==null)&&(Kx(),zx())}}function zo(t,e){var r=t.stateNode;if(r===null)return null;var n=Fu(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(le(231,e,typeof r));return r}var Mh=!1;if(rs)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){Mh=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{Mh=!1}function EC(t,e,r,n,s,i,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var wo=!1,Pc=null,Lc=!1,Dh=null,TC={onError:function(t){wo=!0,Pc=t}};function CC(t,e,r,n,s,i,a,o,l){wo=!1,Pc=null,EC.apply(TC,arguments)}function SC(t,e,r,n,s,i,a,o,l){if(CC.apply(this,arguments),wo){if(wo){var u=Pc;wo=!1,Pc=null}else throw Error(le(198));Lc||(Lc=!0,Dh=u)}}function Si(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Wx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sm(t){if(Si(t)!==t)throw Error(le(188))}function AC(t){var e=t.alternate;if(!e){if(e=Si(t),e===null)throw Error(le(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return Sm(s),t;if(i===n)return Sm(s),e;i=i.sibling}throw Error(le(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a)throw Error(le(189))}}if(r.alternate!==n)throw Error(le(190))}if(r.tag!==3)throw Error(le(188));return r.stateNode.current===r?t:e}function Vx(t){return t=AC(t),t!==null?qx(t):null}function qx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=qx(t);if(e!==null)return e;t=t.sibling}return null}var Yx=Fr.unstable_scheduleCallback,Am=Fr.unstable_cancelCallback,bC=Fr.unstable_shouldYield,kC=Fr.unstable_requestPaint,xt=Fr.unstable_now,IC=Fr.unstable_getCurrentPriorityLevel,a0=Fr.unstable_ImmediatePriority,Qx=Fr.unstable_UserBlockingPriority,jc=Fr.unstable_NormalPriority,NC=Fr.unstable_LowPriority,Xx=Fr.unstable_IdlePriority,Lu=null,Pn=null;function RC(t){if(Pn&&typeof Pn.onCommitFiberRoot=="function")try{Pn.onCommitFiberRoot(Lu,t,void 0,(t.current.flags&128)===128)}catch{}}var mn=Math.clz32?Math.clz32:LC,OC=Math.log,PC=Math.LN2;function LC(t){return t>>>=0,t===0?32:31-(OC(t)/PC|0)|0}var Bl=64,Hl=4194304;function po(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Mc(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var o=a&~s;o!==0?n=po(o):(i&=a,i!==0&&(n=po(i)))}else a=r&~s,a!==0?n=po(a):i!==0&&(n=po(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-mn(e),s=1<<r,n|=t[r],e&=~s;return n}function jC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function MC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-mn(i),o=1<<a,l=s[a];l===-1?(!(o&r)||o&n)&&(s[a]=jC(o,e)):l<=e&&(t.expiredLanes|=o),i&=~o}}function Fh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Jx(){var t=Bl;return Bl<<=1,!(Bl&4194240)&&(Bl=64),t}function Rd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function ml(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mn(e),t[e]=r}function DC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-mn(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function o0(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-mn(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Ve=0;function Zx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ey,l0,ty,ry,ny,Uh=!1,zl=[],As=null,bs=null,ks=null,$o=new Map,Ko=new Map,ys=[],FC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bm(t,e){switch(t){case"focusin":case"focusout":As=null;break;case"dragenter":case"dragleave":bs=null;break;case"mouseover":case"mouseout":ks=null;break;case"pointerover":case"pointerout":$o.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ko.delete(e.pointerId)}}function no(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=vl(e),e!==null&&l0(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function UC(t,e,r,n,s){switch(e){case"focusin":return As=no(As,t,e,r,n,s),!0;case"dragenter":return bs=no(bs,t,e,r,n,s),!0;case"mouseover":return ks=no(ks,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return $o.set(i,no($o.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Ko.set(i,no(Ko.get(i)||null,t,e,r,n,s)),!0}return!1}function sy(t){var e=ni(t.target);if(e!==null){var r=Si(e);if(r!==null){if(e=r.tag,e===13){if(e=Wx(r),e!==null){t.blockedOn=e,ny(t.priority,function(){ty(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _c(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Bh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Lh=n,r.target.dispatchEvent(n),Lh=null}else return e=vl(r),e!==null&&l0(e),t.blockedOn=r,!1;e.shift()}return!0}function km(t,e,r){_c(t)&&r.delete(e)}function BC(){Uh=!1,As!==null&&_c(As)&&(As=null),bs!==null&&_c(bs)&&(bs=null),ks!==null&&_c(ks)&&(ks=null),$o.forEach(km),Ko.forEach(km)}function so(t,e){t.blockedOn===e&&(t.blockedOn=null,Uh||(Uh=!0,Fr.unstable_scheduleCallback(Fr.unstable_NormalPriority,BC)))}function Go(t){function e(s){return so(s,t)}if(0<zl.length){so(zl[0],t);for(var r=1;r<zl.length;r++){var n=zl[r];n.blockedOn===t&&(n.blockedOn=null)}}for(As!==null&&so(As,t),bs!==null&&so(bs,t),ks!==null&&so(ks,t),$o.forEach(e),Ko.forEach(e),r=0;r<ys.length;r++)n=ys[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<ys.length&&(r=ys[0],r.blockedOn===null);)sy(r),r.blockedOn===null&&ys.shift()}var va=cs.ReactCurrentBatchConfig,Dc=!0;function HC(t,e,r,n){var s=Ve,i=va.transition;va.transition=null;try{Ve=1,c0(t,e,r,n)}finally{Ve=s,va.transition=i}}function zC(t,e,r,n){var s=Ve,i=va.transition;va.transition=null;try{Ve=4,c0(t,e,r,n)}finally{Ve=s,va.transition=i}}function c0(t,e,r,n){if(Dc){var s=Bh(t,e,r,n);if(s===null)Hd(t,e,n,Fc,r),bm(t,n);else if(UC(s,t,e,r,n))n.stopPropagation();else if(bm(t,n),e&4&&-1<FC.indexOf(t)){for(;s!==null;){var i=vl(s);if(i!==null&&ey(i),i=Bh(t,e,r,n),i===null&&Hd(t,e,n,Fc,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else Hd(t,e,n,null,r)}}var Fc=null;function Bh(t,e,r,n){if(Fc=null,t=i0(n),t=ni(t),t!==null)if(e=Si(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Wx(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Fc=t,null}function iy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IC()){case a0:return 1;case Qx:return 4;case jc:case NC:return 16;case Xx:return 536870912;default:return 16}default:return 16}}var Es=null,u0=null,Ec=null;function ay(){if(Ec)return Ec;var t,e=u0,r=e.length,n,s="value"in Es?Es.value:Es.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Ec=s.slice(t,1<n?1-n:void 0)}function Tc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $l(){return!0}function Im(){return!1}function Hr(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$l:Im,this.isPropagationStopped=Im,this}return pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),e}var za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d0=Hr(za),gl=pt({},za,{view:0,detail:0}),$C=Hr(gl),Od,Pd,io,ju=pt({},gl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:h0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==io&&(io&&t.type==="mousemove"?(Od=t.screenX-io.screenX,Pd=t.screenY-io.screenY):Pd=Od=0,io=t),Od)},movementY:function(t){return"movementY"in t?t.movementY:Pd}}),Nm=Hr(ju),KC=pt({},ju,{dataTransfer:0}),GC=Hr(KC),WC=pt({},gl,{relatedTarget:0}),Ld=Hr(WC),VC=pt({},za,{animationName:0,elapsedTime:0,pseudoElement:0}),qC=Hr(VC),YC=pt({},za,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),QC=Hr(YC),XC=pt({},za,{data:0}),Rm=Hr(XC),JC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ZC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},eS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function tS(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=eS[t])?!!e[t]:!1}function h0(){return tS}var rS=pt({},gl,{key:function(t){if(t.key){var e=JC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ZC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:h0,charCode:function(t){return t.type==="keypress"?Tc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nS=Hr(rS),sS=pt({},ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Om=Hr(sS),iS=pt({},gl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:h0}),aS=Hr(iS),oS=pt({},za,{propertyName:0,elapsedTime:0,pseudoElement:0}),lS=Hr(oS),cS=pt({},ju,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uS=Hr(cS),dS=[9,13,27,32],f0=rs&&"CompositionEvent"in window,_o=null;rs&&"documentMode"in document&&(_o=document.documentMode);var hS=rs&&"TextEvent"in window&&!_o,oy=rs&&(!f0||_o&&8<_o&&11>=_o),Pm=" ",Lm=!1;function ly(t,e){switch(t){case"keyup":return dS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ea=!1;function fS(t,e){switch(t){case"compositionend":return cy(e);case"keypress":return e.which!==32?null:(Lm=!0,Pm);case"textInput":return t=e.data,t===Pm&&Lm?null:t;default:return null}}function pS(t,e){if(ea)return t==="compositionend"||!f0&&ly(t,e)?(t=ay(),Ec=u0=Es=null,ea=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return oy&&e.locale!=="ko"?null:e.data;default:return null}}var mS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!mS[t.type]:e==="textarea"}function uy(t,e,r,n){Hx(n),e=Uc(e,"onChange"),0<e.length&&(r=new d0("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Eo=null,Wo=null;function gS(t){_y(t,0)}function Mu(t){var e=na(t);if(Lx(e))return t}function vS(t,e){if(t==="change")return e}var dy=!1;if(rs){var jd;if(rs){var Md="oninput"in document;if(!Md){var Mm=document.createElement("div");Mm.setAttribute("oninput","return;"),Md=typeof Mm.oninput=="function"}jd=Md}else jd=!1;dy=jd&&(!document.documentMode||9<document.documentMode)}function Dm(){Eo&&(Eo.detachEvent("onpropertychange",hy),Wo=Eo=null)}function hy(t){if(t.propertyName==="value"&&Mu(Wo)){var e=[];uy(e,Wo,t,i0(t)),Gx(gS,e)}}function xS(t,e,r){t==="focusin"?(Dm(),Eo=e,Wo=r,Eo.attachEvent("onpropertychange",hy)):t==="focusout"&&Dm()}function yS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Mu(Wo)}function wS(t,e){if(t==="click")return Mu(e)}function _S(t,e){if(t==="input"||t==="change")return Mu(e)}function ES(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wn=typeof Object.is=="function"?Object.is:ES;function Vo(t,e){if(wn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Eh.call(e,s)||!wn(t[s],e[s]))return!1}return!0}function Fm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Um(t,e){var r=Fm(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Fm(r)}}function fy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?fy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function py(){for(var t=window,e=Oc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Oc(t.document)}return e}function p0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TS(t){var e=py(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&fy(r.ownerDocument.documentElement,r)){if(n!==null&&p0(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Um(r,i);var a=Um(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var CS=rs&&"documentMode"in document&&11>=document.documentMode,ta=null,Hh=null,To=null,zh=!1;function Bm(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zh||ta==null||ta!==Oc(n)||(n=ta,"selectionStart"in n&&p0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),To&&Vo(To,n)||(To=n,n=Uc(Hh,"onSelect"),0<n.length&&(e=new d0("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=ta)))}function Kl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ra={animationend:Kl("Animation","AnimationEnd"),animationiteration:Kl("Animation","AnimationIteration"),animationstart:Kl("Animation","AnimationStart"),transitionend:Kl("Transition","TransitionEnd")},Dd={},my={};rs&&(my=document.createElement("div").style,"AnimationEvent"in window||(delete ra.animationend.animation,delete ra.animationiteration.animation,delete ra.animationstart.animation),"TransitionEvent"in window||delete ra.transitionend.transition);function Du(t){if(Dd[t])return Dd[t];if(!ra[t])return t;var e=ra[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in my)return Dd[t]=e[r];return t}var gy=Du("animationend"),vy=Du("animationiteration"),xy=Du("animationstart"),yy=Du("transitionend"),wy=new Map,Hm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zs(t,e){wy.set(t,e),Ci(e,[t])}for(var Fd=0;Fd<Hm.length;Fd++){var Ud=Hm[Fd],SS=Ud.toLowerCase(),AS=Ud[0].toUpperCase()+Ud.slice(1);zs(SS,"on"+AS)}zs(gy,"onAnimationEnd");zs(vy,"onAnimationIteration");zs(xy,"onAnimationStart");zs("dblclick","onDoubleClick");zs("focusin","onFocus");zs("focusout","onBlur");zs(yy,"onTransitionEnd");Aa("onMouseEnter",["mouseout","mouseover"]);Aa("onMouseLeave",["mouseout","mouseover"]);Aa("onPointerEnter",["pointerout","pointerover"]);Aa("onPointerLeave",["pointerout","pointerover"]);Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bS=new Set("cancel close invalid load scroll toggle".split(" ").concat(mo));function zm(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,SC(n,e,void 0,t),t.currentTarget=null}function _y(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;zm(s,o,u),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;zm(s,o,u),i=l}}}if(Lc)throw t=Dh,Lc=!1,Dh=null,t}function rt(t,e){var r=e[Vh];r===void 0&&(r=e[Vh]=new Set);var n=t+"__bubble";r.has(n)||(Ey(e,t,2,!1),r.add(n))}function Bd(t,e,r){var n=0;e&&(n|=4),Ey(r,t,n,e)}var Gl="_reactListening"+Math.random().toString(36).slice(2);function qo(t){if(!t[Gl]){t[Gl]=!0,Ix.forEach(function(r){r!=="selectionchange"&&(bS.has(r)||Bd(r,!1,t),Bd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Gl]||(e[Gl]=!0,Bd("selectionchange",!1,e))}}function Ey(t,e,r,n){switch(iy(e)){case 1:var s=HC;break;case 4:s=zC;break;default:s=c0}r=s.bind(null,e,r,t),s=void 0,!Mh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Hd(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=ni(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}Gx(function(){var u=i,d=i0(r),h=[];e:{var f=wy.get(t);if(f!==void 0){var p=d0,g=t;switch(t){case"keypress":if(Tc(r)===0)break e;case"keydown":case"keyup":p=nS;break;case"focusin":g="focus",p=Ld;break;case"focusout":g="blur",p=Ld;break;case"beforeblur":case"afterblur":p=Ld;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Nm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=GC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=aS;break;case gy:case vy:case xy:p=qC;break;case yy:p=lS;break;case"scroll":p=$C;break;case"wheel":p=uS;break;case"copy":case"cut":case"paste":p=QC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Om}var m=(e&4)!==0,w=!m&&t==="scroll",v=m?f!==null?f+"Capture":null:f;m=[];for(var y=u,x;y!==null;){x=y;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,v!==null&&(_=zo(y,v),_!=null&&m.push(Yo(y,_,x)))),w)break;y=y.return}0<m.length&&(f=new p(f,g,null,r,d),h.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==Lh&&(g=r.relatedTarget||r.fromElement)&&(ni(g)||g[ns]))break e;if((p||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=u,g=g?ni(g):null,g!==null&&(w=Si(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(m=Nm,_="onMouseLeave",v="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=Om,_="onPointerLeave",v="onPointerEnter",y="pointer"),w=p==null?f:na(p),x=g==null?f:na(g),f=new m(_,y+"leave",p,r,d),f.target=w,f.relatedTarget=x,_=null,ni(d)===u&&(m=new m(v,y+"enter",g,r,d),m.target=x,m.relatedTarget=w,_=m),w=_,p&&g)t:{for(m=p,v=g,y=0,x=m;x;x=Mi(x))y++;for(x=0,_=v;_;_=Mi(_))x++;for(;0<y-x;)m=Mi(m),y--;for(;0<x-y;)v=Mi(v),x--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Mi(m),v=Mi(v)}m=null}else m=null;p!==null&&$m(h,f,p,m,!1),g!==null&&w!==null&&$m(h,w,g,m,!0)}}e:{if(f=u?na(u):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var P=vS;else if(jm(f))if(dy)P=_S;else{P=yS;var S=xS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=wS);if(P&&(P=P(t,u))){uy(h,P,r,d);break e}S&&S(t,f,u),t==="focusout"&&(S=f._wrapperState)&&S.controlled&&f.type==="number"&&Ih(f,"number",f.value)}switch(S=u?na(u):window,t){case"focusin":(jm(S)||S.contentEditable==="true")&&(ta=S,Hh=u,To=null);break;case"focusout":To=Hh=ta=null;break;case"mousedown":zh=!0;break;case"contextmenu":case"mouseup":case"dragend":zh=!1,Bm(h,r,d);break;case"selectionchange":if(CS)break;case"keydown":case"keyup":Bm(h,r,d)}var T;if(f0)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else ea?ly(t,r)&&(O="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(oy&&r.locale!=="ko"&&(ea||O!=="onCompositionStart"?O==="onCompositionEnd"&&ea&&(T=ay()):(Es=d,u0="value"in Es?Es.value:Es.textContent,ea=!0)),S=Uc(u,O),0<S.length&&(O=new Rm(O,t,null,r,d),h.push({event:O,listeners:S}),T?O.data=T:(T=cy(r),T!==null&&(O.data=T)))),(T=hS?fS(t,r):pS(t,r))&&(u=Uc(u,"onBeforeInput"),0<u.length&&(d=new Rm("onBeforeInput","beforeinput",null,r,d),h.push({event:d,listeners:u}),d.data=T))}_y(h,e)})}function Yo(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Uc(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=zo(t,r),i!=null&&n.unshift(Yo(t,i,s)),i=zo(t,e),i!=null&&n.push(Yo(t,i,s))),t=t.return}return n}function Mi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function $m(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=zo(r,i),l!=null&&a.unshift(Yo(r,l,o))):s||(l=zo(r,i),l!=null&&a.push(Yo(r,l,o)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var kS=/\r\n?/g,IS=/\u0000|\uFFFD/g;function Km(t){return(typeof t=="string"?t:""+t).replace(kS,`
`).replace(IS,"")}function Wl(t,e,r){if(e=Km(e),Km(t)!==e&&r)throw Error(le(425))}function Bc(){}var $h=null,Kh=null;function Gh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wh=typeof setTimeout=="function"?setTimeout:void 0,NS=typeof clearTimeout=="function"?clearTimeout:void 0,Gm=typeof Promise=="function"?Promise:void 0,RS=typeof queueMicrotask=="function"?queueMicrotask:typeof Gm<"u"?function(t){return Gm.resolve(null).then(t).catch(OS)}:Wh;function OS(t){setTimeout(function(){throw t})}function zd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Go(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Go(e)}function Is(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Wm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var $a=Math.random().toString(36).slice(2),In="__reactFiber$"+$a,Qo="__reactProps$"+$a,ns="__reactContainer$"+$a,Vh="__reactEvents$"+$a,PS="__reactListeners$"+$a,LS="__reactHandles$"+$a;function ni(t){var e=t[In];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ns]||r[In]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Wm(t);t!==null;){if(r=t[In])return r;t=Wm(t)}return e}t=r,r=t.parentNode}return null}function vl(t){return t=t[In]||t[ns],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function na(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function Fu(t){return t[Qo]||null}var qh=[],sa=-1;function $s(t){return{current:t}}function st(t){0>sa||(t.current=qh[sa],qh[sa]=null,sa--)}function tt(t,e){sa++,qh[sa]=t.current,t.current=e}var Ms={},ir=$s(Ms),wr=$s(!1),hi=Ms;function ba(t,e){var r=t.type.contextTypes;if(!r)return Ms;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function _r(t){return t=t.childContextTypes,t!=null}function Hc(){st(wr),st(ir)}function Vm(t,e,r){if(ir.current!==Ms)throw Error(le(168));tt(ir,e),tt(wr,r)}function Ty(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(le(108,xC(t)||"Unknown",s));return pt({},r,n)}function zc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ms,hi=ir.current,tt(ir,t),tt(wr,wr.current),!0}function qm(t,e,r){var n=t.stateNode;if(!n)throw Error(le(169));r?(t=Ty(t,e,hi),n.__reactInternalMemoizedMergedChildContext=t,st(wr),st(ir),tt(ir,t)):st(wr),tt(wr,r)}var Gn=null,Uu=!1,$d=!1;function Cy(t){Gn===null?Gn=[t]:Gn.push(t)}function jS(t){Uu=!0,Cy(t)}function Ks(){if(!$d&&Gn!==null){$d=!0;var t=0,e=Ve;try{var r=Gn;for(Ve=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Gn=null,Uu=!1}catch(s){throw Gn!==null&&(Gn=Gn.slice(t+1)),Yx(a0,Ks),s}finally{Ve=e,$d=!1}}return null}var ia=[],aa=0,$c=null,Kc=0,Wr=[],Vr=0,fi=null,Wn=1,Vn="";function Xs(t,e){ia[aa++]=Kc,ia[aa++]=$c,$c=t,Kc=e}function Sy(t,e,r){Wr[Vr++]=Wn,Wr[Vr++]=Vn,Wr[Vr++]=fi,fi=t;var n=Wn;t=Vn;var s=32-mn(n)-1;n&=~(1<<s),r+=1;var i=32-mn(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Wn=1<<32-mn(e)+s|r<<s|n,Vn=i+t}else Wn=1<<i|r<<s|n,Vn=t}function m0(t){t.return!==null&&(Xs(t,1),Sy(t,1,0))}function g0(t){for(;t===$c;)$c=ia[--aa],ia[aa]=null,Kc=ia[--aa],ia[aa]=null;for(;t===fi;)fi=Wr[--Vr],Wr[Vr]=null,Vn=Wr[--Vr],Wr[Vr]=null,Wn=Wr[--Vr],Wr[Vr]=null}var Dr=null,jr=null,ot=!1,dn=null;function Ay(t,e){var r=Yr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Ym(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dr=t,jr=Is(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dr=t,jr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=fi!==null?{id:Wn,overflow:Vn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Yr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Dr=t,jr=null,!0):!1;default:return!1}}function Yh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Qh(t){if(ot){var e=jr;if(e){var r=e;if(!Ym(t,e)){if(Yh(t))throw Error(le(418));e=Is(r.nextSibling);var n=Dr;e&&Ym(t,e)?Ay(n,r):(t.flags=t.flags&-4097|2,ot=!1,Dr=t)}}else{if(Yh(t))throw Error(le(418));t.flags=t.flags&-4097|2,ot=!1,Dr=t}}}function Qm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dr=t}function Vl(t){if(t!==Dr)return!1;if(!ot)return Qm(t),ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gh(t.type,t.memoizedProps)),e&&(e=jr)){if(Yh(t))throw by(),Error(le(418));for(;e;)Ay(t,e),e=Is(e.nextSibling)}if(Qm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){jr=Is(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}jr=null}}else jr=Dr?Is(t.stateNode.nextSibling):null;return!0}function by(){for(var t=jr;t;)t=Is(t.nextSibling)}function ka(){jr=Dr=null,ot=!1}function v0(t){dn===null?dn=[t]:dn.push(t)}var MS=cs.ReactCurrentBatchConfig;function ao(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(le(309));var n=r.stateNode}if(!n)throw Error(le(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(le(284));if(!r._owner)throw Error(le(290,t))}return t}function ql(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Xm(t){var e=t._init;return e(t._payload)}function ky(t){function e(v,y){if(t){var x=v.deletions;x===null?(v.deletions=[y],v.flags|=16):x.push(y)}}function r(v,y){if(!t)return null;for(;y!==null;)e(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function s(v,y){return v=Ps(v,y),v.index=0,v.sibling=null,v}function i(v,y,x){return v.index=x,t?(x=v.alternate,x!==null?(x=x.index,x<y?(v.flags|=2,y):x):(v.flags|=2,y)):(v.flags|=1048576,y)}function a(v){return t&&v.alternate===null&&(v.flags|=2),v}function o(v,y,x,_){return y===null||y.tag!==6?(y=Qd(x,v.mode,_),y.return=v,y):(y=s(y,x),y.return=v,y)}function l(v,y,x,_){var P=x.type;return P===Zi?d(v,y,x.props.children,_,x.key):y!==null&&(y.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===vs&&Xm(P)===y.type)?(_=s(y,x.props),_.ref=ao(v,y,x),_.return=v,_):(_=Nc(x.type,x.key,x.props,null,v.mode,_),_.ref=ao(v,y,x),_.return=v,_)}function u(v,y,x,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Xd(x,v.mode,_),y.return=v,y):(y=s(y,x.children||[]),y.return=v,y)}function d(v,y,x,_,P){return y===null||y.tag!==7?(y=ci(x,v.mode,_,P),y.return=v,y):(y=s(y,x),y.return=v,y)}function h(v,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Qd(""+y,v.mode,x),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Dl:return x=Nc(y.type,y.key,y.props,null,v.mode,x),x.ref=ao(v,null,y),x.return=v,x;case Ji:return y=Xd(y,v.mode,x),y.return=v,y;case vs:var _=y._init;return h(v,_(y._payload),x)}if(fo(y)||to(y))return y=ci(y,v.mode,x,null),y.return=v,y;ql(v,y)}return null}function f(v,y,x,_){var P=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return P!==null?null:o(v,y,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Dl:return x.key===P?l(v,y,x,_):null;case Ji:return x.key===P?u(v,y,x,_):null;case vs:return P=x._init,f(v,y,P(x._payload),_)}if(fo(x)||to(x))return P!==null?null:d(v,y,x,_,null);ql(v,x)}return null}function p(v,y,x,_,P){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(x)||null,o(y,v,""+_,P);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Dl:return v=v.get(_.key===null?x:_.key)||null,l(y,v,_,P);case Ji:return v=v.get(_.key===null?x:_.key)||null,u(y,v,_,P);case vs:var S=_._init;return p(v,y,x,S(_._payload),P)}if(fo(_)||to(_))return v=v.get(x)||null,d(y,v,_,P,null);ql(y,_)}return null}function g(v,y,x,_){for(var P=null,S=null,T=y,O=y=0,L=null;T!==null&&O<x.length;O++){T.index>O?(L=T,T=null):L=T.sibling;var j=f(v,T,x[O],_);if(j===null){T===null&&(T=L);break}t&&T&&j.alternate===null&&e(v,T),y=i(j,y,O),S===null?P=j:S.sibling=j,S=j,T=L}if(O===x.length)return r(v,T),ot&&Xs(v,O),P;if(T===null){for(;O<x.length;O++)T=h(v,x[O],_),T!==null&&(y=i(T,y,O),S===null?P=T:S.sibling=T,S=T);return ot&&Xs(v,O),P}for(T=n(v,T);O<x.length;O++)L=p(T,v,O,x[O],_),L!==null&&(t&&L.alternate!==null&&T.delete(L.key===null?O:L.key),y=i(L,y,O),S===null?P=L:S.sibling=L,S=L);return t&&T.forEach(function(G){return e(v,G)}),ot&&Xs(v,O),P}function m(v,y,x,_){var P=to(x);if(typeof P!="function")throw Error(le(150));if(x=P.call(x),x==null)throw Error(le(151));for(var S=P=null,T=y,O=y=0,L=null,j=x.next();T!==null&&!j.done;O++,j=x.next()){T.index>O?(L=T,T=null):L=T.sibling;var G=f(v,T,j.value,_);if(G===null){T===null&&(T=L);break}t&&T&&G.alternate===null&&e(v,T),y=i(G,y,O),S===null?P=G:S.sibling=G,S=G,T=L}if(j.done)return r(v,T),ot&&Xs(v,O),P;if(T===null){for(;!j.done;O++,j=x.next())j=h(v,j.value,_),j!==null&&(y=i(j,y,O),S===null?P=j:S.sibling=j,S=j);return ot&&Xs(v,O),P}for(T=n(v,T);!j.done;O++,j=x.next())j=p(T,v,O,j.value,_),j!==null&&(t&&j.alternate!==null&&T.delete(j.key===null?O:j.key),y=i(j,y,O),S===null?P=j:S.sibling=j,S=j);return t&&T.forEach(function(W){return e(v,W)}),ot&&Xs(v,O),P}function w(v,y,x,_){if(typeof x=="object"&&x!==null&&x.type===Zi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Dl:e:{for(var P=x.key,S=y;S!==null;){if(S.key===P){if(P=x.type,P===Zi){if(S.tag===7){r(v,S.sibling),y=s(S,x.props.children),y.return=v,v=y;break e}}else if(S.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===vs&&Xm(P)===S.type){r(v,S.sibling),y=s(S,x.props),y.ref=ao(v,S,x),y.return=v,v=y;break e}r(v,S);break}else e(v,S);S=S.sibling}x.type===Zi?(y=ci(x.props.children,v.mode,_,x.key),y.return=v,v=y):(_=Nc(x.type,x.key,x.props,null,v.mode,_),_.ref=ao(v,y,x),_.return=v,v=_)}return a(v);case Ji:e:{for(S=x.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(v,y.sibling),y=s(y,x.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else e(v,y);y=y.sibling}y=Xd(x,v.mode,_),y.return=v,v=y}return a(v);case vs:return S=x._init,w(v,y,S(x._payload),_)}if(fo(x))return g(v,y,x,_);if(to(x))return m(v,y,x,_);ql(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(v,y.sibling),y=s(y,x),y.return=v,v=y):(r(v,y),y=Qd(x,v.mode,_),y.return=v,v=y),a(v)):r(v,y)}return w}var Ia=ky(!0),Iy=ky(!1),Gc=$s(null),Wc=null,oa=null,x0=null;function y0(){x0=oa=Wc=null}function w0(t){var e=Gc.current;st(Gc),t._currentValue=e}function Xh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function xa(t,e){Wc=t,x0=oa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yr=!0),t.firstContext=null)}function Jr(t){var e=t._currentValue;if(x0!==t)if(t={context:t,memoizedValue:e,next:null},oa===null){if(Wc===null)throw Error(le(308));oa=t,Wc.dependencies={lanes:0,firstContext:t}}else oa=oa.next=t;return e}var si=null;function _0(t){si===null?si=[t]:si.push(t)}function Ny(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,_0(e)):(r.next=s.next,s.next=r),e.interleaved=r,ss(t,n)}function ss(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var xs=!1;function E0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ry(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Xn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ns(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ue&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,ss(t,r)}return s=n.interleaved,s===null?(e.next=e,_0(n)):(e.next=s.next,s.next=e),n.interleaved=e,ss(t,r)}function Cc(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,o0(t,r)}}function Jm(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Vc(t,e,r,n){var s=t.updateQueue;xs=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?i=u:a.next=u,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;a=0,d=u=l=null,o=i;do{var f=o.lane,p=o.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=t,m=o;switch(f=e,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=pt({},h,f);break e;case 2:xs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,l=h):d=d.next=p,a|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);mi|=a,t.lanes=a,t.memoizedState=h}}function Zm(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(le(191,s));s.call(n)}}}var xl={},Ln=$s(xl),Xo=$s(xl),Jo=$s(xl);function ii(t){if(t===xl)throw Error(le(174));return t}function T0(t,e){switch(tt(Jo,e),tt(Xo,t),tt(Ln,xl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Rh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Rh(e,t)}st(Ln),tt(Ln,e)}function Na(){st(Ln),st(Xo),st(Jo)}function Oy(t){ii(Jo.current);var e=ii(Ln.current),r=Rh(e,t.type);e!==r&&(tt(Xo,t),tt(Ln,r))}function C0(t){Xo.current===t&&(st(Ln),st(Xo))}var dt=$s(0);function qc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Kd=[];function S0(){for(var t=0;t<Kd.length;t++)Kd[t]._workInProgressVersionPrimary=null;Kd.length=0}var Sc=cs.ReactCurrentDispatcher,Gd=cs.ReactCurrentBatchConfig,pi=0,ft=null,Nt=null,jt=null,Yc=!1,Co=!1,Zo=0,DS=0;function Jt(){throw Error(le(321))}function A0(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!wn(t[r],e[r]))return!1;return!0}function b0(t,e,r,n,s,i){if(pi=i,ft=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sc.current=t===null||t.memoizedState===null?HS:zS,t=r(n,s),Co){i=0;do{if(Co=!1,Zo=0,25<=i)throw Error(le(301));i+=1,jt=Nt=null,e.updateQueue=null,Sc.current=$S,t=r(n,s)}while(Co)}if(Sc.current=Qc,e=Nt!==null&&Nt.next!==null,pi=0,jt=Nt=ft=null,Yc=!1,e)throw Error(le(300));return t}function k0(){var t=Zo!==0;return Zo=0,t}function bn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?ft.memoizedState=jt=t:jt=jt.next=t,jt}function Zr(){if(Nt===null){var t=ft.alternate;t=t!==null?t.memoizedState:null}else t=Nt.next;var e=jt===null?ft.memoizedState:jt.next;if(e!==null)jt=e,Nt=t;else{if(t===null)throw Error(le(310));Nt=t,t={memoizedState:Nt.memoizedState,baseState:Nt.baseState,baseQueue:Nt.baseQueue,queue:Nt.queue,next:null},jt===null?ft.memoizedState=jt=t:jt=jt.next=t}return jt}function el(t,e){return typeof e=="function"?e(t):e}function Wd(t){var e=Zr(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=Nt,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var o=a=null,l=null,u=i;do{var d=u.lane;if((pi&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,ft.lanes|=d,mi|=d}u=u.next}while(u!==null&&u!==i);l===null?a=n:l.next=o,wn(n,e.memoizedState)||(yr=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,ft.lanes|=i,mi|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Vd(t){var e=Zr(),r=e.queue;if(r===null)throw Error(le(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);wn(i,e.memoizedState)||(yr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function Py(){}function Ly(t,e){var r=ft,n=Zr(),s=e(),i=!wn(n.memoizedState,s);if(i&&(n.memoizedState=s,yr=!0),n=n.queue,I0(Dy.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||jt!==null&&jt.memoizedState.tag&1){if(r.flags|=2048,tl(9,My.bind(null,r,n,s,e),void 0,null),Bt===null)throw Error(le(349));pi&30||jy(r,e,s)}return s}function jy(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function My(t,e,r,n){e.value=r,e.getSnapshot=n,Fy(e)&&Uy(t)}function Dy(t,e,r){return r(function(){Fy(e)&&Uy(t)})}function Fy(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!wn(t,r)}catch{return!0}}function Uy(t){var e=ss(t,1);e!==null&&gn(e,t,1,-1)}function eg(t){var e=bn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:el,lastRenderedState:t},e.queue=t,t=t.dispatch=BS.bind(null,ft,t),[e.memoizedState,t]}function tl(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=ft.updateQueue,e===null?(e={lastEffect:null,stores:null},ft.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function By(){return Zr().memoizedState}function Ac(t,e,r,n){var s=bn();ft.flags|=t,s.memoizedState=tl(1|e,r,void 0,n===void 0?null:n)}function Bu(t,e,r,n){var s=Zr();n=n===void 0?null:n;var i=void 0;if(Nt!==null){var a=Nt.memoizedState;if(i=a.destroy,n!==null&&A0(n,a.deps)){s.memoizedState=tl(e,r,i,n);return}}ft.flags|=t,s.memoizedState=tl(1|e,r,i,n)}function tg(t,e){return Ac(8390656,8,t,e)}function I0(t,e){return Bu(2048,8,t,e)}function Hy(t,e){return Bu(4,2,t,e)}function zy(t,e){return Bu(4,4,t,e)}function $y(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ky(t,e,r){return r=r!=null?r.concat([t]):null,Bu(4,4,$y.bind(null,e,t),r)}function N0(){}function Gy(t,e){var r=Zr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&A0(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Wy(t,e){var r=Zr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&A0(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Vy(t,e,r){return pi&21?(wn(r,e)||(r=Jx(),ft.lanes|=r,mi|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yr=!0),t.memoizedState=r)}function FS(t,e){var r=Ve;Ve=r!==0&&4>r?r:4,t(!0);var n=Gd.transition;Gd.transition={};try{t(!1),e()}finally{Ve=r,Gd.transition=n}}function qy(){return Zr().memoizedState}function US(t,e,r){var n=Os(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Yy(t))Qy(e,r);else if(r=Ny(t,e,r,n),r!==null){var s=hr();gn(r,t,n,s),Xy(r,e,n)}}function BS(t,e,r){var n=Os(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Yy(t))Qy(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,r);if(s.hasEagerState=!0,s.eagerState=o,wn(o,a)){var l=e.interleaved;l===null?(s.next=s,_0(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=Ny(t,e,s,n),r!==null&&(s=hr(),gn(r,t,n,s),Xy(r,e,n))}}function Yy(t){var e=t.alternate;return t===ft||e!==null&&e===ft}function Qy(t,e){Co=Yc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Xy(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,o0(t,r)}}var Qc={readContext:Jr,useCallback:Jt,useContext:Jt,useEffect:Jt,useImperativeHandle:Jt,useInsertionEffect:Jt,useLayoutEffect:Jt,useMemo:Jt,useReducer:Jt,useRef:Jt,useState:Jt,useDebugValue:Jt,useDeferredValue:Jt,useTransition:Jt,useMutableSource:Jt,useSyncExternalStore:Jt,useId:Jt,unstable_isNewReconciler:!1},HS={readContext:Jr,useCallback:function(t,e){return bn().memoizedState=[t,e===void 0?null:e],t},useContext:Jr,useEffect:tg,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ac(4194308,4,$y.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ac(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ac(4,2,t,e)},useMemo:function(t,e){var r=bn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=bn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=US.bind(null,ft,t),[n.memoizedState,t]},useRef:function(t){var e=bn();return t={current:t},e.memoizedState=t},useState:eg,useDebugValue:N0,useDeferredValue:function(t){return bn().memoizedState=t},useTransition:function(){var t=eg(!1),e=t[0];return t=FS.bind(null,t[1]),bn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=ft,s=bn();if(ot){if(r===void 0)throw Error(le(407));r=r()}else{if(r=e(),Bt===null)throw Error(le(349));pi&30||jy(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,tg(Dy.bind(null,n,i,t),[t]),n.flags|=2048,tl(9,My.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=bn(),e=Bt.identifierPrefix;if(ot){var r=Vn,n=Wn;r=(n&~(1<<32-mn(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Zo++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=DS++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zS={readContext:Jr,useCallback:Gy,useContext:Jr,useEffect:I0,useImperativeHandle:Ky,useInsertionEffect:Hy,useLayoutEffect:zy,useMemo:Wy,useReducer:Wd,useRef:By,useState:function(){return Wd(el)},useDebugValue:N0,useDeferredValue:function(t){var e=Zr();return Vy(e,Nt.memoizedState,t)},useTransition:function(){var t=Wd(el)[0],e=Zr().memoizedState;return[t,e]},useMutableSource:Py,useSyncExternalStore:Ly,useId:qy,unstable_isNewReconciler:!1},$S={readContext:Jr,useCallback:Gy,useContext:Jr,useEffect:I0,useImperativeHandle:Ky,useInsertionEffect:Hy,useLayoutEffect:zy,useMemo:Wy,useReducer:Vd,useRef:By,useState:function(){return Vd(el)},useDebugValue:N0,useDeferredValue:function(t){var e=Zr();return Nt===null?e.memoizedState=t:Vy(e,Nt.memoizedState,t)},useTransition:function(){var t=Vd(el)[0],e=Zr().memoizedState;return[t,e]},useMutableSource:Py,useSyncExternalStore:Ly,useId:qy,unstable_isNewReconciler:!1};function on(t,e){if(t&&t.defaultProps){e=pt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Jh(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:pt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Hu={isMounted:function(t){return(t=t._reactInternals)?Si(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=hr(),s=Os(t),i=Xn(n,s);i.payload=e,r!=null&&(i.callback=r),e=Ns(t,i,s),e!==null&&(gn(e,t,s,n),Cc(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=hr(),s=Os(t),i=Xn(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=Ns(t,i,s),e!==null&&(gn(e,t,s,n),Cc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=hr(),n=Os(t),s=Xn(r,n);s.tag=2,e!=null&&(s.callback=e),e=Ns(t,s,n),e!==null&&(gn(e,t,n,r),Cc(e,t,n))}};function rg(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!Vo(r,n)||!Vo(s,i):!0}function Jy(t,e,r){var n=!1,s=Ms,i=e.contextType;return typeof i=="object"&&i!==null?i=Jr(i):(s=_r(e)?hi:ir.current,n=e.contextTypes,i=(n=n!=null)?ba(t,s):Ms),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Hu,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function ng(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Hu.enqueueReplaceState(e,e.state,null)}function Zh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},E0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Jr(i):(i=_r(e)?hi:ir.current,s.context=ba(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Jh(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Hu.enqueueReplaceState(s,s.state,null),Vc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ra(t,e){try{var r="",n=e;do r+=vC(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function qd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function ef(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var KS=typeof WeakMap=="function"?WeakMap:Map;function Zy(t,e,r){r=Xn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Jc||(Jc=!0,df=n),ef(t,e)},r}function e1(t,e,r){r=Xn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){ef(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){ef(t,e),typeof n!="function"&&(Rs===null?Rs=new Set([this]):Rs.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function sg(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new KS;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=sA.bind(null,t,e,r),e.then(t,t))}function ig(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ag(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Xn(-1,1),e.tag=2,Ns(r,e,1))),r.lanes|=1),t)}var GS=cs.ReactCurrentOwner,yr=!1;function lr(t,e,r,n){e.child=t===null?Iy(e,null,r,n):Ia(e,t.child,r,n)}function og(t,e,r,n,s){r=r.render;var i=e.ref;return xa(e,s),n=b0(t,e,r,n,i,s),r=k0(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,is(t,e,s)):(ot&&r&&m0(e),e.flags|=1,lr(t,e,n,s),e.child)}function lg(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!F0(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,t1(t,e,i,n,s)):(t=Nc(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:Vo,r(a,n)&&t.ref===e.ref)return is(t,e,s)}return e.flags|=1,t=Ps(i,n),t.ref=e.ref,t.return=e,e.child=t}function t1(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(Vo(i,n)&&t.ref===e.ref)if(yr=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(yr=!0);else return e.lanes=t.lanes,is(t,e,s)}return tf(t,e,r,n,s)}function r1(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(ca,Nr),Nr|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,tt(ca,Nr),Nr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,tt(ca,Nr),Nr|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,tt(ca,Nr),Nr|=n;return lr(t,e,s,r),e.child}function n1(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function tf(t,e,r,n,s){var i=_r(r)?hi:ir.current;return i=ba(e,i),xa(e,s),r=b0(t,e,r,n,i,s),n=k0(),t!==null&&!yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,is(t,e,s)):(ot&&n&&m0(e),e.flags|=1,lr(t,e,r,s),e.child)}function cg(t,e,r,n,s){if(_r(r)){var i=!0;zc(e)}else i=!1;if(xa(e,s),e.stateNode===null)bc(t,e),Jy(e,r,n),Zh(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=Jr(u):(u=_r(r)?hi:ir.current,u=ba(e,u));var d=r.getDerivedStateFromProps,h=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&ng(e,a,n,u),xs=!1;var f=e.memoizedState;a.state=f,Vc(e,n,a,s),l=e.memoizedState,o!==n||f!==l||wr.current||xs?(typeof d=="function"&&(Jh(e,r,d,n),l=e.memoizedState),(o=xs||rg(e,r,o,n,f,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,Ry(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:on(e.type,o),a.props=u,h=e.pendingProps,f=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Jr(l):(l=_r(r)?hi:ir.current,l=ba(e,l));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||f!==l)&&ng(e,a,n,l),xs=!1,f=e.memoizedState,a.state=f,Vc(e,n,a,s);var g=e.memoizedState;o!==h||f!==g||wr.current||xs?(typeof p=="function"&&(Jh(e,r,p,n),g=e.memoizedState),(u=xs||rg(e,r,u,n,f,g,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),a.props=n,a.state=g,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return rf(t,e,r,n,i,s)}function rf(t,e,r,n,s,i){n1(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&qm(e,r,!1),is(t,e,i);n=e.stateNode,GS.current=e;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Ia(e,t.child,null,i),e.child=Ia(e,null,o,i)):lr(t,e,o,i),e.memoizedState=n.state,s&&qm(e,r,!0),e.child}function s1(t){var e=t.stateNode;e.pendingContext?Vm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vm(t,e.context,!1),T0(t,e.containerInfo)}function ug(t,e,r,n,s){return ka(),v0(s),e.flags|=256,lr(t,e,r,n),e.child}var nf={dehydrated:null,treeContext:null,retryLane:0};function sf(t){return{baseLanes:t,cachePool:null,transitions:null}}function i1(t,e,r){var n=e.pendingProps,s=dt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),tt(dt,s&1),t===null)return Qh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Ku(a,n,0,null),t=ci(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=sf(r),e.memoizedState=nf,t):R0(e,a));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return WS(t,e,a,n,o,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Ps(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Ps(o,i):(i=ci(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?sf(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=nf,n}return i=t.child,t=i.sibling,n=Ps(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function R0(t,e){return e=Ku({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yl(t,e,r,n){return n!==null&&v0(n),Ia(e,t.child,null,r),t=R0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function WS(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=qd(Error(le(422))),Yl(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Ku({mode:"visible",children:n.children},s,0,null),i=ci(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Ia(e,t.child,null,a),e.child.memoizedState=sf(a),e.memoizedState=nf,i);if(!(e.mode&1))return Yl(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(le(419)),n=qd(i,n,void 0),Yl(t,e,a,n)}if(o=(a&t.childLanes)!==0,yr||o){if(n=Bt,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ss(t,s),gn(n,t,s,-1))}return D0(),n=qd(Error(le(421))),Yl(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=iA.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,jr=Is(s.nextSibling),Dr=e,ot=!0,dn=null,t!==null&&(Wr[Vr++]=Wn,Wr[Vr++]=Vn,Wr[Vr++]=fi,Wn=t.id,Vn=t.overflow,fi=e),e=R0(e,n.children),e.flags|=4096,e)}function dg(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Xh(t.return,e,r)}function Yd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function a1(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(lr(t,e,n.children,r),n=dt.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dg(t,r,e);else if(t.tag===19)dg(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(tt(dt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&qc(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Yd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&qc(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Yd(e,!0,r,null,i);break;case"together":Yd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function is(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),mi|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,r=Ps(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Ps(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function VS(t,e,r){switch(e.tag){case 3:s1(e),ka();break;case 5:Oy(e);break;case 1:_r(e.type)&&zc(e);break;case 4:T0(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;tt(Gc,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(tt(dt,dt.current&1),e.flags|=128,null):r&e.child.childLanes?i1(t,e,r):(tt(dt,dt.current&1),t=is(t,e,r),t!==null?t.sibling:null);tt(dt,dt.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return a1(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),tt(dt,dt.current),n)break;return null;case 22:case 23:return e.lanes=0,r1(t,e,r)}return is(t,e,r)}var o1,af,l1,c1;o1=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};af=function(){};l1=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ii(Ln.current);var i=null;switch(r){case"input":s=bh(t,s),n=bh(t,n),i=[];break;case"select":s=pt({},s,{value:void 0}),n=pt({},n,{value:void 0}),i=[];break;case"textarea":s=Nh(t,s),n=Nh(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Bc)}Oh(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bo.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(i||(i=[]),i.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bo.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&rt("scroll",t),i||o===l||(i=[])):(i=i||[]).push(u,l))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};c1=function(t,e,r,n){r!==n&&(e.flags|=4)};function oo(t,e){if(!ot)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Zt(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function qS(t,e,r){var n=e.pendingProps;switch(g0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(e),null;case 1:return _r(e.type)&&Hc(),Zt(e),null;case 3:return n=e.stateNode,Na(),st(wr),st(ir),S0(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Vl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,dn!==null&&(pf(dn),dn=null))),af(t,e),Zt(e),null;case 5:C0(e);var s=ii(Jo.current);if(r=e.type,t!==null&&e.stateNode!=null)l1(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(le(166));return Zt(e),null}if(t=ii(Ln.current),Vl(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[In]=e,n[Qo]=i,t=(e.mode&1)!==0,r){case"dialog":rt("cancel",n),rt("close",n);break;case"iframe":case"object":case"embed":rt("load",n);break;case"video":case"audio":for(s=0;s<mo.length;s++)rt(mo[s],n);break;case"source":rt("error",n);break;case"img":case"image":case"link":rt("error",n),rt("load",n);break;case"details":rt("toggle",n);break;case"input":wm(n,i),rt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},rt("invalid",n);break;case"textarea":Em(n,i),rt("invalid",n)}Oh(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Wl(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Wl(n.textContent,o,t),s=["children",""+o]):Bo.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&rt("scroll",n)}switch(r){case"input":Fl(n),_m(n,i,!0);break;case"textarea":Fl(n),Tm(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Bc)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Dx(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[In]=e,t[Qo]=n,o1(t,e,!1,!1),e.stateNode=t;e:{switch(a=Ph(r,n),r){case"dialog":rt("cancel",t),rt("close",t),s=n;break;case"iframe":case"object":case"embed":rt("load",t),s=n;break;case"video":case"audio":for(s=0;s<mo.length;s++)rt(mo[s],t);s=n;break;case"source":rt("error",t),s=n;break;case"img":case"image":case"link":rt("error",t),rt("load",t),s=n;break;case"details":rt("toggle",t),s=n;break;case"input":wm(t,n),s=bh(t,n),rt("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=pt({},n,{value:void 0}),rt("invalid",t);break;case"textarea":Em(t,n),s=Nh(t,n),rt("invalid",t);break;default:s=n}Oh(r,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?Bx(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Fx(t,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ho(t,l):typeof l=="number"&&Ho(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Bo.hasOwnProperty(i)?l!=null&&i==="onScroll"&&rt("scroll",t):l!=null&&t0(t,i,l,a))}switch(r){case"input":Fl(t),_m(t,n,!1);break;case"textarea":Fl(t),Tm(t);break;case"option":n.value!=null&&t.setAttribute("value",""+js(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?pa(t,!!n.multiple,i,!1):n.defaultValue!=null&&pa(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Bc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Zt(e),null;case 6:if(t&&e.stateNode!=null)c1(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(le(166));if(r=ii(Jo.current),ii(Ln.current),Vl(e)){if(n=e.stateNode,r=e.memoizedProps,n[In]=e,(i=n.nodeValue!==r)&&(t=Dr,t!==null))switch(t.tag){case 3:Wl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wl(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[In]=e,e.stateNode=n}return Zt(e),null;case 13:if(st(dt),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ot&&jr!==null&&e.mode&1&&!(e.flags&128))by(),ka(),e.flags|=98560,i=!1;else if(i=Vl(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(le(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(le(317));i[In]=e}else ka(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Zt(e),i=!1}else dn!==null&&(pf(dn),dn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||dt.current&1?Rt===0&&(Rt=3):D0())),e.updateQueue!==null&&(e.flags|=4),Zt(e),null);case 4:return Na(),af(t,e),t===null&&qo(e.stateNode.containerInfo),Zt(e),null;case 10:return w0(e.type._context),Zt(e),null;case 17:return _r(e.type)&&Hc(),Zt(e),null;case 19:if(st(dt),i=e.memoizedState,i===null)return Zt(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)oo(i,!1);else{if(Rt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=qc(t),a!==null){for(e.flags|=128,oo(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return tt(dt,dt.current&1|2),e.child}t=t.sibling}i.tail!==null&&xt()>Oa&&(e.flags|=128,n=!0,oo(i,!1),e.lanes=4194304)}else{if(!n)if(t=qc(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),oo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!ot)return Zt(e),null}else 2*xt()-i.renderingStartTime>Oa&&r!==1073741824&&(e.flags|=128,n=!0,oo(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=xt(),e.sibling=null,r=dt.current,tt(dt,n?r&1|2:r&1),e):(Zt(e),null);case 22:case 23:return M0(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Nr&1073741824&&(Zt(e),e.subtreeFlags&6&&(e.flags|=8192)):Zt(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function YS(t,e){switch(g0(e),e.tag){case 1:return _r(e.type)&&Hc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Na(),st(wr),st(ir),S0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return C0(e),null;case 13:if(st(dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));ka()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return st(dt),null;case 4:return Na(),null;case 10:return w0(e.type._context),null;case 22:case 23:return M0(),null;case 24:return null;default:return null}}var Ql=!1,tr=!1,QS=typeof WeakSet=="function"?WeakSet:Set,we=null;function la(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){mt(t,e,n)}else r.current=null}function of(t,e,r){try{r()}catch(n){mt(t,e,n)}}var hg=!1;function XS(t,e){if($h=Dc,t=py(),p0(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var p;h!==r||s!==0&&h.nodeType!==3||(o=a+s),h!==i||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===r&&++u===s&&(o=a),f===i&&++d===n&&(l=a),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kh={focusedElem:t,selectionRange:r},Dc=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,w=g.memoizedState,v=e.stateNode,y=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:on(e.type,m),w);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(_){mt(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return g=hg,hg=!1,g}function So(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&of(e,r,i)}s=s.next}while(s!==n)}}function zu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function lf(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function u1(t){var e=t.alternate;e!==null&&(t.alternate=null,u1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[In],delete e[Qo],delete e[Vh],delete e[PS],delete e[LS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function d1(t){return t.tag===5||t.tag===3||t.tag===4}function fg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||d1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Bc));else if(n!==4&&(t=t.child,t!==null))for(cf(t,e,r),t=t.sibling;t!==null;)cf(t,e,r),t=t.sibling}function uf(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(uf(t,e,r),t=t.sibling;t!==null;)uf(t,e,r),t=t.sibling}var $t=null,ln=!1;function hs(t,e,r){for(r=r.child;r!==null;)h1(t,e,r),r=r.sibling}function h1(t,e,r){if(Pn&&typeof Pn.onCommitFiberUnmount=="function")try{Pn.onCommitFiberUnmount(Lu,r)}catch{}switch(r.tag){case 5:tr||la(r,e);case 6:var n=$t,s=ln;$t=null,hs(t,e,r),$t=n,ln=s,$t!==null&&(ln?(t=$t,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):$t.removeChild(r.stateNode));break;case 18:$t!==null&&(ln?(t=$t,r=r.stateNode,t.nodeType===8?zd(t.parentNode,r):t.nodeType===1&&zd(t,r),Go(t)):zd($t,r.stateNode));break;case 4:n=$t,s=ln,$t=r.stateNode.containerInfo,ln=!0,hs(t,e,r),$t=n,ln=s;break;case 0:case 11:case 14:case 15:if(!tr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&of(r,e,a),s=s.next}while(s!==n)}hs(t,e,r);break;case 1:if(!tr&&(la(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){mt(r,e,o)}hs(t,e,r);break;case 21:hs(t,e,r);break;case 22:r.mode&1?(tr=(n=tr)||r.memoizedState!==null,hs(t,e,r),tr=n):hs(t,e,r);break;default:hs(t,e,r)}}function pg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new QS),e.forEach(function(n){var s=aA.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function rn(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:$t=o.stateNode,ln=!1;break e;case 3:$t=o.stateNode.containerInfo,ln=!0;break e;case 4:$t=o.stateNode.containerInfo,ln=!0;break e}o=o.return}if($t===null)throw Error(le(160));h1(i,a,s),$t=null,ln=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){mt(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)f1(e,t),e=e.sibling}function f1(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rn(e,t),Tn(t),n&4){try{So(3,t,t.return),zu(3,t)}catch(m){mt(t,t.return,m)}try{So(5,t,t.return)}catch(m){mt(t,t.return,m)}}break;case 1:rn(e,t),Tn(t),n&512&&r!==null&&la(r,r.return);break;case 5:if(rn(e,t),Tn(t),n&512&&r!==null&&la(r,r.return),t.flags&32){var s=t.stateNode;try{Ho(s,"")}catch(m){mt(t,t.return,m)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&jx(s,i),Ph(o,a);var u=Ph(o,i);for(a=0;a<l.length;a+=2){var d=l[a],h=l[a+1];d==="style"?Bx(s,h):d==="dangerouslySetInnerHTML"?Fx(s,h):d==="children"?Ho(s,h):t0(s,d,h,u)}switch(o){case"input":kh(s,i);break;case"textarea":Mx(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?pa(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?pa(s,!!i.multiple,i.defaultValue,!0):pa(s,!!i.multiple,i.multiple?[]:"",!1))}s[Qo]=i}catch(m){mt(t,t.return,m)}}break;case 6:if(rn(e,t),Tn(t),n&4){if(t.stateNode===null)throw Error(le(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(m){mt(t,t.return,m)}}break;case 3:if(rn(e,t),Tn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Go(e.containerInfo)}catch(m){mt(t,t.return,m)}break;case 4:rn(e,t),Tn(t);break;case 13:rn(e,t),Tn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(L0=xt())),n&4&&pg(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(tr=(u=tr)||d,rn(e,t),tr=u):rn(e,t),Tn(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(we=t,d=t.child;d!==null;){for(h=we=d;we!==null;){switch(f=we,p=f.child,f.tag){case 0:case 11:case 14:case 15:So(4,f,f.return);break;case 1:la(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(m){mt(n,r,m)}}break;case 5:la(f,f.return);break;case 22:if(f.memoizedState!==null){gg(h);continue}}p!==null?(p.return=f,we=p):gg(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Ux("display",a))}catch(m){mt(t,t.return,m)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(m){mt(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rn(e,t),Tn(t),n&4&&pg(t);break;case 21:break;default:rn(e,t),Tn(t)}}function Tn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(d1(r)){var n=r;break e}r=r.return}throw Error(le(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Ho(s,""),n.flags&=-33);var i=fg(t);uf(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,o=fg(t);cf(t,o,a);break;default:throw Error(le(161))}}catch(l){mt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function JS(t,e,r){we=t,p1(t)}function p1(t,e,r){for(var n=(t.mode&1)!==0;we!==null;){var s=we,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Ql;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||tr;o=Ql;var u=tr;if(Ql=a,(tr=l)&&!u)for(we=s;we!==null;)a=we,l=a.child,a.tag===22&&a.memoizedState!==null?vg(s):l!==null?(l.return=a,we=l):vg(s);for(;i!==null;)we=i,p1(i),i=i.sibling;we=s,Ql=o,tr=u}mg(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,we=i):mg(t)}}function mg(t){for(;we!==null;){var e=we;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tr||zu(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!tr)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:on(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Zm(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Zm(e,a,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Go(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}tr||e.flags&512&&lf(e)}catch(f){mt(e,e.return,f)}}if(e===t){we=null;break}if(r=e.sibling,r!==null){r.return=e.return,we=r;break}we=e.return}}function gg(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var r=e.sibling;if(r!==null){r.return=e.return,we=r;break}we=e.return}}function vg(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{zu(4,e)}catch(l){mt(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){mt(e,s,l)}}var i=e.return;try{lf(e)}catch(l){mt(e,i,l)}break;case 5:var a=e.return;try{lf(e)}catch(l){mt(e,a,l)}}}catch(l){mt(e,e.return,l)}if(e===t){we=null;break}var o=e.sibling;if(o!==null){o.return=e.return,we=o;break}we=e.return}}var ZS=Math.ceil,Xc=cs.ReactCurrentDispatcher,O0=cs.ReactCurrentOwner,Qr=cs.ReactCurrentBatchConfig,Ue=0,Bt=null,Ct=null,Vt=0,Nr=0,ca=$s(0),Rt=0,rl=null,mi=0,$u=0,P0=0,Ao=null,gr=null,L0=0,Oa=1/0,zn=null,Jc=!1,df=null,Rs=null,Xl=!1,Ts=null,Zc=0,bo=0,hf=null,kc=-1,Ic=0;function hr(){return Ue&6?xt():kc!==-1?kc:kc=xt()}function Os(t){return t.mode&1?Ue&2&&Vt!==0?Vt&-Vt:MS.transition!==null?(Ic===0&&(Ic=Jx()),Ic):(t=Ve,t!==0||(t=window.event,t=t===void 0?16:iy(t.type)),t):1}function gn(t,e,r,n){if(50<bo)throw bo=0,hf=null,Error(le(185));ml(t,r,n),(!(Ue&2)||t!==Bt)&&(t===Bt&&(!(Ue&2)&&($u|=r),Rt===4&&ws(t,Vt)),Er(t,n),r===1&&Ue===0&&!(e.mode&1)&&(Oa=xt()+500,Uu&&Ks()))}function Er(t,e){var r=t.callbackNode;MC(t,e);var n=Mc(t,t===Bt?Vt:0);if(n===0)r!==null&&Am(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Am(r),e===1)t.tag===0?jS(xg.bind(null,t)):Cy(xg.bind(null,t)),RS(function(){!(Ue&6)&&Ks()}),r=null;else{switch(Zx(n)){case 1:r=a0;break;case 4:r=Qx;break;case 16:r=jc;break;case 536870912:r=Xx;break;default:r=jc}r=E1(r,m1.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function m1(t,e){if(kc=-1,Ic=0,Ue&6)throw Error(le(327));var r=t.callbackNode;if(ya()&&t.callbackNode!==r)return null;var n=Mc(t,t===Bt?Vt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=eu(t,n);else{e=n;var s=Ue;Ue|=2;var i=v1();(Bt!==t||Vt!==e)&&(zn=null,Oa=xt()+500,li(t,e));do try{rA();break}catch(o){g1(t,o)}while(!0);y0(),Xc.current=i,Ue=s,Ct!==null?e=0:(Bt=null,Vt=0,e=Rt)}if(e!==0){if(e===2&&(s=Fh(t),s!==0&&(n=s,e=ff(t,s))),e===1)throw r=rl,li(t,0),ws(t,n),Er(t,xt()),r;if(e===6)ws(t,n);else{if(s=t.current.alternate,!(n&30)&&!eA(s)&&(e=eu(t,n),e===2&&(i=Fh(t),i!==0&&(n=i,e=ff(t,i))),e===1))throw r=rl,li(t,0),ws(t,n),Er(t,xt()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(le(345));case 2:Js(t,gr,zn);break;case 3:if(ws(t,n),(n&130023424)===n&&(e=L0+500-xt(),10<e)){if(Mc(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){hr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Wh(Js.bind(null,t,gr,zn),e);break}Js(t,gr,zn);break;case 4:if(ws(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-mn(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=xt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ZS(n/1960))-n,10<n){t.timeoutHandle=Wh(Js.bind(null,t,gr,zn),n);break}Js(t,gr,zn);break;case 5:Js(t,gr,zn);break;default:throw Error(le(329))}}}return Er(t,xt()),t.callbackNode===r?m1.bind(null,t):null}function ff(t,e){var r=Ao;return t.current.memoizedState.isDehydrated&&(li(t,e).flags|=256),t=eu(t,e),t!==2&&(e=gr,gr=r,e!==null&&pf(e)),t}function pf(t){gr===null?gr=t:gr.push.apply(gr,t)}function eA(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!wn(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ws(t,e){for(e&=~P0,e&=~$u,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-mn(e),n=1<<r;t[r]=-1,e&=~n}}function xg(t){if(Ue&6)throw Error(le(327));ya();var e=Mc(t,0);if(!(e&1))return Er(t,xt()),null;var r=eu(t,e);if(t.tag!==0&&r===2){var n=Fh(t);n!==0&&(e=n,r=ff(t,n))}if(r===1)throw r=rl,li(t,0),ws(t,e),Er(t,xt()),r;if(r===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Js(t,gr,zn),Er(t,xt()),null}function j0(t,e){var r=Ue;Ue|=1;try{return t(e)}finally{Ue=r,Ue===0&&(Oa=xt()+500,Uu&&Ks())}}function gi(t){Ts!==null&&Ts.tag===0&&!(Ue&6)&&ya();var e=Ue;Ue|=1;var r=Qr.transition,n=Ve;try{if(Qr.transition=null,Ve=1,t)return t()}finally{Ve=n,Qr.transition=r,Ue=e,!(Ue&6)&&Ks()}}function M0(){Nr=ca.current,st(ca)}function li(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,NS(r)),Ct!==null)for(r=Ct.return;r!==null;){var n=r;switch(g0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Hc();break;case 3:Na(),st(wr),st(ir),S0();break;case 5:C0(n);break;case 4:Na();break;case 13:st(dt);break;case 19:st(dt);break;case 10:w0(n.type._context);break;case 22:case 23:M0()}r=r.return}if(Bt=t,Ct=t=Ps(t.current,null),Vt=Nr=e,Rt=0,rl=null,P0=$u=mi=0,gr=Ao=null,si!==null){for(e=0;e<si.length;e++)if(r=si[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}si=null}return t}function g1(t,e){do{var r=Ct;try{if(y0(),Sc.current=Qc,Yc){for(var n=ft.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Yc=!1}if(pi=0,jt=Nt=ft=null,Co=!1,Zo=0,O0.current=null,r===null||r.return===null){Rt=1,rl=e,Ct=null;break}e:{var i=t,a=r.return,o=r,l=e;if(e=Vt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ig(a);if(p!==null){p.flags&=-257,ag(p,a,o,i,e),p.mode&1&&sg(i,u,e),e=p,l=u;var g=e.updateQueue;if(g===null){var m=new Set;m.add(l),e.updateQueue=m}else g.add(l);break e}else{if(!(e&1)){sg(i,u,e),D0();break e}l=Error(le(426))}}else if(ot&&o.mode&1){var w=ig(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),ag(w,a,o,i,e),v0(Ra(l,o));break e}}i=l=Ra(l,o),Rt!==4&&(Rt=2),Ao===null?Ao=[i]:Ao.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=Zy(i,l,e);Jm(i,v);break e;case 1:o=l;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Rs===null||!Rs.has(x)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=e1(i,o,e);Jm(i,_);break e}}i=i.return}while(i!==null)}y1(r)}catch(P){e=P,Ct===r&&r!==null&&(Ct=r=r.return);continue}break}while(!0)}function v1(){var t=Xc.current;return Xc.current=Qc,t===null?Qc:t}function D0(){(Rt===0||Rt===3||Rt===2)&&(Rt=4),Bt===null||!(mi&268435455)&&!($u&268435455)||ws(Bt,Vt)}function eu(t,e){var r=Ue;Ue|=2;var n=v1();(Bt!==t||Vt!==e)&&(zn=null,li(t,e));do try{tA();break}catch(s){g1(t,s)}while(!0);if(y0(),Ue=r,Xc.current=n,Ct!==null)throw Error(le(261));return Bt=null,Vt=0,Rt}function tA(){for(;Ct!==null;)x1(Ct)}function rA(){for(;Ct!==null&&!bC();)x1(Ct)}function x1(t){var e=_1(t.alternate,t,Nr);t.memoizedProps=t.pendingProps,e===null?y1(t):Ct=e,O0.current=null}function y1(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=YS(r,e),r!==null){r.flags&=32767,Ct=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Rt=6,Ct=null;return}}else if(r=qS(r,e,Nr),r!==null){Ct=r;return}if(e=e.sibling,e!==null){Ct=e;return}Ct=e=t}while(e!==null);Rt===0&&(Rt=5)}function Js(t,e,r){var n=Ve,s=Qr.transition;try{Qr.transition=null,Ve=1,nA(t,e,r,n)}finally{Qr.transition=s,Ve=n}return null}function nA(t,e,r,n){do ya();while(Ts!==null);if(Ue&6)throw Error(le(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(DC(t,i),t===Bt&&(Ct=Bt=null,Vt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Xl||(Xl=!0,E1(jc,function(){return ya(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Qr.transition,Qr.transition=null;var a=Ve;Ve=1;var o=Ue;Ue|=4,O0.current=null,XS(t,r),f1(r,t),TS(Kh),Dc=!!$h,Kh=$h=null,t.current=r,JS(r),kC(),Ue=o,Ve=a,Qr.transition=i}else t.current=r;if(Xl&&(Xl=!1,Ts=t,Zc=s),i=t.pendingLanes,i===0&&(Rs=null),RC(r.stateNode),Er(t,xt()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Jc)throw Jc=!1,t=df,df=null,t;return Zc&1&&t.tag!==0&&ya(),i=t.pendingLanes,i&1?t===hf?bo++:(bo=0,hf=t):bo=0,Ks(),null}function ya(){if(Ts!==null){var t=Zx(Zc),e=Qr.transition,r=Ve;try{if(Qr.transition=null,Ve=16>t?16:t,Ts===null)var n=!1;else{if(t=Ts,Ts=null,Zc=0,Ue&6)throw Error(le(331));var s=Ue;for(Ue|=4,we=t.current;we!==null;){var i=we,a=i.child;if(we.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(we=u;we!==null;){var d=we;switch(d.tag){case 0:case 11:case 15:So(8,d,i)}var h=d.child;if(h!==null)h.return=d,we=h;else for(;we!==null;){d=we;var f=d.sibling,p=d.return;if(u1(d),d===u){we=null;break}if(f!==null){f.return=p,we=f;break}we=p}}}var g=i.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}we=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,we=a;else e:for(;we!==null;){if(i=we,i.flags&2048)switch(i.tag){case 0:case 11:case 15:So(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,we=v;break e}we=i.return}}var y=t.current;for(we=y;we!==null;){a=we;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,we=x;else e:for(a=y;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:zu(9,o)}}catch(P){mt(o,o.return,P)}if(o===a){we=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,we=_;break e}we=o.return}}if(Ue=s,Ks(),Pn&&typeof Pn.onPostCommitFiberRoot=="function")try{Pn.onPostCommitFiberRoot(Lu,t)}catch{}n=!0}return n}finally{Ve=r,Qr.transition=e}}return!1}function yg(t,e,r){e=Ra(r,e),e=Zy(t,e,1),t=Ns(t,e,1),e=hr(),t!==null&&(ml(t,1,e),Er(t,e))}function mt(t,e,r){if(t.tag===3)yg(t,t,r);else for(;e!==null;){if(e.tag===3){yg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Rs===null||!Rs.has(n))){t=Ra(r,t),t=e1(e,t,1),e=Ns(e,t,1),t=hr(),e!==null&&(ml(e,1,t),Er(e,t));break}}e=e.return}}function sA(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=hr(),t.pingedLanes|=t.suspendedLanes&r,Bt===t&&(Vt&r)===r&&(Rt===4||Rt===3&&(Vt&130023424)===Vt&&500>xt()-L0?li(t,0):P0|=r),Er(t,e)}function w1(t,e){e===0&&(t.mode&1?(e=Hl,Hl<<=1,!(Hl&130023424)&&(Hl=4194304)):e=1);var r=hr();t=ss(t,e),t!==null&&(ml(t,e,r),Er(t,r))}function iA(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),w1(t,r)}function aA(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(le(314))}n!==null&&n.delete(e),w1(t,r)}var _1;_1=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||wr.current)yr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return yr=!1,VS(t,e,r);yr=!!(t.flags&131072)}else yr=!1,ot&&e.flags&1048576&&Sy(e,Kc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;bc(t,e),t=e.pendingProps;var s=ba(e,ir.current);xa(e,r),s=b0(null,e,n,t,s,r);var i=k0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_r(n)?(i=!0,zc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,E0(e),s.updater=Hu,e.stateNode=s,s._reactInternals=e,Zh(e,n,t,r),e=rf(null,e,n,!0,i,r)):(e.tag=0,ot&&i&&m0(e),lr(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(bc(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=lA(n),t=on(n,t),s){case 0:e=tf(null,e,n,t,r);break e;case 1:e=cg(null,e,n,t,r);break e;case 11:e=og(null,e,n,t,r);break e;case 14:e=lg(null,e,n,on(n.type,t),r);break e}throw Error(le(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:on(n,s),tf(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:on(n,s),cg(t,e,n,s,r);case 3:e:{if(s1(e),t===null)throw Error(le(387));n=e.pendingProps,i=e.memoizedState,s=i.element,Ry(t,e),Vc(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Ra(Error(le(423)),e),e=ug(t,e,n,r,s);break e}else if(n!==s){s=Ra(Error(le(424)),e),e=ug(t,e,n,r,s);break e}else for(jr=Is(e.stateNode.containerInfo.firstChild),Dr=e,ot=!0,dn=null,r=Iy(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ka(),n===s){e=is(t,e,r);break e}lr(t,e,n,r)}e=e.child}return e;case 5:return Oy(e),t===null&&Qh(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,Gh(n,s)?a=null:i!==null&&Gh(n,i)&&(e.flags|=32),n1(t,e),lr(t,e,a,r),e.child;case 6:return t===null&&Qh(e),null;case 13:return i1(t,e,r);case 4:return T0(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Ia(e,null,n,r):lr(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:on(n,s),og(t,e,n,s,r);case 7:return lr(t,e,e.pendingProps,r),e.child;case 8:return lr(t,e,e.pendingProps.children,r),e.child;case 12:return lr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,tt(Gc,n._currentValue),n._currentValue=a,i!==null)if(wn(i.value,a)){if(i.children===s.children&&!wr.current){e=is(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Xn(-1,r&-r),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),Xh(i.return,r,e),o.lanes|=r;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(le(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Xh(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}lr(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,xa(e,r),s=Jr(s),n=n(s),e.flags|=1,lr(t,e,n,r),e.child;case 14:return n=e.type,s=on(n,e.pendingProps),s=on(n.type,s),lg(t,e,n,s,r);case 15:return t1(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:on(n,s),bc(t,e),e.tag=1,_r(n)?(t=!0,zc(e)):t=!1,xa(e,r),Jy(e,n,s),Zh(e,n,s,r),rf(null,e,n,!0,t,r);case 19:return a1(t,e,r);case 22:return r1(t,e,r)}throw Error(le(156,e.tag))};function E1(t,e){return Yx(t,e)}function oA(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(t,e,r,n){return new oA(t,e,r,n)}function F0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function lA(t){if(typeof t=="function")return F0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===n0)return 11;if(t===s0)return 14}return 2}function Ps(t,e){var r=t.alternate;return r===null?(r=Yr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Nc(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")F0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Zi:return ci(r.children,s,i,e);case r0:a=8,s|=8;break;case Th:return t=Yr(12,r,e,s|2),t.elementType=Th,t.lanes=i,t;case Ch:return t=Yr(13,r,e,s),t.elementType=Ch,t.lanes=i,t;case Sh:return t=Yr(19,r,e,s),t.elementType=Sh,t.lanes=i,t;case Ox:return Ku(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Nx:a=10;break e;case Rx:a=9;break e;case n0:a=11;break e;case s0:a=14;break e;case vs:a=16,n=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=Yr(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function ci(t,e,r,n){return t=Yr(7,t,n,e),t.lanes=r,t}function Ku(t,e,r,n){return t=Yr(22,t,n,e),t.elementType=Ox,t.lanes=r,t.stateNode={isHidden:!1},t}function Qd(t,e,r){return t=Yr(6,t,null,e),t.lanes=r,t}function Xd(t,e,r){return e=Yr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function cA(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rd(0),this.expirationTimes=Rd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rd(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function U0(t,e,r,n,s,i,a,o,l){return t=new cA(t,e,r,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Yr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},E0(i),t}function uA(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ji,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function T1(t){if(!t)return Ms;t=t._reactInternals;e:{if(Si(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_r(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var r=t.type;if(_r(r))return Ty(t,r,e)}return e}function C1(t,e,r,n,s,i,a,o,l){return t=U0(r,n,!0,t,s,i,a,o,l),t.context=T1(null),r=t.current,n=hr(),s=Os(r),i=Xn(n,s),i.callback=e??null,Ns(r,i,s),t.current.lanes=s,ml(t,s,n),Er(t,n),t}function Gu(t,e,r,n){var s=e.current,i=hr(),a=Os(s);return r=T1(r),e.context===null?e.context=r:e.pendingContext=r,e=Xn(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Ns(s,e,a),t!==null&&(gn(t,s,a,i),Cc(t,s,a)),a}function tu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function B0(t,e){wg(t,e),(t=t.alternate)&&wg(t,e)}function dA(){return null}var S1=typeof reportError=="function"?reportError:function(t){console.error(t)};function H0(t){this._internalRoot=t}Wu.prototype.render=H0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));Gu(t,e,null,null)};Wu.prototype.unmount=H0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;gi(function(){Gu(null,t,null,null)}),e[ns]=null}};function Wu(t){this._internalRoot=t}Wu.prototype.unstable_scheduleHydration=function(t){if(t){var e=ry();t={blockedOn:null,target:t,priority:e};for(var r=0;r<ys.length&&e!==0&&e<ys[r].priority;r++);ys.splice(r,0,t),r===0&&sy(t)}};function z0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Vu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _g(){}function hA(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=tu(a);i.call(u)}}var a=C1(e,n,t,0,null,!1,!1,"",_g);return t._reactRootContainer=a,t[ns]=a.current,qo(t.nodeType===8?t.parentNode:t),gi(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=tu(l);o.call(u)}}var l=U0(t,0,!1,null,null,!1,!1,"",_g);return t._reactRootContainer=l,t[ns]=l.current,qo(t.nodeType===8?t.parentNode:t),gi(function(){Gu(e,l,r,n)}),l}function qu(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=tu(a);o.call(l)}}Gu(e,a,t,s)}else a=hA(r,e,t,s,n);return tu(a)}ey=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=po(e.pendingLanes);r!==0&&(o0(e,r|1),Er(e,xt()),!(Ue&6)&&(Oa=xt()+500,Ks()))}break;case 13:gi(function(){var n=ss(t,1);if(n!==null){var s=hr();gn(n,t,1,s)}}),B0(t,1)}};l0=function(t){if(t.tag===13){var e=ss(t,134217728);if(e!==null){var r=hr();gn(e,t,134217728,r)}B0(t,134217728)}};ty=function(t){if(t.tag===13){var e=Os(t),r=ss(t,e);if(r!==null){var n=hr();gn(r,t,e,n)}B0(t,e)}};ry=function(){return Ve};ny=function(t,e){var r=Ve;try{return Ve=t,e()}finally{Ve=r}};jh=function(t,e,r){switch(e){case"input":if(kh(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Fu(n);if(!s)throw Error(le(90));Lx(n),kh(n,s)}}}break;case"textarea":Mx(t,r);break;case"select":e=r.value,e!=null&&pa(t,!!r.multiple,e,!1)}};$x=j0;Kx=gi;var fA={usingClientEntryPoint:!1,Events:[vl,na,Fu,Hx,zx,j0]},lo={findFiberByHostInstance:ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pA={bundleType:lo.bundleType,version:lo.version,rendererPackageName:lo.rendererPackageName,rendererConfig:lo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Vx(t),t===null?null:t.stateNode},findFiberByHostInstance:lo.findFiberByHostInstance||dA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jl.isDisabled&&Jl.supportsFiber)try{Lu=Jl.inject(pA),Pn=Jl}catch{}}Br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fA;Br.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!z0(e))throw Error(le(200));return uA(t,e,null,r)};Br.createRoot=function(t,e){if(!z0(t))throw Error(le(299));var r=!1,n="",s=S1;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=U0(t,1,!1,null,null,r,!1,n,s),t[ns]=e.current,qo(t.nodeType===8?t.parentNode:t),new H0(e)};Br.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=Vx(e),t=t===null?null:t.stateNode,t};Br.flushSync=function(t){return gi(t)};Br.hydrate=function(t,e,r){if(!Vu(e))throw Error(le(200));return qu(null,t,e,!0,r)};Br.hydrateRoot=function(t,e,r){if(!z0(t))throw Error(le(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=S1;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=C1(e,null,t,1,r??null,s,!1,i,a),t[ns]=e.current,qo(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Wu(e)};Br.render=function(t,e,r){if(!Vu(e))throw Error(le(200));return qu(null,t,e,!1,r)};Br.unmountComponentAtNode=function(t){if(!Vu(t))throw Error(le(40));return t._reactRootContainer?(gi(function(){qu(null,null,t,!1,function(){t._reactRootContainer=null,t[ns]=null})}),!0):!1};Br.unstable_batchedUpdates=j0;Br.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Vu(r))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return qu(t,e,r,!1,n)};Br.version="18.3.1-next-f1338f8080-20240426";function A1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(A1)}catch(t){console.error(t)}}A1(),Ax.exports=Br;var mA=Ax.exports,b1,Eg=mA;b1=Eg.createRoot,Eg.hydrateRoot;/*! @azure/msal-common v14.16.1 2025-08-05 */const V={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Zl={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},Ka=[V.OPENID_SCOPE,V.PROFILE_SCOPE,V.OFFLINE_ACCESS_SCOPE],Tg=[...Ka,V.EMAIL_SCOPE],cr={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Lt={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Ls={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},ec={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Mt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Cg={PLAIN:"plain",S256:"S256"},yl={QUERY:"query",FRAGMENT:"fragment"},gA={...yl,FORM_POST:"form_post"},k1={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},tc={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},rr={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Ie={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},$0="appmetadata",vA="client_info",ko="1",ru={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},br={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Ht={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Xe={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Io={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Sg={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Ag={username:"username",password:"password"},rc={httpSuccess:200,httpBadRequest:400},Di={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Jd={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},ms={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},xA={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},yA=300;/*! @azure/msal-common v14.16.1 2025-08-05 */const K0="unexpected_error",wA="post_request_failed";/*! @azure/msal-common v14.16.1 2025-08-05 */const bg={[K0]:"Unexpected error in authentication.",[wA]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};let ht=class I1 extends Error{constructor(e,r,n){const s=r?`${e}: ${r}`:e;super(s),Object.setPrototypeOf(this,I1.prototype),this.errorCode=e||V.EMPTY_STRING,this.errorMessage=r||V.EMPTY_STRING,this.subError=n||V.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function N1(t,e){return new ht(t,e?`${bg[t]} ${e}`:bg[t])}/*! @azure/msal-common v14.16.1 2025-08-05 */const G0="client_info_decoding_error",R1="client_info_empty_error",W0="token_parsing_error",O1="null_or_empty_token",$n="endpoints_resolution_error",P1="network_error",L1="openid_config_error",j1="hash_not_deserialized",Pa="invalid_state",M1="state_mismatch",nu="state_not_found",D1="nonce_mismatch",V0="auth_time_not_found",F1="max_age_transpired",_A="multiple_matching_tokens",EA="multiple_matching_accounts",U1="multiple_matching_appMetadata",B1="request_cannot_be_made",H1="cannot_remove_empty_scope",z1="cannot_append_scopeset",mf="empty_input_scopeset",TA="device_code_polling_cancelled",CA="device_code_expired",SA="device_code_unknown_error",q0="no_account_in_silent_request",$1="invalid_cache_record",Y0="invalid_cache_environment",gf="no_account_found",vf="no_crypto_object",xf="unexpected_credential_type",AA="invalid_assertion",bA="invalid_client_credential",qn="token_refresh_required",kA="user_timeout_reached",K1="token_claims_cnf_required_for_signedjwt",G1="authorization_code_missing_from_server_response",IA="binding_key_not_removed",W1="end_session_endpoint_not_supported",Q0="key_id_missing",NA="no_network_connectivity",RA="user_canceled",OA="missing_tenant_id_error",je="method_not_implemented",PA="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.16.1 2025-08-05 */const kg={[G0]:"The client info could not be parsed/decoded correctly",[R1]:"The client info was empty",[W0]:"Token cannot be parsed",[O1]:"The token is null or empty",[$n]:"Endpoints cannot be resolved",[P1]:"Network request failed",[L1]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[j1]:"The hash parameters could not be deserialized",[Pa]:"State was not the expected format",[M1]:"State mismatch error",[nu]:"State not found",[D1]:"Nonce mismatch error",[V0]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[F1]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[_A]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[EA]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[U1]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[B1]:"Token request cannot be made without authorization code or refresh token.",[H1]:"Cannot remove null or empty scope from ScopeSet",[z1]:"Cannot append ScopeSet",[mf]:"Empty input ScopeSet cannot be processed",[TA]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[CA]:"Device code is expired.",[SA]:"Device code stopped polling for unknown reasons.",[q0]:"Please pass an account object, silent flow is not supported without account information",[$1]:"Cache record object was null or undefined.",[Y0]:"Invalid environment when attempting to create cache entry",[gf]:"No account found in cache for given key.",[vf]:"No crypto object detected.",[xf]:"Unexpected credential type.",[AA]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[bA]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[qn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[kA]:"User defined timeout for device code polling reached",[K1]:"Cannot generate a POP jwt if the token_claims are not populated",[G1]:"Server response does not contain an authorization code to proceed",[IA]:"Could not remove the credential's binding key from storage.",[W1]:"The provided authority does not support logout",[Q0]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[NA]:"No network connectivity. Check your internet connection.",[RA]:"User cancelled the flow.",[OA]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[je]:"This method has not been implemented",[PA]:"The nested app auth bridge is disabled"};class Yu extends ht{constructor(e,r){super(e,r?`${kg[e]}: ${r}`:kg[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Yu.prototype)}}function ae(t,e){return new Yu(t,e)}/*! @azure/msal-common v14.16.1 2025-08-05 */const su={createNewGuid:()=>{throw ae(je)},base64Decode:()=>{throw ae(je)},base64Encode:()=>{throw ae(je)},base64UrlEncode:()=>{throw ae(je)},encodeKid:()=>{throw ae(je)},async getPublicKeyThumbprint(){throw ae(je)},async removeTokenBindingKey(){throw ae(je)},async clearKeystore(){throw ae(je)},async signJwt(){throw ae(je)},async hashString(){throw ae(je)}};/*! @azure/msal-common v14.16.1 2025-08-05 */var Ye;(function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose",t[t.Trace=4]="Trace"})(Ye||(Ye={}));class as{constructor(e,r,n){this.level=Ye.Info;const s=()=>{},i=e||as.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||s,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:Ye.Info,this.correlationId=i.correlationId||V.EMPTY_STRING,this.packageName=r||V.EMPTY_STRING,this.packageVersion=n||V.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ye.Info}}clone(e,r,n){return new as({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,r)}logMessage(e,r){if(r.logLevel>this.level||!this.piiLoggingEnabled&&r.containsPii)return;const i=`${`[${new Date().toUTCString()}] : [${r.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Ye[r.logLevel]} - ${e}`;this.executeCallback(r.logLevel,i,r.containsPii||!1)}executeCallback(e,r,n){this.localCallback&&this.localCallback(e,r,n)}error(e,r){this.logMessage(e,{logLevel:Ye.Error,containsPii:!1,correlationId:r||V.EMPTY_STRING})}errorPii(e,r){this.logMessage(e,{logLevel:Ye.Error,containsPii:!0,correlationId:r||V.EMPTY_STRING})}warning(e,r){this.logMessage(e,{logLevel:Ye.Warning,containsPii:!1,correlationId:r||V.EMPTY_STRING})}warningPii(e,r){this.logMessage(e,{logLevel:Ye.Warning,containsPii:!0,correlationId:r||V.EMPTY_STRING})}info(e,r){this.logMessage(e,{logLevel:Ye.Info,containsPii:!1,correlationId:r||V.EMPTY_STRING})}infoPii(e,r){this.logMessage(e,{logLevel:Ye.Info,containsPii:!0,correlationId:r||V.EMPTY_STRING})}verbose(e,r){this.logMessage(e,{logLevel:Ye.Verbose,containsPii:!1,correlationId:r||V.EMPTY_STRING})}verbosePii(e,r){this.logMessage(e,{logLevel:Ye.Verbose,containsPii:!0,correlationId:r||V.EMPTY_STRING})}trace(e,r){this.logMessage(e,{logLevel:Ye.Trace,containsPii:!1,correlationId:r||V.EMPTY_STRING})}tracePii(e,r){this.logMessage(e,{logLevel:Ye.Trace,containsPii:!0,correlationId:r||V.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.16.1 2025-08-05 */const V1="@azure/msal-common",X0="14.16.1";/*! @azure/msal-common v14.16.1 2025-08-05 */const J0={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v14.16.1 2025-08-05 */function Ai(t,e){const r=LA(t);try{const n=e(r);return JSON.parse(n)}catch{throw ae(W0)}}function LA(t){if(!t)throw ae(O1);const r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw ae(W0);return r[2]}function q1(t,e){if(e===0||Date.now()-3e5>t+e)throw ae(F1)}/*! @azure/msal-common v14.16.1 2025-08-05 */function Mn(){return Math.round(new Date().getTime()/1e3)}function yf(t,e){const r=Number(t)||0;return Mn()+e>r}function jA(t){return Number(t)>Mn()}/*! @azure/msal-common v14.16.1 2025-08-05 */function ua(t){return[MA(t),DA(t),FA(t),UA(t),BA(t)].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}function Qu(t,e,r,n,s){return{credentialType:Ie.ID_TOKEN,homeAccountId:t,environment:e,clientId:n,secret:r,realm:s}}function Xu(t,e,r,n,s,i,a,o,l,u,d,h,f,p,g){var w,v;const m={homeAccountId:t,credentialType:Ie.ACCESS_TOKEN,secret:r,cachedAt:Mn().toString(),expiresOn:a.toString(),extendedExpiresOn:o.toString(),environment:e,clientId:n,realm:s,target:i,tokenType:d||Xe.BEARER};if(h&&(m.userAssertionHash=h),u&&(m.refreshOn=u.toString()),p&&(m.requestedClaims=p,m.requestedClaimsHash=g),((w=m.tokenType)==null?void 0:w.toLowerCase())!==Xe.BEARER.toLowerCase())switch(m.credentialType=Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case Xe.POP:const y=Ai(r,l);if(!((v=y==null?void 0:y.cnf)!=null&&v.kid))throw ae(K1);m.keyId=y.cnf.kid;break;case Xe.SSH:m.keyId=f}return m}function Y1(t,e,r,n,s,i,a){const o={credentialType:Ie.REFRESH_TOKEN,homeAccountId:t,environment:e,clientId:n,secret:r};return i&&(o.userAssertionHash=i),s&&(o.familyId=s),a&&(o.expiresOn=a.toString()),o}function Z0(t){return t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")}function Ig(t){return t?Z0(t)&&t.hasOwnProperty("realm")&&t.hasOwnProperty("target")&&(t.credentialType===Ie.ACCESS_TOKEN||t.credentialType===Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function Ng(t){return t?Z0(t)&&t.hasOwnProperty("realm")&&t.credentialType===Ie.ID_TOKEN:!1}function Rg(t){return t?Z0(t)&&t.credentialType===Ie.REFRESH_TOKEN:!1}function MA(t){return[t.homeAccountId,t.environment].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}function DA(t){const e=t.credentialType===Ie.REFRESH_TOKEN&&t.familyId||t.clientId;return[t.credentialType,e,t.realm||""].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}function FA(t){return(t.target||"").toLowerCase()}function UA(t){return(t.requestedClaimsHash||"").toLowerCase()}function BA(t){return t.tokenType&&t.tokenType.toLowerCase()!==Xe.BEARER.toLowerCase()?t.tokenType.toLowerCase():""}function HA(t,e){const r=t.indexOf(Ht.CACHE_KEY)===0;let n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),r&&n}function zA(t,e){let r=!1;t&&(r=t.indexOf(Io.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),r&&n}function $A({environment:t,clientId:e}){return[$0,t,e].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}function KA(t,e){return e?t.indexOf($0)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function GA(t,e){return e?t.indexOf(ru.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Og(){return Mn()+ru.REFRESH_TIME_SECONDS}function nc(t,e,r){t.authorization_endpoint=e.authorization_endpoint,t.token_endpoint=e.token_endpoint,t.end_session_endpoint=e.end_session_endpoint,t.issuer=e.issuer,t.endpointsFromNetwork=r,t.jwks_uri=e.jwks_uri}function Zd(t,e,r){t.aliases=e.aliases,t.preferred_cache=e.preferred_cache,t.preferred_network=e.preferred_network,t.aliasesFromNetwork=r}function Pg(t){return t.expiresAt<=Mn()}/*! @azure/msal-common v14.16.1 2025-08-05 */const Q1="redirect_uri_empty",WA="claims_request_parsing_error",X1="authority_uri_insecure",go="url_parse_error",J1="empty_url_error",Z1="empty_input_scopes_error",ew="invalid_prompt_value",ep="invalid_claims",tw="token_request_empty",rw="logout_request_empty",nw="invalid_code_challenge_method",tp="pkce_params_missing",rp="invalid_cloud_discovery_metadata",sw="invalid_authority_metadata",iw="untrusted_authority",Ju="missing_ssh_jwk",aw="missing_ssh_kid",VA="missing_nonce_authentication_header",qA="invalid_authentication_header",ow="cannot_set_OIDCOptions",lw="cannot_allow_native_broker",cw="authority_mismatch";/*! @azure/msal-common v14.16.1 2025-08-05 */const YA={[Q1]:"A redirect URI is required for all calls, and none has been set.",[WA]:"Could not parse the given claims request object.",[X1]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[go]:"URL could not be parsed into appropriate segments.",[J1]:"URL was empty or null.",[Z1]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[ew]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[ep]:"Given claims parameter must be a stringified JSON object.",[tw]:"Token request was empty and not found in cache.",[rw]:"The logout request was null or undefined.",[nw]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[tp]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[rp]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[sw]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[iw]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Ju]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[aw]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[VA]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[qA]:"Invalid authentication header provided",[ow]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[lw]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[cw]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class np extends ht{constructor(e){super(e,YA[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,np.prototype)}}function Ze(t){return new np(t)}/*! @azure/msal-common v14.16.1 2025-08-05 */class vn{static isEmptyObj(e){if(e)try{const r=JSON.parse(e);return Object.keys(r).length===0}catch{}return!0}static startsWith(e,r){return e.indexOf(r)===0}static endsWith(e,r){return e.length>=r.length&&e.lastIndexOf(r)===e.length-r.length}static queryStringToObject(e){const r={},n=e.split("&"),s=i=>decodeURIComponent(i.replace(/\+/g," "));return n.forEach(i=>{if(i.trim()){const[a,o]=i.split(/=(.+)/g,2);a&&o&&(r[s(a)]=s(o))}}),r}static trimArrayEntries(e){return e.map(r=>r.trim())}static removeEmptyStringsFromArray(e){return e.filter(r=>!!r)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,r){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(r)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class yt{constructor(e){const r=e?vn.trimArrayEntries([...e]):[],n=r?vn.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(s=>this.scopes.add(s))}static fromString(e){const n=(e||V.EMPTY_STRING).split(" ");return new yt(n)}static createSearchScopes(e){const r=new yt(e);return r.containsOnlyOIDCScopes()?r.removeScope(V.OFFLINE_ACCESS_SCOPE):r.removeOIDCScopes(),r}validateInputScopes(e){if(!e||e.length<1)throw Ze(Z1)}containsScope(e){const r=this.printScopesLowerCase().split(" "),n=new yt(r);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(r=>this.containsScope(r))}containsOnlyOIDCScopes(){let e=0;return Tg.forEach(r=>{this.containsScope(r)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(r=>this.appendScope(r))}catch{throw ae(z1)}}removeScope(e){if(!e)throw ae(H1);this.scopes.delete(e.trim())}removeOIDCScopes(){Tg.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw ae(mf);const r=new Set;return e.scopes.forEach(n=>r.add(n.toLowerCase())),this.scopes.forEach(n=>r.add(n.toLowerCase())),r}intersectingScopeSets(e){if(!e)throw ae(mf);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const r=this.unionScopeSets(e),n=e.getScopeCount(),s=this.getScopeCount();return r.size<s+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(r=>e.push(r)),e}printScopes(){return this.scopes?this.asArray().join(" "):V.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.16.1 2025-08-05 */function iu(t,e){if(!t)throw ae(R1);try{const r=e(t);return JSON.parse(r)}catch{throw ae(G0)}}function da(t){if(!t)throw ae(G0);const e=t.split(rr.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?V.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.16.1 2025-08-05 */function au(t,e){return!!t&&!!e&&t===e.split(".")[1]}function sp(t,e,r,n){if(n){const{oid:s,sub:i,tid:a,name:o,tfp:l,acr:u}=n,d=a||l||u||"";return{tenantId:d,localAccountId:s||i||"",name:o,isHomeTenant:au(d,t)}}else return{tenantId:r,localAccountId:e,isHomeTenant:au(r,t)}}function ip(t,e,r,n){let s=t;if(e){const{isHomeTenant:i,...a}=e;s={...t,...a}}if(r){const{isHomeTenant:i,...a}=sp(t.homeAccountId,t.localAccountId,t.tenantId,r);return s={...s,...a,idTokenClaims:r,idToken:n},s}return s}/*! @azure/msal-common v14.16.1 2025-08-05 */const cn={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.16.1 2025-08-05 */function uw(t){return t&&(t.tid||t.tfp||t.acr)||null}/*! @azure/msal-common v14.16.1 2025-08-05 */const Jn={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.16.1 2025-08-05 */class Ot{generateAccountId(){return[this.homeAccountId,this.environment].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Ot.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const r=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",r||e.tenantId||""].join(rr.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,r,n){var u,d,h,f,p,g;const s=new Ot;r.authorityType===cn.Adfs?s.authorityType=tc.ADFS_ACCOUNT_TYPE:r.protocolMode===Jn.AAD?s.authorityType=tc.MSSTS_ACCOUNT_TYPE:s.authorityType=tc.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&n&&(i=iu(e.clientInfo,n)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const a=e.environment||r&&r.getPreferredCache();if(!a)throw ae(Y0);s.environment=a,s.realm=(i==null?void 0:i.utid)||uw(e.idTokenClaims)||"",s.localAccountId=(i==null?void 0:i.uid)||((u=e.idTokenClaims)==null?void 0:u.oid)||((d=e.idTokenClaims)==null?void 0:d.sub)||"";const o=((h=e.idTokenClaims)==null?void 0:h.preferred_username)||((f=e.idTokenClaims)==null?void 0:f.upn),l=(p=e.idTokenClaims)!=null&&p.emails?e.idTokenClaims.emails[0]:null;if(s.username=o||l||"",s.name=((g=e.idTokenClaims)==null?void 0:g.name)||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const m=sp(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[m]}return s}static createFromAccountInfo(e,r,n){var i;const s=new Ot;return s.authorityType=e.authorityType||tc.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.cloudGraphHostName=r,s.msGraphHost=n,s.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),s}static generateHomeAccountId(e,r,n,s,i){if(!(r===cn.Adfs||r===cn.Dsts)){if(e)try{const a=iu(e,s.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,r,n){if(!e||!r)return!1;let s=!0;if(n){const i=e.idTokenClaims||{},a=r.idTokenClaims||{};s=i.iat===a.iat&&i.nonce===a.nonce}return e.homeAccountId===r.homeAccountId&&e.localAccountId===r.localAccountId&&e.username===r.username&&e.tenantId===r.tenantId&&e.environment===r.environment&&e.nativeAccountId===r.nativeAccountId&&s}}/*! @azure/msal-common v14.16.1 2025-08-05 */function dw(t){return t.startsWith("#/")?t.substring(2):t.startsWith("#")||t.startsWith("?")?t.substring(1):t}function ou(t){if(!t||t.indexOf("=")<0)return null;try{const e=dw(t),r=Object.fromEntries(new URLSearchParams(e));if(r.code||r.error||r.error_description||r.state)return r}catch{throw ae(j1)}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */class Fe{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ze(J1);e.includes("#")||(this._urlString=Fe.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let r=e.toLowerCase();return vn.endsWith(r,"?")?r=r.slice(0,-1):vn.endsWith(r,"?/")&&(r=r.slice(0,-2)),vn.endsWith(r,"/")||(r+="/"),r}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Ze(go)}if(!e.HostNameAndPort||!e.PathSegments)throw Ze(go);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Ze(X1)}static appendQueryString(e,r){return r?e.indexOf("?")<0?`${e}?${r}`:`${e}&${r}`:e}static removeHashFromUrl(e){return Fe.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const r=this.getUrlComponents(),n=r.PathSegments;return e&&n.length!==0&&(n[0]===Ls.COMMON||n[0]===Ls.ORGANIZATIONS)&&(n[0]=e),Fe.constructAuthorityUriFromObject(r)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),r=this.urlString.match(e);if(!r)throw Ze(go);const n={Protocol:r[1],HostNameAndPort:r[4],AbsolutePath:r[5],QueryString:r[7]};let s=n.AbsolutePath.split("/");return s=s.filter(i=>i&&i.length>0),n.PathSegments=s,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const r=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(r);if(!n)throw Ze(go);return n[2]}static getAbsoluteUrl(e,r){if(e[0]===V.FORWARD_SLASH){const s=new Fe(r).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new Fe(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!ou(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const hw={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Lg=hw.endpointMetadata,ap=hw.instanceDiscoveryMetadata,fw=new Set;ap.metadata.forEach(t=>{t.aliases.forEach(e=>{fw.add(e)})});function QA(t,e){var s;let r;const n=t.canonicalAuthority;if(n){const i=new Fe(n).getUrlComponents().HostNameAndPort;r=jg(i,(s=t.cloudDiscoveryMetadata)==null?void 0:s.metadata,br.CONFIG,e)||jg(i,ap.metadata,br.HARDCODED_VALUES,e)||t.knownAuthorities}return r||[]}function jg(t,e,r,n){if(n==null||n.trace(`getAliasesFromMetadata called with source: ${r}`),t&&e){const s=lu(e,t);if(s)return n==null||n.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),s.aliases;n==null||n.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function XA(t){return lu(ap.metadata,t)}function lu(t,e){for(let r=0;r<t.length;r++){const n=t[r];if(n.aliases.includes(e))return n}return null}/*! @azure/msal-common v14.16.1 2025-08-05 */const op="cache_quota_exceeded",lp="cache_error_unknown";/*! @azure/msal-common v14.16.1 2025-08-05 */const eh={[op]:"Exceeded cache storage capacity.",[lp]:"Unexpected error occurred when using cache storage."};class wa extends Error{constructor(e,r){const n=r||(eh[e]?eh[e]:eh[lp]);super(`${e}: ${n}`),Object.setPrototypeOf(this,wa.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function pw(t){return t instanceof Error?t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED"||t.message.includes("exceeded the quota")?new wa(op):new wa(t.name,t.message):new wa(lp)}/*! @azure/msal-common v14.16.1 2025-08-05 */class La{constructor(e,r,n,s){this.clientId=e,this.cryptoImpl=r,this.commonLogger=n.clone(V1,X0),this.staticAuthorityOptions=s}getAllAccounts(e,r){return this.buildTenantProfiles(this.getAccountsFilteredBy(r||{},e),e,r)}getAccountInfoFilteredBy(e,r){const n=this.getAllAccounts(r,e);return n.length>1?n.sort(i=>i.idTokenClaims?-1:1)[0]:n.length===1?n[0]:null}getBaseAccountInfo(e,r){const n=this.getAccountsFilteredBy(e,r);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,r,n){return e.flatMap(s=>this.getTenantProfilesFromAccountEntity(s,r,n==null?void 0:n.tenantId,n))}getTenantedAccountInfoByFilter(e,r,n,s,i){let a=null,o;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;const l=this.getIdToken(e,s,r,n.tenantId);return l&&(o=Ai(l.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,i))?null:(a=ip(e,n,o,l==null?void 0:l.secret),a)}getTenantProfilesFromAccountEntity(e,r,n,s){const i=e.getAccountInfo();let a=i.tenantProfiles||new Map;const o=this.getTokenKeys();if(n){const u=a.get(n);if(u)a=new Map([[n,u]]);else return[]}const l=[];return a.forEach(u=>{const d=this.getTenantedAccountInfoByFilter(i,o,u,r,s);d&&l.push(d)}),l}tenantProfileMatchesFilter(e,r){return!(r.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,r.localAccountId)||r.name&&e.name!==r.name||r.isHomeTenant!==void 0&&e.isHomeTenant!==r.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,r){return!(r&&(r.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,r.localAccountId)||r.loginHint&&!this.matchLoginHintFromTokenClaims(e,r.loginHint)||r.username&&!this.matchUsername(e.preferred_username,r.username)||r.name&&!this.matchName(e,r.name)||r.sid&&!this.matchSid(e,r.sid)))}async saveCacheRecord(e,r,n){var s;if(!e)throw ae($1);try{e.account&&this.setAccount(e.account,r),e.idToken&&(n==null?void 0:n.idToken)!==!1&&this.setIdTokenCredential(e.idToken,r),e.accessToken&&(n==null?void 0:n.accessToken)!==!1&&await this.saveAccessToken(e.accessToken,r),e.refreshToken&&(n==null?void 0:n.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken,r),e.appMetadata&&this.setAppMetadata(e.appMetadata,r)}catch(i){throw(s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: failed"),i instanceof ht?i:pw(i)}}async saveAccessToken(e,r){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),i=yt.fromString(e.target);s.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,n,!1))return;const o=this.getAccessTokenCredential(a,r);o&&this.credentialMatchesFilter(o,n)&&yt.fromString(o.target).intersectingScopeSets(i)&&this.removeAccessToken(a,r)}),this.setAccessTokenCredential(e,r)}getAccountsFilteredBy(e,r){const n=this.getAccountKeys(),s=[];return n.forEach(i=>{var u;if(!this.isAccountKey(i,e.homeAccountId))return;const a=this.getAccount(i,r,this.commonLogger);if(!a||e.homeAccountId&&!this.matchHomeAccountId(a,e.homeAccountId)||e.username&&!this.matchUsername(a.username,e.username)||e.environment&&!this.matchEnvironment(a,e.environment)||e.realm&&!this.matchRealm(a,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(a,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(a,e.authorityType))return;const o={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},l=(u=a.tenantProfiles)==null?void 0:u.filter(d=>this.tenantProfileMatchesFilter(d,o));l&&l.length===0||s.push(a)}),s}isAccountKey(e,r,n){return!(e.split(rr.CACHE_KEY_SEPARATOR).length<3||r&&!e.toLowerCase().includes(r.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(rr.CACHE_KEY_SEPARATOR).length<6)return!1;const r=e.toLowerCase();if(r.indexOf(Ie.ID_TOKEN.toLowerCase())===-1&&r.indexOf(Ie.ACCESS_TOKEN.toLowerCase())===-1&&r.indexOf(Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&r.indexOf(Ie.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(r.indexOf(Ie.REFRESH_TOKEN.toLowerCase())>-1){const n=`${Ie.REFRESH_TOKEN}${rr.CACHE_KEY_SEPARATOR}${this.clientId}${rr.CACHE_KEY_SEPARATOR}`,s=`${Ie.REFRESH_TOKEN}${rr.CACHE_KEY_SEPARATOR}${ko}${rr.CACHE_KEY_SEPARATOR}`;if(r.indexOf(n.toLowerCase())===-1&&r.indexOf(s.toLowerCase())===-1)return!1}else if(r.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,r){return!(r.clientId&&!this.matchClientId(e,r.clientId)||r.userAssertionHash&&!this.matchUserAssertionHash(e,r.userAssertionHash)||typeof r.homeAccountId=="string"&&!this.matchHomeAccountId(e,r.homeAccountId)||r.environment&&!this.matchEnvironment(e,r.environment)||r.realm&&!this.matchRealm(e,r.realm)||r.credentialType&&!this.matchCredentialType(e,r.credentialType)||r.familyId&&!this.matchFamilyId(e,r.familyId)||r.target&&!this.matchTarget(e,r.target)||(r.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==r.requestedClaimsHash||e.credentialType===Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(r.tokenType&&!this.matchTokenType(e,r.tokenType)||r.tokenType===Xe.SSH&&r.keyId&&!this.matchKeyId(e,r.keyId)))}getAppMetadataFilteredBy(e){const r=this.getKeys(),n={};return r.forEach(s=>{if(!this.isAppMetadata(s))return;const i=this.getAppMetadata(s);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(n[s]=i))}),n}getAuthorityMetadataByAlias(e){const r=this.getAuthorityMetadataKeys();let n=null;return r.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const i=this.getAuthorityMetadata(s);i&&i.aliases.indexOf(e)!==-1&&(n=i)}),n}async removeAllAccounts(e){const r=this.getAccountKeys(),n=[];r.forEach(s=>{n.push(this.removeAccount(s,e))}),await Promise.all(n)}async removeAccount(e,r){const n=this.getAccount(e,r,this.commonLogger);n&&(await this.removeAccountContext(n,r),this.removeItem(e,r))}async removeAccountContext(e,r){const n=this.getTokenKeys(),s=e.generateAccountId();n.idToken.forEach(i=>{i.indexOf(s)===0&&this.removeIdToken(i,r)}),n.accessToken.forEach(i=>{i.indexOf(s)===0&&this.removeAccessToken(i,r)}),n.refreshToken.forEach(i=>{i.indexOf(s)===0&&this.removeRefreshToken(i,r)}),this.getKeys().forEach(i=>{i.includes(s)&&this.removeItem(i,r)})}updateOutdatedCachedAccount(e,r,n,s){var i;if(r&&r.isSingleTenant()){(i=this.commonLogger)==null||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const a=this.getAccountKeys().filter(h=>h.startsWith(r.homeAccountId)),o=[];a.forEach(h=>{const f=this.getCachedAccountEntity(h,n);f&&o.push(f)});const l=o.find(h=>au(h.realm,h.homeAccountId))||o[0];l.tenantProfiles=o.map(h=>({tenantId:h.realm,localAccountId:h.localAccountId,name:h.name,isHomeTenant:au(h.realm,h.homeAccountId)}));const u=La.toObject(new Ot,{...l}),d=u.generateAccountKey();return a.forEach(h=>{h!==d&&this.removeOutdatedAccount(e,n)}),this.setAccount(u,n),s==null||s.verbose("Updated an outdated account entity in the cache"),u}return r}removeAccessToken(e,r){const n=this.getAccessTokenCredential(e,r);if(this.removeItem(e,r),!n||n.credentialType.toLowerCase()!==Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==Xe.POP)return;const s=n.keyId;s&&this.cryptoImpl.removeTokenBindingKey(s).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(n=>{this.isAppMetadata(n)&&this.removeItem(n,e)}),!0}readAccountFromCache(e,r){const n=Ot.generateAccountCacheKey(e);return this.getAccount(n,r,this.commonLogger)}getIdToken(e,r,n,s,i){this.commonLogger.trace("CacheManager - getIdToken called");const a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ie.ID_TOKEN,clientId:this.clientId,realm:s},o=this.getIdTokensByFilter(a,r,n),l=o.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let u=o;if(!s){const d=new Map;o.forEach((f,p)=>{f.realm===e.tenantId&&d.set(p,f)});const h=d.size;if(h<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(h===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),d.values().next().value;u=d}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),u.forEach((d,h)=>{this.removeIdToken(h,r)}),i&&r&&i.addFields({multiMatchedID:o.size},r),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,r,n){const s=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return s.forEach(a=>{if(!this.idTokenKeyMatchesFilter(a,{clientId:this.clientId,...e}))return;const o=this.getIdTokenCredential(a,r);o&&this.credentialMatchesFilter(o,e)&&i.set(a,o)}),i}idTokenKeyMatchesFilter(e,r){const n=e.toLowerCase();return!(r.clientId&&n.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&n.indexOf(r.homeAccountId.toLowerCase())===-1)}removeIdToken(e,r){this.removeItem(e,r)}removeRefreshToken(e,r){this.removeItem(e,r)}getAccessToken(e,r,n,s,i){this.commonLogger.trace("CacheManager - getAccessToken called");const a=yt.createSearchScopes(r.scopes),o=r.authenticationScheme||Xe.BEARER,l=o&&o.toLowerCase()!==Xe.BEARER.toLowerCase()?Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME:Ie.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:s||e.tenantId,target:a,tokenType:o,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},d=n&&n.accessToken||this.getTokenKeys().accessToken,h=[];d.forEach(p=>{if(this.accessTokenKeyMatchesFilter(p,u,!0)){const g=this.getAccessTokenCredential(p,r.correlationId);g&&this.credentialMatchesFilter(g,u)&&h.push(g)}});const f=h.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach(p=>{this.removeAccessToken(ua(p),r.correlationId)}),i&&r.correlationId&&i.addFields({multiMatchedAT:h.length},r.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,r,n){const s=e.toLowerCase();if(r.clientId&&s.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&s.indexOf(r.homeAccountId.toLowerCase())===-1||r.realm&&s.indexOf(r.realm.toLowerCase())===-1||r.requestedClaimsHash&&s.indexOf(r.requestedClaimsHash.toLowerCase())===-1)return!1;if(r.target){const i=r.target.asArray();for(let a=0;a<i.length;a++){if(n&&!s.includes(i[a].toLowerCase()))return!1;if(!n&&s.includes(i[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,r){const n=this.getTokenKeys(),s=[];return n.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;const a=this.getAccessTokenCredential(i,r);a&&this.credentialMatchesFilter(a,e)&&s.push(a)}),s}getRefreshToken(e,r,n,s,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const a=r?ko:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Ie.REFRESH_TOKEN,clientId:this.clientId,familyId:a},l=s&&s.refreshToken||this.getTokenKeys().refreshToken,u=[];l.forEach(h=>{if(this.refreshTokenKeyMatchesFilter(h,o)){const f=this.getRefreshTokenCredential(h,n);f&&this.credentialMatchesFilter(f,o)&&u.push(f)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&i&&n&&i.addFields({multiMatchedRT:d},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),u[0])}refreshTokenKeyMatchesFilter(e,r){const n=e.toLowerCase();return!(r.familyId&&n.indexOf(r.familyId.toLowerCase())===-1||!r.familyId&&r.clientId&&n.indexOf(r.clientId.toLowerCase())===-1||r.homeAccountId&&n.indexOf(r.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const r={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(r),s=Object.keys(n).map(a=>n[a]),i=s.length;if(i<1)return null;if(i>1)throw ae(U1);return s[0]}isAppMetadataFOCI(e){const r=this.readAppMetadataFromCache(e);return!!(r&&r.familyId===ko)}matchHomeAccountId(e,r){return typeof e.homeAccountId=="string"&&r===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,r){const n=e.oid||e.sub;return r===n}matchLocalAccountIdFromTenantProfile(e,r){return e.localAccountId===r}matchName(e,r){var n;return r.toLowerCase()===((n=e.name)==null?void 0:n.toLowerCase())}matchUsername(e,r){return!!(e&&typeof e=="string"&&(r==null?void 0:r.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,r){return!!(e.userAssertionHash&&r===e.userAssertionHash)}matchEnvironment(e,r){if(this.staticAuthorityOptions){const s=QA(this.staticAuthorityOptions,this.commonLogger);if(s.includes(r)&&s.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(r);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,r){return e.credentialType&&r.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,r){return!!(e.clientId&&r===e.clientId)}matchFamilyId(e,r){return!!(e.familyId&&r===e.familyId)}matchRealm(e,r){var n;return((n=e.realm)==null?void 0:n.toLowerCase())===r.toLowerCase()}matchNativeAccountId(e,r){return!!(e.nativeAccountId&&r===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,r){return e.login_hint===r||e.preferred_username===r||e.upn===r}matchSid(e,r){return e.sid===r}matchAuthorityType(e,r){return!!(e.authorityType&&r.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,r){return e.credentialType!==Ie.ACCESS_TOKEN&&e.credentialType!==Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:yt.fromString(e.target).containsScopeSet(r)}matchTokenType(e,r){return!!(e.tokenType&&e.tokenType===r)}matchKeyId(e,r){return!!(e.keyId&&e.keyId===r)}isAppMetadata(e){return e.indexOf($0)!==-1}isAuthorityMetadata(e){return e.indexOf(ru.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${ru.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,r){for(const n in r)e[n]=r[n];return e}}class JA extends La{setAccount(){throw ae(je)}getAccount(){throw ae(je)}getCachedAccountEntity(){throw ae(je)}setIdTokenCredential(){throw ae(je)}getIdTokenCredential(){throw ae(je)}setAccessTokenCredential(){throw ae(je)}getAccessTokenCredential(){throw ae(je)}setRefreshTokenCredential(){throw ae(je)}getRefreshTokenCredential(){throw ae(je)}setAppMetadata(){throw ae(je)}getAppMetadata(){throw ae(je)}setServerTelemetry(){throw ae(je)}getServerTelemetry(){throw ae(je)}setAuthorityMetadata(){throw ae(je)}getAuthorityMetadata(){throw ae(je)}getAuthorityMetadataKeys(){throw ae(je)}setThrottlingCache(){throw ae(je)}getThrottlingCache(){throw ae(je)}removeItem(){throw ae(je)}getKeys(){throw ae(je)}getAccountKeys(){throw ae(je)}getTokenKeys(){throw ae(je)}updateCredentialCacheKey(){throw ae(je)}removeOutdatedAccount(){throw ae(je)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const mw={tokenRenewalOffsetSeconds:yA,preventCorsPreflight:!1},ZA={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ye.Info,correlationId:V.EMPTY_STRING},eb={claimsBasedCachingEnabled:!1},tb={async sendGetRequestAsync(){throw ae(je)},async sendPostRequestAsync(){throw ae(je)}},rb={sku:V.SKU,version:X0,cpu:V.EMPTY_STRING,os:V.EMPTY_STRING},nb={clientSecret:V.EMPTY_STRING,clientAssertion:void 0},sb={azureCloudInstance:J0.None,tenant:`${V.DEFAULT_COMMON_TENANT}`},ib={application:{appName:"",appVersion:""}};function ab({authOptions:t,systemOptions:e,loggerOptions:r,cacheOptions:n,storageInterface:s,networkInterface:i,cryptoInterface:a,clientCredentials:o,libraryInfo:l,telemetry:u,serverTelemetryManager:d,persistencePlugin:h,serializableCache:f}){const p={...ZA,...r};return{authOptions:ob(t),systemOptions:{...mw,...e},loggerOptions:p,cacheOptions:{...eb,...n},storageInterface:s||new JA(t.clientId,su,new as(p)),networkInterface:i||tb,cryptoInterface:a||su,clientCredentials:o||nb,libraryInfo:{...rb,...l},telemetry:{...ib,...u},serverTelemetryManager:d||null,persistencePlugin:h||null,serializableCache:f||null}}function ob(t){return{clientCapabilities:[],azureCloudOptions:sb,skipAuthorityMetadataCache:!1,instanceAware:!1,...t}}function wf(t){return t.authOptions.authority.options.protocolMode===Jn.OIDC}/*! @azure/msal-common v14.16.1 2025-08-05 */const Mr={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.16.1 2025-08-05 */const vi="client_id",gw="redirect_uri",Mg="response_type",lb="response_mode",cb="grant_type",ub="claims",db="scope",hb="refresh_token",fb="state",pb="nonce",mb="prompt",gb="code",vb="code_challenge",xb="code_challenge_method",yb="code_verifier",wb="client-request-id",_b="x-client-SKU",Eb="x-client-VER",Tb="x-client-OS",Cb="x-client-CPU",Sb="x-client-current-telemetry",Ab="x-client-last-telemetry",bb="x-ms-lib-capability",kb="x-app-name",Ib="x-app-ver",Nb="post_logout_redirect_uri",Rb="id_token_hint",Ob="device_code",Pb="client_secret",Lb="client_assertion",jb="client_assertion_type",Dg="token_type",Fg="req_cnf",Mb="assertion",Db="requested_token_use",Ug="return_spa_code",Fb="nativebroker",Ub="logout_hint",Bb="sid",Hb="login_hint",zb="domain_hint",$b="x-client-xtra-sku",cp="brk_client_id",_f="brk_redirect_uri";/*! @azure/msal-common v14.16.1 2025-08-05 */class Wi{static validateRedirectUri(e){if(!e)throw Ze(Q1)}static validatePrompt(e){const r=[];for(const n in Mt)r.push(Mt[n]);if(r.indexOf(e)<0)throw Ze(ew)}static validateClaims(e){try{JSON.parse(e)}catch{throw Ze(ep)}}static validateCodeChallengeParams(e,r){if(!e||!r)throw Ze(tp);this.validateCodeChallengeMethod(r)}static validateCodeChallengeMethod(e){if([Cg.PLAIN,Cg.S256].indexOf(e)<0)throw Ze(nw)}}/*! @azure/msal-common v14.16.1 2025-08-05 */function Kb(t,e,r){if(!e)return;const n=t.get(vi);n&&t.has(cp)&&(r==null||r.addFields({embeddedClientId:n,embeddedRedirectUri:t.get(gw)},e))}class No{constructor(e,r){this.parameters=new Map,this.performanceClient=r,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Mg,encodeURIComponent(V.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Mg,encodeURIComponent(`${V.TOKEN_RESPONSE_TYPE} ${V.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(lb,encodeURIComponent(e||gA.QUERY))}addNativeBroker(){this.parameters.set(Fb,encodeURIComponent("1"))}addScopes(e,r=!0,n=Ka){r&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");const s=r?[...e||[],...n]:e||[],i=new yt(s);this.parameters.set(db,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(vi,encodeURIComponent(e))}addRedirectUri(e){Wi.validateRedirectUri(e),this.parameters.set(gw,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Wi.validateRedirectUri(e),this.parameters.set(Nb,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(Rb,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(zb,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(Hb,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(cr.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(cr.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(Bb,encodeURIComponent(e))}addClaims(e,r){const n=this.addClientCapabilitiesToClaims(e,r);Wi.validateClaims(n),this.parameters.set(ub,encodeURIComponent(n))}addCorrelationId(e){this.parameters.set(wb,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(_b,e.sku),this.parameters.set(Eb,e.version),e.os&&this.parameters.set(Tb,e.os),e.cpu&&this.parameters.set(Cb,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(kb,e.appName),e!=null&&e.appVersion&&this.parameters.set(Ib,e.appVersion)}addPrompt(e){Wi.validatePrompt(e),this.parameters.set(`${mb}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(fb,encodeURIComponent(e))}addNonce(e){this.parameters.set(pb,encodeURIComponent(e))}addCodeChallengeParams(e,r){if(Wi.validateCodeChallengeParams(e,r),e&&r)this.parameters.set(vb,encodeURIComponent(e)),this.parameters.set(xb,encodeURIComponent(r));else throw Ze(tp)}addAuthorizationCode(e){this.parameters.set(gb,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(Ob,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(hb,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(yb,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(Pb,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(Lb,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(jb,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(Mb,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(Db,encodeURIComponent(e))}addGrantType(e){this.parameters.set(cb,encodeURIComponent(e))}addClientInfo(){this.parameters.set(vA,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([r,n])=>{!this.parameters.has(r)&&n&&this.parameters.set(r,n)})}addClientCapabilitiesToClaims(e,r){let n;if(!e)n={};else try{n=JSON.parse(e)}catch{throw Ze(ep)}return r&&r.length>0&&(n.hasOwnProperty(ec.ACCESS_TOKEN)||(n[ec.ACCESS_TOKEN]={}),n[ec.ACCESS_TOKEN][ec.XMS_CC]={values:r}),JSON.stringify(n)}addUsername(e){this.parameters.set(Ag.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Ag.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Dg,Xe.POP),this.parameters.set(Fg,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Dg,Xe.SSH),this.parameters.set(Fg,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(Sb,e.generateCurrentRequestHeaderValue()),this.parameters.set(Ab,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(bb,Io.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(Ub,encodeURIComponent(e))}addBrokerParameters(e){const r={};r[cp]=e.brokerClientId,r[_f]=e.brokerRedirectUri,this.addExtraQueryParameters(r)}createQueryString(){const e=new Array;return this.parameters.forEach((r,n)=>{e.push(`${n}=${r}`)}),Kb(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v14.16.1 2025-08-05 */function Gb(t){return t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.16.1 2025-08-05 */function Wb(t){return t.hasOwnProperty("tenant_discovery_endpoint")&&t.hasOwnProperty("metadata")}/*! @azure/msal-common v14.16.1 2025-08-05 */function Vb(t){return t.hasOwnProperty("error")&&t.hasOwnProperty("error_description")}/*! @azure/msal-common v14.16.1 2025-08-05 */const U={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},qb={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v14.16.1 2025-08-05 */const bi=(t,e,r,n,s)=>(...i)=>{r.trace(`Executing function ${e}`);const a=n==null?void 0:n.startMeasurement(e,s);if(s){const o=e+"CallCount";n==null||n.incrementFields({[o]:1},s)}try{const o=t(...i);return a==null||a.end({success:!0}),r.trace(`Returning result from ${e}`),o}catch(o){r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(o))}catch{r.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o}},he=(t,e,r,n,s)=>(...i)=>{r.trace(`Executing function ${e}`);const a=n==null?void 0:n.startMeasurement(e,s);if(s){const o=e+"CallCount";n==null||n.incrementFields({[o]:1},s)}return n==null||n.setPreQueueTime(e,s),t(...i).then(o=>(r.trace(`Returning result from ${e}`),a==null||a.end({success:!0}),o)).catch(o=>{r.trace(`Error occurred in ${e}`);try{r.trace(JSON.stringify(o))}catch{r.trace("Unable to print error message.")}throw a==null||a.end({success:!1},o),o})};/*! @azure/msal-common v14.16.1 2025-08-05 */class Zu{constructor(e,r,n,s){this.networkInterface=e,this.logger=r,this.performanceClient=n,this.correlationId=s}async detectRegion(e,r){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(U.RegionDiscoveryDetectRegion,this.correlationId);let n=e;if(n)r.region_source=Di.ENVIRONMENT_VARIABLE;else{const i=Zu.IMDS_OPTIONS;try{const a=await he(this.getRegionFromIMDS.bind(this),U.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(V.IMDS_VERSION,i);if(a.status===rc.httpSuccess&&(n=a.body,r.region_source=Di.IMDS),a.status===rc.httpBadRequest){const o=await he(this.getCurrentVersion.bind(this),U.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!o)return r.region_source=Di.FAILED_AUTO_DETECTION,null;const l=await he(this.getRegionFromIMDS.bind(this),U.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(o,i);l.status===rc.httpSuccess&&(n=l.body,r.region_source=Di.IMDS)}}catch{return r.region_source=Di.FAILED_AUTO_DETECTION,null}}return n||(r.region_source=Di.FAILED_AUTO_DETECTION),n||null}async getRegionFromIMDS(e,r){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(U.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${V.IMDS_ENDPOINT}?api-version=${e}&format=text`,r,V.IMDS_TIMEOUT)}async getCurrentVersion(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(U.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const n=await this.networkInterface.sendGetRequestAsync(`${V.IMDS_ENDPOINT}?format=json`,e);return n.status===rc.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch{return null}}}Zu.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.16.1 2025-08-05 */class er{constructor(e,r,n,s,i,a,o,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=r,this.cacheManager=n,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=o,this.correlationId=a,this.managedIdentity=l||!1,this.regionDiscovery=new Zu(r,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(V.CIAM_AUTH_URL))return cn.Ciam;const r=e.PathSegments;if(r.length)switch(r[0].toLowerCase()){case V.ADFS:return cn.Adfs;case V.DSTS:return cn.Dsts}return cn.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Fe(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw ae($n)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw ae($n)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw ae($n)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ae(W1);return this.replacePath(this.metadata.end_session_endpoint)}else throw ae($n)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw ae($n)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw ae($n)}canReplaceTenant(e){return e.PathSegments.length===1&&!er.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===cn.Default&&this.protocolMode===Jn.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let r=e;const s=new Fe(this.metadata.canonical_authority).getUrlComponents(),i=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((o,l)=>{let u=i[l];if(l===0&&this.canReplaceTenant(s)){const d=new Fe(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];u!==d&&(this.logger.verbose(`Replacing tenant domain name ${u} with id ${d}`),u=d)}o!==u&&(r=r.replace(`/${u}/`,`/${o}/`))}),this.replaceTenant(r)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===cn.Adfs||this.protocolMode!==Jn.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var s,i;(s=this.performanceClient)==null||s.addQueueMeasurement(U.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),r=await he(this.updateCloudDiscoveryMetadata.bind(this),U.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const n=await he(this.updateEndpointMetadata.bind(this),U.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,r,{source:n}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:r,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Og(),jwks_uri:""}),e}updateCachedMetadata(e,r,n){r!==br.CACHE&&(n==null?void 0:n.source)!==br.CACHE&&(e.expiresAt=Og(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){var s,i,a;(s=this.performanceClient)==null||s.addQueueMeasurement(U.AuthorityUpdateEndpointMetadata,this.correlationId);const r=this.updateEndpointMetadataFromLocalSources(e);if(r){if(r.source===br.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&r.metadata){const o=await he(this.updateMetadataWithRegionalInformation.bind(this),U.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r.metadata);nc(e,o,!1),e.canonical_authority=this.canonicalAuthority}return r.source}let n=await he(this.getEndpointMetadataFromNetwork.bind(this),U.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return(a=this.authorityOptions.azureRegionConfiguration)!=null&&a.azureRegion&&(n=await he(this.updateMetadataWithRegionalInformation.bind(this),U.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),nc(e,n,!0),br.NETWORK;throw ae(L1,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const r=this.getEndpointMetadataFromConfig();if(r)return this.logger.verbose("Found endpoint metadata in authority configuration"),nc(e,r,!1),{source:br.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return nc(e,s,!1),{source:br.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=Pg(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:br.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Fe(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ze(sw)}return null}async getEndpointMetadataFromNetwork(){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(U.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},r=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${r}`);try{const s=await this.networkInterface.sendGetRequestAsync(r,e);return Gb(s.body)?s.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(s){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${s}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Lg?Lg[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var n,s,i;(n=this.performanceClient)==null||n.addQueueMeasurement(U.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const r=(s=this.authorityOptions.azureRegionConfiguration)==null?void 0:s.azureRegion;if(r){if(r!==V.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Jd.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=r,er.replaceWithRegionalInformation(e,r);const a=await he(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),U.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=Jd.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,er.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=Jd.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(U.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const r=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(r)return r;const n=await he(this.getCloudDiscoveryMetadataFromNetwork.bind(this),U.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return Zd(e,n,!0),br.NETWORK;throw Ze(iw)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||V.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||V.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||V.NOT_APPLICABLE}`);const r=this.getCloudDiscoveryMetadataFromConfig();if(r)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Zd(e,r,!1),br.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=XA(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Zd(e,s,!1),br.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const n=Pg(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),br.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===cn.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),er.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=lu(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),r)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),r;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ze(rp)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),er.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(U.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${V.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,r={};let n=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,r);let a,o;if(Wb(i.body))a=i.body,o=a.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${a.tenant_discovery_endpoint}`);else if(Vb(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),a=i.body,a.error===V.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${a.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${a.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=lu(o,this.hostnameAndPort)}catch(i){if(i instanceof ht)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{const a=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${a.name}
Error Description: ${a.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=er.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(r=>r&&Fe.getDomainFromUrl(r).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,r){let n;if(r&&r.azureCloudInstance!==J0.None){const s=r.tenant?r.tenant:V.DEFAULT_COMMON_TENANT;n=`${r.azureCloudInstance}/${s}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return V.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw ae($n)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return fw.has(e)}static isPublicCloudAuthority(e){return V.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,r,n){const s=new Fe(e);s.validateAsUri();const i=s.getUrlComponents();let a=`${r}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${r}.${V.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const o=Fe.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:a}).urlString;return n?`${o}?${n}`:o}static replaceWithRegionalInformation(e,r){const n={...e};return n.authorization_endpoint=er.buildRegionalAuthorityString(n.authorization_endpoint,r),n.token_endpoint=er.buildRegionalAuthorityString(n.token_endpoint,r),n.end_session_endpoint&&(n.end_session_endpoint=er.buildRegionalAuthorityString(n.end_session_endpoint,r)),n}static transformCIAMAuthority(e){let r=e;const s=new Fe(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(V.CIAM_AUTH_URL)){const i=s.HostNameAndPort.split(".")[0];r=`${r}${i}${V.AAD_TENANT_DOMAIN_SUFFIX}`}return r}}er.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ls.COMMON,Ls.CONSUMERS,Ls.ORGANIZATIONS]);function Yb(t){var s;const n=(s=new Fe(t).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:s.toLowerCase();switch(n){case Ls.COMMON:case Ls.ORGANIZATIONS:case Ls.CONSUMERS:return;default:return n}}function vw(t){return t.endsWith(V.FORWARD_SLASH)?t:`${t}${V.FORWARD_SLASH}`}function Qb(t){const e=t.cloudDiscoveryMetadata;let r;if(e)try{r=JSON.parse(e)}catch{throw Ze(rp)}return{canonicalAuthority:t.authority?vw(t.authority):void 0,knownAuthorities:t.knownAuthorities,cloudDiscoveryMetadata:r}}/*! @azure/msal-common v14.16.1 2025-08-05 */async function xw(t,e,r,n,s,i,a){a==null||a.addQueueMeasurement(U.AuthorityFactoryCreateDiscoveredInstance,i);const o=er.transformCIAMAuthority(vw(t)),l=new er(o,e,r,n,s,i,a);try{return await he(l.resolveEndpointsAsync.bind(l),U.AuthorityResolveEndpointsAsync,s,a,i)(),l}catch{throw ae($n)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Ds extends ht{constructor(e,r,n,s,i){super(e,r,n),this.name="ServerError",this.errorNo=s,this.status=i,Object.setPrototypeOf(this,Ds.prototype)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Nn{static generateThrottlingStorageKey(e){return`${Io.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,r,n){var a;const s=Nn.generateThrottlingStorageKey(r),i=e.getThrottlingCache(s);if(i){if(i.throttleTime<Date.now()){e.removeItem(s,n);return}throw new Ds(((a=i.errorCodes)==null?void 0:a.join(" "))||V.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,r,n,s){if(Nn.checkResponseStatus(n)||Nn.checkResponseForRetryAfter(n)){const i={throttleTime:Nn.calculateThrottleTime(parseInt(n.headers[cr.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(Nn.generateThrottlingStorageKey(r),i,s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(cr.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const r=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(r||Io.DEFAULT_THROTTLE_TIME_SECONDS),n+Io.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,r,n,s){const i={clientId:r,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:s,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(i);e.removeItem(a,n.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class ed extends ht{constructor(e,r,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,ed.prototype),this.name="NetworkError",this.error=e,this.httpStatus=r,this.responseHeaders=n}}function Bg(t,e,r){return new ed(t,e,r)}/*! @azure/msal-common v14.16.1 2025-08-05 */class up{constructor(e,r){this.config=ab(e),this.logger=new as(this.config.loggerOptions,V1,X0),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=r}createTokenRequestHeaders(e){const r={};if(r[cr.CONTENT_TYPE]=V.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Mr.HOME_ACCOUNT_ID:try{const n=da(e.credential);r[cr.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Mr.UPN:r[cr.CCS_HEADER]=`UPN: ${e.credential}`;break}return r}async executePostToTokenEndpoint(e,r,n,s,i,a){var l;a&&((l=this.performanceClient)==null||l.addQueueMeasurement(a,i));const o=await this.sendPostRequest(s,e,{body:r,headers:n},i);return this.config.serverTelemetryManager&&o.status<500&&o.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,r,n,s){var a,o,l;Nn.preProcess(this.cacheManager,e,s);let i;try{i=await he(this.networkClient.sendPostRequestAsync.bind(this.networkClient),U.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(r,n);const u=i.headers||{};(o=this.performanceClient)==null||o.addFields({refreshTokenSize:((a=i.body.refresh_token)==null?void 0:a.length)||0,httpVerToken:u[cr.X_MS_HTTP_VERSION]||"",requestId:u[cr.X_MS_REQUEST_ID]||""},s)}catch(u){if(u instanceof ed){const d=u.responseHeaders;throw d&&((l=this.performanceClient)==null||l.addFields({httpVerToken:d[cr.X_MS_HTTP_VERSION]||"",requestId:d[cr.X_MS_REQUEST_ID]||"",contentTypeHeader:d[cr.CONTENT_TYPE]||void 0,contentLengthHeader:d[cr.CONTENT_LENGTH]||void 0,httpStatus:u.httpStatus},s)),u.error}throw u instanceof ht?u:ae(P1)}return Nn.postProcess(this.cacheManager,e,i,s),i}async updateAuthority(e,r){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(U.UpdateTokenEndpointAuthority,r);const n=`https://${e}/${this.authority.tenant}/`,s=await xw(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,r,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const r=new No(e.correlationId,this.performanceClient);return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&r.addExtraQueryParameters(e.tokenQueryParameters),r.addCorrelationId(e.correlationId),r.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */const cu="no_tokens_found",yw="native_account_unavailable",dp="refresh_token_expired",Xb="interaction_required",Jb="consent_required",Zb="login_required",td="bad_token";/*! @azure/msal-common v14.16.1 2025-08-05 */const Hg=[Xb,Jb,Zb,td],e2=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],t2={[cu]:"No refresh token found in the cache. Please sign-in.",[yw]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[dp]:"Refresh token has expired.",[td]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class _n extends ht{constructor(e,r,n,s,i,a,o,l){super(e,r,n),Object.setPrototypeOf(this,_n.prototype),this.timestamp=s||V.EMPTY_STRING,this.traceId=i||V.EMPTY_STRING,this.correlationId=a||V.EMPTY_STRING,this.claims=o||V.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function zg(t,e,r){const n=!!t&&Hg.indexOf(t)>-1,s=!!r&&e2.indexOf(r)>-1,i=!!e&&Hg.some(a=>e.indexOf(a)>-1);return n||i||s}function Ef(t){return new _n(t,t2[t])}/*! @azure/msal-common v14.16.1 2025-08-05 */class xn{static setRequestState(e,r,n){const s=xn.generateLibraryState(e,n);return r?`${s}${V.RESOURCE_DELIM}${r}`:s}static generateLibraryState(e,r){if(!e)throw ae(vf);const n={id:e.createNewGuid()};r&&(n.meta=r);const s=JSON.stringify(n);return e.base64Encode(s)}static parseRequestState(e,r){if(!e)throw ae(vf);if(!r)throw ae(Pa);try{const n=r.split(V.RESOURCE_DELIM),s=n[0],i=n.length>1?n.slice(1).join(V.RESOURCE_DELIM):V.EMPTY_STRING,a=e.base64Decode(s),o=JSON.parse(a);return{userRequestState:i||V.EMPTY_STRING,libraryState:o}}catch{throw ae(Pa)}}}/*! @azure/msal-common v14.16.1 2025-08-05 */const r2={SW:"sw",UHW:"uhw"};class ja{constructor(e,r){this.cryptoUtils=e,this.performanceClient=r}async generateCnf(e,r){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(U.PopTokenGenerateCnf,e.correlationId);const n=await he(this.generateKid.bind(this),U.PopTokenGenerateCnf,r,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:s}}async generateKid(e){var n;return(n=this.performanceClient)==null||n.addQueueMeasurement(U.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:r2.SW}}async signPopToken(e,r,n){return this.signPayload(e,r,n)}async signPayload(e,r,n,s){const{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:o,shrNonce:l,shrOptions:u}=n,d=a?new Fe(a):void 0,h=d==null?void 0:d.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Mn(),m:i==null?void 0:i.toUpperCase(),u:h==null?void 0:h.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:h==null?void 0:h.AbsolutePath,q:h!=null&&h.QueryString?[[],h.QueryString]:void 0,client_claims:o||void 0,...s},r,u,n.correlationId)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class n2{constructor(e,r){this.cache=e,this.hasChanged=r}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.16.1 2025-08-05 */function s2(t){var n,s;const e="code=",r=(n=t.error_uri)==null?void 0:n.lastIndexOf(e);return r&&r>=0?(s=t.error_uri)==null?void 0:s.substring(r+e.length):void 0}class xi{constructor(e,r,n,s,i,a,o){this.clientId=e,this.cacheStorage=r,this.cryptoObj=n,this.logger=s,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,r){if(!e.state||!r)throw e.state?ae(nu,"Cached State"):ae(nu,"Server State");let n,s;try{n=decodeURIComponent(e.state)}catch{throw ae(Pa,e.state)}try{s=decodeURIComponent(r)}catch{throw ae(Pa,e.state)}if(n!==s)throw ae(M1);if(e.error||e.error_description||e.suberror){const i=s2(e);throw zg(e.error,e.error_description,e.suberror)?new _n(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new Ds(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,r){var n;if(e.error||e.error_description||e.suberror){const s=`Error(s): ${e.error_codes||V.NOT_AVAILABLE} - Timestamp: ${e.timestamp||V.NOT_AVAILABLE} - Description: ${e.error_description||V.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||V.NOT_AVAILABLE} - Trace ID: ${e.trace_id||V.NOT_AVAILABLE}`,i=(n=e.error_codes)!=null&&n.length?e.error_codes[0]:void 0,a=new Ds(e.error,s,e.suberror,i,e.status);if(r&&e.status&&e.status>=Zl.SERVER_ERROR_RANGE_START&&e.status<=Zl.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${a}`);return}else if(r&&e.status&&e.status>=Zl.CLIENT_ERROR_RANGE_START&&e.status<=Zl.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${a}`);return}throw zg(e.error,e.error_description,e.suberror)?new _n(e.error,e.error_description,e.suberror,e.timestamp||V.EMPTY_STRING,e.trace_id||V.EMPTY_STRING,e.correlation_id||V.EMPTY_STRING,e.claims||V.EMPTY_STRING,i):a}}async handleServerTokenResponse(e,r,n,s,i,a,o,l,u){var g;(g=this.performanceClient)==null||g.addQueueMeasurement(U.HandleServerTokenResponse,e.correlation_id);let d;if(e.id_token){if(d=Ai(e.id_token||V.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&d.nonce!==i.nonce)throw ae(D1);if(s.maxAge||s.maxAge===0){const m=d.auth_time;if(!m)throw ae(V0);q1(m,s.maxAge)}}this.homeAccountIdentifier=Ot.generateHomeAccountId(e.client_info||V.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,d);let h;i&&i.state&&(h=xn.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||s.sshKid||void 0;const f=this.generateCacheRecord(e,r,n,s,d,a,i);let p;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new n2(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(p)),o&&!l&&f.account){const m=f.account.generateAccountKey();if(!this.cacheStorage.getAccount(m,s.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await xi.generateAuthenticationResult(this.cryptoObj,r,f,!1,s,d,h,void 0,u)}await this.cacheStorage.saveCacheRecord(f,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&p&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(p))}return xi.generateAuthenticationResult(this.cryptoObj,r,f,!1,s,d,h,e,u)}generateCacheRecord(e,r,n,s,i,a,o){const l=r.getPreferredCache();if(!l)throw ae(Y0);const u=uw(i);let d,h;e.id_token&&i&&(d=Qu(this.homeAccountIdentifier,l,e.id_token,this.clientId,u||""),h=hp(this.cacheStorage,r,this.homeAccountIdentifier,this.cryptoObj.base64Decode,s.correlationId,i,e.client_info,l,u,o,void 0,this.logger));let f=null;if(e.access_token){const m=e.scope?yt.fromString(e.scope):new yt(s.scopes||[]),w=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,v=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,x=n+w,_=x+v,P=y&&y>0?n+y:void 0;f=Xu(this.homeAccountIdentifier,l,e.access_token,this.clientId,u||r.tenant||"",m.printScopes(),x,_,this.cryptoObj.base64Decode,P,e.token_type,a,e.key_id,s.claims,s.requestedClaimsHash)}let p=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const w=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=n+w}p=Y1(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,a,m)}let g=null;return e.foci&&(g={clientId:this.clientId,environment:l,familyId:e.foci}),{account:h,idToken:d,accessToken:f,refreshToken:p,appMetadata:g}}static async generateAuthenticationResult(e,r,n,s,i,a,o,l,u){var x,_,P,S,T;let d=V.EMPTY_STRING,h=[],f=null,p,g,m=V.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===Xe.POP&&!i.popKid){const O=new ja(e),{secret:L,keyId:j}=n.accessToken;if(!j)throw ae(Q0);d=await O.signPopToken(L,j,i)}else d=n.accessToken.secret;h=yt.fromString(n.accessToken.target).asArray(),f=new Date(Number(n.accessToken.expiresOn)*1e3),p=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),n.accessToken.refreshOn&&(g=new Date(Number(n.accessToken.refreshOn)*1e3))}n.appMetadata&&(m=n.appMetadata.familyId===ko?ko:"");const w=(a==null?void 0:a.oid)||(a==null?void 0:a.sub)||"",v=(a==null?void 0:a.tid)||"";l!=null&&l.spa_accountid&&n.account&&(n.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=n.account?ip(n.account.getAccountInfo(),void 0,a,(x=n.idToken)==null?void 0:x.secret):null;return{authority:r.canonicalAuthority,uniqueId:w,tenantId:v,scopes:h,account:y,idToken:((_=n==null?void 0:n.idToken)==null?void 0:_.secret)||"",idTokenClaims:a||{},accessToken:d,fromCache:s,expiresOn:f,extExpiresOn:p,refreshOn:g,correlationId:i.correlationId,requestId:u||V.EMPTY_STRING,familyId:m,tokenType:((P=n.accessToken)==null?void 0:P.tokenType)||V.EMPTY_STRING,state:o?o.userRequestState:V.EMPTY_STRING,cloudGraphHostName:((S=n.account)==null?void 0:S.cloudGraphHostName)||V.EMPTY_STRING,msGraphHost:((T=n.account)==null?void 0:T.msGraphHost)||V.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function hp(t,e,r,n,s,i,a,o,l,u,d,h){h==null||h.verbose("setCachedAccount called");const p=t.getAccountKeys().find(y=>y.startsWith(r));let g=null;p&&(g=t.getAccount(p,s,h));const m=g||Ot.createAccount({homeAccountId:r,idTokenClaims:i,clientInfo:a,environment:o,cloudGraphHostName:u==null?void 0:u.cloud_graph_host_name,msGraphHost:u==null?void 0:u.msgraph_host,nativeAccountId:d},e,n),w=m.tenantProfiles||[],v=l||m.realm;if(v&&!w.find(y=>y.tenantId===v)){const y=sp(r,m.localAccountId,v,i);w.push(y)}return m.tenantProfiles=w,m}/*! @azure/msal-common v14.16.1 2025-08-05 */async function ww(t,e,r){return typeof t=="string"?t:t({clientId:e,tokenEndpoint:r})}/*! @azure/msal-common v14.16.1 2025-08-05 */class _w extends up{constructor(e,r){var n;super(e,r),this.includeRedirectUri=!0,this.oidcDefaultScopes=(n=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:n.defaultScopes}async getAuthCodeUrl(e){var n;(n=this.performanceClient)==null||n.addQueueMeasurement(U.GetAuthCodeUrl,e.correlationId);const r=await he(this.createAuthCodeUrlQueryString.bind(this),U.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Fe.appendQueryString(this.authority.authorizationEndpoint,r)}async acquireToken(e,r){var o,l;if((o=this.performanceClient)==null||o.addQueueMeasurement(U.AuthClientAcquireToken,e.correlationId),!e.code)throw ae(B1);const n=Mn(),s=await he(this.executeTokenRequest.bind(this),U.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(l=s.headers)==null?void 0:l[cr.X_MS_REQUEST_ID],a=new xi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(s.body),he(a.handleServerTokenResponse.bind(a),U.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,n,e,r,void 0,void 0,void 0,i)}handleFragmentResponse(e,r){if(new xi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,r),!e.code)throw ae(G1);return e}getLogoutUri(e){if(!e)throw Ze(rw);const r=this.createLogoutUrlQueryString(e);return Fe.appendQueryString(this.authority.endSessionEndpoint,r)}async executeTokenRequest(e,r){var u,d;(u=this.performanceClient)==null||u.addQueueMeasurement(U.AuthClientExecuteTokenRequest,r.correlationId);const n=this.createTokenQueryParameters(r),s=Fe.appendQueryString(e.tokenEndpoint,n),i=await he(this.createTokenRequestBody.bind(this),U.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,r.correlationId)(r);let a;if(r.clientInfo)try{const h=iu(r.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${h.uid}${rr.CLIENT_INFO_SEPARATOR}${h.utid}`,type:Mr.HOME_ACCOUNT_ID}}catch(h){this.logger.verbose("Could not parse client info for CCS Header: "+h)}const o=this.createTokenRequestHeaders(a||r.ccsCredential),l={clientId:((d=r.tokenBodyParameters)==null?void 0:d.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:r.scopes,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid};return he(this.executePostToTokenEndpoint.bind(this),U.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,r.correlationId)(s,i,o,l,r.correlationId,U.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,i;(s=this.performanceClient)==null||s.addQueueMeasurement(U.AuthClientCreateTokenRequestBody,e.correlationId);const r=new No(e.correlationId,this.performanceClient);if(r.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[vi])||this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):Wi.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.oidcDefaultScopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!wf(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await ww(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(r.addGrantType(k1.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),e.authenticationScheme===Xe.POP){const a=new ja(this.cryptoUtils,this.performanceClient);let o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(await he(a.generateCnf.bind(a),U.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(o)}else if(e.authenticationScheme===Xe.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Ze(Ju);(!vn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities);let n;if(e.clientInfo)try{const a=iu(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${a.uid}${rr.CLIENT_INFO_SEPARATOR}${a.utid}`,type:Mr.HOME_ACCOUNT_ID}}catch(a){this.logger.verbose("Could not parse client info for CCS Header: "+a)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case Mr.HOME_ACCOUNT_ID:try{const a=da(n.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Mr.UPN:r.addCcsUpn(n.credential);break}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Ug])&&r.addExtraQueryParameters({[Ug]:"1"}),r.createQueryString()}async createAuthCodeUrlQueryString(e){var i,a;const r=e.correlationId||this.config.cryptoInterface.createNewGuid();(i=this.performanceClient)==null||i.addQueueMeasurement(U.AuthClientCreateQueryString,r);const n=new No(r,this.performanceClient);n.addClientId(e.embeddedClientId||((a=e.extraQueryParameters)==null?void 0:a[vi])||this.config.authOptions.clientId);const s=[...e.scopes||[],...e.extraScopesToConsent||[]];if(n.addScopes(s,!0,this.oidcDefaultScopes),n.addRedirectUri(e.redirectUri),n.addCorrelationId(r),n.addResponseMode(e.responseMode),n.addResponseTypeCode(),n.addLibraryInfo(this.config.libraryInfo),wf(this.config)||n.addApplicationTelemetry(this.config.telemetry.application),n.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&n.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&n.addPrompt(e.prompt),e.domainHint&&n.addDomainHint(e.domainHint),e.prompt!==Mt.SELECT_ACCOUNT)if(e.sid&&e.prompt===Mt.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),n.addSid(e.sid);else if(e.account){const o=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),n.addLoginHint(l);try{const u=da(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(o&&e.prompt===Mt.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),n.addSid(o);try{const u=da(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),n.addLoginHint(e.account.username);try{const u=da(e.account.homeAccountId);n.addCcsOid(u)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),n.addLoginHint(e.loginHint),n.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&n.addNonce(e.nonce),e.state&&n.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&n.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,n),e.nativeBroker&&(n.addNativeBroker(),e.authenticationScheme===Xe.POP)){const o=new ja(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await he(o.generateCnf.bind(o),U.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(l)}return n.createQueryString()}createLogoutUrlQueryString(e){const r=new No(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&r.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&r.addCorrelationId(e.correlationId),e.idTokenHint&&r.addIdTokenHint(e.idTokenHint),e.state&&r.addState(e.state),e.logoutHint&&r.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,r),r.createQueryString()}addExtraQueryParams(e,r){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&r.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var r;return((r=e.idTokenClaims)==null?void 0:r.sid)||null}extractLoginHint(e){var r;return((r=e.idTokenClaims)==null?void 0:r.login_hint)||null}}/*! @azure/msal-common v14.16.1 2025-08-05 */const i2=300;class Tf extends up{constructor(e,r){super(e,r)}async acquireToken(e){var a,o;(a=this.performanceClient)==null||a.addQueueMeasurement(U.RefreshTokenClientAcquireToken,e.correlationId);const r=Mn(),n=await he(this.executeTokenRequest.bind(this),U.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=(o=n.headers)==null?void 0:o[cr.X_MS_REQUEST_ID],i=new xi(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),he(i.handleServerTokenResponse.bind(i),U.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){var n;if(!e)throw Ze(tw);if((n=this.performanceClient)==null||n.addQueueMeasurement(U.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw ae(q0);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await he(this.acquireTokenWithCachedRefreshToken.bind(this),U.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(s){const i=s instanceof _n&&s.errorCode===cu,a=s instanceof Ds&&s.errorCode===Sg.INVALID_GRANT_ERROR&&s.subError===Sg.CLIENT_MISMATCH_ERROR;if(i||a)return he(this.acquireTokenWithCachedRefreshToken.bind(this),U.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw s}return he(this.acquireTokenWithCachedRefreshToken.bind(this),U.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,r){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(U.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const n=bi(this.cacheManager.getRefreshToken.bind(this.cacheManager),U.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,r,e.correlationId,void 0,this.performanceClient);if(!n)throw Ef(cu);if(n.expiresOn&&yf(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||i2))throw Ef(dp);const s={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||Xe.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Mr.HOME_ACCOUNT_ID}};try{return await he(this.acquireToken.bind(this),U.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(a){if(a instanceof _n&&a.subError===td){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const o=ua(n);this.cacheManager.removeRefreshToken(o,e.correlationId)}throw a}}async executeTokenRequest(e,r){var l,u;(l=this.performanceClient)==null||l.addQueueMeasurement(U.RefreshTokenClientExecuteTokenRequest,e.correlationId);const n=this.createTokenQueryParameters(e),s=Fe.appendQueryString(r.tokenEndpoint,n),i=await he(this.createTokenRequestBody.bind(this),U.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:((u=e.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:r.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return he(this.executePostToTokenEndpoint.bind(this),U.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,i,a,o,e.correlationId,U.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var s,i,a;(s=this.performanceClient)==null||s.addQueueMeasurement(U.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const r=e.correlationId,n=new No(r,this.performanceClient);if(n.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[vi])||this.config.authOptions.clientId),e.redirectUri&&n.addRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,(a=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:a.defaultScopes),n.addGrantType(k1.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!wf(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const o=this.config.clientCredentials.clientAssertion;n.addClientAssertion(await ww(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(o.assertionType)}if(e.authenticationScheme===Xe.POP){const o=new ja(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await he(o.generateCnf.bind(o),U.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(l)}else if(e.authenticationScheme===Xe.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw Ze(Ju);if((!vn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Mr.HOME_ACCOUNT_ID:try{const o=da(e.ccsCredential.credential);n.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Mr.UPN:n.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&n.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),n.createQueryString()}}/*! @azure/msal-common v14.16.1 2025-08-05 */class a2 extends up{constructor(e,r){super(e,r)}async acquireToken(e){var r;try{const[n,s]=await this.acquireCachedToken({...e,scopes:(r=e.scopes)!=null&&r.length?e.scopes:[...Ka]});return s===ms.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new Tf(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),n}catch(n){if(n instanceof Yu&&n.errorCode===qn)return new Tf(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw n}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(U.SilentFlowClientAcquireCachedToken,e.correlationId);let r=ms.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!vn.isEmptyObj(e.claims))throw this.setCacheOutcome(ms.FORCE_REFRESH_OR_CLAIMS,e.correlationId),ae(qn);if(!e.account)throw ae(q0);const n=e.account.tenantId||Yb(e.authority),s=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,s,n,this.performanceClient);if(i){if(jA(i.cachedAt)||yf(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(ms.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),ae(qn);i.refreshOn&&yf(i.refreshOn,0)&&(r=ms.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(ms.NO_CACHED_ACCESS_TOKEN,e.correlationId),ae(qn);const a=e.authority||this.authority.getPreferredCache(),o={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,s,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(r,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await he(this.generateResultFromCacheRecord.bind(this),U.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(o,e),r]}setCacheOutcome(e,r){var n,s;(n=this.serverTelemetryManager)==null||n.setCacheOutcome(e),(s=this.performanceClient)==null||s.addFields({cacheOutcome:e},r),e!==ms.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,r){var s;(s=this.performanceClient)==null||s.addQueueMeasurement(U.SilentFlowClientGenerateResultFromCacheRecord,r.correlationId);let n;if(e.idToken&&(n=Ai(e.idToken.secret,this.config.cryptoInterface.base64Decode)),r.maxAge||r.maxAge===0){const i=n==null?void 0:n.auth_time;if(!i)throw ae(V0);q1(i,r.maxAge)}return xi.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,r,n)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const o2={sendGetRequestAsync:()=>Promise.reject(ae(je)),sendPostRequestAsync:()=>Promise.reject(ae(je))};/*! @azure/msal-common v14.16.1 2025-08-05 */const $g=",",Ew="|";function l2(t){const{skus:e,libraryName:r,libraryVersion:n,extensionName:s,extensionVersion:i}=t,a=new Map([[0,[r,n]],[2,[s,i]]]);let o=[];if(e!=null&&e.length){if(o=e.split($g),o.length<4)return e}else o=Array.from({length:4},()=>Ew);return a.forEach((l,u)=>{var d,h;l.length===2&&((d=l[0])!=null&&d.length)&&((h=l[1])!=null&&h.length)&&c2({skuArr:o,index:u,skuName:l[0],skuVersion:l[1]})}),o.join($g)}function c2(t){const{skuArr:e,index:r,skuName:n,skuVersion:s}=t;r>=e.length||(e[r]=[n,s].join(Ew))}class nl{constructor(e,r){this.cacheOutcome=ms.NOT_APPLICABLE,this.cacheManager=r,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||V.EMPTY_STRING,this.wrapperVer=e.wrapperVer||V.EMPTY_STRING,this.telemetryCacheKey=Ht.CACHE_KEY+rr.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Ht.VALUE_SEPARATOR}${this.cacheOutcome}`,r=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n!=null&&n.length&&r.push(`broker_error=${n}`);const s=r.join(Ht.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),a=[e,i].join(Ht.VALUE_SEPARATOR);return[Ht.SCHEMA_VERSION,a,s].join(Ht.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),r=nl.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*r).join(Ht.VALUE_SEPARATOR),s=e.errors.slice(0,r).join(Ht.VALUE_SEPARATOR),i=e.errors.length,a=r<i?Ht.OVERFLOW_TRUE:Ht.OVERFLOW_FALSE,o=[i,a].join(Ht.VALUE_SEPARATOR);return[Ht.SCHEMA_VERSION,e.cacheHits,n,s,o].join(Ht.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const r=this.getLastRequests();r.errors.length>=Ht.MAX_CACHED_ERRORS&&(r.failedRequests.shift(),r.failedRequests.shift(),r.errors.shift()),r.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ht?e.subError?r.errors.push(e.subError):e.errorCode?r.errors.push(e.errorCode):r.errors.push(e.toString()):r.errors.push(e.toString()):r.errors.push(Ht.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),r=nl.maxErrorsToSend(e),n=e.errors.length;if(r===n)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const s={failedRequests:e.failedRequests.slice(r*2),errors:e.errors.slice(r),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s,this.correlationId)}}static maxErrorsToSend(e){let r,n=0,s=0;const i=e.errors.length;for(r=0;r<i;r++){const a=e.failedRequests[2*r]||V.EMPTY_STRING,o=e.failedRequests[2*r+1]||V.EMPTY_STRING,l=e.errors[r]||V.EMPTY_STRING;if(s+=a.toString().length+o.toString().length+l.length+3,s<Ht.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||V.EMPTY_STRING),e.push(this.regionSource||V.EMPTY_STRING),e.push(this.regionOutcome||V.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const r=this.getLastRequests();r.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return l2(e)}}/*! @azure/msal-common v14.16.1 2025-08-05 */const Tw="missing_kid_error",Cw="missing_alg_error";/*! @azure/msal-common v14.16.1 2025-08-05 */const u2={[Tw]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Cw]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class fp extends ht{constructor(e,r){super(e,r),this.name="JoseHeaderError",Object.setPrototypeOf(this,fp.prototype)}}function Kg(t){return new fp(t,u2[t])}/*! @azure/msal-common v14.16.1 2025-08-05 */class pp{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Kg(Tw);if(!e.alg)throw Kg(Cw);const r=new pp({typ:e.typ||xA.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(r)}}/*! @azure/msal-common v14.16.1 2025-08-05 */class Gg{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class d2{generateId(){return"callback-id"}startMeasurement(e,r){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:qb.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:r||""},measurement:new Gg}}startPerformanceMeasurement(){return new Gg}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const mp="pkce_not_created",Cf="crypto_nonexistent",rd="empty_navigate_uri",Sw="hash_empty_error",gp="no_state_in_hash",Aw="hash_does_not_contain_known_properties",bw="unable_to_parse_state",kw="state_interaction_type_mismatch",Iw="interaction_in_progress",Nw="popup_window_error",Rw="empty_window_error",yi="user_cancelled",h2="monitor_popup_timeout",Ow="monitor_window_timeout",Pw="redirect_in_iframe",Lw="block_iframe_reload",jw="block_nested_popups",f2="iframe_closed_prematurely",nd="silent_logout_unsupported",Mw="no_account_error",p2="silent_prompt_value_error",Dw="no_token_request_cache_error",Fw="unable_to_parse_token_request_cache_error",vp="no_cached_authority_error",m2="auth_request_not_set_error",g2="invalid_cache_type",sd="non_browser_environment",Vi="database_not_open",uu="no_network_connectivity",Uw="post_request_failed",Bw="get_request_failed",Sf="failed_to_parse_response",Hw="unable_to_load_token",xp="crypto_key_not_found",zw="auth_code_required",$w="auth_code_or_nativeAccountId_required",Kw="spa_code_and_nativeAccountId_present",yp="database_unavailable",Gw="unable_to_acquire_token_from_native_platform",Ww="native_handshake_timeout",Vw="native_extension_not_installed",wl="native_connection_not_established",qw="uninitialized_public_client_application",Yw="native_prompt_not_supported",Qw="invalid_base64_string",Xw="invalid_pop_token_request",Jw="failed_to_build_headers",Zw="failed_to_parse_headers";/*! @azure/msal-browser v3.30.0 2025-08-05 */const Bn="For more visit: aka.ms/msaljs/browser-errors",v2={[mp]:"The PKCE code challenge and verifier could not be generated.",[Cf]:"The crypto object or function is not available.",[rd]:"Navigation URI is empty. Please check stack trace for more info.",[Sw]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Bn}`,[gp]:"Hash does not contain state. Please verify that the request originated from msal.",[Aw]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Bn}`,[bw]:"Unable to parse state. Please verify that the request originated from msal.",[kw]:"Hash contains state but the interaction type does not match the caller.",[Iw]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Bn}`,[Nw]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Rw]:"window.open returned null or undefined window object.",[yi]:"User cancelled the flow.",[h2]:`Token acquisition in popup failed due to timeout.  ${Bn}`,[Ow]:`Token acquisition in iframe failed due to timeout.  ${Bn}`,[Pw]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Lw]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Bn}`,[jw]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[f2]:"The iframe being monitored was closed prematurely.",[nd]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Mw]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[p2]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Dw]:"No token request found in cache.",[Fw]:"The cached token request could not be parsed.",[vp]:"No cached authority found.",[m2]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[g2]:"Invalid cache type",[sd]:"Login and token requests are not supported in non-browser environments.",[Vi]:"Database is not open!",[uu]:"No network connectivity. Check your internet connection.",[Uw]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Bw]:"Network request failed. Please check the network trace to determine root cause.",[Sf]:"Failed to parse network response. Check network trace.",[Hw]:"Error loading token to cache.",[xp]:"Cryptographic Key or Keypair not found in browser storage.",[zw]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[$w]:"An authorization code or nativeAccountId must be provided to this flow.",[Kw]:"Request cannot contain both spa code and native account id.",[yp]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Gw]:`Unable to acquire token from native platform.  ${Bn}`,[Ww]:"Timed out while attempting to establish connection to browser extension",[Vw]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[wl]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Bn}`,[qw]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Bn}`,[Yw]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[Qw]:"Invalid base64 encoded string.",[Xw]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Jw]:"Failed to build request headers object.",[Zw]:"Failed to parse response headers"};class _l extends ht{constructor(e,r){super(e,v2[e],r),Object.setPrototypeOf(this,_l.prototype),this.name="BrowserAuthError"}}function _e(t,e){return new _l(t,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Or={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},ha={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},ai={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},xr={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Wg={GET:"GET",POST:"POST"},Ke={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},$r={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},sc={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},nt={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var Ae;(function(t){t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none"})(Ae||(Ae={}));const Tt={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Vg={scopes:Ka},e_="jwk",x2={React:"@azure/msal-react",Angular:"@azure/msal-angular"},Af="msal.db",y2=1,w2=`${Af}.keys`,kr={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},_2=[kr.Default,kr.Skip,kr.RefreshTokenAndNetwork],E2="msal.browser.log.level",T2="msal.browser.log.pii";/*! @azure/msal-browser v3.30.0 2025-08-05 */function ic(t){return encodeURIComponent(wp(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function id(t){return t_(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function wp(t){return t_(new TextEncoder().encode(t))}function t_(t){const e=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const C2="RSASSA-PKCS1-v1_5",r_="SHA-256",S2=2048,A2=new Uint8Array([1,0,1]),qg="0123456789abcdef",Yg=new Uint32Array(1),b2="crypto_subtle_undefined",_p={name:C2,hash:r_,modulusLength:S2,publicExponent:A2};function k2(t){if(!window)throw _e(sd);if(!window.crypto)throw _e(Cf);if(!t&&!window.crypto.subtle)throw _e(Cf,b2)}async function n_(t,e,r){e==null||e.addQueueMeasurement(U.Sha256Digest,r);const s=new TextEncoder().encode(t);return window.crypto.subtle.digest(r_,s)}function I2(t){return window.crypto.getRandomValues(t)}function th(){return window.crypto.getRandomValues(Yg),Yg[0]}function Dn(){const t=Date.now(),e=th()*1024+(th()&1023),r=new Uint8Array(16),n=Math.trunc(e/2**30),s=e&2**30-1,i=th();r[0]=t/2**40,r[1]=t/2**32,r[2]=t/2**24,r[3]=t/2**16,r[4]=t/2**8,r[5]=t,r[6]=112|n>>>8,r[7]=n,r[8]=128|s>>>24,r[9]=s>>>16,r[10]=s>>>8,r[11]=s,r[12]=i>>>24,r[13]=i>>>16,r[14]=i>>>8,r[15]=i;let a="";for(let o=0;o<r.length;o++)a+=qg.charAt(r[o]>>>4),a+=qg.charAt(r[o]&15),(o===3||o===5||o===7||o===9)&&(a+="-");return a}async function N2(t,e){return window.crypto.subtle.generateKey(_p,t,e)}async function rh(t){return window.crypto.subtle.exportKey(e_,t)}async function R2(t,e,r){return window.crypto.subtle.importKey(e_,t,_p,e,r)}async function O2(t,e){return window.crypto.subtle.sign(_p,t,e)}async function s_(t){const e=await n_(t),r=new Uint8Array(e);return id(r)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const sl="storage_not_supported",_t="stubbed_public_client_application_called",du="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.30.0 2025-08-05 */const Rc={[sl]:"Given storage configuration option was not supported.",[_t]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[du]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};Rc[sl],Rc[_t],Rc[du];class Ep extends ht{constructor(e,r){super(e,r),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Ep.prototype)}}function Et(t){return new Ep(t,Rc[t])}/*! @azure/msal-browser v3.30.0 2025-08-05 */function P2(t){t.location.hash="",typeof t.history.replaceState=="function"&&t.history.replaceState(null,"",`${t.location.origin}${t.location.pathname}${t.location.search}`)}function L2(t){const e=t.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Tp(){return window.parent!==window}function j2(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Or.POPUP_NAME_PREFIX}.`)===0}function Yn(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function M2(){const e=new Fe(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function D2(){if(Fe.hashContainsKnownProperties(window.location.hash)&&Tp())throw _e(Lw)}function F2(t){if(Tp()&&!t)throw _e(Pw)}function U2(){if(j2())throw _e(jw)}function i_(){if(typeof window>"u")throw _e(sd)}function a_(t){if(!t)throw _e(qw)}function Cp(t){i_(),D2(),U2(),a_(t)}function Qg(t,e){if(Cp(t),F2(e.system.allowRedirectInIframe),e.cache.cacheLocation===xr.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Et(du)}function o_(t){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(t).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function B2(){return Dn()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class hu{navigateInternal(e,r){return hu.defaultNavigateWindow(e,r)}navigateExternal(e,r){return hu.defaultNavigateWindow(e,r)}static defaultNavigateWindow(e,r){return r.noHistory?window.location.replace(e):window.location.assign(e),new Promise(n=>{setTimeout(()=>{n(!0)},r.timeout)})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class H2{async sendGetRequestAsync(e,r){let n,s={},i=0;const a=Xg(r);try{n=await fetch(e,{method:Wg.GET,headers:a})}catch{throw _e(window.navigator.onLine?Bw:uu)}s=Jg(n.headers);try{return i=n.status,{headers:s,body:await n.json(),status:i}}catch{throw Bg(_e(Sf),i,s)}}async sendPostRequestAsync(e,r){const n=r&&r.body||"",s=Xg(r);let i,a=0,o={};try{i=await fetch(e,{method:Wg.POST,headers:s,body:n})}catch{throw _e(window.navigator.onLine?Uw:uu)}o=Jg(i.headers);try{return a=i.status,{headers:o,body:await i.json(),status:a}}catch{throw Bg(_e(Sf),a,o)}}}function Xg(t){try{const e=new Headers;if(!(t&&t.headers))return e;const r=t.headers;return Object.entries(r).forEach(([n,s])=>{e.append(n,s)}),e}catch{throw _e(Jw)}}function Jg(t){try{const e={};return t.forEach((r,n)=>{e[n]=r}),e}catch{throw _e(Zw)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const z2=6e4,bf=1e4,$2=3e4,K2=2e3;function G2({auth:t,cache:e,system:r,telemetry:n},s){const i={clientId:V.EMPTY_STRING,authority:`${V.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:V.EMPTY_STRING,authorityMetadata:V.EMPTY_STRING,redirectUri:typeof window<"u"?Yn():"",postLogoutRedirectUri:V.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Jn.AAD,OIDCOptions:{serverResponseType:yl.FRAGMENT,defaultScopes:[V.OPENID_SCOPE,V.PROFILE_SCOPE,V.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:J0.None,tenant:V.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},a={cacheLocation:xr.SessionStorage,temporaryCacheLocation:xr.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===xr.LocalStorage),claimsBasedCachingEnabled:!1},o={loggerCallback:()=>{},logLevel:Ye.Info,piiLoggingEnabled:!1},u={...{...mw,loggerOptions:o,networkClient:s?new H2:o2,navigationClient:new hu,loadFrameTimeout:0,windowHashTimeout:(r==null?void 0:r.loadFrameTimeout)||z2,iframeHashTimeout:(r==null?void 0:r.loadFrameTimeout)||bf,navigateFrameWait:0,redirectNavigationTimeout:$2,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(r==null?void 0:r.nativeBrokerHandshakeTimeout)||K2,pollIntervalMilliseconds:Or.DEFAULT_POLL_INTERVAL_MS},...r,loggerOptions:(r==null?void 0:r.loggerOptions)||o},d={application:{appName:V.EMPTY_STRING,appVersion:V.EMPTY_STRING},client:new d2};if((t==null?void 0:t.protocolMode)!==Jn.OIDC&&(t!=null&&t.OIDCOptions)&&new as(u.loggerOptions).warning(JSON.stringify(Ze(ow))),t!=null&&t.protocolMode&&t.protocolMode!==Jn.AAD&&(u!=null&&u.allowNativeBroker))throw Ze(lw);return{auth:{...i,...t,OIDCOptions:{...i.OIDCOptions,...t==null?void 0:t.OIDCOptions}},cache:{...a,...e},system:u,telemetry:{...d,...n}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const W2="@azure/msal-browser",Ma="3.30.0";/*! @azure/msal-browser v3.30.0 2025-08-05 */class Sp{static loggerCallback(e,r){switch(e){case Ye.Error:console.error(r);return;case Ye.Info:console.info(r);return;case Ye.Verbose:console.debug(r);return;case Ye.Warning:console.warn(r);return;default:console.log(r);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=G2(e,this.browserEnvironment);let r;try{r=window[xr.SessionStorage]}catch{}const n=r==null?void 0:r.getItem(E2),s=(l=r==null?void 0:r.getItem(T2))==null?void 0:l.toLowerCase(),i=s==="true"?!0:s==="false"?!1:void 0,a={...this.config.system.loggerOptions},o=n&&Object.keys(Ye).includes(n)?Ye[n]:void 0;o&&(a.loggerCallback=Sp.loggerCallback,a.logLevel=o),i!==void 0&&(a.piiLoggingEnabled=i),this.logger=new as(a,W2,Ma),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class wi extends Sp{getModuleName(){return wi.MODULE_NAME}getId(){return wi.ID}async initialize(){return this.available=typeof window<"u",this.available}}wi.MODULE_NAME="";wi.ID="StandardOperatingContext";/*! @azure/msal-browser v3.30.0 2025-08-05 */function jn(t){return new TextDecoder().decode(V2(t))}function V2(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw _e(Qw)}const r=atob(e);return Uint8Array.from(r,n=>n.codePointAt(0)||0)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class q2{constructor(){this.dbName=Af,this.version=y2,this.tableName=w2,this.dbOpen=!1}async open(){return new Promise((e,r)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",s=>{const i=s;this.db=i.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>r(_e(yp)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((r,n)=>{if(!this.db)return n(_e(Vi));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),r(l.target.result)}),a.addEventListener("error",o=>{this.closeConnection(),n(o)})})}async setItem(e,r){return await this.validateDbIsOpen(),new Promise((n,s)=>{if(!this.db)return s(_e(Vi));const o=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(r,e);o.addEventListener("success",()=>{this.closeConnection(),n()}),o.addEventListener("error",l=>{this.closeConnection(),s(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((r,n)=>{if(!this.db)return n(_e(Vi));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",o=>{this.closeConnection(),n(o)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,r)=>{if(!this.db)return r(_e(Vi));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",a=>{const o=a;this.closeConnection(),e(o.target.result)}),i.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((r,n)=>{if(!this.db)return n(_e(Vi));const a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",o=>{const l=o;this.closeConnection(),r(l.target.result===1)}),a.addEventListener("error",o=>{this.closeConnection(),n(o)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,r)=>{const n=window.indexedDB.deleteDatabase(Af),s=setTimeout(()=>r(!1),200);n.addEventListener("success",()=>(clearTimeout(s),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),n.addEventListener("error",()=>(clearTimeout(s),r(!1)))})}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class kf{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,r){this.cache.set(e,r)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((r,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Y2{constructor(e){this.inMemoryCache=new kf,this.indexedDBCache=new q2,this.logger=e}handleDatabaseAccessError(e){if(e instanceof _l&&e.errorCode===yp)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const r=this.inMemoryCache.getItem(e);if(!r)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return r}async setItem(e,r){this.inMemoryCache.setItem(e,r);try{await this.indexedDBCache.setItem(e,r)}catch(n){this.handleDatabaseAccessError(n)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(r){this.handleDatabaseAccessError(r)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(r){this.handleDatabaseAccessError(r)}return e}async containsKey(e){const r=this.inMemoryCache.containsKey(e);if(!r)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return r}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Da{constructor(e,r,n){this.logger=e,k2(n??!1),this.cache=new Y2(this.logger),this.performanceClient=r}createNewGuid(){return Dn()}base64Encode(e){return wp(e)}base64Decode(e){return jn(e)}base64UrlEncode(e){return ic(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var d;const r=(d=this.performanceClient)==null?void 0:d.startMeasurement(U.CryptoOptsGetPublicKeyThumbprint,e.correlationId),n=await N2(Da.EXTRACTABLE,Da.POP_KEY_USAGES),s=await rh(n.publicKey),i={e:s.e,kty:s.kty,n:s.n},a=Zg(i),o=await this.hashString(a),l=await rh(n.privateKey),u=await R2(l,!1,["sign"]);return await this.cache.setItem(o,{privateKey:u,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),r&&r.end({success:!0}),o}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,r,n,s){var x;const i=(x=this.performanceClient)==null?void 0:x.startMeasurement(U.CryptoOptsSignJwt,s),a=await this.cache.getItem(r);if(!a)throw _e(xp);const o=await rh(a.publicKey),l=Zg(o),u=ic(JSON.stringify({kid:r})),d=pp.getShrHeaderString({...n==null?void 0:n.header,alg:o.alg,kid:u}),h=ic(d);e.cnf={jwk:JSON.parse(l)};const f=ic(JSON.stringify(e)),p=`${h}.${f}`,m=new TextEncoder().encode(p),w=await O2(a.privateKey,m),v=id(new Uint8Array(w)),y=`${p}.${v}`;return i&&i.end({success:!0}),y}async hashString(e){return s_(e)}}Da.POP_KEY_USAGES=["sign","verify"];Da.EXTRACTABLE=!0;function Zg(t){return JSON.stringify(t,Object.keys(t).sort())}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Q2{constructor(){if(!window.localStorage)throw Et(sl)}getItem(e){return window.localStorage.getItem(e)}setItem(e,r){window.localStorage.setItem(e,r)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class X2{constructor(){if(!window.sessionStorage)throw Et(sl)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,r){window.sessionStorage.setItem(e,r)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function l_(t,e){if(!e)return null;try{return xn.parseRequestState(t,e).libraryState.meta}catch{throw ae(Pa)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const J2=24*60*60*1e3;class Z2{getItem(e){const r=`${encodeURIComponent(e)}`,n=document.cookie.split(";");for(let s=0;s<n.length;s++){const i=n[s],[a,...o]=decodeURIComponent(i).trim().split("="),l=o.join("=");if(a===r)return l}return""}setItem(e,r,n,s=!0){let i=`${encodeURIComponent(e)}=${encodeURIComponent(r)};path=/;SameSite=Lax;`;if(n){const a=ek(n);i+=`expires=${a};`}s&&(i+="Secure;"),document.cookie=i}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),r=[];return e.forEach(n=>{const s=decodeURIComponent(n).trim().split("=");r.push(s[0])}),r}containsKey(e){return this.getKeys().includes(e)}}function ek(t){const e=new Date;return new Date(e.getTime()+t*J2).toUTCString()}/*! @azure/msal-browser v3.30.0 2025-08-05 */class If extends La{constructor(e,r,n,s,i,a){super(e,n,s,i),this.cacheConfig=r,this.logger=s,this.internalStorage=new kf,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new Z2,r.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=a}setupBrowserStorage(e){try{switch(e){case xr.LocalStorage:return new Q2;case xr.SessionStorage:return new X2;case xr.MemoryStorage:default:break}}catch(r){this.logger.error(r)}return this.cacheConfig.cacheLocation=xr.MemoryStorage,new kf}migrateCacheEntries(){const e=this.browserStorage.getItem($r.VERSION);e&&this.logger.info(`MSAL.js was last initialized with version ${e}`),e!==Ma&&this.browserStorage.setItem($r.VERSION,Ma);const r=`${V.CACHE_PREFIX}.${Lt.ID_TOKEN}`,n=`${V.CACHE_PREFIX}.${Lt.CLIENT_INFO}`,s=`${V.CACHE_PREFIX}.${Lt.ERROR}`,i=`${V.CACHE_PREFIX}.${Lt.ERROR_DESC}`,a=this.browserStorage.getItem(r),o=this.browserStorage.getItem(n),l=this.browserStorage.getItem(s),u=this.browserStorage.getItem(i),d=[a,o,l,u];[Lt.ID_TOKEN,Lt.CLIENT_INFO,Lt.ERROR,Lt.ERROR_DESC].forEach((f,p)=>{const g=d[p];g&&this.setTemporaryCache(f,g,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.cryptoImpl.createNewGuid(),r=this.getItem($r.ACCOUNT_KEYS),n=this.getItem(`${$r.TOKEN_KEYS}.${this.clientId}`);if(r&&n){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){const a=this.getItem(i);if(a){const o=this.validateAndParseJson(a);if(o&&o.hasOwnProperty("credentialType"))switch(o.credentialType){case Ie.ID_TOKEN:if(Ng(o)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);const l=o,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,Ie.ID_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case Ie.ACCESS_TOKEN:case Ie.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Ig(o)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);const l=o,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,Ie.ACCESS_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case Ie.REFRESH_TOKEN:if(Rg(o)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);const l=o,u=this.updateCredentialCacheKey(i,l,e);this.addTokenKey(u,Ie.REFRESH_TOKEN,e);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){const a=this.getItem(i);if(a){const o=this.validateAndParseJson(a);o&&Ot.isAccountEntity(o)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i,e))}}})}validateAndParseJson(e){try{const r=JSON.parse(e);return r&&typeof r=="object"?r:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,r,n){let s=[];for(let a=0;a<=20;a++)try{this.browserStorage.setItem(e,r),a>0&&this.removeAccessTokenKeys(s.slice(0,a),n);break}catch(o){const l=pw(o);if(l.errorCode===op&&a<20){if(s.length||(e===`${$r.TOKEN_KEYS}.${this.clientId}`?s=JSON.parse(r).accessToken:s=this.getTokenKeys().accessToken),s.length<=a)throw l;this.removeAccessToken(s[a],n,!1)}else throw l}}getAccount(e,r,n){this.logger.trace("BrowserCacheManager.getAccount called");const s=this.getCachedAccountEntity(e,r);return this.updateOutdatedCachedAccount(e,s,r,n)}getCachedAccountEntity(e,r){const n=this.getItem(e);if(!n)return this.removeAccountKeyFromMap(e,r),null;const s=this.validateAndParseJson(n);return!s||!Ot.isAccountEntity(s)?null:La.toObject(new Ot,s)}setAccount(e,r){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),r),this.addAccountKeyToMap(n,r)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem($r.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,r){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();n.indexOf(e)===-1?(n.push(e),this.setItem($r.ACCOUNT_KEYS,JSON.stringify(n),r),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,r){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),s=n.indexOf(e);if(s>-1){if(n.splice(s,1),n.length===0){this.removeItem($r.ACCOUNT_KEYS);return}else this.setItem($r.ACCOUNT_KEYS,JSON.stringify(n),r);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,r){super.removeAccount(e,r),this.removeAccountKeyFromMap(e,r)}removeOutdatedAccount(e,r){this.removeItem(e),this.removeAccountKeyFromMap(e,r)}removeIdToken(e,r){super.removeIdToken(e,r),this.removeTokenKey(e,Ie.ID_TOKEN,r)}removeAccessToken(e,r,n=!0){var s;super.removeAccessToken(e,r),(s=this.performanceClient)==null||s.incrementFields({accessTokensRemoved:1},r),n&&this.removeTokenKey(e,Ie.ACCESS_TOKEN,r)}removeAccessTokenKeys(e,r){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys();let s=0;if(e.forEach(i=>{const a=n.accessToken.indexOf(i);a>-1&&(n.accessToken.splice(a,1),s++)}),s>0){this.logger.info(`removed ${s} accessToken keys from tokenKeys map`),this.setTokenKeys(n,r);return}}removeRefreshToken(e,r){super.removeRefreshToken(e,r),this.removeTokenKey(e,Ie.REFRESH_TOKEN,r)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${$r.TOKEN_KEYS}.${this.clientId}`);if(e){const r=this.validateAndParseJson(e);if(r&&r.hasOwnProperty("idToken")&&r.hasOwnProperty("accessToken")&&r.hasOwnProperty("refreshToken"))return r;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,r){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(`${$r.TOKEN_KEYS}.${this.clientId}`);return}else this.setItem(`${$r.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(e),r)}addTokenKey(e,r,n){this.logger.trace("BrowserCacheManager addTokenKey called");const s=this.getTokenKeys();switch(r){case Ie.ID_TOKEN:s.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),s.idToken.push(e));break;case Ie.ACCESS_TOKEN:const i=s.accessToken.indexOf(e);i!==-1&&s.accessToken.splice(i,1),this.logger.trace(`access token ${i===-1?"added to":"updated in"} map`),s.accessToken.push(e);break;case Ie.REFRESH_TOKEN:s.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),s.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${r}`),ae(xf)}this.setTokenKeys(s,n)}removeTokenKey(e,r,n,s=this.getTokenKeys()){switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),r){case Ie.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const i=s.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),s.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Ie.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const a=s.accessToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),s.accessToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Ie.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const o=s.refreshToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),s.refreshToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${r}`),ae(xf)}this.setTokenKeys(s,n)}getIdTokenCredential(e,r){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,r),null;const s=this.validateAndParseJson(n);return!s||!Ng(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),s)}setIdTokenCredential(e,r){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=ua(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),r),this.addTokenKey(n,Ie.ID_TOKEN,r)}getAccessTokenCredential(e,r){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ie.ACCESS_TOKEN,r),null;const s=this.validateAndParseJson(n);return!s||!Ig(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),s)}setAccessTokenCredential(e,r){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=ua(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),r),this.addTokenKey(n,Ie.ACCESS_TOKEN,r)}getRefreshTokenCredential(e,r){const n=this.getItem(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Ie.REFRESH_TOKEN,r),null;const s=this.validateAndParseJson(n);return!s||!Rg(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),s)}setRefreshTokenCredential(e,r){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=ua(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(n,JSON.stringify(e),r),this.addTokenKey(n,Ie.REFRESH_TOKEN,r)}getAppMetadata(e){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(r);return!n||!KA(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n)}setAppMetadata(e,r){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=$A(e);this.setItem(n,JSON.stringify(e),r)}getServerTelemetry(e){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(r);return!n||!HA(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n)}setServerTelemetry(e,r,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(r),n)}getAuthorityMetadata(e){const r=this.internalStorage.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(r);return n&&GA(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(r=>this.isAuthorityMetadata(r))}setWrapperMetadata(e,r){this.internalStorage.setItem(sc.WRAPPER_SKU,e),this.internalStorage.setItem(sc.WRAPPER_VER,r)}getWrapperMetadata(){const e=this.internalStorage.getItem(sc.WRAPPER_SKU)||V.EMPTY_STRING,r=this.internalStorage.getItem(sc.WRAPPER_VER)||V.EMPTY_STRING;return[e,r]}setAuthorityMetadata(e,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(r))}getActiveAccount(e){const r=this.generateCacheKey(Lt.ACTIVE_ACCOUNT_FILTERS),n=this.getItem(r);if(!n){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const i=this.generateCacheKey(Lt.ACTIVE_ACCOUNT),a=this.getItem(i);if(!a)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const o=this.getAccountInfoFilteredBy({localAccountId:a},e);return o?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(o,e),o):null}const s=this.validateAndParseJson(n);return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:s.homeAccountId,localAccountId:s.localAccountId,tenantId:s.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,r){const n=this.generateCacheKey(Lt.ACTIVE_ACCOUNT_FILTERS),s=this.generateCacheKey(Lt.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(n,JSON.stringify(i),r),this.setItem(s,e.localAccountId,r)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n),this.browserStorage.removeItem(s)}getThrottlingCache(e){const r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(r);return!n||!zA(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n)}setThrottlingCache(e,r,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(r),n)}getTemporaryCache(e,r){const n=r?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.cookieStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const s=this.temporaryCacheStorage.getItem(n);if(!s){if(this.cacheConfig.cacheLocation===xr.LocalStorage){const i=this.browserStorage.getItem(n);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,r,n){const s=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,r,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(r=>{(r.indexOf(V.CACHE_PREFIX)!==-1||r.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(r)}),this.browserStorage.getKeys().forEach(r=>{(r.indexOf(V.CACHE_PREFIX)!==-1||r.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(r)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,r){e.addQueueMeasurement(U.ClearTokensAndKeysWithClaims,r);const n=this.getTokenKeys();let s=0;n.accessToken.forEach(i=>{const a=this.getAccessTokenCredential(i,r);a!=null&&a.requestedClaimsHash&&i.includes(a.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(i,r),s++)}),s>0&&this.logger.warning(`${s} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):vn.startsWith(e,V.CACHE_PREFIX)||vn.startsWith(e,Lt.ADAL_ID_TOKEN)?e:`${V.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:r}}=xn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ke.AUTHORITY}.${r}`)}generateNonceKey(e){const{libraryState:{id:r}}=xn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ke.NONCE_IDTOKEN}.${r}`)}generateStateKey(e){const{libraryState:{id:r}}=xn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${Ke.REQUEST_STATE}.${r}`)}getCachedAuthority(e){const r=this.generateStateKey(e),n=this.getTemporaryCache(r);if(!n)return null;const s=this.generateAuthorityKey(n);return this.getTemporaryCache(s)}updateCacheEntries(e,r,n,s,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);const o=this.generateNonceKey(e);this.setTemporaryCache(o,r,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,n,!1),i){const u={credential:i.homeAccountId,type:Mr.HOME_ACCOUNT_ID};this.setTemporaryCache(Ke.CCS_CREDENTIAL,JSON.stringify(u),!0)}else if(s){const u={credential:s,type:Mr.UPN};this.setTemporaryCache(Ke.CCS_CREDENTIAL,JSON.stringify(u),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(r=>{r.indexOf(e)!==-1&&this.removeTemporaryItem(r)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(Ke.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Ke.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Ke.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Ke.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(Ke.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(Ke.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const r=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(r);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||V.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(r=>{if(r.indexOf(Ke.REQUEST_STATE)===-1)return;const n=this.temporaryCacheStorage.getItem(r);if(!n)return;const s=l_(this.cryptoImpl,n);s&&s.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const r=wp(JSON.stringify(e));this.setTemporaryCache(Ke.REQUEST_PARAMS,r,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const r=this.getTemporaryCache(Ke.REQUEST_PARAMS,!0);if(!r)throw _e(Dw);let n;try{n=JSON.parse(jn(r))}catch(s){throw this.logger.errorPii(`Attempted to parse: ${r}`),this.logger.error(`Parsing cached token request threw with error: ${s}`),_e(Fw)}if(this.removeTemporaryItem(this.generateCacheKey(Ke.REQUEST_PARAMS)),!n.authority){const s=this.generateAuthorityKey(e),i=this.getTemporaryCache(s);if(!i)throw _e(vp);n.authority=i}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Ke.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const r=this.validateAndParseJson(e);return r||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const r=this.getInteractionInProgress();return e?r===this.clientId:!!r}getInteractionInProgress(){const e=`${V.CACHE_PREFIX}.${Ke.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const r=`${V.CACHE_PREFIX}.${Ke.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw _e(Iw);this.setTemporaryCache(r,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(r)}getLegacyLoginHint(){const e=this.getTemporaryCache(Lt.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Lt.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const r=this.getTemporaryCache(Lt.ID_TOKEN,!0);r&&(this.browserStorage.removeItem(this.generateCacheKey(Lt.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const n=r||e;if(n){const s=Ai(n,jn);if(s.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),s.preferred_username;if(s.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),s.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,r,n){const s=ua(r);if(e!==s){const i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(s,i,n),this.logger.verbose(`Updated an outdated ${r.credentialType} cache key`),s;this.logger.error(`Attempted to update an outdated ${r.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,r){var o,l,u;const n=Qu((o=e.account)==null?void 0:o.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let s;r.claims&&(s=await this.cryptoImpl.hashString(r.claims));const i=Xu((u=e.account)==null?void 0:u.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,jn,void 0,e.tokenType,void 0,r.sshKid,r.claims,s),a={idToken:n,accessToken:i};return this.saveCacheRecord(a,e.correlationId)}async saveCacheRecord(e,r,n){try{await super.saveCacheRecord(e,r,n)}catch(s){if(s instanceof wa&&this.performanceClient&&r)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},r)}catch{}throw s}}}const tk=(t,e)=>{const r={cacheLocation:xr.MemoryStorage,temporaryCacheLocation:xr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new If(t,r,su,e)};/*! @azure/msal-browser v3.30.0 2025-08-05 */function rk(t,e,r,n,s){return t.verbose("getAllAccounts called"),r?e.getAllAccounts(n,s):[]}function nk(t,e,r,n){if(e.trace("getAccount called"),Object.keys(t).length===0)return e.warning("getAccount: No accountFilter provided"),null;const s=r.getAccountInfoFilteredBy(t,n);return s?(e.verbose("getAccount: Account matching provided filter found, returning"),s):(e.verbose("getAccount: No matching account found, returning null"),null)}function sk(t,e,r,n){if(e.trace("getAccountByUsername called"),!t)return e.warning("getAccountByUsername: No username provided"),null;const s=r.getAccountInfoFilteredBy({username:t},n);return s?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${t}`),s):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function ik(t,e,r,n){if(e.trace("getAccountByHomeId called"),!t)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const s=r.getAccountInfoFilteredBy({homeAccountId:t},n);return s?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${t}`),s):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function ak(t,e,r,n){if(e.trace("getAccountByLocalId called"),!t)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const s=r.getAccountInfoFilteredBy({localAccountId:t},n);return s?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${t}`),s):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function ok(t,e,r){e.setActiveAccount(t,r)}function lk(t,e){return t.getActiveAccount(e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Te={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.30.0 2025-08-05 */class ck{constructor(e){this.eventCallbacks=new Map,this.logger=e||new as({})}addEventCallback(e,r,n){if(typeof window<"u"){const s=n||B2();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,r||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,r,n,s){if(typeof window<"u"){const i={eventType:e,interactionType:r||null,payload:n||null,error:s||null,timestamp:Date.now()};this.eventCallbacks.forEach(([a,o],l)=>{(o.length===0||o.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),a.apply(null,[i]))})}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class c_{constructor(e,r,n,s,i,a,o,l,u){this.config=e,this.browserStorage=r,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=a,this.nativeMessageHandler=l,this.correlationId=u||Dn(),this.logger=s.clone(Or.MSAL_SKU,Ma,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){Ot.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(Ot.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const r=e||this.config.auth.redirectUri;return Fe.getAbsoluteUrl(r,Yn())}initializeServerTelemetryManager(e,r){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:r||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new nl(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:r}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(U.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,a=n!=null&&n.length?n==="true":this.config.auth.instanceAware,o=r&&a?this.config.auth.authority.replace(Fe.getDomainFromUrl(i),r.environment):i,l=er.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),u=await he(xw,U.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(r&&!u.isAlias(r.environment))throw Ze(cw);return u}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const uk=32;async function dk(t,e,r){t.addQueueMeasurement(U.GeneratePkceCodes,r);const n=bi(hk,U.GenerateCodeVerifier,e,t,r)(t,e,r),s=await he(fk,U.GenerateCodeChallengeFromVerifier,e,t,r)(n,t,e,r);return{verifier:n,challenge:s}}function hk(t,e,r){try{const n=new Uint8Array(uk);return bi(I2,U.GetRandomValues,e,t,r)(n),id(n)}catch{throw _e(mp)}}async function fk(t,e,r,n){e.addQueueMeasurement(U.GenerateCodeChallengeFromVerifier,n);try{const s=await he(n_,U.Sha256Digest,r,e,n)(t,e,n);return id(new Uint8Array(s))}catch{throw _e(mp)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function Ap(t,e,r,n){r.addQueueMeasurement(U.InitializeBaseRequest,t.correlationId);const s=t.authority||e.auth.authority,i=[...t&&t.scopes||[]],a={...t,correlationId:t.correlationId,authority:s,scopes:i};if(!a.authenticationScheme)a.authenticationScheme=Xe.BEARER,n.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===Xe.SSH){if(!t.sshJwk)throw Ze(Ju);if(!t.sshKid)throw Ze(aw)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&t.claims&&!vn.isEmptyObj(t.claims)&&(a.requestedClaimsHash=await s_(t.claims)),a}async function pk(t,e,r,n,s){n.addQueueMeasurement(U.InitializeSilentRequest,t.correlationId);const i=await he(Ap,U.InitializeBaseRequest,s,n,t.correlationId)(t,r,n,s);return{...t,...i,account:e,forceRefresh:t.forceRefresh||!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Ga extends c_{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(U.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const r=await he(dk,U.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n={...e,redirectUri:e.redirectUri,code:V.EMPTY_STRING,codeVerifier:r.verifier};return e.codeChallenge=r.challenge,e.codeChallengeMethod=V.S256_CODE_CHALLENGE_METHOD,n}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const r={correlationId:this.correlationId||Dn(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=Fe.getAbsoluteUrl(e.postLogoutRedirectUri,Yn())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=Fe.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Yn())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=Fe.getAbsoluteUrl(Yn(),Yn())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId),r}getLogoutHintFromIdTokenClaims(e){const r=e.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(U.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const r=await he(this.getClientConfiguration.bind(this),U.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new _w(r,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:r,requestAuthority:n,requestAzureCloudOptions:s,requestExtraQueryParameters:i,account:a}=e;this.performanceClient.addQueueMeasurement(U.StandardInteractionClientGetClientConfiguration,this.correlationId);const o=await he(this.getDiscoveredAuthority.bind(this),U.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:s,requestExtraQueryParameters:i,account:a}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:r,libraryInfo:{sku:Or.MSAL_SKU,version:Ma,cpu:V.EMPTY_STRING,os:V.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,r){this.performanceClient.addQueueMeasurement(U.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const n=this.getRedirectUri(e.redirectUri),s={interactionType:r},i=xn.setRequestState(this.browserCrypto,e&&e.state||V.EMPTY_STRING,s),o={...await he(Ap,U.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:n,state:i,nonce:e.nonce||Dn(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;const l=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),o.account=l),!o.loginHint&&!l){const u=this.browserStorage.getLegacyLoginHint();u&&(o.loginHint=u)}return o}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const mk="ContentError",u_="user_switch";/*! @azure/msal-browser v3.30.0 2025-08-05 */const gk="USER_INTERACTION_REQUIRED",vk="USER_CANCEL",xk="NO_NETWORK",yk="PERSISTENT_ERROR",wk="DISABLED",_k="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.30.0 2025-08-05 */const Ek=-2147186943,Tk={[u_]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class Rn extends ht{constructor(e,r,n){super(e,r),Object.setPrototypeOf(this,Rn.prototype),this.name="NativeAuthError",this.ext=n}}function qi(t){if(t.ext&&t.ext.status&&(t.ext.status===yk||t.ext.status===wk)||t.ext&&t.ext.error&&t.ext.error===Ek)return!0;switch(t.errorCode){case mk:return!0;default:return!1}}function Nf(t,e,r){if(r&&r.status)switch(r.status){case _k:return Ef(yw);case gk:return new _n(t,e);case vk:return _e(yi);case xk:return _e(uu)}return new Rn(t,Tk[t]||e,r)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class d_ extends Ga{async acquireToken(e){this.performanceClient.addQueueMeasurement(U.SilentCacheClientAcquireToken,e.correlationId);const r=this.initializeServerTelemetryManager(nt.acquireTokenSilent_silentFlow),n=await he(this.getClientConfiguration.bind(this),U.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new a2(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const a=(await he(s.acquireCachedToken.bind(s),U.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(i){throw i instanceof _l&&i.errorCode===xp&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(r==null?void 0:r.account)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class _a extends c_{constructor(e,r,n,s,i,a,o,l,u,d,h,f){var g;super(e,r,n,s,i,a,l,u,f),this.apiId=o,this.accountId=d,this.nativeMessageHandler=u,this.nativeStorageManager=h,this.silentCacheClient=new d_(e,this.nativeStorageManager,n,s,i,a,l,u,f),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const p=this.nativeMessageHandler.getExtensionId()===ha.PREFERRED_EXTENSION_ID?"chrome":(g=this.nativeMessageHandler.getExtensionId())!=null&&g.length?"unknown":void 0;this.skus=nl.makeExtraSkuString({libraryName:Or.MSAL_SKU,libraryVersion:Ma,extensionName:p,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[$b]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(U.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const r=this.performanceClient.startMeasurement(U.NativeInteractionClientAcquireToken,e.correlationId),n=Mn();try{const s=await this.initializeNativeRequest(e);try{const u=await this.acquireTokensFromCache(this.accountId,s);return r.end({success:!0,isNativeBroker:!1,fromCache:!0}),u}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=s,a={method:ai.GetToken,request:i},o=await this.nativeMessageHandler.sendMessage(a),l=this.validateNativeResponse(o);return await this.handleNativeResponse(l,s,n).then(u=>(r.end({success:!0,isNativeBroker:!0,requestId:u.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),u)).catch(u=>{throw r.end({success:!1,errorCode:u.errorCode,subErrorCode:u.subError,isNativeBroker:!0}),u})}catch(s){throw s instanceof Rn&&this.serverTelemetryManager.setNativeBrokerErrorCode(s.errorCode),s}}createSilentCacheRequest(e,r){return{authority:e.authority,correlationId:this.correlationId,scopes:yt.fromString(e.scope).asArray(),account:r,forceRefresh:!1}}async acquireTokensFromCache(e,r){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),ae(gf);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},r.correlationId);if(!n)throw ae(gf);try{const s=this.createSilentCacheRequest(r,n),i=await this.silentCacheClient.acquireToken(s),a={...n,idTokenClaims:i==null?void 0:i.idTokenClaims,idToken:i==null?void 0:i.idToken};return{...i,account:a}}catch(s){throw s}}async acquireTokenRedirect(e,r){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...n}=e;delete n.onRedirectNavigate;const s=await this.initializeNativeRequest(n),i={method:ai.GetToken,request:s};try{const l=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(l)}catch(l){if(l instanceof Rn&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),qi(l)))throw l}this.browserStorage.setTemporaryCache(Ke.NATIVE_REQUEST,JSON.stringify(s),!0);const a={apiId:nt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);r.end({success:!0}),await this.navigationClient.navigateExternal(o,a)}async handleRedirectPromise(e,r){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&r&&(e==null||e.addFields({errorCode:"no_cached_request"},r)),null;const{prompt:s,...i}=n;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ke.NATIVE_REQUEST));const a={method:ai.GetToken,request:i},o=Mn();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);const u=this.handleNativeResponse(l,i,o);this.browserStorage.setInteractionInProgress(!1);const d=await u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),d}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,r,n){var d;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=Ai(e.id_token,jn),i=this.createHomeAccountIdentifier(e,s),a=(d=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:r.accountId},this.correlationId))==null?void 0:d.homeAccountId;if(i!==a&&e.account.id!==r.accountId)throw Nf(u_);const o=await this.getDiscoveredAuthority({requestAuthority:r.authority}),l=hp(this.browserStorage,o,i,jn,this.correlationId,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger),u=await this.generateAuthenticationResult(e,r,s,l,o.canonicalAuthority,n);return this.cacheAccount(l),this.cacheNativeTokens(e,r,i,s,e.access_token,u.tenantId,n),u}createHomeAccountIdentifier(e,r){return Ot.generateHomeAccountId(e.client_info||V.EMPTY_STRING,cn.Default,this.logger,this.browserCrypto,r)}generateScopes(e,r){return e.scope?yt.fromString(e.scope):yt.fromString(r.scope)}async generatePopAccessToken(e,r){if(r.tokenType===Xe.POP&&r.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new ja(this.browserCrypto),s={resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce};if(!r.keyId)throw ae(Q0);return n.signPopToken(e.access_token,r.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,r,n,s,i,a){const o=this.addTelemetryFromNativeResponse(e),l=e.scope?yt.fromString(e.scope):yt.fromString(r.scope),u=e.account.properties||{},d=u.UID||n.oid||n.sub||V.EMPTY_STRING,h=u.TenantId||n.tid||V.EMPTY_STRING,f=ip(s.getAccountInfo(),void 0,n,e.id_token);f.nativeAccountId!==e.account.id&&(f.nativeAccountId=e.account.id);const p=await this.generatePopAccessToken(e,r),g=r.tokenType===Xe.POP?Xe.POP:Xe.BEARER;return{authority:i,uniqueId:d,tenantId:h,scopes:l.asArray(),account:f,idToken:e.id_token,idTokenClaims:n,accessToken:p,fromCache:o?this.isResponseFromCache(o):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:g,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(r=>{this.logger.error(`Error occurred while removing account context from browser storage. ${r}`)})}cacheNativeTokens(e,r,n,s,i,a,o){const l=Qu(n,r.authority,e.id_token||"",r.clientId,s.tid||""),u=r.tokenType===Xe.POP?V.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,d=o+u,h=this.generateScopes(e,r),f=Xu(n,r.authority,i,r.clientId,s.tid||a,h.printScopes(),d,0,jn,void 0,r.tokenType,void 0,r.keyId),p={idToken:l,accessToken:f};this.nativeStorageManager.saveCacheRecord(p,r.correlationId,r.storeInCache)}addTelemetryFromNativeResponse(e){const r=this.getMATSFromResponse(e);return r?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:r.broker_version,matsAccountJoinOnStart:r.account_join_on_start,matsAccountJoinOnEnd:r.account_join_on_end,matsDeviceJoin:r.device_join,matsPromptBehavior:r.prompt_behavior,matsApiErrorCode:r.api_error_code,matsUiVisible:r.ui_visible,matsSilentCode:r.silent_code,matsSilentBiSubCode:r.silent_bi_sub_code,matsSilentMessage:r.silent_message,matsSilentStatus:r.silent_status,matsHttpStatus:r.http_status,matsHttpEventCount:r.http_event_count},this.correlationId),r):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw N1(K0,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const r=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:r,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new Fe(r);n.validateAsUri();const{scopes:s,...i}=e,a=new yt(s||[]);a.appendScopes(Ka);const o=()=>{switch(this.apiId){case nt.ssoSilent:case nt.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Mt.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Mt.NONE:case Mt.CONSENT:case Mt.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),_e(Yw)}},l={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:o(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw _e(Xw);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=ha.MATS_TELEMETRY,e.authenticationScheme===Xe.POP){const u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},d=new ja(this.browserCrypto);let h;if(l.keyId)h=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const f=await he(d.generateCnf.bind(d),U.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);h=f.reqCnfString,l.keyId=f.kid,l.signPopToken=!0}l.reqCnf=h}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var i;const r=e.extraParameters&&e.extraParameters.hasOwnProperty(cp)&&e.extraParameters.hasOwnProperty(_f)&&e.extraParameters.hasOwnProperty(vi);if(!e.embeddedClientId&&!r)return;let n="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,n=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[_f],n=e.extraParameters[vi]),e.extraParameters={child_client_id:n,child_redirect_uri:s},(i=this.performanceClient)==null||i.addFields({embeddedClientId:n,embeddedRedirectUri:s},e.correlationId)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class On{constructor(e,r,n,s){this.logger=e,this.handshakeTimeoutMs=r,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(U.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const r={channel:ha.CHANNEL_ID,extensionId:this.extensionId,responseId:Dn(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(r)}`),this.messageChannel.port1.postMessage(r),new Promise((n,s)=>{this.resolvers.set(r.responseId,{resolve:n,reject:s})})}static async createProvider(e,r,n){e.trace("NativeMessageHandler - createProvider called.");try{const s=new On(e,r,n,ha.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const i=new On(e,r,n);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:ha.CHANNEL_ID,extensionId:this.extensionId,responseId:Dn(),body:{method:ai.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=r=>{this.onChannelMessage(r)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((r,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:r,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(_e(Ww)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const r=e.data;if(!(!r.channel||r.channel!==ha.CHANNEL_ID)&&!(r.extensionId&&r.extensionId!==this.extensionId)&&r.body.method===ai.HandshakeRequest){const n=this.handshakeResolvers.get(r.responseId);if(!n){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${r.responseId}`);return}this.logger.verbose(r.extensionId?`Extension with id: ${r.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject(_e(Vw))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const r=e.data,n=this.resolvers.get(r.responseId),s=this.handshakeResolvers.get(r.responseId);try{const i=r.body.method;if(i===ai.Response){if(!n)return;const a=r.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")n.reject(Nf(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?n.reject(Nf(a.result.code,a.result.description,a.result.ext)):n.resolve(a.result);else throw N1(K0,"Event does not contain result.");this.resolvers.delete(r.responseId)}else if(i===ai.HandshakeResponse){if(!s){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${r.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=r.extensionId,this.extensionVersion=r.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(r.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(i):s&&s.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,r,n,s){if(r.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return r.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return r.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(s)switch(s){case Xe.BEARER:case Xe.POP:return r.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return r.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class bp{constructor(e,r,n,s,i){this.authModule=e,this.browserStorage=r,this.authCodeRequest=n,this.logger=s,this.performanceClient=i}async handleCodeResponse(e,r){this.performanceClient.addQueueMeasurement(U.HandleCodeResponse,r.correlationId);let n;try{n=this.authModule.handleFragmentResponse(e,r.state)}catch(s){throw s instanceof Ds&&s.subError===yi?_e(yi):s}return he(this.handleCodeResponseFromServer.bind(this),U.HandleCodeResponseFromServer,this.logger,this.performanceClient,r.correlationId)(n,r)}async handleCodeResponseFromServer(e,r,n=!0){if(this.performanceClient.addQueueMeasurement(U.HandleCodeResponseFromServer,r.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await he(this.authModule.updateAuthority.bind(this.authModule),U.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,r.correlationId)(e.cloud_instance_host_name,r.correlationId),n&&(e.nonce=r.nonce||void 0),e.state=r.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(r);i&&(this.authCodeRequest.ccsCredential=i)}return await he(this.authModule.acquireToken.bind(this.authModule),U.AuthClientAcquireToken,this.logger,this.performanceClient,r.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Mr.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Mr.UPN}:null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function h_(t,e,r){const n=ou(t);if(!n)throw dw(t)?(r.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${e} detected is: ${t}`),_e(Aw)):(r.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),_e(Sw));return n}function Ck(t,e,r){if(!t.state)throw _e(gp);const n=l_(e,t.state);if(!n)throw _e(bw);if(n.interactionType!==r)throw _e(kw)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Sk extends Ga{constructor(e,r,n,s,i,a,o,l,u,d){super(e,r,n,s,i,a,o,u,d),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const n={popupName:this.generatePopupName(e.scopes||Ka,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n))}catch(r){return Promise.reject(r)}}logout(e){try{this.logger.verbose("logoutPopup called");const r=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(r),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},s=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,n,s,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(r,n,s,i))}catch(r){return Promise.reject(r)}}async acquireTokenPopupAsync(e,r){var i;this.logger.verbose("acquireTokenPopupAsync called");const n=this.initializeServerTelemetryManager(nt.acquireTokenPopup),s=await he(this.initializeAuthorizationRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Ae.Popup);o_(s.authority);try{const a=await he(this.initializeAuthorizationCodeRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(s),o=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account}),l=On.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let u;l&&(u=this.performanceClient.startMeasurement(U.FetchAccountIdWithNativeBroker,e.correlationId));const d=await o.getAuthCodeUrl({...s,nativeBroker:l}),h=new bp(o,this.browserStorage,a,this.logger,this.performanceClient),f=this.initiateAuthRequest(d,r);this.eventHandler.emitEvent(Te.POPUP_OPENED,Ae.Popup,{popupWindow:f},null);const p=await this.monitorPopupForHash(f,r.popupWindowParent),g=bi(h_,U.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(p,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Nn.removeThrottle(this.browserStorage,this.config.auth.clientId,a),g.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw _e(wl);const w=new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,g.accountId,this.nativeStorage,s.correlationId),{userRequestState:v}=xn.parseRequestState(this.browserCrypto,s.state);return await w.acquireToken({...s,state:v,prompt:void 0})}return await h.handleCodeResponse(g,s)}catch(a){throw(i=r.popup)==null||i.close(),a instanceof ht&&(a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a)),a}}async logoutPopupAsync(e,r,n,s){var a,o,l,u;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Te.LOGOUT_START,Ae.Popup,e);const i=this.initializeServerTelemetryManager(nt.logoutPopup);try{await this.clearCacheOnLogout(e.account);const d=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{d.authority.endSessionEndpoint}catch{if((a=e.account)!=null&&a.homeAccountId&&e.postLogoutRedirectUri&&d.authority.protocolMode===Jn.OIDC){if(this.browserStorage.removeAccount((o=e.account)==null?void 0:o.homeAccountId,this.correlationId),this.eventHandler.emitEvent(Te.LOGOUT_SUCCESS,Ae.Popup,e),s){const p={apiId:nt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Fe.getAbsoluteUrl(s,Yn());await this.navigationClient.navigateInternal(g,p)}(l=r.popup)==null||l.close();return}}const h=d.getLogoutUri(e);this.eventHandler.emitEvent(Te.LOGOUT_SUCCESS,Ae.Popup,e);const f=this.openPopup(h,r);if(this.eventHandler.emitEvent(Te.POPUP_OPENED,Ae.Popup,{popupWindow:f},null),await this.monitorPopupForHash(f,r.popupWindowParent).catch(()=>{}),s){const p={apiId:nt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},g=Fe.getAbsoluteUrl(s,Yn());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${g}`),await this.navigationClient.navigateInternal(g,p)}else this.logger.verbose("No main window navigation requested")}catch(d){throw(u=r.popup)==null||u.close(),d instanceof ht&&(d.setCorrelationId(this.correlationId),i.cacheFailedRequest(d)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Te.LOGOUT_FAILURE,Ae.Popup,null,d),this.eventHandler.emitEvent(Te.LOGOUT_END,Ae.Popup),d}this.eventHandler.emitEvent(Te.LOGOUT_END,Ae.Popup)}initiateAuthRequest(e,r){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,r);throw this.logger.error("Navigate url is empty"),_e(rd)}monitorPopupForHash(e,r){return new Promise((n,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),s(_e(yi));return}let a="";try{a=e.location.href}catch{}if(!a||a==="about:blank")return;clearInterval(i);let o="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===yl.QUERY?o=e.location.search:o=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),n(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,r)})}openPopup(e,r){try{let n;if(r.popup?(n=r.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof r.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,r)),!n)throw _e(Rw);return n.focus&&n.focus(),this.currentWindow=n,r.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),_e(Nw)}}openSizedPopup(e,{popupName:r,popupWindowAttributes:n,popupWindowParent:s}){var p,g,m,w;const i=s.screenLeft?s.screenLeft:s.screenX,a=s.screenTop?s.screenTop:s.screenY,o=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let u=(p=n.popupSize)==null?void 0:p.width,d=(g=n.popupSize)==null?void 0:g.height,h=(m=n.popupPosition)==null?void 0:m.top,f=(w=n.popupPosition)==null?void 0:w.left;return(!u||u<0||u>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),u=Or.POPUP_WIDTH),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),d=Or.POPUP_HEIGHT),(!h||h<0||h>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),h=Math.max(0,l/2-Or.POPUP_HEIGHT/2+a)),(!f||f<0||f>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),f=Math.max(0,o/2-Or.POPUP_WIDTH/2+i)),s.open(e,r,`width=${u}, height=${d}, top=${h}, left=${f}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(Ae.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,r){e.close(),r.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,r){return`${Or.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${r}.${this.correlationId}`}generateLogoutPopupName(e){const r=e.account&&e.account.homeAccountId;return`${Or.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${r}.${this.correlationId}`}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class ev{constructor(e,r,n,s,i){this.authModule=e,this.browserStorage=r,this.authCodeRequest=n,this.logger=s,this.performanceClient=i}async initiateAuthRequest(e,r){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){r.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(Ke.ORIGIN_URI,r.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(Ke.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:nt.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:!1};if(typeof r.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),r.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await r.navigationClient.navigateExternal(e,n);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await r.navigationClient.navigateExternal(e,n);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),_e(rd)}async handleCodeResponse(e,r){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const n=this.browserStorage.generateStateKey(r),s=this.browserStorage.getTemporaryCache(n);if(!s)throw ae(nu,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,s)}catch(u){throw u instanceof Ds&&u.subError===yi?_e(yi):u}const a=this.browserStorage.generateNonceKey(s),o=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await he(this.authModule.updateAuthority.bind(this.authModule),U.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=o||void 0,i.state=s,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const u=this.checkCcsCredentials();u&&(this.authCodeRequest.ccsCredential=u)}const l=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(r),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(Ke.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function Ak(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const t=window.performance.getEntriesByType("navigation"),e=t.length?t[0]:void 0;return e==null?void 0:e.type}class bk extends Ga{constructor(e,r,n,s,i,a,o,l,u,d){super(e,r,n,s,i,a,o,u,d),this.nativeStorage=l}async acquireToken(e){const r=await he(this.initializeAuthorizationRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,Ae.Redirect);this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||"",r.account||null);const n=this.initializeServerTelemetryManager(nt.acquireTokenRedirect),s=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(r.state),this.eventHandler.emitEvent(Te.RESTORE_FROM_BFCACHE,Ae.Redirect))};try{const i=await he(this.initializeAuthorizationCodeRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(r),a=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),o=new ev(a,this.browserStorage,i,this.logger,this.performanceClient),l=await a.getAuthCodeUrl({...r,nativeBroker:On.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),u=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${u}`),window.addEventListener("pageshow",s),await o.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:u,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof ht&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),window.removeEventListener("pageshow",s),this.browserStorage.cleanRequestByState(r.state),i}}async handleRedirectPromise(e="",r){const n=this.initializeServerTelemetryManager(nt.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[s,i]=this.getRedirectResponse(e||"");if(!s)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(Ae.Redirect),Ak()!=="back_forward"?r.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(Ke.ORIGIN_URI,!0)||V.EMPTY_STRING,o=Fe.removeHashFromUrl(a),l=Fe.removeHashFromUrl(window.location.href);if(o===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&L2(a),await this.handleResponse(s,n);if(this.config.auth.navigateToLoginRequestUrl){if(!Tp()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Ke.URL_HASH,i,!0);const u={apiId:nt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let d=!0;if(!a||a==="null"){const h=M2();this.browserStorage.setTemporaryCache(Ke.ORIGIN_URI,h,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),d=await this.navigationClient.navigateInternal(h,u)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),d=await this.navigationClient.navigateInternal(a,u);if(!d)return await this.handleResponse(s,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(s,n);return null}catch(s){throw s instanceof ht&&(s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s)),this.browserStorage.cleanRequestByInteractionType(Ae.Redirect),s}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let r=e;r||(this.config.auth.OIDCOptions.serverResponseType===yl.QUERY?r=window.location.search:r=window.location.hash);let n=ou(r);if(n){try{Ck(n,this.browserCrypto,Ae.Redirect)}catch(i){return i instanceof ht&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return P2(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,r]}const s=this.browserStorage.getTemporaryCache(Ke.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Ke.URL_HASH)),s&&(n=ou(s),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,s]):[null,""]}async handleResponse(e,r){const n=e.state;if(!n)throw _e(gp);const s=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw _e(wl);const l=new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,s.correlationId),{userRequestState:u}=xn.parseRequestState(this.browserCrypto,n);return l.acquireToken({...s,state:u,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(n)})}const i=this.browserStorage.getCachedAuthority(n);if(!i)throw _e(vp);const a=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i});return Nn.removeThrottle(this.browserStorage,this.config.auth.clientId,s),new ev(a,this.browserStorage,s,this.logger,this.performanceClient).handleCodeResponse(e,n)}async logout(e){var s,i;this.logger.verbose("logoutRedirect called");const r=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(nt.logout);try{this.eventHandler.emitEvent(Te.LOGOUT_START,Ae.Redirect,e),await this.clearCacheOnLogout(r.account);const a={apiId:nt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(o.authority.protocolMode===Jn.OIDC)try{o.authority.endSessionEndpoint}catch{if((s=r.account)!=null&&s.homeAccountId){this.browserStorage.removeAccount((i=r.account)==null?void 0:i.homeAccountId,this.correlationId),this.eventHandler.emitEvent(Te.LOGOUT_SUCCESS,Ae.Redirect,r);return}}const l=o.getLogoutUri(r);if(this.eventHandler.emitEvent(Te.LOGOUT_SUCCESS,Ae.Redirect,r),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,a);return}}catch(a){throw a instanceof ht&&(a.setCorrelationId(this.correlationId),n.cacheFailedRequest(a)),this.eventHandler.emitEvent(Te.LOGOUT_FAILURE,Ae.Redirect,null,a),this.eventHandler.emitEvent(Te.LOGOUT_END,Ae.Redirect),a}this.eventHandler.emitEvent(Te.LOGOUT_END,Ae.Redirect)}getRedirectStartPage(e){const r=e||window.location.href;return Fe.getAbsoluteUrl(r,Yn())}}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function kk(t,e,r,n,s){if(e.addQueueMeasurement(U.SilentHandlerInitiateAuthRequest,n),!t)throw r.info("Navigate url is empty"),_e(rd);return s?he(Nk,U.SilentHandlerLoadFrame,r,e,n)(t,s,e,n):bi(Rk,U.SilentHandlerLoadFrameSync,r,e,n)(t)}async function Ik(t,e,r,n,s,i,a){return n.addQueueMeasurement(U.SilentHandlerMonitorIframeForHash,i),new Promise((o,l)=>{e<bf&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${bf}ms). This may result in timeouts.`);const u=window.setTimeout(()=>{window.clearInterval(d),l(_e(Ow))},e),d=window.setInterval(()=>{let h="";const f=t.contentWindow;try{h=f?f.location.href:""}catch{}if(!h||h==="about:blank")return;let p="";f&&(a===yl.QUERY?p=f.location.search:p=f.location.hash),window.clearTimeout(u),window.clearInterval(d),o(p)},r)}).finally(()=>{bi(Ok,U.RemoveHiddenIframe,s,n,i)(t)})}function Nk(t,e,r,n){return r.addQueueMeasurement(U.SilentHandlerLoadFrame,n),new Promise((s,i)=>{const a=f_();window.setTimeout(()=>{if(!a){i("Unable to load iframe");return}a.src=t,s(a)},e)})}function Rk(t){const e=f_();return e.src=t,e}function f_(){const t=document.createElement("iframe");return t.className="msalSilentIframe",t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(t),t}function Ok(t){document.body===t.parentNode&&document.body.removeChild(t)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Pk extends Ga{constructor(e,r,n,s,i,a,o,l,u,d,h){super(e,r,n,s,i,a,l,d,h),this.apiId=o,this.nativeStorage=u}async acquireToken(e){this.performanceClient.addQueueMeasurement(U.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const r={...e};r.prompt?r.prompt!==Mt.NONE&&r.prompt!==Mt.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${Mt.NONE}`),r.prompt=Mt.NONE):r.prompt=Mt.NONE;const n=await he(this.initializeAuthorizationRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,Ae.Silent);o_(n.authority);const s=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await he(this.createAuthCodeClient.bind(this),U.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:s,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await he(this.silentTokenHelper.bind(this),U.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,n)}catch(a){if(a instanceof ht&&(a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a)),!i||!(a instanceof ht)||a.errorCode!==Or.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);const o=await he(this.initializeAuthorizationRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,Ae.Silent);return await he(this.silentTokenHelper.bind(this),U.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,o)}}logout(){return Promise.reject(_e(nd))}async silentTokenHelper(e,r){const n=r.correlationId;this.performanceClient.addQueueMeasurement(U.SilentIframeClientTokenHelper,n);const s=await he(this.initializeAuthorizationCodeRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,n)(r),i=await he(e.getAuthCodeUrl.bind(e),U.GetAuthCodeUrl,this.logger,this.performanceClient,n)({...r,nativeBroker:On.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme)}),a=new bp(e,this.browserStorage,s,this.logger,this.performanceClient),o=await he(kk,U.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(i,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,u=await he(Ik,U.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,l),d=bi(h_,U.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(u,l,this.logger);if(d.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw _e(wl);const h=new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,d.accountId,this.browserStorage,n),{userRequestState:f}=xn.parseRequestState(this.browserCrypto,r.state);return he(h.acquireToken.bind(h),U.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,n)({...r,state:f,prompt:r.prompt||Mt.NONE})}return he(a.handleCodeResponse.bind(a),U.HandleCodeResponse,this.logger,this.performanceClient,n)(d,r)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Lk extends Ga{async acquireToken(e){this.performanceClient.addQueueMeasurement(U.SilentRefreshClientAcquireToken,e.correlationId);const r=await he(Ap,U.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n={...e,...r};e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(nt.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return he(i.acquireTokenByRefreshToken.bind(i),U.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(a=>{throw a.setCorrelationId(this.correlationId),s.cacheFailedRequest(a),a})}logout(){return Promise.reject(_e(nd))}async createRefreshTokenClient(e){const r=await he(this.getClientConfiguration.bind(this),U.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Tf(r,this.performanceClient)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class jk{constructor(e,r,n,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=r,this.logger=n,this.cryptoObj=s}loadExternalTokens(e,r,n){if(!this.isBrowserEnvironment)throw _e(sd);const s=e.correlationId||Dn(),i=r.id_token?Ai(r.id_token,jn):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new er(er.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||Dn()):void 0,l=this.loadAccount(e,n.clientInfo||r.client_info||"",s,i,o),u=this.loadIdToken(r,l.homeAccountId,l.environment,l.realm,s),d=this.loadAccessToken(e,r,l.homeAccountId,l.environment,l.realm,n,s),h=this.loadRefreshToken(r,l.homeAccountId,l.environment,s);return this.generateAuthenticationResult(e,{account:l,idToken:u,accessToken:d,refreshToken:h},i,o)}loadAccount(e,r,n,s,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const u=Ot.createFromAccountInfo(e.account);return this.storage.setAccount(u,n),u}else if(!i||!r&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),_e(Hw);const a=Ot.generateHomeAccountId(r,i.authorityType,this.logger,this.cryptoObj,s),o=s==null?void 0:s.tid,l=hp(this.storage,i,a,jn,n,s,r,i.hostnameAndPort,o,void 0,void 0,this.logger);return this.storage.setAccount(l,n),l}loadIdToken(e,r,n,s,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const a=Qu(r,n,e.id_token,this.config.auth.clientId,s);return this.storage.setIdTokenCredential(a,i),a}loadAccessToken(e,r,n,s,i,a,o){if(r.access_token)if(r.expires_in){if(!r.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const l=r.scope?yt.fromString(r.scope):new yt(e.scopes),u=a.expiresOn||r.expires_in+new Date().getTime()/1e3,d=a.extendedExpiresOn||(r.ext_expires_in||r.expires_in)+new Date().getTime()/1e3,h=Xu(n,s,r.access_token,this.config.auth.clientId,i,l.printScopes(),u,d,jn);return this.storage.setAccessTokenCredential(h,o),h}loadRefreshToken(e,r,n,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const i=Y1(r,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i,s),i}generateAuthenticationResult(e,r,n,s){var d,h,f;let i="",a=[],o=null,l;r!=null&&r.accessToken&&(i=r.accessToken.secret,a=yt.fromString(r.accessToken.target).asArray(),o=new Date(Number(r.accessToken.expiresOn)*1e3),l=new Date(Number(r.accessToken.extendedExpiresOn)*1e3));const u=r.account;return{authority:s?s.canonicalAuthority:"",uniqueId:r.account.localAccountId,tenantId:r.account.realm,scopes:a,account:u.getAccountInfo(),idToken:((d=r.idToken)==null?void 0:d.secret)||"",idTokenClaims:n||{},accessToken:i,fromCache:!0,expiresOn:o,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((h=r.refreshToken)==null?void 0:h.familyId)||"",tokenType:((f=r==null?void 0:r.accessToken)==null?void 0:f.tokenType)||"",state:e.state||"",cloudGraphHostName:u.cloudGraphHostName||"",msGraphHost:u.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Mk extends _w{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.30.0 2025-08-05 */class Dk extends Ga{constructor(e,r,n,s,i,a,o,l,u,d){super(e,r,n,s,i,a,l,u,d),this.apiId=o}async acquireToken(e){if(!e.code)throw _e(zw);const r=await he(this.initializeAuthorizationRequest.bind(this),U.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,Ae.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const s={...r,code:e.code},i=await he(this.getClientConfiguration.bind(this),U.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),a=new Mk(i);this.logger.verbose("Auth code client created");const o=new bp(a,this.browserStorage,s,this.logger,this.performanceClient);return await he(o.handleCodeResponseFromServer.bind(o),U.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},r,!1)}catch(s){throw s instanceof ht&&(s.setCorrelationId(this.correlationId),n.cacheFailedRequest(s)),s}}logout(){return Promise.reject(_e(nd))}}/*! @azure/msal-browser v3.30.0 2025-08-05 */function Cn(t){const e=t==null?void 0:t.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function ac(t,e){try{Cp(t)}catch(r){throw e.end({success:!1},r),r}}class ad{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Da(this.logger,this.performanceClient):su,this.eventHandler=new ck(this.logger),this.browserStorage=this.isBrowserEnvironment?new If(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Qb(this.config.auth),this.performanceClient):tk(this.config.auth.clientId,this.logger);const r={cacheLocation:xr.MemoryStorage,temporaryCacheLocation:xr.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new If(this.config.auth.clientId,r,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new jk(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,r){const n=new ad(e);return await n.initialize(r),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(Te.INITIALIZE_END);return}const r=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,s=this.performanceClient.startMeasurement(U.InitializeClientApplication,r);if(this.eventHandler.emitEvent(Te.INITIALIZE_START),n)try{this.nativeExtensionProvider=await On.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await he(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),U.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,r)(this.performanceClient,r)),this.initialized=!0,this.eventHandler.emitEvent(Te.INITIALIZE_END),s.end({allowNativeBroker:n,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),a_(this.initialized),this.isBrowserEnvironment){const r=e||"";let n=this.redirectResponse.get(r);return typeof n>"u"?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(r,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),s=n&&On.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=s?n==null?void 0:n.correlationId:this.browserStorage.getTemporaryCache(Ke.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(U.AcquireTokenRedirect,i);this.eventHandler.emitEvent(Te.HANDLE_REDIRECT_START,Ae.Redirect);let o;if(s&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);o=he(l.handleRedirectPromise.bind(l),U.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(i);o=he(l.handleRedirectPromise.bind(l),U.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return o.then(l=>(l?(r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(Te.LOGIN_SUCCESS,Ae.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_SUCCESS,Ae.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:Cn(l.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(Te.HANDLE_REDIRECT_END,Ae.Redirect),l)).catch(l=>{const u=l;throw r.length>0?this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,u):this.eventHandler.emitEvent(Te.LOGIN_FAILURE,Ae.Redirect,null,u),this.eventHandler.emitEvent(Te.HANDLE_REDIRECT_END,Ae.Redirect),a.end({success:!1},u),l})}async acquireTokenRedirect(e){const r=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",r);const n=this.performanceClient.startMeasurement(U.AcquireTokenPreRedirect,r);n.add({accountType:Cn(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=a=>{const o=typeof s=="function"?s(a):void 0;return o!==!1?n.end({success:!0}):n.discard(),o};else{const a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=o=>{const l=typeof a=="function"?a(o):void 0;return l!==!1?n.end({success:!0}):n.discard(),l}}const i=this.getAllAccounts().length>0;try{Qg(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_START,Ae.Redirect,e):this.eventHandler.emitEvent(Te.LOGIN_START,Ae.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUseNative(e)?a=new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,r).acquireTokenRedirect(e,n).catch(l=>{if(l instanceof Rn&&qi(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(r).acquireToken(e);if(l instanceof _n)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(r).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):a=this.createRedirectClient(r).acquireToken(e),await a}catch(a){throw n.end({success:!1},a),i?this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_FAILURE,Ae.Redirect,null,a):this.eventHandler.emitEvent(Te.LOGIN_FAILURE,Ae.Redirect,null,a),a}}acquireTokenPopup(e){const r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(U.AcquireTokenPopup,r);n.add({scenarioId:e.scenarioId,accountType:Cn(e.account)});try{this.logger.verbose("acquireTokenPopup called",r),ac(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(a){return Promise.reject(a)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_START,Ae.Popup,e):this.eventHandler.emitEvent(Te.LOGIN_START,Ae.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:r},nt.acquireTokenPopup).then(a=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:Cn(a.account)}),a)).catch(a=>{if(a instanceof Rn&&qi(a))return this.nativeExtensionProvider=void 0,this.createPopupClient(r).acquireToken(e);if(a instanceof _n)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),a}):i=this.createPopupClient(r).acquireToken(e),i.then(a=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent(Te.LOGIN_SUCCESS,Ae.Popup,a):this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_SUCCESS,Ae.Popup,a),n.end({success:!0,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Cn(a.account)}),a)).catch(a=>(s.length>0?this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_FAILURE,Ae.Popup,null,a):this.eventHandler.emitEvent(Te.LOGIN_FAILURE,Ae.Popup,null,a),n.end({success:!1},a),Promise.reject(a)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var i,a;const r=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:r};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(U.SsoSilent,r),(i=this.ssoSilentMeasurement)==null||i.add({scenarioId:e.scenarioId,accountType:Cn(e.account)}),ac(this.initialized,this.ssoSilentMeasurement),(a=this.ssoSilentMeasurement)==null||a.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(Te.SSO_SILENT_START,Ae.Silent,n);let s;return this.canUseNative(n)?s=this.acquireTokenNative(n,nt.ssoSilent).catch(o=>{if(o instanceof Rn&&qi(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw o}):s=this.createSilentIframeClient(n.correlationId).acquireToken(n),s.then(o=>{var l;return this.eventHandler.emitEvent(Te.SSO_SILENT_SUCCESS,Ae.Silent,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:o.fromNativeBroker,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Cn(o.account)}),o}).catch(o=>{var l;throw this.eventHandler.emitEvent(Te.SSO_SILENT_FAILURE,Ae.Silent,null,o),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const r=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",r);const n=this.performanceClient.startMeasurement(U.AcquireTokenByCode,r);ac(this.initialized,n),this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_BY_CODE_START,Ae.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw _e(Kw);if(e.code){const s=e.code;let i=this.hybridAuthCodeResponses.get(s);return i?(this.logger.verbose("Existing acquireTokenByCode request found",r),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",r),i=this.acquireTokenByCodeAsync({...e,correlationId:r}).then(a=>(this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_BY_CODE_SUCCESS,Ae.Silent,a),this.hybridAuthCodeResponses.delete(s),n.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Cn(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ae.Silent,null,a),n.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(s,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const s=await this.acquireTokenNative({...e,correlationId:r},nt.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof Rn&&qi(i)&&(this.nativeExtensionProvider=void 0),i});return n.end({accountType:Cn(s.account),success:!0}),s}else throw _e(Gw);else throw _e($w)}catch(s){throw this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_BY_CODE_FAILURE,Ae.Silent,null,s),n.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){var s;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(U.AcquireTokenByCodeAsync,e.correlationId),(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>{var a;return(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker}),i}).catch(i=>{var a;throw(a=this.acquireTokenByCodeAsyncMeasurement)==null||a.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,r){switch(this.performanceClient.addQueueMeasurement(U.AcquireTokenFromCache,e.correlationId),r){case kr.Default:case kr.AccessToken:case kr.AccessTokenAndRefreshToken:const n=this.createSilentCacheClient(e.correlationId);return he(n.acquireToken.bind(n),U.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ae(qn)}}async acquireTokenByRefreshToken(e,r){switch(this.performanceClient.addQueueMeasurement(U.AcquireTokenByRefreshToken,e.correlationId),r){case kr.Default:case kr.AccessTokenAndRefreshToken:case kr.RefreshToken:case kr.RefreshTokenAndNetwork:const n=this.createSilentRefreshClient(e.correlationId);return he(n.acquireToken.bind(n),U.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw ae(qn)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(U.AcquireTokenBySilentIframe,e.correlationId);const r=this.createSilentIframeClient(e.correlationId);return he(r.acquireToken.bind(r),U.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const r=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",r),this.logoutRedirect({correlationId:r,...e})}async logoutRedirect(e){const r=this.getRequestCorrelationId(e);return Qg(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(r).logout(e)}logoutPopup(e){try{const r=this.getRequestCorrelationId(e);return Cp(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(r).logout(e)}catch(r){return Promise.reject(r)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const r=this.getRequestCorrelationId(e);return this.createSilentCacheClient(r).logout(e)}getAllAccounts(e){const r=this.getRequestCorrelationId();return rk(this.logger,this.browserStorage,this.isBrowserEnvironment,r,e)}getAccount(e){const r=this.getRequestCorrelationId();return nk(e,this.logger,this.browserStorage,r)}getAccountByUsername(e){const r=this.getRequestCorrelationId();return sk(e,this.logger,this.browserStorage,r)}getAccountByHomeId(e){const r=this.getRequestCorrelationId();return ik(e,this.logger,this.browserStorage,r)}getAccountByLocalId(e){const r=this.getRequestCorrelationId();return ak(e,this.logger,this.browserStorage,r)}setActiveAccount(e){const r=this.getRequestCorrelationId();ok(e,this.browserStorage,r)}getActiveAccount(){const e=this.getRequestCorrelationId();return lk(this.browserStorage,e)}async hydrateCache(e,r){this.logger.verbose("hydrateCache called");const n=Ot.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,r)):this.browserStorage.hydrateCache(e,r)}async acquireTokenNative(e,r,n){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw _e(wl);return new _a(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,r,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,r){if(this.logger.trace("canUseNative called"),!On.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Mt.NONE:case Mt.CONSENT:case Mt.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!r&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const r=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return r&&r.nativeAccountId||""}createPopupClient(e){return new Sk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new bk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new Pk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new d_(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Lk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Dk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,nt.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,r){return this.eventHandler.addEventCallback(e,r)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return i_(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var r;try{(r=e.key)!=null&&r.includes(Lt.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(Te.ACTIVE_ACCOUNT_CHANGED);const n=e.newValue||e.oldValue;if(!n)return;const s=JSON.parse(n);if(typeof s!="object"||!Ot.isAccountEntity(s))return;const a=La.toObject(new Ot,s).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(Te.ACCOUNT_ADDED,void 0,a)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(Te.ACCOUNT_REMOVED,void 0,a))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,r){this.browserStorage.setWrapperMetadata(e,r)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Dn():V.EMPTY_STRING}async loginRedirect(e){const r=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",r),this.acquireTokenRedirect({correlationId:r,...e||Vg})}loginPopup(e){const r=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup({correlationId:r,...e||Vg})}async acquireTokenSilent(e){const r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(U.AcquireTokenSilent,r);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),ac(this.initialized,n),this.logger.verbose("acquireTokenSilent called",r);const s=e.account||this.getActiveAccount();if(!s)throw _e(Mw);n.add({accountType:Cn(s)});const i={clientId:this.config.auth.clientId,authority:e.authority||V.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:s.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(i),o=this.activeSilentTokenRequests.get(a);if(typeof o>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r);const l=he(this.acquireTokenSilentAsync.bind(this),U.AcquireTokenSilentAsync,this.logger,this.performanceClient,r)({...e,correlationId:r},s).then(u=>(this.activeSilentTokenRequests.delete(a),n.end({success:!0,fromCache:u.fromCache,isNativeBroker:u.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:u.accessToken.length,idTokenSize:u.idToken.length}),u)).catch(u=>{throw this.activeSilentTokenRequests.delete(a),n.end({success:!1},u),u});return this.activeSilentTokenRequests.set(a,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),n.discard(),{...await o,state:e.state}}async acquireTokenSilentAsync(e,r){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(U.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_START,Ae.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const s=await he(pk,U.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,r,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||kr.Default;return this.acquireTokenSilentNoIframe(s,i).catch(async o=>{if(Fk(o,i))if(this.activeIframeRequest)if(i!==kr.Skip){const[u,d]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${d}`,s.correlationId);const h=this.performanceClient.startMeasurement(U.AwaitConcurrentIframe,s.correlationId);h.add({awaitIframeCorrelationId:d});const f=await u;if(h.end({success:f}),f)return this.logger.verbose(`Parallel iframe request with correlationId: ${d} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,i);throw this.logger.info(`Iframe request with correlationId: ${d} failed. Interaction is required.`),o}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),he(this.acquireTokenBySilentIframe.bind(this),U.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let u;return this.activeIframeRequest=[new Promise(d=>{u=d}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),he(this.acquireTokenBySilentIframe.bind(this),U.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(d=>(u(!0),d)).catch(d=>{throw u(!1),d}).finally(()=>{this.activeIframeRequest=void 0})}else throw o}).then(o=>(this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_SUCCESS,Ae.Silent,o),e.correlationId&&this.performanceClient.addFields({fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker},e.correlationId),o)).catch(o=>{throw this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_FAILURE,Ae.Silent,null,o),o}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,r){return On.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,nt.acquireTokenSilent_silentFlow).catch(async n=>{throw n instanceof Rn&&qi(n)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,ae(qn)):n})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),he(this.acquireTokenFromCache.bind(this),U.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,r).catch(n=>{if(r===kr.AccessToken)throw n;return this.eventHandler.emitEvent(Te.ACQUIRE_TOKEN_NETWORK_START,Ae.Silent,e),he(this.acquireTokenByRefreshToken.bind(this),U.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,r)}))}}function Fk(t,e){const r=!(t instanceof _n&&t.subError!==td),n=t.errorCode===Or.INVALID_GRANT_ERROR||t.errorCode===qn,s=r&&n||t.errorCode===cu||t.errorCode===dp,i=_2.includes(e);return s&&i}/*! @azure/msal-browser v3.30.0 2025-08-05 */async function Uk(t,e){const r=new wi(t);return await r.initialize(),ad.createController(r,e)}/*! @azure/msal-browser v3.30.0 2025-08-05 */class fu{static async createPublicClientApplication(e){const r=await Uk(e);return new fu(e,r)}constructor(e,r){this.controller=r||new ad(new wi(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,r){return this.controller.addEventCallback(e,r)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,r){return this.controller.initializeWrapperLibrary(e,r)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,r){return this.controller.hydrateCache(e,r)}clearCache(e){return this.controller.clearCache(e)}}/*! @azure/msal-browser v3.30.0 2025-08-05 */const Bk={initialize:()=>Promise.reject(Et(_t)),acquireTokenPopup:()=>Promise.reject(Et(_t)),acquireTokenRedirect:()=>Promise.reject(Et(_t)),acquireTokenSilent:()=>Promise.reject(Et(_t)),acquireTokenByCode:()=>Promise.reject(Et(_t)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(Et(_t)),loginPopup:()=>Promise.reject(Et(_t)),loginRedirect:()=>Promise.reject(Et(_t)),logout:()=>Promise.reject(Et(_t)),logoutRedirect:()=>Promise.reject(Et(_t)),logoutPopup:()=>Promise.reject(Et(_t)),ssoSilent:()=>Promise.reject(Et(_t)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw Et(_t)},getLogger:()=>{throw Et(_t)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw Et(_t)},hydrateCache:()=>Promise.reject(Et(_t)),clearCache:()=>Promise.reject(Et(_t))};/*! @azure/msal-browser v3.30.0 2025-08-05 */class Hk{static getInteractionStatusFromEvent(e,r){switch(e.eventType){case Te.LOGIN_START:return Tt.Login;case Te.SSO_SILENT_START:return Tt.SsoSilent;case Te.ACQUIRE_TOKEN_START:if(e.interactionType===Ae.Redirect||e.interactionType===Ae.Popup)return Tt.AcquireToken;break;case Te.HANDLE_REDIRECT_START:return Tt.HandleRedirect;case Te.LOGOUT_START:return Tt.Logout;case Te.SSO_SILENT_SUCCESS:case Te.SSO_SILENT_FAILURE:if(r&&r!==Tt.SsoSilent)break;return Tt.None;case Te.LOGOUT_END:if(r&&r!==Tt.Logout)break;return Tt.None;case Te.HANDLE_REDIRECT_END:if(r&&r!==Tt.HandleRedirect)break;return Tt.None;case Te.LOGIN_SUCCESS:case Te.LOGIN_FAILURE:case Te.ACQUIRE_TOKEN_SUCCESS:case Te.ACQUIRE_TOKEN_FAILURE:case Te.RESTORE_FROM_BFCACHE:if(e.interactionType===Ae.Redirect||e.interactionType===Ae.Popup){if(r&&r!==Tt.Login&&r!==Tt.AcquireToken)break;return Tt.None}break}return null}}const zk="modulepreload",$k=function(t){return"/"+t},tv={},hn=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=$k(l),l in tv)return;tv[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":zk,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};/*! @azure/msal-react v2.2.0 2024-11-05 */const Kk={instance:Bk,inProgress:Tt.None,accounts:[],logger:new as({})},kp=Y.createContext(Kk);kp.Consumer;/*! @azure/msal-react v2.2.0 2024-11-05 */function rv(t,e){if(t.length!==e.length)return!1;const r=[...e];return t.every(n=>{const s=r.shift();return!n||!s?!1:n.homeAccountId===s.homeAccountId&&n.localAccountId===s.localAccountId&&n.username===s.username})}/*! @azure/msal-react v2.2.0 2024-11-05 */const Gk="@azure/msal-react",nv="2.2.0";/*! @azure/msal-react v2.2.0 2024-11-05 */const pu={UNBLOCK_INPROGRESS:"UNBLOCK_INPROGRESS",EVENT:"EVENT"},Wk=(t,e)=>{const{type:r,payload:n}=e;let s=t.inProgress;switch(r){case pu.UNBLOCK_INPROGRESS:t.inProgress===Tt.Startup&&(s=Tt.None,n.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case pu.EVENT:const a=n.message,o=Hk.getInteractionStatusFromEvent(a,t.inProgress);o&&(n.logger.info(`MsalProvider - ${a.eventType} results in setting inProgress from ${t.inProgress} to ${o}`),s=o);break;default:throw new Error(`Unknown action type: ${r}`)}const i=n.instance.getAllAccounts();return s!==t.inProgress&&!rv(i,t.accounts)?{...t,inProgress:s,accounts:i}:s!==t.inProgress?{...t,inProgress:s}:rv(i,t.accounts)?t:{...t,accounts:i}};function Vk({instance:t,children:e}){Y.useEffect(()=>{t.initializeWrapperLibrary(x2.React,nv)},[t]);const r=Y.useMemo(()=>t.getLogger().clone(Gk,nv),[t]),[n,s]=Y.useReducer(Wk,void 0,()=>({inProgress:Tt.Startup,accounts:t.getAllAccounts()}));Y.useEffect(()=>{const a=t.addEventCallback(o=>{s({payload:{instance:t,logger:r,message:o},type:pu.EVENT})});return r.verbose(`MsalProvider - Registered event callback with id: ${a}`),t.initialize().then(()=>{t.handleRedirectPromise().catch(()=>{}).finally(()=>{s({payload:{instance:t,logger:r},type:pu.UNBLOCK_INPROGRESS})})}).catch(()=>{}),()=>{a&&(r.verbose(`MsalProvider - Removing event callback ${a}`),t.removeEventCallback(a))}},[t,r]);const i={instance:t,inProgress:n.inProgress,accounts:n.accounts,logger:r};return sC.createElement(kp.Provider,{value:i},e)}/*! @azure/msal-react v2.2.0 2024-11-05 */const Ip=()=>Y.useContext(kp);/*! @azure/msal-react v2.2.0 2024-11-05 */function qk(t,e){return t.length>0}function Yk(t){const{accounts:e,inProgress:r}=Ip();return Y.useMemo(()=>r===Tt.Startup?!1:qk(e),[e,r,t])}const Qk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>hn(async()=>{const{default:n}=await Promise.resolve().then(()=>Wa);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class Np extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class Xk extends Np{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sv extends Np{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class iv extends Np{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Rf;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Rf||(Rf={}));var Jk=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class Zk{constructor(e,{headers:r={},customFetch:n,region:s=Rf.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=Qk(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return Jk(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=r;let o={},{region:l}=r;l||(l=this.region);const u=new URL(`${this.url}/${e}`);l&&l!=="any"&&(o["x-region"]=l,u.searchParams.set("forceFunctionRegion",l));let d;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(o["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(o["Content-Type"]="application/json",d=JSON.stringify(a)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:d}).catch(m=>{throw new Xk(m)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new sv(h);if(!h.ok)throw new iv(h);let p=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return p==="application/json"?g=yield h.json():p==="application/octet-stream"?g=yield h.blob():p==="text/event-stream"?g=h:p==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof iv||s instanceof sv?s.context:void 0}}})}}var vr={},Rp={},od={},El={},ld={},cd={},eI=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fa=eI();const tI=Fa.fetch,p_=Fa.fetch.bind(Fa),m_=Fa.Headers,rI=Fa.Request,nI=Fa.Response,Wa=Object.freeze(Object.defineProperty({__proto__:null,Headers:m_,Request:rI,Response:nI,default:p_,fetch:tI},Symbol.toStringTag,{value:"Module"})),sI=zT(Wa);var ud={};Object.defineProperty(ud,"__esModule",{value:!0});let iI=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ud.default=iI;var g_=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cd,"__esModule",{value:!0});const aI=g_(sI),oI=g_(ud);let lI=class{constructor(e){var r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=aI.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l,u;let d=null,h=null,f=null,p=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?h=y:h=JSON.parse(y))}const w=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");w&&v&&v.length>1&&(f=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,p=406,g="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const w=await i.text();try{d=JSON.parse(w),Array.isArray(d)&&i.status===404&&(h=[],d=null,p=200,g="OK")}catch{i.status===404&&w===""?(p=204,g="No Content"):d={message:w}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,p=200,g="OK"),d&&this.shouldThrowOnError)throw new oI.default(d)}return{error:d,data:h,count:f,status:p,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,r)}returns(){return this}overrideTypes(){return this}};cd.default=lI;var cI=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ld,"__esModule",{value:!0});const uI=cI(cd);let dI=class extends uI.default{select(e){let r=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${u}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};ld.default=dI;var hI=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(El,"__esModule",{value:!0});const fI=hI(ld);let pI=class extends fI.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${a}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};El.default=pI;var mI=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(od,"__esModule",{value:!0});const co=mI(El);let gI=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(e,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),n&&this.headers.append("Prefer",`count=${n}`),new co.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:n=!0}={}){var s;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new co.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:i=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new co.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new co.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var r;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new co.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};od.default=gI;var v_=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Rp,"__esModule",{value:!0});const vI=v_(od),xI=v_(El);let yI=class x_{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new vI.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new x_(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let u;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{l.searchParams.append(h,f)})):(o="POST",u=r);const d=new Headers(this.headers);return i&&d.set("Prefer",`count=${i}`),new xI.default({method:o,url:l,headers:d,schema:this.schemaName,body:u,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};Rp.default=yI;var Va=Xr&&Xr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vr,"__esModule",{value:!0});vr.PostgrestError=vr.PostgrestBuilder=vr.PostgrestTransformBuilder=vr.PostgrestFilterBuilder=vr.PostgrestQueryBuilder=vr.PostgrestClient=void 0;const y_=Va(Rp);vr.PostgrestClient=y_.default;const w_=Va(od);vr.PostgrestQueryBuilder=w_.default;const __=Va(El);vr.PostgrestFilterBuilder=__.default;const E_=Va(ld);vr.PostgrestTransformBuilder=E_.default;const T_=Va(cd);vr.PostgrestBuilder=T_.default;const C_=Va(ud);vr.PostgrestError=C_.default;var wI=vr.default={PostgrestClient:y_.default,PostgrestQueryBuilder:w_.default,PostgrestFilterBuilder:__.default,PostgrestTransformBuilder:E_.default,PostgrestBuilder:T_.default,PostgrestError:C_.default};const{PostgrestClient:_I,PostgrestQueryBuilder:WD,PostgrestFilterBuilder:VD,PostgrestTransformBuilder:qD,PostgrestBuilder:YD,PostgrestError:QD}=wI;class EI{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const TI="2.15.5",CI=`realtime-js/${TI}`,SI="1.0.0",Of=1e4,AI=1e3,bI=100;var Ro;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ro||(Ro={}));var bt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(bt||(bt={}));var un;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(un||(un={}));var Pf;(function(t){t.websocket="websocket"})(Pf||(Pf={}));var ei;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ei||(ei={}));class kI{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),i=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+s));a=a+s;const l=n.decode(e.slice(a,a+i));a=a+i;const u=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:u}}}class S_{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var et;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(et||(et={}));const av=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((i,a)=>(i[a]=II(a,t,e,s),i),{})},II=(t,e,r,n)=>{const s=e.find(o=>o.name===t),i=s==null?void 0:s.type,a=r[t];return i&&!n.includes(i)?A_(i,a):Lf(a)},A_=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return PI(e,r)}switch(t){case et.bool:return NI(e);case et.float4:case et.float8:case et.int2:case et.int4:case et.int8:case et.numeric:case et.oid:return RI(e);case et.json:case et.jsonb:return OI(e);case et.timestamp:return LI(e);case et.abstime:case et.date:case et.daterange:case et.int4range:case et.int8range:case et.money:case et.reltime:case et.text:case et.time:case et.timestamptz:case et.timetz:case et.tsrange:case et.tstzrange:return Lf(e);default:return Lf(e)}},Lf=t=>t,NI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},RI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},OI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},PI=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let i;const a=t.slice(1,r);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>A_(e,o))}return t},LI=t=>typeof t=="string"?t.replace(" ","T"):t,b_=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class nh{constructor(e,r,n={},s=Of){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ov;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ov||(ov={}));class Oo{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Oo.syncState(this.state,s,i,a),this.pendingDiffs.forEach(l=>{this.state=Oo.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Oo.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const i=this.cloneDeep(e),a=this.transformState(r),o={},l={};return this.map(i,(u,d)=>{a[u]||(l[u]=d)}),this.map(a,(u,d)=>{const h=i[u];if(h){const f=d.map(w=>w.presence_ref),p=h.map(w=>w.presence_ref),g=d.filter(w=>p.indexOf(w.presence_ref)<0),m=h.filter(w=>f.indexOf(w.presence_ref)<0);g.length>0&&(o[u]=g),m.length>0&&(l[u]=m)}else o[u]=d}),this.syncDiff(i,{joins:o,leaves:l},n,s)}static syncDiff(e,r,n,s){const{joins:i,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(i,(o,l)=>{var u;const d=(u=e[o])!==null&&u!==void 0?u:[];if(e[o]=this.cloneDeep(l),d.length>0){const h=e[o].map(p=>p.presence_ref),f=d.filter(p=>h.indexOf(p.presence_ref)<0);e[o].unshift(...f)}n(o,d,l)}),this.map(a,(o,l)=>{let u=e[o];if(!u)return;const d=l.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),e[o]=u,s(o,u,l),u.length===0&&delete e[o]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var lv;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(lv||(lv={}));var Po;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Po||(Po={}));var Kn;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Kn||(Kn={}));class Op{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new nh(this,un.join,this.params,this.timeout),this.rejoinTimer=new S_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(un.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Oo(this),this.broadcastEndpointURL=b_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==bt.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Po.PRESENCE]&&this.bindings[Po.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(Kn.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(Kn.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e==null||e(Kn.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,w=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,v=[];for(let y=0;y<w;y++){const x=m[y],{filter:{event:_,schema:P,table:S,filter:T}}=x,O=p&&p[y];if(O&&O.event===_&&O.schema===P&&O.table===S&&O.filter===T)v.push(Object.assign(Object.assign({},x),{id:O.id}));else{this.unsubscribe(),this.state=bt.errored,e==null||e(Kn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(Kn.SUBSCRIBED);return}}).receive("error",p=>{this.state=bt.errored,e==null||e(Kn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Kn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===bt.joined&&e===Po.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=bt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(un.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new nh(this,un.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=bt.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,i=setTimeout(()=>s.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),a}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new nh(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>bI){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:u,join:d}=un;if(n&&[o,l,u,d].indexOf(a)>=0&&n!==this._joinRef())return;let f=this._onMessage(a,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,m,w;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((w=(m=p.filter)===null||m===void 0?void 0:m.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(p=>p.callback(f,n)):(i=this.bindings[a])===null||i===void 0||i.filter(p=>{var g,m,w,v,y,x;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const _=p.id,P=(g=p.filter)===null||g===void 0?void 0:g.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((w=r.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const _=(y=(v=p==null?void 0:p.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return _==="*"||_===((x=r==null?void 0:r.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:m,table:w,commit_timestamp:v,type:y,errors:x}=g;f=Object.assign(Object.assign({},{schema:m,table:w,commit_timestamp:v,eventType:y,new:{},old:{},errors:x}),this._getPayloadRecords(g))}p.callback(f,n)})}_isClosed(){return this.state===bt.closed}_isJoined(){return this.state===bt.joined}_isJoining(){return this.state===bt.joining}_isLeaving(){return this.state===bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),i={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Op.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(un.close,{},e)}_onError(e){this._on(un.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=av(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=av(e.columns,e.old_record)),r}}const sh=()=>{},oc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},jI=[1e3,2e3,5e3,1e4],MI=1e4,DI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class FI{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Of,this.transport=null,this.heartbeatIntervalMs=oc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sh,this.ref=0,this.reconnectTimer=null,this.logger=sh,this.conn=null,this.sendBuffer=[],this.serializer=new kI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>hn(async()=>{const{default:o}=await Promise.resolve().then(()=>Wa);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Pf.websocket}`,this.httpEndpoint=b_(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=EI.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:SI}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ro.connecting:return ei.Connecting;case Ro.open:return ei.Open;case Ro.closing:return ei.Closing;default:return ei.Closed}}isConnected(){return this.connectionState()===ei.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===n);if(s)return s;{const i=new Op(`realtime:${e}`,r,this);return this.channels.push(i),i}}push(e){const{topic:r,event:n,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(AI,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},oc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:i,ref:a}=r,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${s} ${o}`.trim(),i),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,i,a)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(un.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([DI],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:CI};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(un.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new S_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},oc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,i,a,o,l,u,d;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Of,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:oc.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:sh,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:h=>jI[h-1]||MI,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(h,f)=>f(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Pp extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function It(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class UI extends Pp{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class jf extends Pp{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var BI=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const k_=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>hn(async()=>{const{default:n}=await Promise.resolve().then(()=>Wa);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},HI=()=>BI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield hn(()=>Promise.resolve().then(()=>Wa),void 0)).Response:Response}),Mf=t=>{if(Array.isArray(t))return t.map(r=>Mf(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Mf(n)}),e},zI=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var ki=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const ih=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$I=(t,e,r)=>ki(void 0,void 0,void 0,function*(){const n=yield HI();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const i=t.status||500,a=(s==null?void 0:s.statusCode)||i+"";e(new UI(ih(s),i,a))}).catch(s=>{e(new jf(ih(s),s))}):e(new jf(ih(t),t))}),KI=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(zI(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function Tl(t,e,r,n,s,i){return ki(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(r,KI(e,n,s,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>$I(l,o,n))})})}function mu(t,e,r,n){return ki(this,void 0,void 0,function*(){return Tl(t,"GET",e,r,n)})}function kn(t,e,r,n,s){return ki(this,void 0,void 0,function*(){return Tl(t,"POST",e,n,s,r)})}function Df(t,e,r,n,s){return ki(this,void 0,void 0,function*(){return Tl(t,"PUT",e,n,s,r)})}function GI(t,e,r,n){return ki(this,void 0,void 0,function*(){return Tl(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function I_(t,e,r,n,s){return ki(this,void 0,void 0,function*(){return Tl(t,"DELETE",e,n,s,r)})}var or=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const WI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class VI{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=k_(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return or(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},cv),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),h=yield(e=="PUT"?Df:kn)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(It(i))return{data:null,error:i};throw i}})}upload(e,r,n){return or(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return or(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const u=Object.assign({upsert:cv.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",u.cacheControl)):(l=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield Df(this.fetch,o.toString(),l,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,r){return or(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield kn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new Pp("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}update(e,r,n){return or(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return or(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}})}copy(e,r,n){return or(this,void 0,void 0,function*(){try{return{data:{path:(yield kn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return or(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield kn(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return or(this,void 0,void 0,function*(){try{const s=yield kn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}})}download(e,r){return or(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield mu(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(It(o))return{data:null,error:o};throw o}})}info(e){return or(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield mu(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Mf(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}exists(e){return or(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield GI(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n)&&n instanceof jf){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(e){return or(this,void 0,void 0,function*(){try{return{data:yield I_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}list(e,r,n){return or(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},WI),r),{prefix:e||""});return{data:yield kn(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(It(s))return{data:null,error:s};throw s}})}listV2(e,r){return or(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield kn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const qI="2.12.1",YI={"X-Client-Info":`storage-js/${qI}`};var Fi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class QI{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const i=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},YI),r),this.fetch=k_(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Fi(this,void 0,void 0,function*(){try{return{data:yield mu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}})}getBucket(e){return Fi(this,void 0,void 0,function*(){try{return{data:yield mu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Fi(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Fi(this,void 0,void 0,function*(){try{return{data:yield Df(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(It(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Fi(this,void 0,void 0,function*(){try{return{data:yield kn(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Fi(this,void 0,void 0,function*(){try{return{data:yield I_(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}}class XI extends QI{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new VI(this.url,this.headers,e,this.fetch)}}const JI="2.57.4";let vo="";typeof Deno<"u"?vo="deno":typeof document<"u"?vo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?vo="react-native":vo="node";const ZI={"X-Client-Info":`supabase-js-${vo}/${JI}`},eN={headers:ZI},tN={schema:"public"},rN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nN={};var sN=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};const iN=t=>{let e;return t?e=t:typeof fetch>"u"?e=p_:e=fetch,(...r)=>e(...r)},aN=()=>typeof Headers>"u"?m_:Headers,oN=(t,e,r)=>{const n=iN(r),s=aN();return(i,a)=>sN(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:t;let u=new s(a==null?void 0:a.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},a),{headers:u}))})};var lN=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};function cN(t){return t.endsWith("/")?t:t+"/"}function uN(t,e){var r,n;const{db:s,auth:i,realtime:a,global:o}=t,{db:l,auth:u,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),a),storage:{},global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>lN(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function dN(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(cN(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const N_="2.71.1",Yi=30*1e3,Ff=3,ah=Ff*Yi,hN="http://localhost:9999",fN="supabase.auth.token",pN={"X-Client-Info":`gotrue-js/${N_}`},Uf="X-Supabase-Api-Version",R_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},mN=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,gN=10*60*1e3;class Lp extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Oe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class vN extends Lp{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function xN(t){return Oe(t)&&t.name==="AuthApiError"}class O_ extends Lp{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Gs extends Lp{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class gs extends Gs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function yN(t){return Oe(t)&&t.name==="AuthSessionMissingError"}class lc extends Gs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cc extends Gs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class uc extends Gs{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wN(t){return Oe(t)&&t.name==="AuthImplicitGrantRedirectError"}class uv extends Gs{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bf extends Gs{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function oh(t){return Oe(t)&&t.name==="AuthRetryableFetchError"}class dv extends Gs{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hf extends Gs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const gu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hv=` 	
\r=`.split(""),_N=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<hv.length;e+=1)t[hv[e].charCodeAt(0)]=-2;for(let e=0;e<gu.length;e+=1)t[gu[e].charCodeAt(0)]=e;return t})();function fv(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(gu[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(gu[n]),e.queuedBits-=6}}function P_(t,e,r){const n=_N[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function pv(t){const e=[],r=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=a=>{CN(a,n,r)};for(let a=0;a<t.length;a+=1)P_(t.charCodeAt(a),s,i);return e.join("")}function EN(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function TN(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}EN(n,e)}}function CN(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function SN(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)P_(t.charCodeAt(s),r,n);return new Uint8Array(e)}function AN(t){const e=[];return TN(t,r=>e.push(r)),new Uint8Array(e)}function bN(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>fv(s,r,n)),fv(null,r,n),e.join("")}function kN(t){return Math.round(Date.now()/1e3)+t}function IN(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const an=()=>typeof window<"u"&&typeof document<"u",Ys={tested:!1,writable:!1},L_=()=>{if(!an())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ys.tested)return Ys.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ys.tested=!0,Ys.writable=!0}catch{Ys.tested=!0,Ys.writable=!1}return Ys.writable};function NN(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const j_=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>hn(async()=>{const{default:n}=await Promise.resolve().then(()=>Wa);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},RN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Qi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Qs=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},fs=async(t,e)=>{await t.removeItem(e)};class dd{constructor(){this.promise=new dd.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}dd.promiseConstructor=Promise;function lh(t){const e=t.split(".");if(e.length!==3)throw new Hf("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!mN.test(e[n]))throw new Hf("JWT not in base64url format");return{header:JSON.parse(pv(e[0])),payload:JSON.parse(pv(e[1])),signature:SN(e[2]),raw:{header:e[0],payload:e[1]}}}async function ON(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function PN(t,e){return new Promise((n,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function LN(t){return("0"+t.toString(16)).substr(-2)}function jN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,LN).join("")}async function MN(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function DN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await MN(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ui(t,e,r=!1){const n=jN();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Qi(t,`${e}-code-verifier`,s);const i=await DN(n);return[i,n===i?"plain":"s256"]}const FN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function UN(t){const e=t.headers.get(Uf);if(!e||!e.match(FN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function BN(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function HN(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const zN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bi(t){if(!zN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ch(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function mv(t){return JSON.parse(JSON.stringify(t))}var $N=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const Zs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),KN=[502,503,504];async function gv(t){var e;if(!RN(t))throw new Bf(Zs(t),0);if(KN.includes(t.status))throw new Bf(Zs(t),t.status);let r;try{r=await t.json()}catch(i){throw new O_(Zs(i),i)}let n;const s=UN(t);if(s&&s.getTime()>=R_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new dv(Zs(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new gs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new dv(Zs(r),t.status,r.weak_password.reasons);throw new vN(Zs(r),t.status||500,n)}const GN=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Me(t,e,r,n){var s;const i=Object.assign({},n==null?void 0:n.headers);i[Uf]||(i[Uf]=R_["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await WN(t,e,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function WN(t,e,r,n,s,i){const a=GN(e,n,s,i);let o;try{o=await t(r,Object.assign({},a))}catch(l){throw console.error(l),new Bf(Zs(l),0)}if(o.ok||await gv(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await gv(l)}}function Hn(t){var e;let r=null;QN(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=kN(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function vv(t){const e=Hn(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function _s(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function VN(t){return{data:t,error:null}}function qN(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i}=t,a=$N(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function YN(t){return t}function QN(t){return t.access_token&&t.refresh_token&&t.expires_in}const uh=["global","local","others"];var XN=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class JN{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=j_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=uh[0]){if(uh.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${uh.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:_s})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=XN(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:qN,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Oe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_s})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,i,a,o,l;try{const u={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:YN});if(d.error)throw d.error;const h=await d.json(),f=(a=d.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(g.split(";")[1].split("=")[1]);u[`${w}Page`]=m}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Oe(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Bi(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_s})}catch(r){if(Oe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Bi(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:_s})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Bi(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:_s})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Bi(e.userId);try{const{data:r,error:n}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Bi(e.userId),Bi(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}}function xv(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function ZN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Hi={debug:!!(globalThis&&L_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class M_ extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eR extends M_{}async function tR(t,e,r){Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new eR(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Hi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}ZN();const rR={url:hN,storageKey:fN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:pN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function yv(t,e,r){return await r()}const zi={};class il{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=il.nextInstanceID,il.nextInstanceID+=1,this.instanceID>0&&an()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},rR),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new JN({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=j_(s.fetch),this.lock=s.lock||yv,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:an()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=tR:this.lock=yv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:L_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=xv(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=xv(this.memoryStorage)),an()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=zi[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){zi[this.storageKey]=Object.assign(Object.assign({},zi[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=zi[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){zi[this.storageKey]=Object.assign(Object.assign({},zi[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${N_}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=NN(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),an()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),wN(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Oe(r)?{error:r}:{error:new O_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const i=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:Hn}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(Oe(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var r,n,s;try{let i;if("email"in e){const{email:d,password:h,options:f}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Ui(this.storage,this.storageKey)),i=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:Hn})}else if("phone"in e){const{phone:d,password:h,options:f}=e;i=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Hn})}else throw new cc("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,u=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(i){if(Oe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let r;if("email"in e){const{email:i,password:a,options:o}=e;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vv})}else if("phone"in e){const{phone:i,password:a,options:o}=e;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:vv})}else throw new cc("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new lc}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Oe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,i,a,o,l,u,d,h,f,p;let g,m;if("message"in e)g=e.message,m=e.signature;else{const{chain:w,wallet:v,statement:y,options:x}=e;let _;if(an())if(typeof v=="object")_=v;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))_=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=v}const P=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const S=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),y?{statement:y}:null));let T;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")T=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)T=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${P.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(s=(n=x==null?void 0:x.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=x==null?void 0:x.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((u=x==null?void 0:x.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((h=(d=x==null?void 0:x.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...x.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const S=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=S}}try{const{data:w,error:v}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:bN(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Hn});if(v)throw v;return!w||!w.session||!w.user?{data:{user:null,session:null},error:new lc}:(w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),{data:Object.assign({},w),error:v})}catch(w){if(Oe(w))return{data:{user:null,session:null},error:w};throw w}}async _exchangeCodeForSession(e){const r=await Qs(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:i,error:a}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Hn});if(await fs(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new lc}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(Oe(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:i,nonce:a}=e,o=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Hn}),{data:l,error:u}=o;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new lc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(r){if(Oe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,i,a;try{if("email"in e){const{email:o,options:l}=e;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Ui(this.storage,this.storageKey));const{error:h}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:u,error:d}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new cc("You must provide either an email or phone number.")}catch(o){if(Oe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var r,n;try{let s,i;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:Hn});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,u=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(Oe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Ui(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:VN})}catch(i){if(Oe(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new gs;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Oe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:i}=e,{error:a}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:s,options:i}=e,{data:a,error:o}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new cc("You must provide either an email or phone number and a type")}catch(r){if(Oe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Qs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<ah:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await Qs(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=ch()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,u,d)=>(!a&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,u,d))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_s}):await this._useSession(async r=>{var n,s,i;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gs}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:_s})})}catch(r){if(Oe(r))return yN(r)&&(await this._removeSession(),await fs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:i}=n;if(i)throw i;if(!s.session)throw new gs;const a=s.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Ui(this.storage,this.storageKey));const{data:u,error:d}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:_s});if(d)throw d;return a.user=u.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new gs;const r=Date.now()/1e3;let n=r,s=!0,i=null;const{payload:a}=lh(e.access_token);if(a.exp&&(n=a.exp,s=n<=r),s){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Oe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:a,error:o}=r;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new gs;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Oe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!an())throw new uc("No browser detected.");if(e.error||e.error_description||e.error_code)throw new uc(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new uv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new uc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new uv("No code detected.");const{data:y,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:u}=e;if(!i||!o||!a||!u)throw new uc("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(o);let f=d+h;l&&(f=parseInt(l));const p=f-d;p*1e3<=Yi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=f-h;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:m,error:w}=await this._getUser(i);if(w)throw w;const v={provider_token:n,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:a,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(n){if(Oe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Qs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{error:i};const a=(n=s.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(xN(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await fs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=IN(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:i},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Ui(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Oe(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async i=>{var a,o,l,u,d;const{data:h,error:f}=i;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return an()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Oe(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)throw a;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await PN(async s=>(s>0&&await ON(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Hn})),(s,i)=>{const a=200*Math.pow(2,s);return i&&oh(i)&&Date.now()+a-n<Yi})}catch(n){if(this._debug(r,"error",n),Oe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),an()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Qs(this.storage,this.storageKey);if(s&&this.userStorage){let a=await Qs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:s.user},await Qi(this.userStorage,this.storageKey+"-user",a)),s.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:ch()}else if(s&&!s.user&&!s.user){const a=await Qs(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(s.user=a.user,await fs(this.storage,this.storageKey+"-user"),await Qi(this.storage,this.storageKey,s)):s.user=ch()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ah;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${ah}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),oh(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(s.access_token);!o&&(a!=null&&a.user)?(s.user=a.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new dd;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new gs;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),Oe(i)){const a={session:null,error:i};return oh(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,r)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Qi(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=mv(s);await Qi(this.storage,this.storageKey,i)}else{const s=mv(r);await Qi(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await fs(this.storage,this.storageKey),await fs(this.storage,this.storageKey+"-code-verifier"),await fs(this.storage,this.storageKey+"-user"),this.userStorage&&await fs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&an()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Yi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/Yi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Yi}ms, refresh threshold is ${Ff} ticks`),s<=Ff&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof M_)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!an()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ui(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);s.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:i,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:u}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:a,error:o}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:i}=r;return i?{data:null,error:i}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Oe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],s=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=lh(s.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(o=>o.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+gN>s)return n;const{data:i,error:a}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,n=i.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:i,signature:a,raw:{header:o,payload:l}}=lh(n);r!=null&&r.allowExpired||BN(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:i,header:s,signature:a},error:null}}const d=HN(s.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,a,AN(`${o}.${l}`)))throw new Hf("Invalid JWT signature");return{data:{claims:i,header:s,signature:a},error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}}il.nextInstanceID=0;const nR=il;class sR extends nR{constructor(e){super(e)}}var iR=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function o(d){try{u(n.next(d))}catch(h){a(h)}}function l(d){try{u(n.throw(d))}catch(h){a(h)}}function u(d){d.done?i(d.value):s(d.value).then(o,l)}u((n=n.apply(t,e||[])).next())})};class aR{constructor(e,r,n){var s,i,a;this.supabaseUrl=e,this.supabaseKey=r;const o=dN(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:tN,realtime:nN,auth:Object.assign(Object.assign({},rN),{storageKey:l}),global:eN},d=uN(n??{},u);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=d.global.headers)!==null&&i!==void 0?i:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=oN(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new _I(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new XI(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Zk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return iR(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,storageKey:a,flowType:o,lock:l,debug:u},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sR({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:a,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:i,flowType:o,lock:l,debug:u,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new FI(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const D_=(t,e,r)=>new aR(t,e,r);function oR(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}oR()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let Ua=null;function ui(){return{url:"https://owvcdjfcsuzbflwmrazq.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im93dmNkamZjc3V6YmZsd21yYXpxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA1MDIwMjksImV4cCI6MjA3NjA3ODAyOX0.SJ5PluM-HuKTqp8hJeneDW99EQGdlNuFh402XFYljro"}}function F_(t,e){return localStorage.setItem("supabase_config",JSON.stringify({url:t,anonKey:e})),Ua=D_(t,e,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Ua}function qr(){if(Ua)return Ua;const t=ui();if(!t)throw new Error("Supabase not configured. Please complete setup first.");return F_(t.url,t.anonKey)}const dh=ui();dh&&(Ua=D_(dh.url,dh.anonKey,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}));const U_=Ua;let vu=null;async function lR(){try{const t=qr(),{data:e,error:r}=await t.from("system_config").select("azure_client_id, azure_tenant_id, azure_redirect_uri, azure_enabled").maybeSingle();if(r)throw r;if(e&&e.azure_enabled&&e.azure_client_id&&e.azure_tenant_id){const n={clientId:e.azure_client_id,tenantId:e.azure_tenant_id,redirectUri:e.azure_redirect_uri||window.location.origin,enabled:e.azure_enabled};return vu=n,n}return null}catch(t){return console.error("Error loading Azure config from database:",t),null}}function hd(){if(vu)return vu;const t=localStorage.getItem("azureConfig");return t?JSON.parse(t):null}function wv(t){vu=t,localStorage.setItem("azureConfig",JSON.stringify(t))}function cR(){const t=hd();return{auth:{clientId:(t==null?void 0:t.clientId)||"",authority:`https://login.microsoftonline.com/${(t==null?void 0:t.tenantId)||"common"}`,redirectUri:(t==null?void 0:t.redirectUri)||window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:(e,r,n)=>{if(!n)switch(e){case Ye.Error:console.error(r);return;case Ye.Info:console.info(r);return;case Ye.Verbose:console.debug(r);return;case Ye.Warning:console.warn(r);return}}}}}}const uR={scopes:["User.Read","email","profile","openid"]};class lt{constructor(){this.adapter=null,this.config=null}static getInstance(){return lt.instance||(lt.instance=new lt),lt.instance}async initialize(e){this.config=e;const{type:r}=e;switch(r){case"supabase":const{SupabaseAdapter:n}=await hn(async()=>{const{SupabaseAdapter:u}=await import("./SupabaseAdapter-nbl8rplV.js");return{SupabaseAdapter:u}},[]);this.adapter=new n;break;case"firebase":const{FirebaseAdapter:s}=await hn(async()=>{const{FirebaseAdapter:u}=await import("./FirebaseAdapter-DkXeuD_Q.js");return{FirebaseAdapter:u}},[]);this.adapter=new s;break;case"mysql":case"postgresql":case"azure-mysql":case"azure-postgresql":const{MySQLAdapter:i}=await hn(async()=>{const{MySQLAdapter:u}=await import("./MySQLAdapter-BwD9y-fM.js");return{MySQLAdapter:u}},[]);this.adapter=new i;break;case"azure-sql":const{AzureSQLAdapter:a}=await hn(async()=>{const{AzureSQLAdapter:u}=await import("./AzureSQLAdapter-DY5Cp2jO.js");return{AzureSQLAdapter:u}},[]);this.adapter=new a;break;case"azure-cosmos":const{AzureCosmosAdapter:o}=await hn(async()=>{const{AzureCosmosAdapter:u}=await import("./AzureCosmosAdapter-DTgjON3W.js");return{AzureCosmosAdapter:u}},[]);this.adapter=new o;break;case"sqlite":const{SQLiteAdapter:l}=await hn(async()=>{const{SQLiteAdapter:u}=await import("./SQLiteAdapter-Dr8ARAbV.js");return{SQLiteAdapter:u}},[]);this.adapter=new l;break;default:throw new Error(`Unsupported database type: ${r}`)}await this.adapter.initialize(e.config),localStorage.setItem("db_config",JSON.stringify(e))}getAdapter(){if(!this.adapter)throw new Error("Database not initialized. Call initialize() first.");return this.adapter}getConfig(){return this.config}async loadFromStorage(){const e=localStorage.getItem("db_config");if(e)try{const r=JSON.parse(e);return await this.initialize(r),!0}catch(r){console.error("Failed to load database config from storage:",r),localStorage.removeItem("db_config")}return!1}isInitialized(){return this.adapter!==null}async testConnection(){try{if(!this.adapter)return!1;try{return await this.adapter.users.count(),!0}catch(e){if(e.message==="Not implemented")try{return await this.adapter.users.getAll(),!0}catch(r){return r.message==="Not implemented"}return!1}}catch{return!1}}clearConfig(){this.adapter=null,this.config=null,localStorage.removeItem("db_config")}}lt.getInstance();const B_=Y.createContext(void 0);function dR({children:t}){const{instance:e,accounts:r,inProgress:n}=Ip(),s=Yk(),[i,a]=Y.useState(null),[o,l]=Y.useState(null),[u,d]=Y.useState(null),[h,f]=Y.useState(!0),p=r[0]||null,g=async S=>{try{const T=lt.getInstance(),O=T.getConfig();if((O==null?void 0:O.type)==="supabase"){const L=qr(),{data:j,error:G}=await L.from("user_profiles").select("*").eq("id",S).maybeSingle();if(G)throw G;l(j)}else if(T.isInitialized()){const j=await T.getAdapter().users.getById(S);j&&l({id:j.id,net_id:j.netId,full_name:j.fullName,email:j.email,role:j.role,temporary_password:j.temporaryPassword||!1,active:j.active})}}catch(T){console.error("Error fetching profile:",T),l(null)}};Y.useEffect(()=>{(async()=>{try{const T=lt.getInstance();if(!await T.loadFromStorage()&&!ui()){f(!1);return}const L=T.getConfig();if((L==null?void 0:L.type)==="supabase"){const j=qr();j.auth.getSession().then(({data:{session:W}})=>{d(W),a((W==null?void 0:W.user)??null),W!=null&&W.user&&g(W.user.id),f(!1)});const{data:{subscription:G}}=j.auth.onAuthStateChange((W,re)=>{(async()=>(d(re),a((re==null?void 0:re.user)??null),re!=null&&re.user?await g(re.user.id):l(null),f(!1)))()});return()=>G.unsubscribe()}else f(!1)}catch(T){console.error("Error initializing auth:",T),f(!1)}})()},[]),Y.useEffect(()=>{n===Tt.None&&s&&p&&m()},[s,p,n]);const m=async()=>{if(p)try{if(!ui())return;const T=qr(),{data:O}=await T.from("user_profiles").select("*").eq("email",p.username).maybeSingle();O&&l(O)}catch(S){console.error("Error syncing Azure user:",S)}},P={user:i,profile:o,session:u,loading:h,azureUser:p,isAzureAuthenticated:s,signIn:async(S,T)=>{try{const O=lt.getInstance(),L=O.getConfig();if(!L)return{error:new Error("Database not configured")};if(L.type==="supabase"){const j=ui();if(!j)return{error:new Error("Supabase not configured")};const G=`${j.url}/functions/v1/login`,W=await fetch(G,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${j.anonKey}`},body:JSON.stringify({netId:S,password:T})}),re=await W.json();if(!W.ok)return{error:new Error(re.error||"Login failed")};const te=qr(),{error:me}=await te.auth.setSession({access_token:re.session.access_token,refresh_token:re.session.refresh_token});if(me)return{error:me}}else{const G=await O.getAdapter().auth.signIn(S,T);if(!G.user)return{error:new Error("Invalid credentials")};const W={id:G.user.id,email:G.user.email||"",created_at:G.user.createdAt||new Date().toISOString(),app_metadata:{},user_metadata:{},aud:"authenticated"};a(W),await g(G.user.id),f(!1)}return{error:null}}catch(O){return{error:O}}},signInWithAzure:async()=>{try{await e.loginPopup(uR)}catch(S){throw console.error("Azure login failed:",S),S}},signOut:async()=>{s&&await e.logoutPopup();const S=lt.getInstance(),T=S.getConfig();(T==null?void 0:T.type)==="supabase"?await qr().auth.signOut():S.isInitialized()&&await S.getAdapter().auth.signOut(),a(null),l(null),d(null)},updatePassword:async S=>{try{const T=lt.getInstance(),O=T.getConfig();if((O==null?void 0:O.type)==="supabase"){const L=qr(),{error:j}=await L.auth.updateUser({password:S});if(j)return{error:j};o!=null&&o.temporary_password&&(await L.from("user_profiles").update({temporary_password:!1}).eq("id",i.id),await g(i.id))}else if(T.isInitialized()&&i){const L=T.getAdapter();await L.auth.updatePassword(i.id,S),o!=null&&o.temporary_password&&(await L.users.update(i.id,{temporaryPassword:!1}),await g(i.id))}return{error:null}}catch(T){return{error:T}}},refreshProfile:async()=>{i&&await g(i.id)}};return c.jsx(B_.Provider,{value:P,children:t})}function en(){const t=Y.useContext(B_);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Pe=(t,e)=>{const r=Y.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:l,...u},d)=>Y.createElement("svg",{ref:d,...hR,width:s,height:s,stroke:n,strokeWidth:a?Number(i)*24/Number(s):i,className:["lucide",`lucide-${fR(t)}`,o].join(" "),...u},[...e.map(([h,f])=>Y.createElement(h,f)),...Array.isArray(l)?l:[l]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=Pe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=Pe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=Pe("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=Pe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fd=Pe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Pe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=Pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=Pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=Pe("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=Pe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=Pe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=Pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=Pe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=Pe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=Pe("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=Pe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=Pe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Pe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=Pe("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=Pe("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=Pe("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=Pe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=Pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=Pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dp=Pe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=Pe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Pe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=Pe("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=Pe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=Pe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=Pe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ii=Pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=Pe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=Pe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=Pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=Pe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=Pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=Pe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=Pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=Pe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=Pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function NR({databaseType:t}){const[e,r]=Y.useState(!1),[n,s]=Y.useState(!1),a=(()=>{switch(t){case"firebase":return{title:"Firebase Realtime Database Rules",description:"Apply SETUP rules first, then switch to PRODUCTION rules after creating admin user.",language:"json",setupCode:`{
  "rules": {
    ".read": true,
    ".write": true
  }
}`,code:String.raw`{
  "rules": {
    "users": {
      ".indexOn": "netId",
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "campuses": {
      ".indexOn": ["code", "name"],
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "buildings": {
      ".indexOn": ["campusId", "code"],
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "key_systems": {
      ".indexOn": "name",
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "keys": {
      ".indexOn": ["keySystemId", "buildingId", "keyCode"],
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "key_history": {
      ".indexOn": ["keyId", "userId", "status"],
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "audit_logs": {
      ".indexOn": ["userId", "timestamp", "action"],
      ".read": "auth != null",
      ".write": "auth != null"
    },
    "system_config": {
      ".read": "auth != null",
      ".write": "auth != null"
    }
  }
}`,instructions:["Go to Firebase Console  Realtime Database",'Click on "Rules" tab',"Copy and paste SETUP RULES first (completely open)",'Click "Publish" button',"Complete the setup wizard and create your admin user","Return to Rules tab and replace with PRODUCTION RULES (includes .indexOn for performance)",'Click "Publish" again',"The .indexOn properties optimize query performance and eliminate console warnings","NOTE: These rules are simplified. After confirming they work, you can add role-based security in Firebase Console"]};case"supabase":return{title:"Supabase Row Level Security (RLS) Policies",description:"Enable RLS on all tables and create policies for role-based access control.",language:"sql",code:`-- Enable RLS on all tables
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE campuses ENABLE ROW LEVEL SECURITY;
ALTER TABLE buildings ENABLE ROW LEVEL SECURITY;
ALTER TABLE key_systems ENABLE ROW LEVEL SECURITY;
ALTER TABLE keys ENABLE ROW LEVEL SECURITY;
ALTER TABLE key_history ENABLE ROW LEVEL SECURITY;
ALTER TABLE audit_logs ENABLE ROW LEVEL SECURITY;

-- Users table policies
CREATE POLICY "Users can view all users"
  ON users FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Only super_admin can create users"
  ON users FOR INSERT
  TO authenticated
  WITH CHECK (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role = 'super_administrator'
    )
  );

CREATE POLICY "Users can update own profile"
  ON users FOR UPDATE
  TO authenticated
  USING (id = auth.uid() OR EXISTS (
    SELECT 1 FROM users
    WHERE id = auth.uid()
    AND role = 'super_administrator'
  ));

-- Campuses table policies
CREATE POLICY "All authenticated users can view campuses"
  ON campuses FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Only admins can modify campuses"
  ON campuses FOR ALL
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role IN ('administrator', 'super_administrator')
    )
  );

-- Buildings table policies
CREATE POLICY "All authenticated users can view buildings"
  ON buildings FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Only admins can modify buildings"
  ON buildings FOR ALL
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role IN ('administrator', 'super_administrator')
    )
  );

-- Key systems table policies
CREATE POLICY "All authenticated users can view key systems"
  ON key_systems FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Only admins can modify key systems"
  ON key_systems FOR ALL
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role IN ('administrator', 'super_administrator')
    )
  );

-- Keys table policies
CREATE POLICY "All authenticated users can view keys"
  ON keys FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "Key issuers and admins can modify keys"
  ON keys FOR ALL
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role IN ('key_issuer', 'administrator', 'super_administrator')
    )
  );

-- Key history table policies
CREATE POLICY "All authenticated users can view key history"
  ON key_history FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY "All authenticated users can create key history"
  ON key_history FOR INSERT
  TO authenticated
  WITH CHECK (true);

-- Audit logs table policies
CREATE POLICY "Only admins can view audit logs"
  ON audit_logs FOR SELECT
  TO authenticated
  USING (
    EXISTS (
      SELECT 1 FROM users
      WHERE id = auth.uid()
      AND role IN ('administrator', 'super_administrator')
    )
  );

CREATE POLICY "All authenticated users can create audit logs"
  ON audit_logs FOR INSERT
  TO authenticated
  WITH CHECK (true);`,instructions:["Go to Supabase Dashboard  SQL Editor","Create a new query","Paste these SQL commands",'Click "Run" to execute',"Verify policies in Table Editor  Policy tab"]};case"azure-cosmos":return{title:"Azure Cosmos DB Access Control",description:"Use role-based access control (RBAC) for Cosmos DB security.",language:"text",code:`Azure Cosmos DB Security Configuration:

1. Enable Azure AD Authentication:
   - Go to Azure Portal  Your Cosmos DB Account
   - Settings  Keys
   - Enable "Azure Active Directory" authentication

2. Create Custom Roles (Azure CLI):

# Read-only role for regular users
az cosmosdb sql role definition create \\
  --account-name <your-account> \\
  --resource-group <your-rg> \\
  --body '{
    "RoleName": "KeyManagementReader",
    "Type": "CustomRole",
    "AssignableScopes": ["/"],
    "Permissions": [{
      "DataActions": [
        "Microsoft.DocumentDB/databaseAccounts/readMetadata",
        "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/items/read",
        "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/executeQuery"
      ]
    }]
  }'

# Write role for key issuers and admins
az cosmosdb sql role definition create \\
  --account-name <your-account> \\
  --resource-group <your-rg> \\
  --body '{
    "RoleName": "KeyManagementWriter",
    "Type": "CustomRole",
    "AssignableScopes": ["/"],
    "Permissions": [{
      "DataActions": [
        "Microsoft.DocumentDB/databaseAccounts/readMetadata",
        "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/*"
      ]
    }]
  }'

3. Assign Roles to Users:
   - Go to Access Control (IAM)
   - Add role assignment
   - Assign appropriate roles based on user permissions

4. Enable Firewall:
   - Settings  Firewall and virtual networks
   - Select "Selected networks"
   - Add your application's IP addresses
   - Enable "Allow access from Azure Portal"

5. Use Managed Identity:
   - Enable managed identity for your application
   - Assign Cosmos DB roles to the managed identity
   - Use token-based authentication instead of keys`,instructions:["Access Azure Portal","Navigate to your Cosmos DB account","Follow the configuration steps above","Create custom roles using Azure CLI","Assign roles to users via IAM"]};case"azure-sql":case"azure-mysql":case"azure-postgresql":return{title:`Azure ${t==="azure-sql"?"SQL":t==="azure-mysql"?"MySQL":"PostgreSQL"} Security Configuration`,description:"Implement row-level security and role-based access control.",language:"sql",code:`-- Create roles
CREATE ROLE key_viewer;
CREATE ROLE key_issuer;
CREATE ROLE administrator;
CREATE ROLE super_administrator;

-- Grant base permissions to all roles
GRANT SELECT ON users TO key_viewer;
GRANT SELECT ON campuses TO key_viewer;
GRANT SELECT ON buildings TO key_viewer;
GRANT SELECT ON key_systems TO key_viewer;
GRANT SELECT ON keys TO key_viewer;

-- Key issuer permissions
GRANT key_viewer TO key_issuer;
GRANT INSERT, UPDATE ON keys TO key_issuer;
GRANT INSERT ON key_history TO key_issuer;

-- Administrator permissions
GRANT key_issuer TO administrator;
GRANT INSERT, UPDATE, DELETE ON campuses TO administrator;
GRANT INSERT, UPDATE, DELETE ON buildings TO administrator;
GRANT INSERT, UPDATE, DELETE ON key_systems TO administrator;
GRANT SELECT ON audit_logs TO administrator;

-- Super administrator permissions
GRANT administrator TO super_administrator;
GRANT ALL PRIVILEGES ON users TO super_administrator;
GRANT ALL PRIVILEGES ON audit_logs TO super_administrator;

-- Enable Row Level Security (RLS) for Azure SQL
${t==="azure-sql"?`
-- Create security policy for users table
CREATE FUNCTION dbo.fn_securitypredicate_users(@user_id int)
RETURNS TABLE
WITH SCHEMABINDING
AS
RETURN SELECT 1 AS fn_securitypredicate_result
WHERE
  @user_id = CAST(SESSION_CONTEXT(N'user_id') AS int)
  OR IS_MEMBER('administrator') = 1
  OR IS_MEMBER('super_administrator') = 1;

CREATE SECURITY POLICY UsersSecurityPolicy
ADD FILTER PREDICATE dbo.fn_securitypredicate_users(id)
ON dbo.users
WITH (STATE = ON);

-- Similar policies for other tables...
`:`-- For MySQL/PostgreSQL, use views with security definer
CREATE VIEW v_user_keys AS
SELECT k.*
FROM keys k
WHERE
  k.assigned_to = CURRENT_USER
  OR CURRENT_USER IN (
    SELECT username FROM users
    WHERE role IN ('administrator', 'super_administrator')
  );

-- Grant access to views instead of tables
GRANT SELECT ON v_user_keys TO key_viewer;
`}

-- Enable SSL/TLS encryption
${t==="azure-mysql"||t==="azure-postgresql"?`-- Force SSL connections (configure in Azure Portal)
-- Settings  Connection Security  Enforce SSL: ON`:`-- Enable encrypted connections (Azure SQL)
-- Automatic with Azure SQL Database`}

-- Enable firewall rules (Azure Portal)
-- Settings  Firewalls and virtual networks
-- Add IP rules for your application servers only`,instructions:["Connect to your Azure database using SQL client","Run the SQL commands above to create roles","Go to Azure Portal  Connection Security","Enable SSL enforcement","Configure firewall to allow only your application IPs","Assign roles to database users"]};case"mysql":case"postgresql":return{title:`${t==="mysql"?"MySQL":"PostgreSQL"} Security Configuration`,description:"Create roles and implement access control for self-hosted database.",language:"sql",code:`-- Create roles
CREATE ROLE key_viewer;
CREATE ROLE key_issuer;
CREATE ROLE administrator;
CREATE ROLE super_administrator;

-- Grant SELECT to key_viewer
GRANT SELECT ON users TO key_viewer;
GRANT SELECT ON campuses TO key_viewer;
GRANT SELECT ON buildings TO key_viewer;
GRANT SELECT ON key_systems TO key_viewer;
GRANT SELECT ON keys TO key_viewer;
GRANT SELECT ON key_history TO key_viewer;

-- Grant permissions to key_issuer
GRANT key_viewer TO key_issuer;
GRANT INSERT, UPDATE ON keys TO key_issuer;
GRANT INSERT ON key_history TO key_issuer;

-- Grant permissions to administrator
GRANT key_issuer TO administrator;
GRANT INSERT, UPDATE, DELETE ON campuses TO administrator;
GRANT INSERT, UPDATE, DELETE ON buildings TO administrator;
GRANT INSERT, UPDATE, DELETE ON key_systems TO administrator;
GRANT INSERT, UPDATE, DELETE ON keys TO administrator;
GRANT SELECT ON audit_logs TO administrator;

-- Grant permissions to super_administrator
GRANT administrator TO super_administrator;
GRANT ALL PRIVILEGES ON users TO super_administrator;
GRANT ALL PRIVILEGES ON campuses TO super_administrator;
GRANT ALL PRIVILEGES ON buildings TO super_administrator;
GRANT ALL PRIVILEGES ON key_systems TO super_administrator;
GRANT ALL PRIVILEGES ON keys TO super_administrator;
GRANT ALL PRIVILEGES ON key_history TO super_administrator;
GRANT ALL PRIVILEGES ON audit_logs TO super_administrator;

-- Create application users and assign roles
CREATE USER 'app_viewer'@'%' IDENTIFIED BY 'secure_password_here';
GRANT key_viewer TO 'app_viewer'@'%';

CREATE USER 'app_issuer'@'%' IDENTIFIED BY 'secure_password_here';
GRANT key_issuer TO 'app_issuer'@'%';

CREATE USER 'app_admin'@'%' IDENTIFIED BY 'secure_password_here';
GRANT administrator TO 'app_admin'@'%';

-- Enable SSL/TLS
-- Add to my.cnf (MySQL) or postgresql.conf (PostgreSQL):
-- require_secure_transport = ON

-- Restrict remote connections
-- In MySQL: REVOKE ALL PRIVILEGES ON *.* FROM 'root'@'%';
-- In PostgreSQL: Edit pg_hba.conf to restrict connections

FLUSH PRIVILEGES;`,instructions:["Connect to your database as root/admin user","Run the SQL commands above",'Replace "secure_password_here" with strong passwords',"Configure SSL/TLS in database config file","Restrict remote access in database settings","Use strong passwords for all database users"]};case"sqlite":return{title:"SQLite Security Notes",description:"SQLite is file-based and security is managed at application level.",language:"text",code:`SQLite Security Best Practices:

1. File System Permissions:
   - Set database file permissions to 600 (read/write for owner only)
   - Command: chmod 600 /path/to/database.db
   - Ensure only application user can access the file

2. Application-Level Security:
   - Implement authentication in your application code
   - Validate all user roles before database operations
   - Use parameterized queries to prevent SQL injection
   - Never trust client input

3. Encryption (Optional):
   - Use SQLCipher for encrypted SQLite databases
   - Encrypt database file with strong password
   - Store encryption key securely (environment variable)

4. Backup Security:
   - Encrypt backups before storage
   - Store backups in secure location
   - Set appropriate file permissions on backups

5. Access Control in Application:

   Example role checking:

   function canModifyKeys(user) {
     return ['key_issuer', 'administrator', 'super_administrator']
       .includes(user.role);
   }

   function canViewAuditLogs(user) {
     return ['administrator', 'super_administrator']
       .includes(user.role);
   }

   function canManageUsers(user) {
     return user.role === 'super_administrator';
   }

6. Network Security:
   - If exposing via web: Use HTTPS only
   - Implement rate limiting
   - Use CORS restrictions
   - Enable authentication tokens

7. Regular Security Tasks:
   - Update SQLite library regularly
   - Audit application access logs
   - Monitor for suspicious activity
   - Test security regularly`,instructions:["Set proper file permissions on database file","Implement role-based access in application code","Consider using SQLCipher for encryption","Use HTTPS if accessible over network","Regular security audits and updates"]};default:return null}})();if(!a)return null;const o=async()=>{try{await navigator.clipboard.writeText(a.code),r(!0),setTimeout(()=>r(!1),2e3)}catch(d){console.error("Failed to copy:",d)}},l=async()=>{try{await navigator.clipboard.writeText(a.setupCode||a.code),s(!1),r(!0),setTimeout(()=>r(!1),2e3)}catch(d){console.error("Failed to copy:",d)}},u=async()=>{try{await navigator.clipboard.writeText(a.code),r(!1),s(!0),setTimeout(()=>s(!1),2e3)}catch(d){console.error("Failed to copy:",d)}};return c.jsxs("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-6 space-y-4",children:[c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(bR,{className:"w-5 h-5 text-green-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-slate-900",children:a.title}),c.jsx("p",{className:"text-sm text-slate-600 mt-1",children:a.description})]})]})}),a.setupCode&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm font-semibold text-red-900 mb-1",children:"STEP 1: Apply These Rules NOW (For Setup)"}),c.jsx("p",{className:"text-xs text-red-800",children:'Use these open rules to complete initial setup. Without these, you will get "Permission denied" errors.'})]}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute top-3 right-3 z-10",children:c.jsx("button",{onClick:l,className:"flex items-center gap-2 px-3 py-1.5 bg-red-600 text-white text-xs rounded-lg hover:bg-red-700 transition",children:e?c.jsxs(c.Fragment,{children:[c.jsx(Ev,{className:"w-3.5 h-3.5"}),"Copied Setup Rules!"]}):c.jsxs(c.Fragment,{children:[c.jsx(Tv,{className:"w-3.5 h-3.5"}),"Copy Setup Rules"]})})}),c.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-xs leading-relaxed",children:c.jsx("code",{children:a.setupCode})})]}),c.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[c.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:"STEP 2: Switch to Production Rules (After Setup)"}),c.jsx("p",{className:"text-xs text-blue-800",children:"After creating your admin user, replace with these secure rules for production use."})]})]}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute top-3 right-3 z-10",children:c.jsx("button",{onClick:a.setupCode?u:o,className:"flex items-center gap-2 px-3 py-1.5 bg-slate-900 text-white text-xs rounded-lg hover:bg-slate-800 transition",children:(a.setupCode?n:e)?c.jsxs(c.Fragment,{children:[c.jsx(Ev,{className:"w-3.5 h-3.5"}),"Copied!"]}):c.jsxs(c.Fragment,{children:[c.jsx(Tv,{className:"w-3.5 h-3.5"}),a.setupCode?"Copy Production Rules":"Copy Rules"]})})}),c.jsx("pre",{className:"bg-slate-900 text-slate-100 p-4 rounded-lg overflow-x-auto text-xs leading-relaxed",children:c.jsx("code",{children:a.code})})]}),c.jsxs("div",{className:"border-t border-slate-200 pt-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-2",children:"How to Apply These Rules:"}),c.jsx("ol",{className:"space-y-2",children:a.instructions.map((d,h)=>c.jsxs("li",{className:"flex gap-2 text-sm text-slate-700",children:[c.jsxs("span",{className:"font-semibold text-slate-900 min-w-[1.5rem]",children:[h+1,"."]}),c.jsx("span",{children:d})]},h))})]}),c.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:c.jsxs("p",{className:"text-xs text-amber-900",children:[c.jsx("strong",{children:"Security Note:"})," These rules provide role-based access control. Make sure to test them in a development environment first before applying to production. Always backup your data before making security changes."]})})]})}function RR(){var T,O,L,j,G,W,re,te,me,ne,Ce,se,fe,Ee;const t=hd(),[e,r]=Y.useState("database"),[n,s]=Y.useState("supabase"),[i,a]=Y.useState(!1),[o,l]=Y.useState({databaseUrl:"",apiKey:"",firebaseConfig:{apiKey:"",authDomain:"",databaseURL:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",useFirebaseAuth:!1},sqlConfig:{host:"",port:"3306",database:"",username:"",password:""},azureSqlConfig:{server:"",database:"",username:"",password:"",options:{encrypt:!0,trustServerCertificate:!1}},azureCosmosConfig:{endpoint:"",key:"",databaseId:"",containerId:""}}),[u,d]=Y.useState({clientId:(t==null?void 0:t.clientId)||"",tenantId:(t==null?void 0:t.tenantId)||"",redirectUri:(t==null?void 0:t.redirectUri)||window.location.origin}),[h,f]=Y.useState({netId:"",email:"",fullName:"",password:"",confirmPassword:""}),[p,g]=Y.useState(!1),[m,w]=Y.useState(""),[v,y]=Y.useState({}),x=async X=>{X.preventDefault(),w(""),g(!0);try{const N=lt.getInstance();let F;if(n==="supabase"){if(!o.databaseUrl||!o.apiKey)throw new Error("Please provide both Supabase URL and API Key");const M=await fetch(`${o.databaseUrl}/functions/v1/check-setup`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.apiKey}`}});if(!M.ok){const J=await M.text();y({database:{success:!1,message:`Failed to connect to Supabase: ${M.status} - ${J}`}}),r("database-confirm");return}F_(o.databaseUrl,o.apiKey),localStorage.setItem("database_type",n),localStorage.setItem("supabase_config",JSON.stringify({url:o.databaseUrl,anonKey:o.apiKey})),F={type:"supabase",config:{url:o.databaseUrl,anonKey:o.apiKey}}}else if(n==="firebase"){if(!o.firebaseConfig.apiKey||!o.firebaseConfig.authDomain||!o.firebaseConfig.projectId)throw new Error("Please fill in all required Firebase fields");F={type:"firebase",config:o.firebaseConfig},localStorage.setItem("database_type",n),localStorage.setItem("firebase_config",JSON.stringify(o.firebaseConfig))}else if(n==="mysql"||n==="postgresql"){if(!o.sqlConfig.host||!o.sqlConfig.database||!o.sqlConfig.username)throw new Error("Please fill in all required SQL database fields");F={type:n,config:o.sqlConfig},localStorage.setItem("database_type",n),localStorage.setItem("sql_config",JSON.stringify({...o.sqlConfig,type:n}))}else if(n==="azure-sql"){if(!o.azureSqlConfig.server||!o.azureSqlConfig.database)throw new Error("Please fill in all required Azure SQL fields");F={type:"azure-sql",config:o.azureSqlConfig},localStorage.setItem("database_type",n),localStorage.setItem("azure_sql_config",JSON.stringify(o.azureSqlConfig))}else if(n==="azure-cosmos"){if(!o.azureCosmosConfig.endpoint||!o.azureCosmosConfig.key)throw new Error("Please fill in all required Azure Cosmos DB fields");F={type:"azure-cosmos",config:o.azureCosmosConfig},localStorage.setItem("database_type",n),localStorage.setItem("azure_cosmos_config",JSON.stringify(o.azureCosmosConfig))}else throw new Error(`Unsupported database type: ${n}`);if(await N.initialize(F),!await N.testConnection()){let M=`Connected to ${n} but failed to query database. Please check permissions.`;n==="firebase"&&(M=`Connected to Firebase but failed to query database. This usually means:

1. Firebase Realtime Database rules are too restrictive
2. Go to Firebase Console  Realtime Database  Rules
3. For development, use: { "rules": { ".read": true, ".write": true } }
4. For production, set proper authentication rules

See FIREBASE-SETUP-GUIDE.md for detailed instructions.`),y({database:{success:!1,message:M}}),r("database-confirm");return}y({database:{success:!0,message:`Successfully connected to ${n} database!`}}),r("database-confirm")}catch(N){y({database:{success:!1,message:N instanceof Error?N.message:"Failed to connect to database"}}),r("database-confirm")}finally{g(!1)}},_=async X=>{if(X.preventDefault(),w(""),h.password!==h.confirmPassword){w("Passwords do not match");return}if(h.password.length<8){w("Password must be at least 8 characters");return}g(!0);try{const N=lt.getInstance();if(!N.isInitialized())throw new Error("Database not initialized. Please complete database setup first.");if(n==="supabase"){const F=`${o.databaseUrl}/functions/v1/create-first-admin`,D=await fetch(F,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.apiKey}`},body:JSON.stringify({netId:h.netId,email:h.email,fullName:h.fullName,password:h.password,azureConfig:u.clientId&&u.tenantId?{clientId:u.clientId,tenantId:u.tenantId,redirectUri:u.redirectUri,enabled:!0}:null,databaseUrl:o.databaseUrl})}),M=await D.json();if(!D.ok)throw new Error(M.error||"Failed to create administrator in database")}else{const D=await N.getAdapter().auth.createUser({netId:h.netId,email:h.email,fullName:h.fullName,role:"super_administrator",active:!0,temporaryPassword:!1},h.password);u.clientId&&u.tenantId&&await wv({clientId:u.clientId,tenantId:u.tenantId,redirectUri:u.redirectUri}),console.log("Super administrator created successfully:",D)}localStorage.setItem("setup_complete","true"),r("success")}catch(N){w(N instanceof Error?N.message:"An error occurred")}finally{g(!1)}},P=async X=>{X.preventDefault(),w(""),g(!0);try{if(u.clientId&&u.tenantId){const N=`https://login.microsoftonline.com/${u.tenantId}/v2.0/.well-known/openid-configuration`,F=await fetch(N);if(!F.ok){y(D=>({...D,azure:{success:!1,message:`Failed to connect to Azure AD. Tenant ID may be invalid. Status: ${F.status}`}})),r("azure-confirm");return}wv({clientId:u.clientId,tenantId:u.tenantId,redirectUri:u.redirectUri}),y(D=>({...D,azure:{success:!0,message:"Successfully validated Azure AD configuration!"}})),r("azure-confirm")}else y(N=>({...N,azure:{success:!0,message:"Azure AD configuration skipped."}})),r("azure-confirm")}catch(N){y(F=>({...F,azure:{success:!1,message:N instanceof Error?N.message:"Failed to validate Azure AD configuration"}})),r("azure-confirm")}finally{g(!1)}},S=()=>{r("admin")};return e==="database"?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:c.jsx(Fs,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"University Key Management System"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-2",children:"Step 1 of 3: Database Configuration"}),c.jsx("p",{className:"text-xs text-center text-slate-400 mb-6",children:"Designed by Hector Reyes & Oscar Melo"}),m&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-red-700",children:m})}),c.jsxs("form",{onSubmit:x,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Database Type"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[c.jsx("button",{type:"button",onClick:()=>s("supabase"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="supabase"?"border-slate-900 bg-slate-50 text-slate-900":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"Supabase"}),c.jsx("button",{type:"button",onClick:()=>s("firebase"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="firebase"?"border-slate-900 bg-slate-50 text-slate-900":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"Firebase"}),c.jsx("button",{type:"button",onClick:()=>s("mysql"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="mysql"?"border-slate-900 bg-slate-50 text-slate-900":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"MySQL"}),c.jsx("button",{type:"button",onClick:()=>s("postgresql"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="postgresql"?"border-slate-900 bg-slate-50 text-slate-900":"border-slate-200 text-slate-600 hover:border-slate-300"}`,children:"PostgreSQL"})]}),c.jsxs("div",{className:"border-t border-slate-200 pt-2 mt-2",children:[c.jsx("p",{className:"text-xs font-medium text-slate-500 mb-2",children:"Azure Options"}),c.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[c.jsx("button",{type:"button",onClick:()=>s("azure-sql"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="azure-sql"?"border-blue-600 bg-blue-50 text-blue-900":"border-slate-200 text-slate-600 hover:border-blue-300"}`,children:"Azure SQL"}),c.jsx("button",{type:"button",onClick:()=>s("azure-cosmos"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="azure-cosmos"?"border-blue-600 bg-blue-50 text-blue-900":"border-slate-200 text-slate-600 hover:border-blue-300"}`,children:"Cosmos DB"}),c.jsx("button",{type:"button",onClick:()=>s("azure-mysql"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="azure-mysql"?"border-blue-600 bg-blue-50 text-blue-900":"border-slate-200 text-slate-600 hover:border-blue-300"}`,children:"Azure MySQL"}),c.jsx("button",{type:"button",onClick:()=>s("azure-postgresql"),className:`p-2.5 border-2 rounded-lg text-xs font-medium transition ${n==="azure-postgresql"?"border-blue-600 bg-blue-50 text-blue-900":"border-slate-200 text-slate-600 hover:border-blue-300"}`,children:"Azure PostgreSQL"})]})]})]}),n==="supabase"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supabase Project URL"}),c.jsx("input",{type:"url",value:o.databaseUrl,onChange:X=>l({...o,databaseUrl:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"https://your-project.supabase.co",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Supabase Anon Key"}),c.jsx("textarea",{value:o.apiKey,onChange:X=>l({...o,apiKey:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition font-mono text-xs",placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,required:!0,disabled:p})]})]}),n==="firebase"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["API Key ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.firebaseConfig.apiKey,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,apiKey:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition font-mono text-xs",placeholder:"AIzaSy...",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Auth Domain ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.firebaseConfig.authDomain,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,authDomain:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"your-project.firebaseapp.com",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Database URL ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"url",value:o.firebaseConfig.databaseURL,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,databaseURL:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"https://your-project.firebaseio.com",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Project ID ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.firebaseConfig.projectId,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,projectId:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"your-project-id",required:!0,disabled:p})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Storage Bucket"}),c.jsx("input",{type:"text",value:o.firebaseConfig.storageBucket,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,storageBucket:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition text-sm",placeholder:"your-project.appspot.com",disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Messaging Sender ID"}),c.jsx("input",{type:"text",value:o.firebaseConfig.messagingSenderId,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,messagingSenderId:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition text-sm",placeholder:"123456789",disabled:p})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"App ID"}),c.jsx("input",{type:"text",value:o.firebaseConfig.appId,onChange:X=>l({...o,firebaseConfig:{...o.firebaseConfig,appId:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition font-mono text-xs",placeholder:"1:123456789:web:abcdef",disabled:p})]}),c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:i,onChange:X=>{a(X.target.checked),l({...o,firebaseConfig:{...o.firebaseConfig,useFirebaseAuth:X.target.checked}})},className:"mt-1 w-4 h-4 text-blue-600 border-blue-300 rounded focus:ring-blue-500",disabled:p}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-blue-900 mb-1",children:"Enable Firebase Authentication"}),c.jsx("div",{className:"text-sm text-blue-700",children:"Use Firebase Authentication for user management with email/password sign-in, password reset, and email verification. Recommended for production deployments."}),i&&c.jsxs("div",{className:"mt-2 text-xs text-blue-600 bg-blue-100 px-3 py-2 rounded",children:[c.jsx("strong",{children:"Note:"})," You'll need to enable Email/Password authentication in Firebase Console  Authentication  Sign-in method"]})]})]})})]}),(n==="mysql"||n==="postgresql")&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Host ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.host,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,host:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"localhost",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Port"}),c.jsx("input",{type:"text",value:o.sqlConfig.port,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,port:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:n==="mysql"?"3306":"5432",disabled:p})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Database Name ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.database,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,database:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"key_management",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Username ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.username,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,username:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"root",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),c.jsx("input",{type:"password",value:o.sqlConfig.password,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,password:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"",disabled:p})]})]}),n==="azure-sql"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Server ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.azureSqlConfig.server,onChange:X=>l({...o,azureSqlConfig:{...o.azureSqlConfig,server:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"your-server.database.windows.net",required:!0,disabled:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Format: server-name.database.windows.net"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Database Name ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.azureSqlConfig.database,onChange:X=>l({...o,azureSqlConfig:{...o.azureSqlConfig,database:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"unikey_management",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Username ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.azureSqlConfig.username,onChange:X=>l({...o,azureSqlConfig:{...o.azureSqlConfig,username:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"sqladmin",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Password ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"password",value:o.azureSqlConfig.password,onChange:X=>l({...o,azureSqlConfig:{...o.azureSqlConfig,password:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"",required:!0,disabled:p})]})]}),n==="azure-cosmos"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Cosmos DB Endpoint ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"url",value:o.azureCosmosConfig.endpoint,onChange:X=>l({...o,azureCosmosConfig:{...o.azureCosmosConfig,endpoint:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"https://your-account.documents.azure.com:443/",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Primary Key ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("textarea",{value:o.azureCosmosConfig.key,onChange:X=>l({...o,azureCosmosConfig:{...o.azureCosmosConfig,key:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition font-mono text-xs",placeholder:"Your Cosmos DB primary key",rows:3,required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Database ID ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.azureCosmosConfig.databaseId,onChange:X=>l({...o,azureCosmosConfig:{...o.azureCosmosConfig,databaseId:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"unikey-db",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Container ID"}),c.jsx("input",{type:"text",value:o.azureCosmosConfig.containerId,onChange:X=>l({...o,azureCosmosConfig:{...o.azureCosmosConfig,containerId:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"keys",disabled:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Optional: Leave empty for default"})]})]}),(n==="azure-mysql"||n==="azure-postgresql")&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Server Host ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.host,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,host:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:n==="azure-mysql"?"server-name.mysql.database.azure.com":"server-name.postgres.database.azure.com",required:!0,disabled:p})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Port"}),c.jsx("input",{type:"text",value:o.sqlConfig.port,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,port:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:n==="azure-mysql"?"3306":"5432",disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"SSL Mode"}),c.jsx("select",{className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition text-sm",disabled:p,children:c.jsx("option",{children:"Required"})})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Database Name ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.database,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,database:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"unikey_management",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Admin Username ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:o.sqlConfig.username,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,username:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"azureuser@server-name",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Password ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"password",value:o.sqlConfig.password,onChange:X=>l({...o,sqlConfig:{...o.sqlConfig,password:X.target.value}}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:"",required:!0,disabled:p})]})]}),c.jsx(NR,{databaseType:n}),c.jsx("button",{type:"submit",disabled:p,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Testing Connection...":"Continue to Azure Setup"})]})]})})}):e==="database-confirm"?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:`p-4 rounded-2xl ${(T=v.database)!=null&&T.success?"bg-green-500":"bg-red-500"}`,children:c.jsx(Fs,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Database Connection Status"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-6",children:"Step 1 of 3: Database Configuration"}),c.jsxs("div",{className:`mb-6 p-4 rounded-lg border-2 ${(O=v.database)!=null&&O.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsx("p",{className:`text-sm font-medium mb-2 ${(L=v.database)!=null&&L.success?"text-green-900":"text-red-900"}`,children:(j=v.database)!=null&&j.success?"Connection Successful":"Connection Failed"}),c.jsx("p",{className:`text-sm ${(G=v.database)!=null&&G.success?"text-green-700":"text-red-700"}`,children:(W=v.database)==null?void 0:W.message})]}),c.jsx("div",{className:"space-y-3",children:(re=v.database)!=null&&re.success?c.jsx("button",{onClick:()=>r("azure"),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Continue to Azure AD Configuration"}):c.jsx("button",{onClick:()=>r("database"),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Try Again"})})]})})}):e==="azure-confirm"?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:`p-4 rounded-2xl ${(te=v.azure)!=null&&te.success?"bg-green-500":"bg-red-500"}`,children:c.jsx($f,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Azure AD Connection Status"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-6",children:"Step 2 of 3: Azure AD Configuration"}),c.jsxs("div",{className:`mb-6 p-4 rounded-lg border-2 ${(me=v.azure)!=null&&me.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsx("p",{className:`text-sm font-medium mb-2 ${(ne=v.azure)!=null&&ne.success?"text-green-900":"text-red-900"}`,children:(Ce=v.azure)!=null&&Ce.success?"Validation Successful":"Validation Failed"}),c.jsx("p",{className:`text-sm ${(se=v.azure)!=null&&se.success?"text-green-700":"text-red-700"}`,children:(fe=v.azure)==null?void 0:fe.message})]}),c.jsx("div",{className:"space-y-3",children:(Ee=v.azure)!=null&&Ee.success?c.jsx("button",{onClick:()=>r("admin"),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Continue to Create Admin User"}):c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>r("azure"),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Try Again"}),c.jsx("button",{onClick:()=>r("admin"),className:"w-full border-2 border-slate-300 text-slate-700 py-2.5 rounded-lg font-medium hover:bg-slate-50 transition",children:"Continue Anyway (Skip Azure AD)"})]})})]})})}):e==="azure"?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-blue-600 p-4 rounded-2xl",children:c.jsx($f,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Azure AD Configuration"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-2",children:"Step 2 of 3: Microsoft Azure Active Directory (Optional)"}),c.jsx("p",{className:"text-xs text-center text-slate-400 mb-6",children:"Designed by Hector Reyes & Oscar Melo"}),c.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsx("p",{className:"text-xs text-blue-700",children:"Configure Azure AD to enable single sign-on (SSO) for your users. This step is optional."})}),m&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-red-700",children:m})}),c.jsxs("form",{onSubmit:P,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Azure AD Client ID",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Application ID)"})]}),c.jsx("input",{type:"text",value:u.clientId,onChange:X=>d({...u,clientId:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition font-mono text-sm",placeholder:"00000000-0000-0000-0000-000000000000",disabled:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"From Azure Portal  App registrations  Overview"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Azure AD Tenant ID",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Directory ID)"})]}),c.jsx("input",{type:"text",value:u.tenantId,onChange:X=>d({...u,tenantId:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition font-mono text-sm",placeholder:"00000000-0000-0000-0000-000000000000",disabled:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"From Azure Portal  App registrations  Overview"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Redirect URI",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Optional)"})]}),c.jsx("input",{type:"url",value:u.redirectUri,onChange:X=>d({...u,redirectUri:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:window.location.origin,disabled:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Leave blank to use current URL"})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{type:"button",onClick:S,disabled:p,className:"flex-1 bg-slate-200 text-slate-700 py-2.5 rounded-lg font-medium hover:bg-slate-300 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Skip for Now"}),c.jsx("button",{type:"submit",disabled:p,className:"flex-1 bg-blue-600 text-white py-2.5 rounded-lg font-medium hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Save & Continue"})]})]}),c.jsxs("div",{className:"mt-4 p-3 bg-slate-50 rounded-lg",children:[c.jsxs("p",{className:"text-xs text-slate-600 mb-2",children:[c.jsx("strong",{children:"Note:"})," You'll need to register this application in Azure Portal first:"]}),c.jsxs("ol",{className:"text-xs text-slate-600 space-y-1 list-decimal list-inside",children:[c.jsx("li",{children:"Go to Azure Portal  Azure Active Directory"}),c.jsx("li",{children:"Navigate to App registrations  New registration"}),c.jsx("li",{children:"Set redirect URI as a Single-page application (SPA)"}),c.jsx("li",{children:"Copy the Client ID and Tenant ID"})]})]})]})})}):e==="success"?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 text-center",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-green-500 p-4 rounded-2xl",children:c.jsx(IR,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Setup Complete!"}),c.jsx("p",{className:"text-slate-600 mb-4",children:"Your super administrator account has been created successfully."}),c.jsx("p",{className:"text-xs text-slate-400 mb-6",children:"University Key Management System by Hector Reyes & Oscar Melo"}),c.jsxs("div",{className:"bg-slate-50 rounded-lg p-4 mb-6 text-left",children:[c.jsx("p",{className:"text-sm text-slate-600 mb-2",children:"Login Credentials:"}),c.jsxs("p",{className:"text-sm",children:[c.jsx("span",{className:"font-medium",children:"NetID:"})," ",h.netId]}),c.jsxs("p",{className:"text-sm",children:[c.jsx("span",{className:"font-medium",children:"Email:"})," ",h.email]})]}),c.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition",children:"Go to Login"})]})})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:c.jsx(Mp,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Create Super Administrator"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-8",children:"Step 3 of 3: Create your first Super Administrator account"}),m&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-red-700",children:m})}),c.jsxs("form",{onSubmit:_,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name"}),c.jsx("input",{type:"text",value:h.fullName,onChange:X=>f({...h,fullName:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"John Doe",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID"}),c.jsx("input",{type:"text",value:h.netId,onChange:X=>f({...h,netId:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"admin",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email"}),c.jsx("input",{type:"email",value:h.email,onChange:X=>f({...h,email:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"admin@university.edu",required:!0,disabled:p})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),c.jsx("input",{type:"password",value:h.password,onChange:X=>f({...h,password:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Minimum 8 characters",required:!0,disabled:p,minLength:8})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),c.jsx("input",{type:"password",value:h.confirmPassword,onChange:X=>f({...h,confirmPassword:X.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Confirm your password",required:!0,disabled:p,minLength:8})]}),c.jsx("button",{type:"submit",disabled:p,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Creating...":"Create Administrator"})]})]})})})}function OR(){const[t,e]=Y.useState(""),[r,n]=Y.useState(""),[s,i]=Y.useState(""),[a,o]=Y.useState(!1),[l,u]=Y.useState(!1),d=hd(),{signIn:h,signInWithAzure:f}=en(),{instance:p}=Ip(),g=async v=>{v.preventDefault(),i(""),o(!0);const{error:y}=await h(t,r);y&&i(y.message),o(!1)},m=async()=>{try{i(""),o(!0),await f()}catch(v){i(v.message||"Azure login failed")}finally{o(!1)}},w=async()=>{if(!d){i("Azure AD is not configured. Please contact your administrator.");return}try{o(!0),i(""),await p.loginPopup({scopes:["User.Read"],prompt:"select_account",extraQueryParameters:{domain_hint:"organizations"}}),u(!1),i(""),alert("Please use Azure portal to reset your password: https://account.activedirectory.windowsazure.com/ChangePassword.aspx")}catch{i("Unable to initiate password reset. Please contact your IT administrator.")}finally{o(!1)}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsxs("div",{className:"w-full max-w-md",children:[c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-slate-900 p-4 rounded-2xl",children:c.jsx(Mp,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"University Key Management System"}),c.jsx("p",{className:"text-sm text-center text-slate-600 mb-6",children:"Multi-Campus Key Management Solution"}),c.jsx("p",{className:"text-xs text-center text-slate-400 mb-8",children:"Designed by Hector Reyes & Oscar Melo"}),s&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-red-700",children:s})}),d&&c.jsxs("button",{type:"button",onClick:m,disabled:a,className:"w-full mb-4 bg-blue-600 text-white py-2.5 rounded-lg font-medium hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 23 23",fill:"currentColor",children:c.jsx("path",{d:"M0 0h10.931v10.931H0V0zm12.069 0H23v10.931H12.069V0zM0 12.069h10.931V23H0V12.069zm12.069 0H23V23H12.069V12.069z"})}),a?"Signing in...":"Sign in with Microsoft"]}),d&&c.jsxs("div",{className:"relative my-6",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-slate-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-slate-500",children:"Or continue with NetID"})})]}),c.jsxs("form",{onSubmit:g,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"netId",className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID"}),c.jsx("input",{id:"netId",type:"text",value:t,onChange:v=>e(v.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter your NetID",required:!0,disabled:a})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-1",children:"Password"}),c.jsx("input",{id:"password",type:"password",value:r,onChange:v=>n(v.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter your password",required:!0,disabled:a})]}),c.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Signing in...":"Sign In"})]}),d&&c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{type:"button",onClick:w,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Forgot your password?"})})]}),c.jsxs("div",{className:"text-center mt-6 space-y-2",children:[c.jsx("p",{className:"text-sm text-slate-600",children:"Authorized personnel only"}),c.jsx("button",{onClick:()=>{confirm("This will reset the database configuration and return to setup. Continue?")&&(localStorage.removeItem("setup_complete"),localStorage.removeItem("database_type"),localStorage.removeItem("database_config"),window.location.reload())},className:"text-xs text-slate-400 hover:text-slate-600 underline",children:"Reset Database Setup"})]})]})})}function PR(){const[t,e]=Y.useState(""),[r,n]=Y.useState(""),[s,i]=Y.useState(""),[a,o]=Y.useState(!1),{updatePassword:l,profile:u}=en(),d=async h=>{if(h.preventDefault(),i(""),t.length<8){i("Password must be at least 8 characters long");return}if(t!==r){i("Passwords do not match");return}o(!0);const{error:f}=await l(t);f&&(i(f.message),o(!1))};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[c.jsx("div",{className:"flex justify-center mb-6",children:c.jsx("div",{className:"bg-amber-500 p-4 rounded-2xl",children:c.jsx(_R,{className:"w-12 h-12 text-white"})})}),c.jsx("h1",{className:"text-2xl font-bold text-center text-slate-900 mb-2",children:"Change Password Required"}),c.jsxs("p",{className:"text-sm text-center text-slate-600 mb-8",children:["Welcome, ",u==null?void 0:u.full_name,". Please set a new password to continue."]}),c.jsxs("div",{className:"mb-6 p-4 bg-amber-50 border border-amber-200 rounded-lg flex gap-3",children:[c.jsx(jp,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-sm text-amber-800",children:[c.jsx("p",{className:"font-medium mb-1",children:"Password Requirements:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[c.jsx("li",{children:"At least 8 characters long"}),c.jsx("li",{children:"Use a strong, unique password"})]})]})]}),s&&c.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-red-700",children:s})}),c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-slate-700 mb-1",children:"New Password"}),c.jsx("input",{id:"newPassword",type:"password",value:t,onChange:h=>e(h.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Enter new password",required:!0,disabled:a})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirm Password"}),c.jsx("input",{id:"confirmPassword",type:"password",value:r,onChange:h=>n(h.target.value),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"Confirm new password",required:!0,disabled:a})]}),c.jsx("button",{type:"submit",disabled:a,className:"w-full bg-slate-900 text-white py-2.5 rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Updating...":"Update Password"})]})]})})})}function LR({children:t,currentView:e,onNavigate:r}){const{profile:n,signOut:s}=en(),[i,a]=Y.useState(!0),o=(n==null?void 0:n.role)==="administrator"||(n==null?void 0:n.role)==="super_administrator",l=o,u=o,d=o,h=(n==null?void 0:n.role)==="super_administrator",f=[{id:"dashboard",label:"Dashboard",icon:wR,show:!0},{id:"campuses",label:"Campuses",icon:Dp,show:!0},{id:"buildings",label:"Buildings",icon:fd,show:!0},{id:"key-systems",label:"Key Systems",icon:Fs,show:!0},{id:"keys",label:"Keys",icon:al,show:!0},{id:"key-history",label:"Key History",icon:xu,show:!0},{id:"reports",label:"Reports",icon:H_,show:!0},{id:"users",label:"User Management",icon:$_,show:o},{id:"audit-logs",label:"Audit Logs",icon:xu,show:l},{id:"error-reports",label:"Error Reports",icon:zf,show:u},{id:"backup",label:"Backup & Export",icon:Fs,show:d},{id:"system-config",label:"System Configuration",icon:AR,show:h}],p=m=>{switch(m){case"super_administrator":return"bg-red-100 text-red-700 border-red-200";case"administrator":return"bg-blue-100 text-blue-700 border-blue-200";case"standard_user":return"bg-green-100 text-green-700 border-green-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}},g=m=>{switch(m){case"super_administrator":return"Super Admin";case"administrator":return"Administrator";case"standard_user":return"Standard User";case"basic_user":return"Basic User";default:return m}};return c.jsxs("div",{className:"min-h-screen bg-slate-50 flex",children:[c.jsxs("aside",{className:`${i?"w-64":"w-20"} bg-white border-r border-slate-200 transition-all duration-300 flex flex-col`,children:[c.jsxs("div",{className:"h-16 border-b border-slate-200 flex items-center justify-between px-4",children:[i&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"bg-slate-900 p-2 rounded-lg",children:c.jsx(Mp,{className:"w-5 h-5 text-white"})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"font-bold text-slate-900 text-sm",children:"UKMS"}),c.jsx("span",{className:"text-[9px] text-slate-500 leading-tight",children:"by HR & OM"})]})]}),c.jsx("button",{onClick:()=>a(!i),className:"p-2 hover:bg-slate-100 rounded-lg transition",children:i?c.jsx(K_,{className:"w-5 h-5 text-slate-600"}):c.jsx(ER,{className:"w-5 h-5 text-slate-600"})})]}),c.jsx("nav",{className:"flex-1 p-4 space-y-1 overflow-y-auto",children:f.filter(m=>m.show).map(m=>{const w=m.icon,v=e===m.id;return c.jsxs("button",{onClick:()=>r(m.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg transition ${v?"bg-slate-900 text-white":"text-slate-700 hover:bg-slate-100"}`,title:i?"":m.label,children:[c.jsx(w,{className:"w-5 h-5 flex-shrink-0"}),i&&c.jsx("span",{className:"text-sm font-medium",children:m.label})]},m.id)})}),c.jsx("div",{className:"border-t border-slate-200 p-4",children:i?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-900 truncate",children:n==null?void 0:n.full_name}),c.jsx("p",{className:"text-xs text-slate-600 truncate",children:n==null?void 0:n.net_id}),c.jsx("span",{className:`inline-block mt-2 text-xs font-medium px-2 py-1 rounded border ${p((n==null?void 0:n.role)||"")}`,children:g((n==null?void 0:n.role)||"")})]}),c.jsxs("button",{onClick:s,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-700 hover:bg-red-50 rounded-lg transition",children:[c.jsx(Sv,{className:"w-4 h-4"}),c.jsx("span",{children:"Sign Out"})]})]}):c.jsx("button",{onClick:s,className:"w-full p-2 text-red-700 hover:bg-red-50 rounded-lg transition",title:"Sign Out",children:c.jsx(Sv,{className:"w-5 h-5"})})})]}),c.jsx("main",{className:"flex-1 overflow-auto",children:c.jsx("div",{className:"p-8",children:t})})]})}function bv(){const[t,e]=Y.useState({campuses:0,buildings:0,totalKeys:0,assignedKeys:0,unassignedKeys:0,users:0}),[r,n]=Y.useState(!0);Y.useEffect(()=>{s()},[]);const s=async()=>{var a,o;try{const[l,u,d,h]=await Promise.all([supabase.from("campuses").select("id",{count:"exact",head:!0}),supabase.from("buildings").select("id",{count:"exact",head:!0}),supabase.from("keys").select("id, status",{count:"exact"}),supabase.from("user_profiles").select("id",{count:"exact",head:!0})]),f=((a=d.data)==null?void 0:a.filter(g=>g.status==="assigned").length)||0,p=((o=d.data)==null?void 0:o.filter(g=>g.status==="unassigned").length)||0;e({campuses:l.count||0,buildings:u.count||0,totalKeys:d.count||0,assignedKeys:f,unassignedKeys:p,users:h.count||0})}catch(l){console.error("Error fetching stats:",l)}finally{n(!1)}},i=[{label:"Total Campuses",value:t.campuses,icon:Dp,color:"bg-blue-500"},{label:"Total Buildings",value:t.buildings,icon:fd,color:"bg-green-500"},{label:"Total Keys",value:t.totalKeys,icon:al,color:"bg-slate-500"},{label:"Assigned Keys",value:t.assignedKeys,icon:Kf,color:"bg-emerald-500"},{label:"Available Keys",value:t.unassignedKeys,icon:al,color:"bg-amber-500"},{label:"System Users",value:t.users,icon:$_,color:"bg-slate-600"}];return r?c.jsxs("div",{className:"space-y-6",children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Dashboard"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((a,o)=>c.jsxs("div",{className:"bg-white rounded-xl p-6 animate-pulse",children:[c.jsx("div",{className:"h-4 bg-slate-200 rounded w-1/2 mb-4"}),c.jsx("div",{className:"h-8 bg-slate-200 rounded w-1/3"})]},o))})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Dashboard"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Overview of the University Key Management System"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map((a,o)=>{const l=a.icon;return c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6 hover:shadow-md transition",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-slate-600 mb-2",children:a.label}),c.jsx("p",{className:"text-3xl font-bold text-slate-900",children:a.value})]}),c.jsx("div",{className:`${a.color} p-3 rounded-xl`,children:c.jsx(l,{className:"w-6 h-6 text-white"})})]})},o)})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"System Status"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between py-2",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Database Connection"}),c.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),c.jsx("span",{className:"text-green-700 font-medium",children:"Connected"})]})]}),c.jsxs("div",{className:"flex items-center justify-between py-2",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"System Health"}),c.jsxs("span",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),c.jsx("span",{className:"text-green-700 font-medium",children:"Operational"})]})]}),c.jsxs("div",{className:"flex items-center justify-between py-2",children:[c.jsx("span",{className:"text-sm text-slate-600",children:"Key Utilization"}),c.jsxs("span",{className:"text-sm font-medium text-slate-900",children:[t.totalKeys>0?Math.round(t.assignedKeys/t.totalKeys*100):0,"%"]})]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"View All Keys"}),c.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Generate Report"}),c.jsx("button",{className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Assign New Key"})]})]})]})]})}function bl(){const{profile:t}=en();return{logAction:async(r,n,s,i)=>{if(t)try{await U_.from("audit_logs").insert({user_id:t.id,user_net_id:t.net_id,user_full_name:t.full_name,action_type:r,entity_type:n,description:s,entity_id:(i==null?void 0:i.entityId)||null,campus_id:(i==null?void 0:i.campusId)||null,building_id:(i==null?void 0:i.buildingId)||null,metadata:(i==null?void 0:i.metadata)||{}})}catch(a){console.error("Failed to log action:",a)}}}}function jR(){const{profile:t}=en(),{logAction:e}=bl(),[r,n]=Y.useState([]),[s,i]=Y.useState(!0),[a,o]=Y.useState(""),[l,u]=Y.useState(!1),[d,h]=Y.useState(null),[f,p]=Y.useState({name:"",code:"",address:"",active:!0}),g=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="super_administrator";Y.useEffect(()=>{m()},[]);const m=async()=>{try{const _=lt.getInstance();if(!_.isInitialized())throw new Error("Database not initialized");const S=await _.getAdapter().campuses.getAll();n(S)}catch(_){console.error("Error fetching campuses:",_),alert("Error loading campuses. Please refresh the page.")}finally{i(!1)}},w=async _=>{_.preventDefault();try{const S=lt.getInstance().getAdapter();if(d)await S.campuses.update(d.id,f),await e("update","campus",`Updated campus: ${f.name}`,{entityId:d.id,metadata:f});else{const T=await S.campuses.create(f);await e("create","campus",`Created campus: ${f.name}`,{entityId:T.id,metadata:f})}u(!1),h(null),p({name:"",code:"",address:"",active:!0}),m()}catch(P){console.error("Error saving campus:",P),alert("Error saving campus. Please try again.")}},v=_=>{h(_),p({name:_.name,code:_.code,address:_.address,active:_.active}),u(!0)},y=async _=>{if(confirm(`Are you sure you want to delete "${_.name}"?`))try{await lt.getInstance().getAdapter().campuses.delete(_.id),await e("delete","campus",`Deleted campus: ${_.name}`,{entityId:_.id,metadata:{name:_.name,code:_.code}}),m()}catch(P){console.error("Error deleting campus:",P),alert("Error deleting campus. It may have associated buildings or keys.")}},x=r.filter(_=>_.name.toLowerCase().includes(a.toLowerCase())||_.code.toLowerCase().includes(a.toLowerCase()));return s?c.jsx("div",{className:"text-center py-12",children:"Loading campuses..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Campuses"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage university campuses"})]}),g&&c.jsxs("button",{onClick:()=>{h(null),p({name:"",code:"",address:"",active:!0}),u(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[c.jsx(Sl,{className:"w-4 h-4"}),c.jsx("span",{children:"Add Campus"})]})]}),l&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:d?"Edit Campus":"Add Campus"}),c.jsxs("form",{onSubmit:w,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus Name"}),c.jsx("input",{type:"text",value:f.name,onChange:_=>p({...f,name:_.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus Code"}),c.jsx("input",{type:"text",value:f.code,onChange:_=>p({...f,code:_.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Address"}),c.jsx("textarea",{value:f.address,onChange:_=>p({...f,address:_.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",id:"active",checked:f.active,onChange:_=>p({...f,active:_.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),c.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:d?"Update":"Create"}),c.jsx("button",{type:"button",onClick:()=>{u(!1),h(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsx("div",{className:"p-4 border-b border-slate-200",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search campuses...",value:a,onChange:_=>o(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Code"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Address"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),g&&c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-200",children:[x.map(_=>c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:c.jsx(Dp,{className:"w-5 h-5 text-slate-600"})}),c.jsx("span",{className:"font-medium text-slate-900",children:_.name})]})}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:_.code}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:_.address||"-"}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${_.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:_.active?"Active":"Inactive"})}),g&&c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>v(_),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:c.jsx(Cl,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>y(_),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:c.jsx(Al,{className:"w-4 h-4"})})]})})]},_.id)),x.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:g?5:4,className:"px-6 py-12 text-center text-slate-500",children:"No campuses found"})})]})]})})]})]})}function MR(){const{profile:t}=en(),{logAction:e}=bl(),[r,n]=Y.useState([]),[s,i]=Y.useState([]),[a,o]=Y.useState(!0),[l,u]=Y.useState(""),[d,h]=Y.useState(!1),[f,p]=Y.useState(null),[g,m]=Y.useState({name:"",code:"",address:"",campus_id:"",active:!0}),w=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="super_administrator";Y.useEffect(()=>{v()},[]);const v=async()=>{try{const T=lt.getInstance().getAdapter(),[O,L]=await Promise.all([T.buildings.getAll(),T.campuses.getAll()]);n(O),i(L.filter(j=>j.active))}catch(S){console.error("Error fetching data:",S),alert("Error loading data. Please refresh the page.")}finally{o(!1)}},y=async S=>{S.preventDefault();try{const O=lt.getInstance().getAdapter();if(f)await O.buildings.update(f.id,g),await e("update","building",`Updated building: ${g.name}`,{entityId:f.id,metadata:g});else{const L=await O.buildings.create(g);await e("create","building",`Created building: ${g.name}`,{entityId:L.id,metadata:g})}h(!1),p(null),m({name:"",code:"",address:"",campus_id:"",active:!0}),v()}catch(T){console.error("Error saving building:",T),alert("Error saving building. Please try again.")}},x=S=>{p(S),m({name:S.name,code:S.code,address:S.address,campus_id:S.campus_id,active:S.active}),h(!0)},_=async S=>{if(confirm(`Are you sure you want to delete "${S.name}"?`))try{await lt.getInstance().getAdapter().buildings.delete(S.id),await e("delete","building",`Deleted building: ${S.name}`,{entityId:S.id,metadata:{name:S.name,code:S.code}}),v()}catch(T){console.error("Error deleting building:",T),alert("Error deleting building. It may have associated keys.")}},P=r.filter(S=>S.name.toLowerCase().includes(l.toLowerCase())||S.code.toLowerCase().includes(l.toLowerCase()));return a?c.jsx("div",{className:"text-center py-12",children:"Loading buildings..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Buildings"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage buildings across campuses"})]}),w&&c.jsxs("button",{onClick:()=>{p(null),m({name:"",code:"",address:"",campus_id:"",active:!0}),h(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[c.jsx(Sl,{className:"w-4 h-4"}),c.jsx("span",{children:"Add Building"})]})]}),d&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:f?"Edit Building":"Add Building"}),c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus"}),c.jsxs("select",{value:g.campus_id,onChange:S=>m({...g,campus_id:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[c.jsx("option",{value:"",children:"Select Campus"}),s.map(S=>c.jsx("option",{value:S.id,children:S.name},S.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Building Name"}),c.jsx("input",{type:"text",value:g.name,onChange:S=>m({...g,name:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Building Code"}),c.jsx("input",{type:"text",value:g.code,onChange:S=>m({...g,code:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Address"}),c.jsx("textarea",{value:g.address,onChange:S=>m({...g,address:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",id:"active",checked:g.active,onChange:S=>m({...g,active:S.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),c.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:f?"Update":"Create"}),c.jsx("button",{type:"button",onClick:()=>{h(!1),p(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsx("div",{className:"p-4 border-b border-slate-200",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search buildings...",value:l,onChange:S=>u(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Building"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Code"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Address"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),w&&c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-200",children:[P.map(S=>{var T;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:c.jsx(fd,{className:"w-5 h-5 text-slate-600"})}),c.jsx("span",{className:"font-medium text-slate-900",children:S.name})]})}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.code}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:((T=S.campus)==null?void 0:T.name)||"-"}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.address||"-"}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${S.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:S.active?"Active":"Inactive"})}),w&&c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>x(S),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:c.jsx(Cl,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>_(S),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:c.jsx(Al,{className:"w-4 h-4"})})]})})]},S.id)}),P.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:w?6:5,className:"px-6 py-12 text-center text-slate-500",children:"No buildings found"})})]})]})})]})]})}function DR(){const{profile:t}=en(),{logAction:e}=bl(),[r,n]=Y.useState([]),[s,i]=Y.useState([]),[a,o]=Y.useState(!0),[l,u]=Y.useState(""),[d,h]=Y.useState(!1),[f,p]=Y.useState(null),[g,m]=Y.useState({name:"",brand:"",campus_id:"",description:"",active:!0}),w=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="super_administrator";Y.useEffect(()=>{v()},[]);const v=async()=>{try{const T=lt.getInstance().getAdapter(),[O,L]=await Promise.all([T.keySystems.getAll(),T.campuses.getAll()]);n(O),i(L.filter(j=>j.active))}catch(S){console.error("Error fetching data:",S),alert("Error loading data. Please refresh the page.")}finally{o(!1)}},y=async S=>{S.preventDefault();try{const O=lt.getInstance().getAdapter();if(f)await O.keySystems.update(f.id,g),await e("update","system",`Updated key system: ${g.name}`,{entityId:f.id,metadata:g});else{const L=await O.keySystems.create(g);await e("create","system",`Created key system: ${g.name}`,{entityId:L.id,metadata:g})}h(!1),p(null),m({name:"",brand:"",campus_id:"",description:"",active:!0}),v()}catch(T){console.error("Error saving key system:",T),alert("Error saving key system. Please try again.")}},x=S=>{p(S),m({name:S.name,brand:S.brand,campus_id:S.campus_id,description:S.description,active:S.active}),h(!0)},_=async S=>{if(confirm(`Are you sure you want to delete "${S.name}"?`))try{await lt.getInstance().getAdapter().keySystems.delete(S.id),await e("delete","system",`Deleted key system: ${S.name}`,{entityId:S.id,metadata:{name:S.name,brand:S.brand}}),v()}catch(T){console.error("Error deleting key system:",T),alert("Error deleting key system. It may have associated keys.")}},P=r.filter(S=>S.name.toLowerCase().includes(l.toLowerCase())||S.brand.toLowerCase().includes(l.toLowerCase()));return a?c.jsx("div",{className:"text-center py-12",children:"Loading key systems..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Key Systems"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage key systems, brands, and specifications"})]}),w&&c.jsxs("button",{onClick:()=>{p(null),m({name:"",brand:"",campus_id:"",description:"",active:!0}),h(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:[c.jsx(Sl,{className:"w-4 h-4"}),c.jsx("span",{children:"Add Key System"})]})]}),d&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-900 mb-4",children:f?"Edit Key System":"Add Key System"}),c.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"System Name"}),c.jsx("input",{type:"text",value:g.name,onChange:S=>m({...g,name:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",placeholder:"e.g., Main Building System",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Brand"}),c.jsx("input",{type:"text",value:g.brand,onChange:S=>m({...g,brand:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",placeholder:"e.g., Medeco, Schlage, Yale",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Campus"}),c.jsxs("select",{value:g.campus_id,onChange:S=>m({...g,campus_id:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[c.jsx("option",{value:"",children:"Select Campus"}),s.map(S=>c.jsx("option",{value:S.id,children:S.name},S.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Description"}),c.jsx("textarea",{value:g.description,onChange:S=>m({...g,description:S.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3,placeholder:"System details, specifications, notes..."})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",id:"active",checked:g.active,onChange:S=>m({...g,active:S.target.checked}),className:"w-4 h-4 text-slate-900 border-slate-300 rounded focus:ring-slate-900"}),c.jsx("label",{htmlFor:"active",className:"text-sm text-slate-700",children:"Active"})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:f?"Update":"Create"}),c.jsx("button",{type:"button",onClick:()=>{h(!1),p(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition",children:"Cancel"})]})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsx("div",{className:"p-4 border-b border-slate-200",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search key systems...",value:l,onChange:S=>u(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"System Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Brand"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Campus"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Description"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Status"}),w&&c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase tracking-wider",children:"Actions"})]})}),c.jsxs("tbody",{className:"divide-y divide-slate-200",children:[P.map(S=>{var T;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:c.jsx(Fs,{className:"w-5 h-5 text-slate-600"})}),c.jsx("span",{className:"font-medium text-slate-900",children:S.name})]})}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.brand}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:((T=S.campus)==null?void 0:T.name)||"-"}),c.jsx("td",{className:"px-6 py-4 text-sm text-slate-600",children:S.description||"-"}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${S.active?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:S.active?"Active":"Inactive"})}),w&&c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>x(S),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg transition",children:c.jsx(Cl,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>_(S),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:c.jsx(Al,{className:"w-4 h-4"})})]})})]},S.id)}),P.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:w?6:5,className:"px-6 py-12 text-center text-slate-500",children:"No key systems found"})})]})]})})]})]})}function FR(t){const e=[{label:"Top",values:t.top},{label:"Control",values:t.control},{label:"Master",values:t.master},{label:"Bottom",values:t.bottom}];return`
    <div style="display: flex; justify-content: center; margin: 30px 0;">
      <table style="border-collapse: collapse; border: 2px solid #000; background: white;">
        <thead>
          <tr style="background-color: #f3f4f6;">
            <th style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; text-align: center;">Pin Type</th>
            ${Array.from({length:7},(r,n)=>`<th style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; text-align: center;">Pin ${n+1}</th>`).join("")}
          </tr>
        </thead>
        <tbody>
          ${e.map(r=>`
            <tr>
              <td style="border: 1px solid #000; padding: 8px 12px; font-weight: bold; background-color: #f9fafb; text-align: center;">${r.label}</td>
              ${r.values.map(n=>`<td style="border: 1px solid #000; padding: 8px 12px; text-align: center; font-family: monospace;">${typeof n=="number"&&!isNaN(n)?n.toString().padStart(2,"0"):"--"}</td>`).join("")}
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  `}function UR(t){const e=t.top_pins&&t.top_pins.length>0,r={top:t.top_pins||Array(7).fill(null),control:t.control_pins||Array(7).fill(null),master:t.master_pins||Array(7).fill(null),bottom:t.bottom_pins||Array(7).fill(null)},n=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Key ${t.key_code} - Print</title>
      <style>
        body {
          font-family: Arial, sans-serif;
          padding: 40px;
          max-width: 800px;
          margin: 0 auto;
        }
        .header {
          text-align: center;
          margin-bottom: 40px;
          border-bottom: 3px solid #000;
          padding-bottom: 20px;
        }
        .header h1 {
          margin: 0;
          font-size: 28px;
          color: #1e293b;
        }
        .header p {
          margin: 5px 0 0 0;
          color: #64748b;
          font-size: 14px;
        }
        .info-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
          margin: 30px 0;
        }
        .info-item {
          display: flex;
          flex-direction: column;
        }
        .info-label {
          font-weight: bold;
          color: #64748b;
          font-size: 12px;
          text-transform: uppercase;
          margin-bottom: 4px;
        }
        .info-value {
          font-size: 16px;
          color: #1e293b;
          font-weight: 500;
        }
        .notes-section {
          margin: 30px 0;
          padding: 20px;
          background: #f8fafc;
          border-radius: 8px;
          border: 1px solid #e2e8f0;
        }
        .notes-section h3 {
          margin: 0 0 10px 0;
          font-size: 14px;
          color: #64748b;
          text-transform: uppercase;
        }
        .notes-section p {
          margin: 0;
          color: #1e293b;
          line-height: 1.6;
        }
        @media print {
          body {
            padding: 20px;
          }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1>University Key Management System</h1>
        <p>Key Information Report - Designed by Hector Reyes & Oscar Melo</p>
      </div>

      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Key Code</span>
          <span class="info-value">${t.key_code||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Campus</span>
          <span class="info-value">${t.campus||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Building</span>
          <span class="info-value">${t.building||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Room Number</span>
          <span class="info-value">${t.room_number||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Key System</span>
          <span class="info-value">${t.system||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Brand</span>
          <span class="info-value">${t.brand||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Bitting Code</span>
          <span class="info-value">${t.bitting||"N/A"}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Core Code</span>
          <span class="info-value">${t.core_code||"N/A"}</span>
        </div>
      </div>

      ${e?`
        <div style="margin: 40px 0;">
          <h2 style="text-align: center; color: #1e293b; margin-bottom: 20px;">Medeco Pin Configuration</h2>
          ${FR(r)}
        </div>
      `:""}

      ${t.notes?`
        <div class="notes-section">
          <h3>Notes</h3>
          <p>${t.notes}</p>
        </div>
      `:""}

      <div style="margin-top: 60px; padding-top: 20px; border-top: 1px solid #e2e8f0; text-align: center; color: #94a3b8; font-size: 12px;">
        <p>Printed on ${new Date().toLocaleString()}</p>
        <p>University Key Management System -  2025 Hector Reyes & Oscar Melo</p>
      </div>
    </body>
    </html>
  `,s=window.open("","_blank");s&&(s.document.write(n),s.document.close(),s.focus(),setTimeout(()=>{s.print()},250))}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yu={};yu.version="0.18.5";var G_=1252,BR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],W_=function(t){BR.indexOf(t)!=-1&&(G_=t)};function HR(){W_(1252)}var ol=function(t){W_(t)};function zR(){ol(1200),HR()}var dc=function(e){return String.fromCharCode(e)},kv=function(e){return String.fromCharCode(e)},ti,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ll(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),i=r>>2,n=t.charCodeAt(u++),a=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Cs.charAt(i)+Cs.charAt(a)+Cs.charAt(o)+Cs.charAt(l);return e}function os(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)i=Cs.indexOf(t.charAt(u++)),a=Cs.indexOf(t.charAt(u++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Cs.indexOf(t.charAt(u++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Cs.indexOf(t.charAt(u++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),us=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function _i(t){return ze?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Iv(t){return ze?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var fn=function(e){return ze?us(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function pd(t){if(typeof ArrayBuffer>"u")return fn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function kl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function $R(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Gt=ze?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:us(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function KR(t){for(var e=[],r=0,n=t.length+250,s=_i(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=_i(65535),n=65530)}return e.push(s.slice(0,r)),Gt(e)}var Lo=/\u0000/g,hc=/[\u0001-\u0006]/g;function Ea(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function pn(t,e){var r=""+t;return r.length>=e?r:gt("0",e-r.length)+r}function Fp(t,e){var r=""+t;return r.length>=e?r:gt(" ",e-r.length)+r}function wu(t,e){var r=""+t;return r.length>=e?r:r+gt(" ",e-r.length)}function GR(t,e){var r=""+Math.round(t);return r.length>=e?r:gt("0",e-r.length)+r}function WR(t,e){var r=""+t;return r.length>=e?r:gt("0",e-r.length)+r}var Nv=Math.pow(2,32);function $i(t,e){if(t>Nv||t<-Nv)return GR(t,e);var r=Math.round(t);return WR(r,e)}function _u(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Rv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function VR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Ov={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Eu(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,u=0,d=0,h=Math.floor(s);u<e&&(h=Math.floor(s),o=h*a+i,d=h*u+l,!(s-h<5e-8));)s=1/(s-h),i=a,a=o,l=u,u=d;if(d>e&&(u>e?(d=l,o=i):(d=u,o=a)),!r)return[0,n*o,d];var f=Math.floor(n*o/d);return[f,n*o-f*d,d]}function fc(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=tO(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var V_=new Date(1899,11,31,0,0,0),YR=V_.getTime(),QR=new Date(1900,2,1,0,0,0);function q_(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=QR&&(r+=24*60*60*1e3),(r-(YR+(t.getTimezoneOffset()-V_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Up(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function XR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function JR(t){var e=t<0?12:11,r=Up(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function ZR(t){var e=Up(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function eO(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=JR(t):e===10?r=t.toFixed(10).substr(0,12):r=ZR(t),Up(XR(r.toUpperCase()))}function Gf(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):eO(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Us(14,q_(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rO(t,e,r,n){var s="",i=0,a=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return fh[r.m-1][1];case 5:return fh[r.m-1][0];default:return fh[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return Rv[r.q][0];default:return Rv[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?pn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=pn(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?pn(l,u):"";return d}function Ss(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var Y_=/%/g;function nO(t,e,r){var n=e.replace(Y_,""),s=e.length-n.length;return Zn(t,n,r*Math.pow(10,2*s))+gt("%",s)}function sO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Q_(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Q_(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var X_=/# (\?+)( ?)\/( ?)(\d+)/;function iO(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?gt(" ",t[1].length+1+t[4].length):Fp(a,t[1].length)+t[2]+"/"+t[3]+pn(o,t[4].length))}function aO(t,e,r){return r+(e===0?"":""+e)+gt(" ",t[1].length+2+t[4].length)}var J_=/^#*0*\.([0#]+)/,Z_=/\).*[0#]/,eE=/\(###\) ###\\?-####/;function ur(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Pv(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Lv(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function oO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function lO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Kr(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Z_)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Kr("n",n,r):"("+Kr("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return sO(t,e,r);if(e.indexOf("%")!==-1)return nO(t,e,r);if(e.indexOf("E")!==-1)return Q_(e,r);if(e.charCodeAt(0)===36)return"$"+Kr(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+$i(l,e.length);if(e.match(/^[#?]+$/))return s=$i(r,0),s==="0"&&(s=""),s.length>e.length?s:ur(e.substr(0,e.length-s.length))+s;if(i=e.match(X_))return iO(i,l,u);if(e.match(/^#+0+$/))return u+$i(l,e.length-e.indexOf("0"));if(i=e.match(J_))return s=Pv(r,i[1].length).replace(/^([^\.]+)$/,"$1."+ur(i[1])).replace(/\.$/,"."+ur(i[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+gt("0",ur(i[1]).length-m.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+Pv(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+Ss($i(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Kr(t,e,-r):Ss(""+(Math.floor(r)+oO(r,i[1].length)))+"."+pn(Lv(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Kr(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ea(Kr(t,e.replace(/[\\-]/g,""),r)),a=0,Ea(Ea(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(eE))return s=Kr(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Eu(l,Math.pow(10,a)-1,!1),s=""+u,d=Zn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=wu(o[2],a),d.length<i[4].length&&(d=ur(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Eu(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fp(o[1],a)+i[2]+"/"+i[3]+wu(o[2],a):gt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=$i(r,0),e.length<=s.length?s:ur(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,f=e.length-s.length-h;return ur(e.substr(0,h)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Lv(r,i[1].length),r<0?"-"+Kr(t,e,-r):Ss(lO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pn(0,3-g.length):"")+g})+"."+pn(a,i[1].length);switch(e){case"###,##0.00":return Kr(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Ss($i(l,0));return p!=="0"?u+p:"";case"###,###.00":return Kr(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Kr(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Zn(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function uO(t,e,r){var n=e.replace(Y_,""),s=e.length-n.length;return Zn(t,n,r*Math.pow(10,2*s))+gt("%",s)}function tE(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+tE(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+i)%s)+"."+d.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Sn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Z_)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sn("n",n,r):"("+Sn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cO(t,e,r);if(e.indexOf("%")!==-1)return uO(t,e,r);if(e.indexOf("E")!==-1)return tE(e,r);if(e.charCodeAt(0)===36)return"$"+Sn(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+pn(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:ur(e.substr(0,e.length-s.length))+s;if(i=e.match(X_))return aO(i,l,u);if(e.match(/^#+0+$/))return u+pn(l,e.length-e.indexOf("0"));if(i=e.match(J_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ur(i[1])).replace(/\.$/,"."+ur(i[1])),s=s.replace(/\.(\d*)$/,function(g,m){return"."+m+gt("0",ur(i[1]).length-m.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return u+Ss(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sn(t,e,-r):Ss(""+r)+"."+gt("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Sn(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Ea(Sn(t,e.replace(/[\\-]/g,""),r)),a=0,Ea(Ea(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(eE))return s=Sn(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Eu(l,Math.pow(10,a)-1,!1),s=""+u,d=Zn("n",i[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+i[2]+"/"+i[3],d=wu(o[2],a),d.length<i[4].length&&(d=ur(i[4].substr(i[4].length-d.length))+d),s+=d,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Eu(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Fp(o[1],a)+i[2]+"/"+i[3]+wu(o[2],a):gt(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:ur(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var h=e.indexOf(".")-a,f=e.length-s.length-h;return ur(e.substr(0,h)+s+e.substr(e.length-f))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Sn(t,e,-r):Ss(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pn(0,3-g.length):"")+g})+"."+pn(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Ss(""+l);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return Sn(t,e.slice(0,e.lastIndexOf(".")),r)+ur(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Zn(t,e,r){return(r|0)===r?Sn(t,e,r):Kr(t,e,r)}function dO(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var rE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nE(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":_u(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(rE))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function hO(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",u,d,h,f="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!_u(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(h=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(h);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(u==null&&(u=fc(e,r,t.charAt(a+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=fc(e,r),u==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=f),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=fc(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",f="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",a+=5,f="h"):t.substr(a,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",a+=5,f="h"):(m.t="t",++a),u==null&&m.t==="T")return"";s[s.length]=m,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(rE)){if(u==null&&(u=fc(e,r),u==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",nE(t)||(s[s.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var w=0,v=0,y;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=f,l="h",w<1&&(w=1);break;case"s":(y=s[a].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[a].v.match(/[Hh]/)&&(w=1),w<2&&s[a].v.match(/[Mm]/)&&(w=2),w<3&&s[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",_;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=rO(s[a].t.charCodeAt(0),s[a].v,u,v),s[a].t="t";break;case"n":case"?":for(_=a+1;s[_]!=null&&((o=s[_].t)==="?"||o==="D"||(o===" "||o==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[a].v+=s[_].v,s[_]={v:"",t:";"},++_;x+=s[a].v,a=_-1;break;case"G":s[a].t="t",s[a].v=Gf(e,r);break}var P="",S,T;if(x.length>0){x.charCodeAt(0)==40?(S=e<0&&x.charCodeAt(0)===45?-e:e,T=Zn("n",x,S)):(S=e<0&&n>1?-e:e,T=Zn("n",x,S),S<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),_=T.length-1;var O=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){O=a;break}var L=s.length;if(O===s.length&&T.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(_>=s[a].v.length-1?(_-=s[a].v.length,s[a].v=T.substr(_+1,s[a].v.length)):_<0?s[a].v="":(s[a].v=T.substr(0,_+1),_=-1),s[a].t="t",L=a);_>=0&&L<s.length&&(s[L].v=T.substr(0,_+1)+s[L].v)}else if(O!==s.length&&T.indexOf("E")===-1){for(_=T.indexOf(".")-1,a=O;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(d=s[a].v.indexOf(".")>-1&&a===O?s[a].v.indexOf(".")-1:s[a].v.length-1,P=s[a].v.substr(d+1);d>=0;--d)_>=0&&(s[a].v.charAt(d)==="0"||s[a].v.charAt(d)==="#")&&(P=T.charAt(_--)+P);s[a].v=P,s[a].t="t",L=a}for(_>=0&&L<s.length&&(s[L].v=T.substr(0,_+1)+s[L].v),_=T.indexOf(".")+1,a=O;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==O)){for(d=s[a].v.indexOf(".")>-1&&a===O?s[a].v.indexOf(".")+1:0,P=s[a].v.substr(0,d);d<s[a].v.length;++d)_<T.length&&(P+=T.charAt(_++));s[a].v=P,s[a].t="t",L=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(S=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=Zn(s[a].t,s[a].v,S),s[a].t="t");var j="";for(a=0;a!==s.length;++a)s[a]!=null&&(j+=s[a].v);return j}var jv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Mv(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function fO(t,e){var r=dO(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(jv),o=r[1].match(jv);return Mv(e,a)?[n,r[0]]:Mv(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Us(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:vt)[t],n==null&&(n=r.table&&r.table[Ov[t]]||vt[Ov[t]]),n==null&&(n=qR[t]||"General");break}if(_u(n,0))return Gf(e,r);e instanceof Date&&(e=q_(e,r.date1904));var s=fO(n,e);if(_u(s[1]))return Gf(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return hO(s[1],e,r,s[0])}function sE(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(vt[r]==null){e<0&&(e=r);continue}if(vt[r]==t){e=r;break}}e<0&&(e=391)}return vt[e]=t,e}function md(t){for(var e=0;e!=392;++e)t[e]!==void 0&&sE(t[e],e)}function gd(){vt=VR()}var iE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pO(t){var e=typeof t=="number"?vt[t]:t;return e=e.replace(iE,"(\\d+)"),new RegExp("^"+e+"$")}function mO(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(iE)||[]).forEach(function(h,f){var p=parseInt(r[f+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&i==-1?d:u+"T"+d}var gO=function(){var t={};t.version="1.2.0";function e(){for(var T=0,O=new Array(256),L=0;L!=256;++L)T=L,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,O[L]=T;return typeof Int32Array<"u"?new Int32Array(O):O}var r=e();function n(T){var O=0,L=0,j=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)G[j]=T[j];for(j=0;j!=256;++j)for(L=T[j],O=256+j;O<4096;O+=256)L=G[O]=L>>>8^T[L&255];var W=[];for(j=1;j!=16;++j)W[j-1]=typeof Int32Array<"u"?G.subarray(j*256,j*256+256):G.slice(j*256,j*256+256);return W}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],u=s[4],d=s[5],h=s[6],f=s[7],p=s[8],g=s[9],m=s[10],w=s[11],v=s[12],y=s[13],x=s[14];function _(T,O){for(var L=O^-1,j=0,G=T.length;j<G;)L=L>>>8^r[(L^T.charCodeAt(j++))&255];return~L}function P(T,O){for(var L=O^-1,j=T.length-15,G=0;G<j;)L=x[T[G++]^L&255]^y[T[G++]^L>>8&255]^v[T[G++]^L>>16&255]^w[T[G++]^L>>>24]^m[T[G++]]^g[T[G++]]^p[T[G++]]^f[T[G++]]^h[T[G++]]^d[T[G++]]^u[T[G++]]^l[T[G++]]^o[T[G++]]^a[T[G++]]^i[T[G++]]^r[T[G++]];for(j+=15;G<j;)L=L>>>8^r[(L^T[G++])&255];return~L}function S(T,O){for(var L=O^-1,j=0,G=T.length,W=0,re=0;j<G;)W=T.charCodeAt(j++),W<128?L=L>>>8^r[(L^W)&255]:W<2048?(L=L>>>8^r[(L^(192|W>>6&31))&255],L=L>>>8^r[(L^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,re=T.charCodeAt(j++)&1023,L=L>>>8^r[(L^(240|W>>8&7))&255],L=L>>>8^r[(L^(128|W>>2&63))&255],L=L>>>8^r[(L^(128|re>>6&15|(W&3)<<4))&255],L=L>>>8^r[(L^(128|re&63))&255]):(L=L>>>8^r[(L^(224|W>>12&15))&255],L=L>>>8^r[(L^(128|W>>6&63))&255],L=L>>>8^r[(L^(128|W&63))&255]);return~L}return t.table=r,t.bstr=_,t.buf=P,t.str=S,t}(),Qe=function(){var e={};e.version="1.2.1";function r(E,b){for(var C=E.split("/"),A=b.split("/"),k=0,I=0,H=Math.min(C.length,A.length);k<H;++k){if(I=C[k].length-A[k].length)return I;if(C[k]!=A[k])return C[k]<A[k]?-1:1}return C.length-A.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var b=E.lastIndexOf("/");return b===-1?E:E.slice(0,b+1)}function s(E){if(E.charAt(E.length-1)=="/")return s(E.slice(0,-1));var b=E.lastIndexOf("/");return b===-1?E:E.slice(b+1)}function i(E,b){typeof b=="string"&&(b=new Date(b));var C=b.getHours();C=C<<6|b.getMinutes(),C=C<<5|b.getSeconds()>>>1,E.write_shift(2,C);var A=b.getFullYear()-1980;A=A<<4|b.getMonth()+1,A=A<<5|b.getDate(),E.write_shift(2,A)}function a(E){var b=E.read_shift(2)&65535,C=E.read_shift(2)&65535,A=new Date,k=C&31;C>>>=5;var I=C&15;C>>>=4,A.setMilliseconds(0),A.setFullYear(C+1980),A.setMonth(I-1),A.setDate(k);var H=b&31;b>>>=5;var Q=b&63;return b>>>=6,A.setHours(b),A.setMinutes(Q),A.setSeconds(H<<1),A}function o(E){Rr(E,0);for(var b={},C=0;E.l<=E.length-4;){var A=E.read_shift(2),k=E.read_shift(2),I=E.l+k,H={};switch(A){case 21589:C=E.read_shift(1),C&1&&(H.mtime=E.read_shift(4)),k>5&&(C&2&&(H.atime=E.read_shift(4)),C&4&&(H.ctime=E.read_shift(4))),H.mtime&&(H.mt=new Date(H.mtime*1e3));break}E.l=I,b[A]=H}return b}var l;function u(){return l||(l={})}function d(E,b){if(E[0]==80&&E[1]==75)return fm(E,b);if((E[0]|32)==109&&(E[1]|32)==105)return jT(E,b);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var C=3,A=512,k=0,I=0,H=0,Q=0,B=0,z=[],K=E.slice(0,512);Rr(K,0);var oe=h(K);switch(C=oe[0],C){case 3:A=512;break;case 4:A=4096;break;case 0:if(oe[1]==0)return fm(E,b);default:throw new Error("Major Version: Expected 3 or 4 saw "+C)}A!==512&&(K=E.slice(0,A),Rr(K,28));var pe=E.slice(0,A);f(K,C);var ye=K.read_shift(4,"i");if(C===3&&ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ye);K.l+=4,H=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),Q=K.read_shift(4,"i"),k=K.read_shift(4,"i"),B=K.read_shift(4,"i"),I=K.read_shift(4,"i");for(var ce=-1,ge=0;ge<109&&(ce=K.read_shift(4,"i"),!(ce<0));++ge)z[ge]=ce;var Re=p(E,A);w(B,I,Re,A,z);var ct=y(Re,H,z,A);ct[H].name="!Directory",k>0&&Q!==re&&(ct[Q].name="!MiniFAT"),ct[z[0]].name="!FAT",ct.fat_addrs=z,ct.ssz=A;var ut={},Xt=[],Ja=[],Za=[];x(H,ct,Re,Xt,k,ut,Ja,Q),g(Ja,Za,Xt),Xt.shift();var eo={FileIndex:Ja,FullPaths:Za};return b&&b.raw&&(eo.raw={header:pe,sectors:Re}),eo}function h(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(te,"Header Signature: "),E.l+=16;var b=E.read_shift(2,"u");return[E.read_shift(2,"u"),b]}function f(E,b){var C=9;switch(E.l+=2,C=E.read_shift(2)){case 9:if(b!=3)throw new Error("Sector Shift: Expected 9 saw "+C);break;case 12:if(b!=4)throw new Error("Sector Shift: Expected 12 saw "+C);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+C)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function p(E,b){for(var C=Math.ceil(E.length/b)-1,A=[],k=1;k<C;++k)A[k-1]=E.slice(k*b,(k+1)*b);return A[C-1]=E.slice(C*b),A}function g(E,b,C){for(var A=0,k=0,I=0,H=0,Q=0,B=C.length,z=[],K=[];A<B;++A)z[A]=K[A]=A,b[A]=C[A];for(;Q<K.length;++Q)A=K[Q],k=E[A].L,I=E[A].R,H=E[A].C,z[A]===A&&(k!==-1&&z[k]!==k&&(z[A]=z[k]),I!==-1&&z[I]!==I&&(z[A]=z[I])),H!==-1&&(z[H]=A),k!==-1&&A!=z[A]&&(z[k]=z[A],K.lastIndexOf(k)<Q&&K.push(k)),I!==-1&&A!=z[A]&&(z[I]=z[A],K.lastIndexOf(I)<Q&&K.push(I));for(A=1;A<B;++A)z[A]===A&&(I!==-1&&z[I]!==I?z[A]=z[I]:k!==-1&&z[k]!==k&&(z[A]=z[k]));for(A=1;A<B;++A)if(E[A].type!==0){if(Q=A,Q!=z[Q])do Q=z[Q],b[A]=b[Q]+"/"+b[A];while(Q!==0&&z[Q]!==-1&&Q!=z[Q]);z[A]=-1}for(b[0]+="/",A=1;A<B;++A)E[A].type!==2&&(b[A]+="/")}function m(E,b,C){for(var A=E.start,k=E.size,I=[],H=A;C&&k>0&&H>=0;)I.push(b.slice(H*W,H*W+W)),k-=W,H=ri(C,H*4);return I.length===0?q(0):Gt(I).slice(0,E.size)}function w(E,b,C,A,k){var I=re;if(E===re){if(b!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var H=C[E],Q=(A>>>2)-1;if(!H)return;for(var B=0;B<Q&&(I=ri(H,B*4))!==re;++B)k.push(I);w(ri(H,A-4),b-1,C,A,k)}}function v(E,b,C,A,k){var I=[],H=[];k||(k=[]);var Q=A-1,B=0,z=0;for(B=b;B>=0;){k[B]=!0,I[I.length]=B,H.push(E[B]);var K=C[Math.floor(B*4/A)];if(z=B*4&Q,A<4+z)throw new Error("FAT boundary crossed: "+B+" 4 "+A);if(!E[K])break;B=ri(E[K],z)}return{nodes:I,data:Kv([H])}}function y(E,b,C,A){var k=E.length,I=[],H=[],Q=[],B=[],z=A-1,K=0,oe=0,pe=0,ye=0;for(K=0;K<k;++K)if(Q=[],pe=K+b,pe>=k&&(pe-=k),!H[pe]){B=[];var ce=[];for(oe=pe;oe>=0;){ce[oe]=!0,H[oe]=!0,Q[Q.length]=oe,B.push(E[oe]);var ge=C[Math.floor(oe*4/A)];if(ye=oe*4&z,A<4+ye)throw new Error("FAT boundary crossed: "+oe+" 4 "+A);if(!E[ge]||(oe=ri(E[ge],ye),ce[oe]))break}I[pe]={nodes:Q,data:Kv([B])}}return I}function x(E,b,C,A,k,I,H,Q){for(var B=0,z=A.length?2:0,K=b[E].data,oe=0,pe=0,ye;oe<K.length;oe+=128){var ce=K.slice(oe,oe+128);Rr(ce,64),pe=ce.read_shift(2),ye=Kp(ce,0,pe-z),A.push(ye);var ge={name:ye,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},Re=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Re!==0&&(ge.ct=_(ce,ce.l-8));var ct=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);ct!==0&&(ge.mt=_(ce,ce.l-8)),ge.start=ce.read_shift(4,"i"),ge.size=ce.read_shift(4,"i"),ge.size<0&&ge.start<0&&(ge.size=ge.type=0,ge.start=re,ge.name=""),ge.type===5?(B=ge.start,k>0&&B!==re&&(b[B].name="!StreamData")):ge.size>=4096?(ge.storage="fat",b[ge.start]===void 0&&(b[ge.start]=v(C,ge.start,b.fat_addrs,b.ssz)),b[ge.start].name=ge.name,ge.content=b[ge.start].data.slice(0,ge.size)):(ge.storage="minifat",ge.size<0?ge.size=0:B!==re&&ge.start!==re&&b[B]&&(ge.content=m(ge,b[B].data,(b[Q]||{}).data))),ge.content&&Rr(ge.content,0),I[ye]=ge,H.push(ge)}}function _(E,b){return new Date((Lr(E,b+4)/1e7*Math.pow(2,32)+Lr(E,b)/1e7-11644473600)*1e3)}function P(E,b){return u(),d(l.readFileSync(E),b)}function S(E,b){var C=b&&b.type;switch(C||ze&&Buffer.isBuffer(E)&&(C="buffer"),C||"base64"){case"file":return P(E,b);case"base64":return d(fn(os(E)),b);case"binary":return d(fn(E),b)}return d(E,b)}function T(E,b){var C=b||{},A=C.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=A+"/",E.FileIndex[0]={name:A,type:5}),C.CLSID&&(E.FileIndex[0].clsid=C.CLSID),O(E)}function O(E){var b="Sh33tJ5";if(!Qe.find(E,"/"+b)){var C=q(4);C[0]=55,C[1]=C[3]=50,C[2]=54,E.FileIndex.push({name:b,type:2,content:C,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+b),L(E)}}function L(E,b){T(E);for(var C=!1,A=!1,k=E.FullPaths.length-1;k>=0;--k){var I=E.FileIndex[k];switch(I.type){case 0:A?C=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:A=!0,isNaN(I.R*I.L*I.C)&&(C=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(C=!0);break;default:C=!0;break}}if(!(!C&&!b)){var H=new Date(1987,1,19),Q=0,B=Object.create?Object.create(null):{},z=[];for(k=0;k<E.FullPaths.length;++k)B[E.FullPaths[k]]=!0,E.FileIndex[k].type!==0&&z.push([E.FullPaths[k],E.FileIndex[k]]);for(k=0;k<z.length;++k){var K=n(z[k][0]);A=B[K],A||(z.push([K,{name:s(K).replace("/",""),type:1,clsid:ne,ct:H,mt:H,content:null}]),B[K]=!0)}for(z.sort(function(ye,ce){return r(ye[0],ce[0])}),E.FullPaths=[],E.FileIndex=[],k=0;k<z.length;++k)E.FullPaths[k]=z[k][0],E.FileIndex[k]=z[k][1];for(k=0;k<z.length;++k){var oe=E.FileIndex[k],pe=E.FullPaths[k];if(oe.name=s(pe).replace("/",""),oe.L=oe.R=oe.C=-(oe.color=1),oe.size=oe.content?oe.content.length:0,oe.start=0,oe.clsid=oe.clsid||ne,k===0)oe.C=z.length>1?1:-1,oe.size=0,oe.type=5;else if(pe.slice(-1)=="/"){for(Q=k+1;Q<z.length&&n(E.FullPaths[Q])!=pe;++Q);for(oe.C=Q>=z.length?-1:Q,Q=k+1;Q<z.length&&n(E.FullPaths[Q])!=n(pe);++Q);oe.R=Q>=z.length?-1:Q,oe.type=1}else n(E.FullPaths[k+1]||"")==n(pe)&&(oe.R=k+1),oe.type=2}}}function j(E,b){var C=b||{};if(C.fileType=="mad")return MT(E,C);switch(L(E),C.fileType){case"zip":return IT(E,C)}var A=function(ye){for(var ce=0,ge=0,Re=0;Re<ye.FileIndex.length;++Re){var ct=ye.FileIndex[Re];if(ct.content){var ut=ct.content.length;ut>0&&(ut<4096?ce+=ut+63>>6:ge+=ut+511>>9)}}for(var Xt=ye.FullPaths.length+3>>2,Ja=ce+7>>3,Za=ce+127>>7,eo=Ja+ge+Xt+Za,qs=eo+127>>7,Sd=qs<=109?0:Math.ceil((qs-109)/127);eo+qs+Sd+127>>7>qs;)Sd=++qs<=109?0:Math.ceil((qs-109)/127);var Un=[1,Sd,qs,Za,Xt,ge,ce,0];return ye.FileIndex[0].size=ce<<6,Un[7]=(ye.FileIndex[0].start=Un[0]+Un[1]+Un[2]+Un[3]+Un[4]+Un[5])+(Un[6]+7>>3),Un}(E),k=q(A[7]<<9),I=0,H=0;{for(I=0;I<8;++I)k.write_shift(1,me[I]);for(I=0;I<8;++I)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),I=0;I<3;++I)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,A[2]),k.write_shift(4,A[0]+A[1]+A[2]+A[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,A[3]?A[0]+A[1]+A[2]-1:re),k.write_shift(4,A[3]),k.write_shift(-4,A[1]?A[0]-1:re),k.write_shift(4,A[1]),I=0;I<109;++I)k.write_shift(-4,I<A[2]?A[1]+I:-1)}if(A[1])for(H=0;H<A[1];++H){for(;I<236+H*127;++I)k.write_shift(-4,I<A[2]?A[1]+I:-1);k.write_shift(-4,H===A[1]-1?re:H+1)}var Q=function(ye){for(H+=ye;I<H-1;++I)k.write_shift(-4,I+1);ye&&(++I,k.write_shift(-4,re))};for(H=I=0,H+=A[1];I<H;++I)k.write_shift(-4,Ce.DIFSECT);for(H+=A[2];I<H;++I)k.write_shift(-4,Ce.FATSECT);Q(A[3]),Q(A[4]);for(var B=0,z=0,K=E.FileIndex[0];B<E.FileIndex.length;++B)K=E.FileIndex[B],K.content&&(z=K.content.length,!(z<4096)&&(K.start=H,Q(z+511>>9)));for(Q(A[6]+7>>3);k.l&511;)k.write_shift(-4,Ce.ENDOFCHAIN);for(H=I=0,B=0;B<E.FileIndex.length;++B)K=E.FileIndex[B],K.content&&(z=K.content.length,!(!z||z>=4096)&&(K.start=H,Q(z+63>>6)));for(;k.l&511;)k.write_shift(-4,Ce.ENDOFCHAIN);for(I=0;I<A[4]<<2;++I){var oe=E.FullPaths[I];if(!oe||oe.length===0){for(B=0;B<17;++B)k.write_shift(4,0);for(B=0;B<3;++B)k.write_shift(4,-1);for(B=0;B<12;++B)k.write_shift(4,0);continue}K=E.FileIndex[I],I===0&&(K.start=K.size?K.start-1:re);var pe=I===0&&C.root||K.name;if(z=2*(pe.length+1),k.write_shift(64,pe,"utf16le"),k.write_shift(2,z),k.write_shift(1,K.type),k.write_shift(1,K.color),k.write_shift(-4,K.L),k.write_shift(-4,K.R),k.write_shift(-4,K.C),K.clsid)k.write_shift(16,K.clsid,"hex");else for(B=0;B<4;++B)k.write_shift(4,0);k.write_shift(4,K.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,K.start),k.write_shift(4,K.size),k.write_shift(4,0)}for(I=1;I<E.FileIndex.length;++I)if(K=E.FileIndex[I],K.size>=4096)if(k.l=K.start+1<<9,ze&&Buffer.isBuffer(K.content))K.content.copy(k,k.l,0,K.size),k.l+=K.size+511&-512;else{for(B=0;B<K.size;++B)k.write_shift(1,K.content[B]);for(;B&511;++B)k.write_shift(1,0)}for(I=1;I<E.FileIndex.length;++I)if(K=E.FileIndex[I],K.size>0&&K.size<4096)if(ze&&Buffer.isBuffer(K.content))K.content.copy(k,k.l,0,K.size),k.l+=K.size+63&-64;else{for(B=0;B<K.size;++B)k.write_shift(1,K.content[B]);for(;B&63;++B)k.write_shift(1,0)}if(ze)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function G(E,b){var C=E.FullPaths.map(function(B){return B.toUpperCase()}),A=C.map(function(B){var z=B.split("/");return z[z.length-(B.slice(-1)=="/"?2:1)]}),k=!1;b.charCodeAt(0)===47?(k=!0,b=C[0].slice(0,-1)+b):k=b.indexOf("/")!==-1;var I=b.toUpperCase(),H=k===!0?C.indexOf(I):A.indexOf(I);if(H!==-1)return E.FileIndex[H];var Q=!I.match(hc);for(I=I.replace(Lo,""),Q&&(I=I.replace(hc,"!")),H=0;H<C.length;++H)if((Q?C[H].replace(hc,"!"):C[H]).replace(Lo,"")==I||(Q?A[H].replace(hc,"!"):A[H]).replace(Lo,"")==I)return E.FileIndex[H];return null}var W=64,re=-2,te="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(E,b,C){u();var A=j(E,C);l.writeFileSync(b,A)}function fe(E){for(var b=new Array(E.length),C=0;C<E.length;++C)b[C]=String.fromCharCode(E[C]);return b.join("")}function Ee(E,b){var C=j(E,b);switch(b&&b.type||"buffer"){case"file":return u(),l.writeFileSync(b.filename,C),C;case"binary":return typeof C=="string"?C:fe(C);case"base64":return ll(typeof C=="string"?C:fe(C));case"buffer":if(ze)return Buffer.isBuffer(C)?C:us(C);case"array":return typeof C=="string"?fn(C):C}return C}var X;function N(E){try{var b=E.InflateRaw,C=new b;if(C._processChunk(new Uint8Array([3,0]),C._finishFlushFlag),C.bytesRead)X=E;else throw new Error("zlib does not expose bytesRead")}catch(A){console.error("cannot use native zlib: "+(A.message||A))}}function F(E,b){if(!X)return dm(E,b);var C=X.InflateRaw,A=new C,k=A._processChunk(E.slice(E.l),A._finishFlushFlag);return E.l+=A.bytesRead,k}function D(E){return X?X.deflateRawSync(E):im(E)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Se(E){var b=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(b>>16|b>>8|b)&255}for(var R=typeof Uint8Array<"u",ee=R?new Uint8Array(256):[],be=0;be<256;++be)ee[be]=Se(be);function ie(E,b){var C=ee[E&255];return b<=8?C>>>8-b:(C=C<<8|ee[E>>8&255],b<=16?C>>>16-b:(C=C<<8|ee[E>>16&255],C>>>24-b))}function Ne(E,b){var C=b&7,A=b>>>3;return(E[A]|(C<=6?0:E[A+1]<<8))>>>C&3}function ke(E,b){var C=b&7,A=b>>>3;return(E[A]|(C<=5?0:E[A+1]<<8))>>>C&7}function at(E,b){var C=b&7,A=b>>>3;return(E[A]|(C<=4?0:E[A+1]<<8))>>>C&15}function Be(E,b){var C=b&7,A=b>>>3;return(E[A]|(C<=3?0:E[A+1]<<8))>>>C&31}function ve(E,b){var C=b&7,A=b>>>3;return(E[A]|(C<=1?0:E[A+1]<<8))>>>C&127}function Pt(E,b,C){var A=b&7,k=b>>>3,I=(1<<C)-1,H=E[k]>>>A;return C<8-A||(H|=E[k+1]<<8-A,C<16-A)||(H|=E[k+2]<<16-A,C<24-A)||(H|=E[k+3]<<24-A),H&I}function ar(E,b,C){var A=b&7,k=b>>>3;return A<=5?E[k]|=(C&7)<<A:(E[k]|=C<<A&255,E[k+1]=(C&7)>>8-A),b+3}function Ar(E,b,C){var A=b&7,k=b>>>3;return C=(C&1)<<A,E[k]|=C,b+1}function zr(E,b,C){var A=b&7,k=b>>>3;return C<<=A,E[k]|=C&255,C>>>=8,E[k+1]=C,b+8}function ds(E,b,C){var A=b&7,k=b>>>3;return C<<=A,E[k]|=C&255,C>>>=8,E[k+1]=C&255,E[k+2]=C>>>8,b+16}function ji(E,b){var C=E.length,A=2*C>b?2*C:b+5,k=0;if(C>=b)return E;if(ze){var I=Iv(A);if(E.copy)E.copy(I);else for(;k<E.length;++k)I[k]=E[k];return I}else if(R){var H=new Uint8Array(A);if(H.set)H.set(E);else for(;k<C;++k)H[k]=E[k];return H}return E.length=A,E}function En(E){for(var b=new Array(E),C=0;C<E;++C)b[C]=0;return b}function Ll(E,b,C){var A=1,k=0,I=0,H=0,Q=0,B=E.length,z=R?new Uint16Array(32):En(32);for(I=0;I<32;++I)z[I]=0;for(I=B;I<C;++I)E[I]=0;B=E.length;var K=R?new Uint16Array(B):En(B);for(I=0;I<B;++I)z[k=E[I]]++,A<k&&(A=k),K[I]=0;for(z[0]=0,I=1;I<=A;++I)z[I+16]=Q=Q+z[I-1]<<1;for(I=0;I<B;++I)Q=E[I],Q!=0&&(K[I]=z[Q+16]++);var oe=0;for(I=0;I<B;++I)if(oe=E[I],oe!=0)for(Q=ie(K[I],A)>>A-oe,H=(1<<A+4-oe)-1;H>=0;--H)b[Q|H<<oe]=oe&15|I<<4;return A}var Ed=R?new Uint16Array(512):En(512),Td=R?new Uint16Array(32):En(32);if(!R){for(var Vs=0;Vs<512;++Vs)Ed[Vs]=0;for(Vs=0;Vs<32;++Vs)Td[Vs]=0}(function(){for(var E=[],b=0;b<32;b++)E.push(5);Ll(E,Td,32);var C=[];for(b=0;b<=143;b++)C.push(8);for(;b<=255;b++)C.push(9);for(;b<=279;b++)C.push(7);for(;b<=287;b++)C.push(8);Ll(C,Ed,288)})();var ST=function(){for(var b=R?new Uint8Array(32768):[],C=0,A=0;C<xe.length-1;++C)for(;A<xe[C+1];++A)b[A]=C;for(;A<32768;++A)b[A]=29;var k=R?new Uint8Array(259):[];for(C=0,A=0;C<J.length-1;++C)for(;A<J[C+1];++A)k[A]=C;function I(Q,B){for(var z=0;z<Q.length;){var K=Math.min(65535,Q.length-z),oe=z+K==Q.length;for(B.write_shift(1,+oe),B.write_shift(2,K),B.write_shift(2,~K&65535);K-- >0;)B[B.l++]=Q[z++]}return B.l}function H(Q,B){for(var z=0,K=0,oe=R?new Uint16Array(32768):[];K<Q.length;){var pe=Math.min(65535,Q.length-K);if(pe<10){for(z=ar(B,z,+(K+pe==Q.length)),z&7&&(z+=8-(z&7)),B.l=z/8|0,B.write_shift(2,pe),B.write_shift(2,~pe&65535);pe-- >0;)B[B.l++]=Q[K++];z=B.l*8;continue}z=ar(B,z,+(K+pe==Q.length)+2);for(var ye=0;pe-- >0;){var ce=Q[K];ye=(ye<<5^ce)&32767;var ge=-1,Re=0;if((ge=oe[ye])&&(ge|=K&-32768,ge>K&&(ge-=32768),ge<K))for(;Q[ge+Re]==Q[K+Re]&&Re<250;)++Re;if(Re>2){ce=k[Re],ce<=22?z=zr(B,z,ee[ce+1]>>1)-1:(zr(B,z,3),z+=5,zr(B,z,ee[ce-23]>>5),z+=3);var ct=ce<8?0:ce-4>>2;ct>0&&(ds(B,z,Re-J[ce]),z+=ct),ce=b[K-ge],z=zr(B,z,ee[ce]>>3),z-=3;var ut=ce<4?0:ce-2>>1;ut>0&&(ds(B,z,K-ge-xe[ce]),z+=ut);for(var Xt=0;Xt<Re;++Xt)oe[ye]=K&32767,ye=(ye<<5^Q[K])&32767,++K;pe-=Re-1}else ce<=143?ce=ce+48:z=Ar(B,z,1),z=zr(B,z,ee[ce]),oe[ye]=K&32767,++K}z=zr(B,z,0)-1}return B.l=(z+7)/8|0,B.l}return function(B,z){return B.length<8?I(B,z):H(B,z)}}();function im(E){var b=q(50+Math.floor(E.length*1.1)),C=ST(E,b);return b.slice(0,C)}var am=R?new Uint16Array(32768):En(32768),om=R?new Uint16Array(32768):En(32768),lm=R?new Uint16Array(128):En(128),cm=1,um=1;function AT(E,b){var C=Be(E,b)+257;b+=5;var A=Be(E,b)+1;b+=5;var k=at(E,b)+4;b+=4;for(var I=0,H=R?new Uint8Array(19):En(19),Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],B=1,z=R?new Uint8Array(8):En(8),K=R?new Uint8Array(8):En(8),oe=H.length,pe=0;pe<k;++pe)H[M[pe]]=I=ke(E,b),B<I&&(B=I),z[I]++,b+=3;var ye=0;for(z[0]=0,pe=1;pe<=B;++pe)K[pe]=ye=ye+z[pe-1]<<1;for(pe=0;pe<oe;++pe)(ye=H[pe])!=0&&(Q[pe]=K[ye]++);var ce=0;for(pe=0;pe<oe;++pe)if(ce=H[pe],ce!=0){ye=ee[Q[pe]]>>8-ce;for(var ge=(1<<7-ce)-1;ge>=0;--ge)lm[ye|ge<<ce]=ce&7|pe<<3}var Re=[];for(B=1;Re.length<C+A;)switch(ye=lm[ve(E,b)],b+=ye&7,ye>>>=3){case 16:for(I=3+Ne(E,b),b+=2,ye=Re[Re.length-1];I-- >0;)Re.push(ye);break;case 17:for(I=3+ke(E,b),b+=3;I-- >0;)Re.push(0);break;case 18:for(I=11+ve(E,b),b+=7;I-- >0;)Re.push(0);break;default:Re.push(ye),B<ye&&(B=ye);break}var ct=Re.slice(0,C),ut=Re.slice(C);for(pe=C;pe<286;++pe)ct[pe]=0;for(pe=A;pe<30;++pe)ut[pe]=0;return cm=Ll(ct,am,286),um=Ll(ut,om,30),b}function bT(E,b){if(E[0]==3&&!(E[1]&3))return[_i(b),2];for(var C=0,A=0,k=Iv(b||1<<18),I=0,H=k.length>>>0,Q=0,B=0;!(A&1);){if(A=ke(E,C),C+=3,A>>>1)A>>1==1?(Q=9,B=5):(C=AT(E,C),Q=cm,B=um);else{C&7&&(C+=8-(C&7));var z=E[C>>>3]|E[(C>>>3)+1]<<8;if(C+=32,z>0)for(!b&&H<I+z&&(k=ji(k,I+z),H=k.length);z-- >0;)k[I++]=E[C>>>3],C+=8;continue}for(;;){!b&&H<I+32767&&(k=ji(k,I+32767),H=k.length);var K=Pt(E,C,Q),oe=A>>>1==1?Ed[K]:am[K];if(C+=oe&15,oe>>>=4,!(oe>>>8&255))k[I++]=oe;else{if(oe==256)break;oe-=257;var pe=oe<8?0:oe-4>>2;pe>5&&(pe=0);var ye=I+J[oe];pe>0&&(ye+=Pt(E,C,pe),C+=pe),K=Pt(E,C,B),oe=A>>>1==1?Td[K]:om[K],C+=oe&15,oe>>>=4;var ce=oe<4?0:oe-2>>1,ge=xe[oe];for(ce>0&&(ge+=Pt(E,C,ce),C+=ce),!b&&H<ye&&(k=ji(k,ye+100),H=k.length);I<ye;)k[I]=k[I-ge],++I}}}return b?[k,C+7>>>3]:[k.slice(0,I),C+7>>>3]}function dm(E,b){var C=E.slice(E.l||0),A=bT(C,b);return E.l+=A[1],A[0]}function hm(E,b){if(E)typeof console<"u"&&console.error(b);else throw new Error(b)}function fm(E,b){var C=E;Rr(C,0);var A=[],k=[],I={FileIndex:A,FullPaths:k};T(I,{root:b.root});for(var H=C.length-4;(C[H]!=80||C[H+1]!=75||C[H+2]!=5||C[H+3]!=6)&&H>=0;)--H;C.l=H+4,C.l+=4;var Q=C.read_shift(2);C.l+=6;var B=C.read_shift(4);for(C.l=B,H=0;H<Q;++H){C.l+=20;var z=C.read_shift(4),K=C.read_shift(4),oe=C.read_shift(2),pe=C.read_shift(2),ye=C.read_shift(2);C.l+=8;var ce=C.read_shift(4),ge=o(C.slice(C.l+oe,C.l+oe+pe));C.l+=oe+pe+ye;var Re=C.l;C.l=ce+4,kT(C,z,K,I,ge),C.l=Re}return I}function kT(E,b,C,A,k){E.l+=2;var I=E.read_shift(2),H=E.read_shift(2),Q=a(E);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var B=E.read_shift(4),z=E.read_shift(4),K=E.read_shift(4),oe=E.read_shift(2),pe=E.read_shift(2),ye="",ce=0;ce<oe;++ce)ye+=String.fromCharCode(E[E.l++]);if(pe){var ge=o(E.slice(E.l,E.l+pe));(ge[21589]||{}).mt&&(Q=ge[21589].mt),((k||{})[21589]||{}).mt&&(Q=k[21589].mt)}E.l+=pe;var Re=E.slice(E.l,E.l+z);switch(H){case 8:Re=F(E,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+H)}var ct=!1;I&8&&(B=E.read_shift(4),B==134695760&&(B=E.read_shift(4),ct=!0),z=E.read_shift(4),K=E.read_shift(4)),z!=b&&hm(ct,"Bad compressed size: "+b+" != "+z),K!=C&&hm(ct,"Bad uncompressed size: "+C+" != "+K),Cd(A,ye,Re,{unsafe:!0,mt:Q})}function IT(E,b){var C=b||{},A=[],k=[],I=q(1),H=C.compression?8:0,Q=0,B=0,z=0,K=0,oe=0,pe=E.FullPaths[0],ye=pe,ce=E.FileIndex[0],ge=[],Re=0;for(B=1;B<E.FullPaths.length;++B)if(ye=E.FullPaths[B].slice(pe.length),ce=E.FileIndex[B],!(!ce.size||!ce.content||ye=="Sh33tJ5")){var ct=K,ut=q(ye.length);for(z=0;z<ye.length;++z)ut.write_shift(1,ye.charCodeAt(z)&127);ut=ut.slice(0,ut.l),ge[oe]=gO.buf(ce.content,0);var Xt=ce.content;H==8&&(Xt=D(Xt)),I=q(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,Q),I.write_shift(2,H),ce.mt?i(I,ce.mt):I.write_shift(4,0),I.write_shift(-4,ge[oe]),I.write_shift(4,Xt.length),I.write_shift(4,ce.content.length),I.write_shift(2,ut.length),I.write_shift(2,0),K+=I.length,A.push(I),K+=ut.length,A.push(ut),K+=Xt.length,A.push(Xt),I=q(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,Q),I.write_shift(2,H),I.write_shift(4,0),I.write_shift(-4,ge[oe]),I.write_shift(4,Xt.length),I.write_shift(4,ce.content.length),I.write_shift(2,ut.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,ct),Re+=I.l,k.push(I),Re+=ut.length,k.push(ut),++oe}return I=q(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,oe),I.write_shift(2,oe),I.write_shift(4,Re),I.write_shift(4,K),I.write_shift(2,0),Gt([Gt(A),Gt(k),I])}var jl={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function NT(E,b){if(E.ctype)return E.ctype;var C=E.name||"",A=C.match(/\.([^\.]+)$/);return A&&jl[A[1]]||b&&(A=(C=b).match(/[\.\\]([^\.\\])+$/),A&&jl[A[1]])?jl[A[1]]:"application/octet-stream"}function RT(E){for(var b=ll(E),C=[],A=0;A<b.length;A+=76)C.push(b.slice(A,A+76));return C.join(`\r
`)+`\r
`}function OT(E){var b=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var K=z.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});b=b.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),b.charAt(0)==`
`&&(b="=0D"+b.slice(1)),b=b.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var C=[],A=b.split(`\r
`),k=0;k<A.length;++k){var I=A[k];if(I.length==0){C.push("");continue}for(var H=0;H<I.length;){var Q=76,B=I.slice(H,H+Q);B.charAt(Q-1)=="="?Q--:B.charAt(Q-2)=="="?Q-=2:B.charAt(Q-3)=="="&&(Q-=3),B=I.slice(H,H+Q),H+=Q,H<I.length&&(B+="="),C.push(B)}}return C.join(`\r
`)}function PT(E){for(var b=[],C=0;C<E.length;++C){for(var A=E[C];C<=E.length&&A.charAt(A.length-1)=="=";)A=A.slice(0,A.length-1)+E[++C];b.push(A)}for(var k=0;k<b.length;++k)b[k]=b[k].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return fn(b.join(`\r
`))}function LT(E,b,C){for(var A="",k="",I="",H,Q=0;Q<10;++Q){var B=b[Q];if(!B||B.match(/^\s*$/))break;var z=B.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":A=z[2].trim();break;case"content-type":I=z[2].trim();break;case"content-transfer-encoding":k=z[2].trim();break}}switch(++Q,k.toLowerCase()){case"base64":H=fn(os(b.slice(Q).join("")));break;case"quoted-printable":H=PT(b.slice(Q));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var K=Cd(E,A.slice(C.length),H,{unsafe:!0});I&&(K.ctype=I)}function jT(E,b){if(fe(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var C=b&&b.root||"",A=(ze&&Buffer.isBuffer(E)?E.toString("binary"):fe(E)).split(`\r
`),k=0,I="";for(k=0;k<A.length;++k)if(I=A[k],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),C||(C=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,C.length)!=C))for(;C.length>0&&(C=C.slice(0,C.length-1),C=C.slice(0,C.lastIndexOf("/")+1),I.slice(0,C.length)!=C););var H=(A[1]||"").match(/boundary="(.*?)"/);if(!H)throw new Error("MAD cannot find boundary");var Q="--"+(H[1]||""),B=[],z=[],K={FileIndex:B,FullPaths:z};T(K);var oe,pe=0;for(k=0;k<A.length;++k){var ye=A[k];ye!==Q&&ye!==Q+"--"||(pe++&&LT(K,A.slice(oe,k),C),oe=k)}return K}function MT(E,b){var C=b||{},A=C.boundary||"SheetJS";A="------="+A;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+A.slice(2)+'"',"","",""],I=E.FullPaths[0],H=I,Q=E.FileIndex[0],B=1;B<E.FullPaths.length;++B)if(H=E.FullPaths[B].slice(I.length),Q=E.FileIndex[B],!(!Q.size||!Q.content||H=="Sh33tJ5")){H=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Re){return"_x"+Re.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Re){return"_u"+Re.charCodeAt(0).toString(16)+"_"});for(var z=Q.content,K=ze&&Buffer.isBuffer(z)?z.toString("binary"):fe(z),oe=0,pe=Math.min(1024,K.length),ye=0,ce=0;ce<=pe;++ce)(ye=K.charCodeAt(ce))>=32&&ye<128&&++oe;var ge=oe>=pe*4/5;k.push(A),k.push("Content-Location: "+(C.root||"file:///C:/SheetJS/")+H),k.push("Content-Transfer-Encoding: "+(ge?"quoted-printable":"base64")),k.push("Content-Type: "+NT(Q,H)),k.push(""),k.push(ge?OT(K):RT(K))}return k.push(A+`--\r
`),k.join(`\r
`)}function DT(E){var b={};return T(b,E),b}function Cd(E,b,C,A){var k=A&&A.unsafe;k||T(E);var I=!k&&Qe.find(E,b);if(!I){var H=E.FullPaths[0];b.slice(0,H.length)==H?H=b:(H.slice(-1)!="/"&&(H+="/"),H=(H+b).replace("//","/")),I={name:s(b),type:2},E.FileIndex.push(I),E.FullPaths.push(H),k||Qe.utils.cfb_gc(E)}return I.content=C,I.size=C?C.length:0,A&&(A.CLSID&&(I.clsid=A.CLSID),A.mt&&(I.mt=A.mt),A.ct&&(I.ct=A.ct)),I}function FT(E,b){T(E);var C=Qe.find(E,b);if(C){for(var A=0;A<E.FileIndex.length;++A)if(E.FileIndex[A]==C)return E.FileIndex.splice(A,1),E.FullPaths.splice(A,1),!0}return!1}function UT(E,b,C){T(E);var A=Qe.find(E,b);if(A){for(var k=0;k<E.FileIndex.length;++k)if(E.FileIndex[k]==A)return E.FileIndex[k].name=s(C),E.FullPaths[k]=C,!0}return!1}function BT(E){L(E,!0)}return e.find=G,e.read=S,e.parse=d,e.write=Ee,e.writeFile=se,e.utils={cfb_new:DT,cfb_add:Cd,cfb_del:FT,cfb_mov:UT,cfb_gc:BT,ReadShift:Mo,CheckField:TE,prep_blob:Rr,bconcat:Gt,use_zlib:N,_deflateRaw:im,_inflateRaw:dm,consts:Ce},e}();function vO(t){return typeof t=="string"?pd(t):Array.isArray(t)?$R(t):t}function Il(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=pd(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ul(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([vO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=i,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=kl(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function Qt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Dv(t,e){for(var r=[],n=Qt(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Bp(t){for(var e=[],r=Qt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function vd(t){for(var e=[],r=Qt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function xO(t){for(var e=[],r=Qt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Tu=new Date(1899,11,30,0,0,0);function Cr(t,e){var r=t.getTime(),n=Tu.getTime()+(t.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var aE=new Date,yO=Tu.getTime()+(aE.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4,Fv=aE.getTimezoneOffset();function oE(t){var e=new Date;return e.setTime(t*24*60*60*1e3+yO),e.getTimezoneOffset()!==Fv&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Fv)*6e4),e}var Uv=new Date("2017-02-19T19:06:09.000Z"),lE=isNaN(Uv.getFullYear())?new Date("2/19/17"):Uv,wO=lE.getFullYear()==2017;function fr(t,e){var r=new Date(t);if(wO)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(lE.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function xd(t,e){if(ze&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Sr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Sr(t[r]));return e}function gt(t,e){for(var r="";r.length<e;)r+=t;return r}function es(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var _O=["january","february","march","april","may","june","july","august","september","october","november","december"];function cl(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&_O.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Le(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return ze?n=us(r):n=KR(r),Qe.utils.cfb_add(t,e,n)}Qe.utils.cfb_add(t,e,r)}else t.file(e,r)}function Hp(){return Qe.utils.cfb_new()}var At=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,EO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zp=Bp(EO),$p=/[&<>'"]/g,TO=/[\u0000-\u0008\u000b-\u001f]/g;function We(t){var e=t+"";return e.replace($p,function(r){return zp[r]}).replace(TO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bv(t){return We(t).replace(/ /g,"_x0020_")}var cE=/[\u0000-\u001f]/g;function CO(t){var e=t+"";return e.replace($p,function(r){return zp[r]}).replace(/\n/g,"<br/>").replace(cE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function SO(t){var e=t+"";return e.replace($p,function(r){return zp[r]}).replace(cE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function AO(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function bO(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ph(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Hv(t){var e=_i(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function zv(t){return us(t,"binary").toString("utf8")}var pc="foo bar baz",jo=ze&&(zv(pc)==ph(pc)&&zv||Hv(pc)==ph(pc)&&Hv)||ph,ul=ze?function(t){return us(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},kO=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),uE=/(^\s|\s$|\n)/;function Wt(t,e){return"<"+t+(e.match(uE)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function dl(t){return Qt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ue(t,e,r){return"<"+t+(r!=null?dl(r):"")+(e!=null?(e.match(uE)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Wf(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function IO(t,e){switch(typeof t){case"string":var r=ue("vt:lpwstr",We(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ue((t|0)==t?"vt:i4":"vt:r8",We(String(t)));case"boolean":return ue("vt:bool",t?"true":"false")}if(t instanceof Date)return ue("vt:filetime",Wf(t));throw new Error("Unable to serialize "+t)}var Dt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Pr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function NO(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function RO(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var $v=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Kv=ze?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:us(e)})):$v(t)}:$v,Gv=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(xo(t,s)));return n.join("").replace(Lo,"")},Kp=ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Lo,""):Gv(t,e,r)}:Gv,Wv=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},dE=ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Wv(t,e,r)}:Wv,Vv=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Xi(t,s)));return n.join("")},Nl=ze?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Vv(e,r,n)}:Vv,hE=function(t,e){var r=Lr(t,e);return r>0?Nl(t,e+4,e+4+r-1):""},fE=hE,pE=function(t,e){var r=Lr(t,e);return r>0?Nl(t,e+4,e+4+r-1):""},mE=pE,gE=function(t,e){var r=2*Lr(t,e);return r>0?Nl(t,e+4,e+4+r-1):""},vE=gE,xE=function(e,r){var n=Lr(e,r);return n>0?Kp(e,r+4,r+4+n):""},yE=xE,wE=function(t,e){var r=Lr(t,e);return r>0?Nl(t,e+4,e+4+r):""},_E=wE,EE=function(t,e){return NO(t,e)},Cu=EE,Gp=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};ze&&(fE=function(e,r){if(!Buffer.isBuffer(e))return hE(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},mE=function(e,r){if(!Buffer.isBuffer(e))return pE(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},vE=function(e,r){if(!Buffer.isBuffer(e))return gE(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},yE=function(e,r){if(!Buffer.isBuffer(e))return xE(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},_E=function(e,r){if(!Buffer.isBuffer(e))return wE(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Cu=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):EE(e,r)},Gp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xi=function(t,e){return t[e]},xo=function(t,e){return t[e+1]*256+t[e]},OO=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Lr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},ri=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},PO=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Mo(t,e){var r="",n,s,i=[],a,o,l,u;switch(e){case"dbcs":if(u=this.l,ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(xo(this,u)),u+=2;t*=2;break;case"utf8":r=Nl(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Kp(this,this.l,this.l+t);break;case"wstr":return Mo.call(this,t,"dbcs");case"lpstr-ansi":r=fE(this,this.l),t=4+Lr(this,this.l);break;case"lpstr-cp":r=mE(this,this.l),t=4+Lr(this,this.l);break;case"lpwstr":r=vE(this,this.l),t=4+2*Lr(this,this.l);break;case"lpp4":t=4+Lr(this,this.l),r=yE(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Lr(this,this.l),r=_E(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Xi(this,this.l+t++))!==0;)i.push(dc(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=xo(this,this.l+t))!==0;)i.push(dc(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Xi(this,u),this.l=u+1,o=Mo.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(dc(xo(this,u))),u+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=Xi(this,u),this.l=u+1,o=Mo.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(dc(Xi(this,u))),u+=1}r=i.join("");break;default:switch(t){case 1:return n=Xi(this,this.l),this.l++,n;case 2:return n=(e==="i"?OO:xo)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?ri:PO)(this,this.l),this.l+=4,n):(s=Lr(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Cu(this,this.l):s=Cu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=dE(this,this.l,t);break}}return this.l+=t,r}var LO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},jO=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},MO=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function DO(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)MO(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,LO(this,e,this.l);break;case 8:if(n=8,r==="f"){RO(this,e,this.l);break}case 16:break;case-4:n=4,jO(this,e,this.l);break}return this.l+=n,this}function TE(t,e){var r=dE(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Rr(t,e){t.l=e,t.read_shift=Mo,t.chk=TE,t.write_shift=DO}function Fn(t,e){t.l+=e}function q(t){var e=_i(t);return Rr(e,0),e}function Tr(){var t=[],e=ze?256:2048,r=function(u){var d=q(u);return Rr(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},a=function(){return s(),Gt(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Z(t,e,r,n){var s=+e,i;if(!isNaN(s)){n||(n=NM[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=t.next(i);s<=127?a.write_shift(1,s):(a.write_shift(1,(s&127)+128),a.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Gp(r)&&t.push(r)}}function Do(t,e,r){var n=Sr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function qv(t,e,r){var n=Sr(t);return n.s=Do(n.s,e.s,r),n.e=Do(n.e,e.s,r),n}function Fo(t,e){if(t.cRel&&t.c<0)for(t=Sr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Sr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=qe(t);return!t.cRel&&t.cRel!=null&&(r=BO(r)),!t.rRel&&t.rRel!=null&&(r=FO(r)),r}function mh(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+qt(t.s.r)+":"+(t.e.rRel?"":"$")+qt(t.e.r):Fo(t.s,e.biff)+":"+Fo(t.e,e.biff)}function Wp(t){return parseInt(UO(t),10)-1}function qt(t){return""+(t+1)}function FO(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function UO(t){return t.replace(/\$(\d+)$/,"$1")}function Vp(t){for(var e=HO(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function BO(t){return t.replace(/^([A-Z])/,"$$$1")}function HO(t){return t.replace(/^\$([A-Z])/,"$1")}function zO(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ft(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function qe(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ur(t){var e=t.indexOf(":");return e==-1?{s:Ft(t),e:Ft(t)}:{s:Ft(t.slice(0,e)),e:Ft(t.slice(e+1))}}function St(t,e){return typeof e>"u"||typeof e=="number"?St(t.s,t.e):(typeof t!="string"&&(t=qe(t)),typeof e!="string"&&(e=qe(e)),t==e?t:t+":"+e)}function it(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Yv(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Us(t.z,r?Cr(e):e)}catch{}try{return t.w=Us((t.XF||{}).numFmtId||(r?14:0),r?Cr(e):e)}catch{return""+e}}function ls(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Rl[t.v]||t.v:e==null?Yv(t,t.v):Yv(t,e))}function Ni(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function CE(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Ft(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=it(i["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(u.e.r=a=d.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=e[h].length;++f)if(!(typeof e[h][f]>"u")){var p={v:e[h][f]},g=a+h,m=o+f;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),e[h][f]&&typeof e[h][f]=="object"&&!Array.isArray(e[h][f])&&!(e[h][f]instanceof Date))p=e[h][f];else if(Array.isArray(p.v)&&(p.f=e[h][f][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||vt[14],n.cellDates?(p.t="d",p.w=Us(p.z,Cr(p.v))):(p.t="n",p.v=Cr(p.v),p.w=Us(p.z,p.v))):p.t="s";if(s)i[g]||(i[g]=[]),i[g][m]&&i[g][m].z&&(p.z=i[g][m].z),i[g][m]=p;else{var w=qe({c:m,r:g});i[w]&&i[w].z&&(p.z=i[w].z),i[w]=p}}}return u.s.c<1e7&&(i["!ref"]=St(u)),i}function Ya(t,e){return CE(null,t,e)}function $O(t){return t.read_shift(4,"i")}function yn(t,e){return e||(e=q(4)),e.write_shift(4,t),e}function sr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ut(t,e){var r=!1;return e==null&&(r=!0,e=q(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function KO(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function GO(t,e){return e||(e=q(4)),e.write_shift(2,0),e.write_shift(2,0),e}function qp(t,e){var r=t.l,n=t.read_shift(1),s=sr(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(KO(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function WO(t,e){var r=!1;return e==null&&(r=!0,e=q(15+4*t.t.length)),e.write_shift(1,0),Ut(t.t,e),r?e.slice(0,e.l):e}var VO=qp;function qO(t,e){var r=!1;return e==null&&(r=!0,e=q(23+4*t.t.length)),e.write_shift(1,1),Ut(t.t,e),e.write_shift(4,1),GO({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function tn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ri(t,e){return e==null&&(e=q(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Oi(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Pi(t,e){return e==null&&(e=q(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var YO=sr,SE=Ut;function Yp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Su(t,e){var r=!1;return e==null&&(r=!0,e=q(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var QO=sr,Vf=Yp,Qp=Su;function AE(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Cu([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):ri(e,0)>>2;return r?s/100:s}function bE(t,e){e==null&&(e=q(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function kE(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function XO(t,e){return e||(e=q(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Li=kE,Qa=XO;function Xa(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ei(t,e){return(e||q(8)).write_shift(8,t,"f")}function JO(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=oP[s];u&&(e.rgb=ax(u));break;case 2:e.rgb=ax([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Au(t,e){if(e||(e=q(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function ZO(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eP(t,e){e||(e=q(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var IE=2,Ir=3,mc=11,bu=19,gc=64,tP=65,rP=71,nP=4108,sP=4126,Kt=80,Qv={1:{n:"CodePage",t:IE},2:{n:"Category",t:Kt},3:{n:"PresentationFormat",t:Kt},4:{n:"ByteCount",t:Ir},5:{n:"LineCount",t:Ir},6:{n:"ParagraphCount",t:Ir},7:{n:"SlideCount",t:Ir},8:{n:"NoteCount",t:Ir},9:{n:"HiddenCount",t:Ir},10:{n:"MultimediaClipCount",t:Ir},11:{n:"ScaleCrop",t:mc},12:{n:"HeadingPairs",t:nP},13:{n:"TitlesOfParts",t:sP},14:{n:"Manager",t:Kt},15:{n:"Company",t:Kt},16:{n:"LinksUpToDate",t:mc},17:{n:"CharacterCount",t:Ir},19:{n:"SharedDoc",t:mc},22:{n:"HyperlinksChanged",t:mc},23:{n:"AppVersion",t:Ir,p:"version"},24:{n:"DigSig",t:tP},26:{n:"ContentType",t:Kt},27:{n:"ContentStatus",t:Kt},28:{n:"Language",t:Kt},29:{n:"Version",t:Kt},255:{},2147483648:{n:"Locale",t:bu},2147483651:{n:"Behavior",t:bu},1919054434:{}},Xv={1:{n:"CodePage",t:IE},2:{n:"Title",t:Kt},3:{n:"Subject",t:Kt},4:{n:"Author",t:Kt},5:{n:"Keywords",t:Kt},6:{n:"Comments",t:Kt},7:{n:"Template",t:Kt},8:{n:"LastAuthor",t:Kt},9:{n:"RevNumber",t:Kt},10:{n:"EditTime",t:gc},11:{n:"LastPrinted",t:gc},12:{n:"CreatedDate",t:gc},13:{n:"ModifiedDate",t:gc},14:{n:"PageCount",t:Ir},15:{n:"WordCount",t:Ir},16:{n:"CharCount",t:Ir},17:{n:"Thumbnail",t:rP},18:{n:"Application",t:Kt},19:{n:"DocSecurity",t:Ir},255:{},2147483648:{n:"Locale",t:bu},2147483651:{n:"Behavior",t:bu},1919054434:{}};function iP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var aP=iP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),oP=Sr(aP),Rl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lP={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function NE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RE(t,e){var r=xO(lP),n=[],s;n[n.length]=At,n[n.length]=ue("Types",null,{xmlns:Dt.CT,"xmlns:xsd":Dt.xsd,"xmlns:xsi":Dt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ue("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=ue("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:vc[l][e.bookType]||vc[l].xlsx}))},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:vc[l][e.bookType]||vc[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=ue("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return i("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var He={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function OE(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Ta(t){var e=[At,ue("Relationships",null,{xmlns:Dt.RELS})];return Qt(t["!id"]).forEach(function(r){e[e.length]=ue("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ge(t,e,r,n,s,i){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[He.HLINK,He.XPATH,He.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}function cP(t){var e=[At];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Jv(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function uP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function dP(t){var e=[At];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Jv(t[r][0],t[r][1])),e.push(uP("",t[r][0]));return e.push(Jv("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function PE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yu.version+"</meta:generator></office:meta></office:document-meta>"}var di=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function gh(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=We(e),n[n.length]=r?ue(t,e,r):Wt(t,e))}function LE(t,e){var r=e||{},n=[At,ue("cp:coreProperties",null,{"xmlns:cp":Dt.CORE_PROPS,"xmlns:dc":Dt.dc,"xmlns:dcterms":Dt.dcterms,"xmlns:dcmitype":Dt.dcmitype,"xmlns:xsi":Dt.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&gh("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Wf(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&gh("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Wf(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var i=0;i!=di.length;++i){var a=di[i],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&gh(a[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ca=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ME(t){var e=[],r=ue;return t||(t={}),t.Application="SheetJS",e[e.length]=At,e[e.length]=ue("Properties",null,{xmlns:Dt.EXT_PROPS,"xmlns:vt":Dt.vt}),Ca.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=We(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+We(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function DE(t){var e=[At,ue("Properties",null,{xmlns:Dt.CUST_PROPS,"xmlns:vt":Dt.vt})];if(!t)return e.join("");var r=1;return Qt(t).forEach(function(s){++r,e[e.length]=ue("property",IO(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:We(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Zv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hP(t,e){var r=[];return Qt(Zv).map(function(n){for(var s=0;s<di.length;++s)if(di[s][1]==n)return di[s];for(s=0;s<Ca.length;++s)if(Ca[s][1]==n)return Ca[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Wt(Zv[n[1]]||n[1],s))}}),ue("DocumentProperties",r.join(""),{xmlns:Pr.o})}function fP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&Qt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var a=0;a<di.length;++a)if(i==di[a][1])return;for(a=0;a<Ca.length;++a)if(i==Ca[a][1])return;for(a=0;a<r.length;++a)if(i==r[a])return;var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(ue(Bv(i),o,{"dt:dt":l}))}}),e&&Qt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var a=e[i],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),s.push(ue(Bv(i),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Pr.o+'">'+s.join("")+"</"+n+">"}function pP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),s+=i);var a=q(8);return a.write_shift(4,n),a.write_shift(4,s),a}function ex(t,e){var r=q(4),n=q(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=q(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=pP(e);break;case 31:case 80:for(n=q(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Gt([r,n])}var FE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function tx(t,e,r){var n=q(8),s=[],i=[],a=8,o=0,l=q(8),u=q(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),i.push(l),s.push(u),a+=8+l.length,!e){u=q(8),u.write_shift(4,0),s.unshift(u);var d=[q(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(l=q(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=Gt(d),i.unshift(l),a+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(FE.indexOf(t[o][0])>-1||jE.indexOf(t[o][0])>-1)&&t[o][1]!=null){var f=t[o][1],p=0;if(e){p=+e[t[o][0]];var g=r[p];if(g.p=="version"&&typeof f=="string"){var m=f.split(".");f=(+m[0]<<16)+(+m[1]||0)}l=ex(g.t,f)}else{var w=mP(f);w==-1&&(w=31,f=String(f)),l=ex(w,f)}i.push(l),u=q(8),u.write_shift(4,e?p:2+o),s.push(u),a+=8+l.length}var v=8*(i.length+1);for(o=0;o<i.length;++o)s[o].write_shift(4,v),v+=i[o].length;return n.write_shift(4,a),n.write_shift(4,i.length),Gt([n].concat(s).concat(i))}function rx(t,e,r,n,s,i){var a=q(s?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Qe.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,s?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,s?68:48);var l=tx(t,r,n);if(o.push(l),s){var u=tx(s,null,null);a.write_shift(16,i,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Gt(o)}function gP(t,e){e||(e=q(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function vP(t,e){return t.read_shift(e)===1}function dr(t,e){return e||(e=q(2)),e.write_shift(2,+!!t),e}function UE(t){return t.read_shift(2,"u")}function Gr(t,e){return e||(e=q(2)),e.write_shift(2,t),e}function BE(t,e,r){return r||(r=q(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function HE(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function xP(t){var e=t.t||"",r=q(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=q(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return Gt(s)}function yP(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function wP(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):yP(t,n,r)}function _P(t,e,r){if(r.biff>5)return wP(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function zE(t,e,r){return r||(r=q(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function nx(t,e){e||(e=q(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function EP(t){var e=q(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),i=s>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(i==28)n=n.slice(1),nx(n,e);else if(i&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),i&8&&nx(s>-1?n.slice(s+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Ti(t,e,r,n){return n||(n=q(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function TP(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function CP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function $E(t,e){return e||(e=q(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function Xp(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=q(s);return i.write_shift(2,n),i.write_shift(2,e),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function SP(t,e){var r=!e||e.biff==8,n=q(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function AP(t,e){var r=!e||e.biff>=8?2:1,n=q(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function bP(t,e){var r=q(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=xP(t[s]);var i=Gt([r].concat(n));return i.parts=[r.length].concat(n.map(function(a){return a.length})),i}function kP(){var t=q(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function IP(t){var e=q(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function NP(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,i=q(s);return i.write_shift(2,(t.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function RP(t,e,r,n){var s=q(10);return Ti(t,e,n,s),s.write_shift(4,r),s}function OP(t,e,r,n,s){var i=!s||s.biff==8,a=q(8+ +i+(1+i)*r.length);return Ti(t,e,n,a),a.write_shift(2,r.length),i&&a.write_shift(1,1),a.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),a}function PP(t,e,r,n){var s=r&&r.biff==5;n||(n=q(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function LP(t,e){var r=e.biff==8||!e.biff?4:2,n=q(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function sx(t,e,r,n){var s=r&&r.biff==5;n||(n=q(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&s&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function jP(t){var e=q(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function MP(t,e,r,n,s,i){var a=q(8);return Ti(t,e,n,a),BE(r,i,a),a}function DP(t,e,r,n){var s=q(14);return Ti(t,e,n,s),Ei(r,s),s}function FP(t,e,r){if(r.biff<8)return UP(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(TP(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function UP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=HE(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function BP(t){var e=q(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)$E(t[r],e);return e}function HP(t){var e=q(24),r=Ft(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return Gt([e,EP(t[1])])}function zP(t){var e=t[1].Tooltip,r=q(10+2*(e.length+1));r.write_shift(2,2048);var n=Ft(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function $P(t){return t||(t=q(4)),t.write_shift(2,1),t.write_shift(2,1),t}function KP(t,e,r){if(!r.cellStyles)return Fn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function GP(t,e){var r=q(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function WP(t){for(var e=q(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function VP(t,e,r){var n=q(15);return Pl(n,t,e),n.write_shift(8,r,"f"),n}function qP(t,e,r){var n=q(9);return Pl(n,t,e),n.write_shift(2,r),n}var YP=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Bp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=_i(1);switch(l.type){case"base64":d=fn(os(o));break;case"binary":d=fn(o);break;case"buffer":case"array":d=o;break}Rr(d,0);var h=d.read_shift(1),f=!!(h&136),p=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:p=!0,f=!0;break;case 49:p=!0,f=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var m=0,w=521;h==2&&(m=d.read_shift(2)),d.l+=3,h!=2&&(m=d.read_shift(4)),m>1048576&&(m=1e6),h!=2&&(w=d.read_shift(2));var v=d.read_shift(2),y=l.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(y=t[d[d.l]]),d.l+=1,d.l+=2),g&&(d.l+=36);for(var x=[],_={},P=Math.min(d.length,h==2?521:w-10-(p?264:0)),S=g?32:11;d.l<P&&d[d.l]!=13;)switch(_={},_.name=ti.utils.decode(y,d.slice(d.l,d.l+S)).replace(/[\u0000\r\n].*$/g,""),d.l+=S,_.type=String.fromCharCode(d.read_shift(1)),h!=2&&!g&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),h==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&x.push(_),h!=2&&(d.l+=g?13:14),_.type){case"B":(!p||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var T=0,O=0;for(u[0]=[],O=0;O!=x.length;++O)u[0][O]=x[O].name;for(;m-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++T]=[],O=0,O=0;O!=x.length;++O){var L=d.slice(d.l,d.l+x[O].len);d.l+=x[O].len,Rr(L,0);var j=ti.utils.decode(y,L);switch(x[O].type){case"C":j.trim().length&&(u[T][O]=j.replace(/\s+$/,""));break;case"D":j.length===8?u[T][O]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):u[T][O]=j;break;case"F":u[T][O]=parseFloat(j.trim());break;case"+":case"I":u[T][O]=g?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":u[T][O]=!0;break;case"N":case"F":u[T][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!f)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[T][O]="##MEMO##"+(g?parseInt(j.trim(),10):L.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(u[T][O]=+j||0);break;case"@":u[T][O]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":u[T][O]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":u[T][O]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][O]=-L.read_shift(-8,"f");break;case"B":if(p&&x[O].len==8){u[T][O]=L.read_shift(8,"f");break}case"G":case"P":L.l+=x[O].len;break;case"0":if(x[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[O].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=x,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Ya(r(o,u),u);return d["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,d}function s(o,l){try{return Ni(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&ol(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Tr(),h=Ou(o,{header:1,raw:!0,cellDates:!0}),f=h[0],p=h.slice(1),g=o["!cols"]||[],m=0,w=0,v=0,y=1;for(m=0;m<f.length;++m){if(((g[m]||{}).DBF||{}).name){f[m]=g[m].DBF.name,++v;continue}if(f[m]!=null){if(++v,typeof f[m]=="number"&&(f[m]=f[m].toString(10)),typeof f[m]!="string")throw new Error("DBF Invalid column name "+f[m]+" |"+typeof f[m]+"|");if(f.indexOf(f[m])!==m){for(w=0;w<1024;++w)if(f.indexOf(f[m]+"_"+w)==-1){f[m]+="_"+w;break}}}}var x=it(o["!ref"]),_=[],P=[],S=[];for(m=0;m<=x.e.c-x.s.c;++m){var T="",O="",L=0,j=[];for(w=0;w<p.length;++w)p[w][m]!=null&&j.push(p[w][m]);if(j.length==0||f[m]==null){_[m]="?";continue}for(w=0;w<j.length;++w){switch(typeof j[w]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=j[w]instanceof Date?"D":"C";break;default:O="C"}L=Math.max(L,String(j[w]).length),T=T&&T!=O?"C":O}L>250&&(L=250),O=((g[m]||{}).DBF||{}).type,O=="C"&&g[m].DBF.len>L&&(L=g[m].DBF.len),T=="B"&&O=="N"&&(T="N",S[m]=g[m].DBF.dec,L=g[m].DBF.len),P[m]=T=="C"||O=="N"?L:i[T]||0,y+=P[m],_[m]=T}var G=d.next(32);for(G.write_shift(4,318902576),G.write_shift(4,p.length),G.write_shift(2,296+32*v),G.write_shift(2,y),m=0;m<4;++m)G.write_shift(4,0);for(G.write_shift(4,0|(+e[G_]||3)<<8),m=0,w=0;m<f.length;++m)if(f[m]!=null){var W=d.next(32),re=(f[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,re,"sbcs"),W.write_shift(1,_[m]=="?"?"C":_[m],"sbcs"),W.write_shift(4,w),W.write_shift(1,P[m]||i[_[m]]||0),W.write_shift(1,S[m]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),w+=P[m]||i[_[m]]||0}var te=d.next(264);for(te.write_shift(4,13),m=0;m<65;++m)te.write_shift(4,0);for(m=0;m<p.length;++m){var me=d.next(y);for(me.write_shift(1,0),w=0;w<f.length;++w)if(f[w]!=null)switch(_[w]){case"L":me.write_shift(1,p[m][w]==null?63:p[m][w]?84:70);break;case"B":me.write_shift(8,p[m][w]||0,"f");break;case"N":var ne="0";for(typeof p[m][w]=="number"&&(ne=p[m][w].toFixed(S[w]||0)),v=0;v<P[w]-ne.length;++v)me.write_shift(1,32);me.write_shift(1,ne,"sbcs");break;case"D":p[m][w]?(me.write_shift(4,("0000"+p[m][w].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(p[m][w].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+p[m][w].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(p[m][w]!=null?p[m][w]:"").slice(0,P[w]);for(me.write_shift(1,Ce,"sbcs"),v=0;v<P[w]-Ce.length;++v)me.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),QP=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Qt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(f,p){var g=t[p];return typeof g=="number"?kv(g):g},n=function(f,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?f:kv(m)};t["|"]=254;function s(f,p){switch(p.type){case"base64":return i(os(f),p);case"binary":return i(f,p);case"buffer":return i(ze&&Buffer.isBuffer(f)?f.toString("binary"):kl(f),p);case"array":return i(xd(f),p)}throw new Error("Unrecognized type "+p.type)}function i(f,p){var g=f.split(/[\n\r]+/),m=-1,w=-1,v=0,y=0,x=[],_=[],P=null,S={},T=[],O=[],L=[],j=0,G;for(+p.codepage>=0&&ol(+p.codepage);v!==g.length;++v){j=0;var W=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),re=W.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),te=re[0],me;if(W.length>0)switch(te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&_.push(W.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,Ce=!1,se=!1,fe=!1,Ee=-1,X=-1;for(y=1;y<re.length;++y)switch(re[y].charAt(0)){case"A":break;case"X":w=parseInt(re[y].slice(1))-1,Ce=!0;break;case"Y":for(m=parseInt(re[y].slice(1))-1,Ce||(w=0),G=x.length;G<=m;++G)x[G]=[];break;case"K":me=re[y].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(es(me))?isNaN(cl(me).getDate())||(me=fr(me)):(me=es(me),P!==null&&nE(P)&&(me=oE(me))),ne=!0;break;case"E":fe=!0;var N=q4(re[y].slice(1),{r:m,c:w});x[m][w]=[x[m][w],N];break;case"S":se=!0,x[m][w]=[x[m][w],"S5S"];break;case"G":break;case"R":Ee=parseInt(re[y].slice(1))-1;break;case"C":X=parseInt(re[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}if(ne&&(x[m][w]&&x[m][w].length==2?x[m][w][0]=me:x[m][w]=me,P=null),se){if(fe)throw new Error("SYLK shared formula cannot have own formula");var F=Ee>-1&&x[Ee][X];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");x[m][w][1]=Y4(F[1],{r:m-Ee,c:w-X})}break;case"F":var D=0;for(y=1;y<re.length;++y)switch(re[y].charAt(0)){case"X":w=parseInt(re[y].slice(1))-1,++D;break;case"Y":for(m=parseInt(re[y].slice(1))-1,G=x.length;G<=m;++G)x[G]=[];break;case"M":j=parseInt(re[y].slice(1))/20;break;case"F":break;case"G":break;case"P":P=_[parseInt(re[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=re[y].slice(1).split(" "),G=parseInt(L[0],10);G<=parseInt(L[1],10);++G)j=parseInt(L[2],10),O[G-1]=j===0?{hidden:!0}:{wch:j},Jp(O[G-1]);break;case"C":w=parseInt(re[y].slice(1))-1,O[w]||(O[w]={});break;case"R":m=parseInt(re[y].slice(1))-1,T[m]||(T[m]={}),j>0?(T[m].hpt=j,T[m].hpx=qE(j)):j===0&&(T[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}D<1&&(P=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+W)}}return T.length>0&&(S["!rows"]=T),O.length>0&&(S["!cols"]=O),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,S]}function a(f,p){var g=s(f,p),m=g[0],w=g[1],v=Ya(m,p);return Qt(w).forEach(function(y){v[y]=w[y]}),v}function o(f,p){return Ni(a(f,p),p)}function l(f,p,g,m){var w="C;Y"+(g+1)+";X"+(m+1)+";K";switch(f.t){case"n":w+=f.v||0,f.f&&!f.F&&(w+=";E"+em(f.f,{r:g,c:m}));break;case"b":w+=f.v?"TRUE":"FALSE";break;case"e":w+=f.w||f.v;break;case"d":w+='"'+(f.w||f.v)+'"';break;case"s":w+='"'+f.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(f,p){p.forEach(function(g,m){var w="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?w+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ku(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Iu(g.wpx)),typeof g.wch=="number"&&(w+=Math.round(g.wch))),w.charAt(w.length-1)!=" "&&f.push(w)})}function d(f,p){p.forEach(function(g,m){var w="F;";g.hidden?w+="M0;":g.hpt?w+="M"+20*g.hpt+";":g.hpx&&(w+="M"+20*Nu(g.hpx)+";"),w.length>2&&f.push(w+"R"+(m+1))})}function h(f,p){var g=["ID;PWXL;N;E"],m=[],w=it(f["!ref"]),v,y=Array.isArray(f),x=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),f["!cols"]&&u(g,f["!cols"]),f["!rows"]&&d(g,f["!rows"]),g.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var _=w.s.r;_<=w.e.r;++_)for(var P=w.s.c;P<=w.e.c;++P){var S=qe({r:_,c:P});v=y?(f[_]||[])[P]:f[S],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,f,_,P))}return g.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),XP=function(){function t(i,a){switch(a.type){case"base64":return e(os(i),a);case"binary":return e(i,a);case"buffer":return e(ze&&Buffer.isBuffer(i)?i.toString("binary"):kl(i),a);case"array":return e(xd(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,u=-1,d=0,h=[];d!==o.length;++d){if(o[d].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var f=o[d].trim().split(","),p=f[0],g=f[1];++d;for(var m=o[d]||"";(m.match(/["]/g)||[]).length&1&&d<o.length-1;)m+=`
`+o[++d];switch(m=m.trim(),+p){case-1:if(m==="BOT"){h[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?h[l][u]=!0:m==="FALSE"?h[l][u]=!1:isNaN(es(g))?isNaN(cl(g).getDate())?h[l][u]=g:h[l][u]=fr(g):h[l][u]=es(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),h[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(i,a){return Ya(t(i,a),a)}function n(i,a){return Ni(r(i,a),a)}var s=function(){var i=function(l,u,d,h,f){l.push(u),l.push(d+","+h),l.push('"'+f.replace(/"/g,'""')+'"')},a=function(l,u,d,h){l.push(u+","+d),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],d=it(l["!ref"]),h,f=Array.isArray(l);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,d.e.r-d.s.r+1,""),i(u,"TUPLES",0,d.e.c-d.s.c+1,""),i(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){a(u,-1,0,"BOT");for(var g=d.s.c;g<=d.e.c;++g){var m=qe({r:p,c:g});if(h=f?(l[p]||[])[g]:l[m],!h){a(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Us(h.z||vt[14],Cr(fr(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var v=`\r
`,y=u.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),KE=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,f){for(var p=h.split(`
`),g=-1,m=-1,w=0,v=[];w!==p.length;++w){var y=p[w].trim().split(":");if(y[0]==="cell"){var x=Ft(y[1]);if(v.length<=x.r)for(g=v.length;g<=x.r;++g)v[g]||(v[g]=[]);switch(g=x.r,m=x.c,y[2]){case"t":v[g][m]=t(y[3]);break;case"v":v[g][m]=+y[3];break;case"vtf":var _=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[g][m]=!!+y[4];break;default:v[g][m]=+y[4];break}y[2]=="vtf"&&(v[g][m]=[v[g][m],_])}}}return f&&f.sheetRows&&(v=v.slice(0,f.sheetRows)),v}function n(h,f){return Ya(r(h,f),f)}function s(h,f){return Ni(n(h,f),f)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var f=[],p=[],g,m="",w=Ur(h["!ref"]),v=Array.isArray(h),y=w.s.r;y<=w.e.r;++y)for(var x=w.s.c;x<=w.e.c;++x)if(m=qe({r:y,c:x}),g=v?(h[y]||[])[x]:h[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var _=Cr(fr(g.v));p[2]="vtc",p[3]="nd",p[4]=""+_,p[5]=g.w||Us(g.z||vt[14],_);break;case"e":continue}f.push(p.join(":"))}return f.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),f.push("valueformat:1:text-wiki"),f.join(`
`)}function d(h){return[i,a,o,a,u(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),JP=function(){function t(d,h,f,p,g){g.raw?h[f][p]=d:d===""||(d==="TRUE"?h[f][p]=!0:d==="FALSE"?h[f][p]=!1:isNaN(es(d))?isNaN(cl(d).getDate())?h[f][p]=d:h[f][p]=fr(d):h[f][p]=es(d))}function e(d,h){var f=h||{},p=[];if(!d||d.length===0)return p;for(var g=d.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var w=10,v=0,y=0;y<=m;++y)v=g[y].indexOf(" "),v==-1?v=g[y].length:v++,w=Math.max(w,v);for(y=0;y<=m;++y){p[y]=[];var x=0;for(t(g[y].slice(0,w).trim(),p,y,x,f),x=1;x<=(g[y].length-w)/10+1;++x)t(g[y].slice(w+(x-1)*10,w+x*10).trim(),p,y,x,f)}return f.sheetRows&&(p=p.slice(0,f.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var h={},f=!1,p=0,g=0;p<d.length;++p)(g=d.charCodeAt(p))==34?f=!f:!f&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p]);if(!g.length){h=n;for(p in h)Object.prototype.hasOwnProperty.call(h,p)&&g.push([h[p],p])}return g.sort(function(m,w){return m[0]-w[0]||n[m[1]]-n[w[1]]}),r[g.pop()[1]]||44}function i(d,h){var f=h||{},p="",g=f.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):f&&f.FS?p=f.FS:p=s(d.slice(0,1024));var w=0,v=0,y=0,x=0,_=0,P=p.charCodeAt(0),S=!1,T=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var L=f.dateNF!=null?pO(f.dateNF):null;function j(){var G=d.slice(x,_),W={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)W.t="z";else if(f.raw)W.t="s",W.v=G;else if(G.trim().length===0)W.t="s",W.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(W.t="s",W.v=G.slice(2,-1).replace(/""/g,'"')):Q4(G)?(W.t="n",W.f=G.slice(1)):(W.t="s",W.v=G);else if(G=="TRUE")W.t="b",W.v=!0;else if(G=="FALSE")W.t="b",W.v=!1;else if(!isNaN(y=es(G)))W.t="n",f.cellText!==!1&&(W.w=G),W.v=y;else if(!isNaN(cl(G).getDate())||L&&G.match(L)){W.z=f.dateNF||vt[14];var re=0;L&&G.match(L)&&(G=mO(G,f.dateNF,G.match(L)||[]),re=1),f.cellDates?(W.t="d",W.v=fr(G,re)):(W.t="n",W.v=Cr(fr(G,re))),f.cellText!==!1&&(W.w=Us(W.z,W.v instanceof Date?Cr(W.v):W.v)),f.cellNF||delete W.z}else W.t="s",W.v=G;if(W.t=="z"||(f.dense?(g[w]||(g[w]=[]),g[w][v]=W):g[qe({c:v,r:w})]=W),x=_+1,O=d.charCodeAt(x),m.e.c<v&&(m.e.c=v),m.e.r<w&&(m.e.r=w),T==P)++v;else if(v=0,++w,f.sheetRows&&f.sheetRows<=w)return!0}e:for(;_<d.length;++_)switch(T=d.charCodeAt(_)){case 34:O===34&&(S=!S);break;case P:case 10:case 13:if(!S&&j())break e;break}return _-x>0&&j(),g["!ref"]=St(m),g}function a(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,h):Ya(e(d,h),h)}function o(d,h){var f="",p=h.type=="string"?[0,0,0,0]:uD(d,h);switch(h.type){case"base64":f=os(d);break;case"binary":f=d;break;case"buffer":h.codepage==65001?f=d.toString("utf8"):h.codepage&&typeof ti<"u"?f=ti.utils.decode(h.codepage,d):f=ze&&Buffer.isBuffer(d)?d.toString("binary"):kl(d);break;case"array":f=xd(d);break;case"string":f=d;break;default:throw new Error("Unrecognized type "+h.type)}return p[0]==239&&p[1]==187&&p[2]==191?f=jo(f.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?f=jo(f):h.type=="binary"&&typeof ti<"u"&&h.codepage&&(f=ti.utils.decode(h.codepage,ti.utils.encode(28591,f))),f.slice(0,19)=="socialcalc:version:"?KE.to_sheet(h.type=="string"?f:jo(f),h):a(f,h)}function l(d,h){return Ni(o(d,h),h)}function u(d){for(var h=[],f=it(d["!ref"]),p,g=Array.isArray(d),m=f.s.r;m<=f.e.r;++m){for(var w=[],v=f.s.c;v<=f.e.c;++v){var y=qe({r:m,c:v});if(p=g?(d[m]||[])[v]:d[y],!p||p.v==null){w.push("          ");continue}for(var x=(p.w||(ls(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";w.push(x+(v===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),ix=function(){function t(N,F,D){if(N){Rr(N,N.l||0);for(var M=D.Enum||Ee;N.l<N.length;){var J=N.read_shift(2),xe=M[J]||M[65535],Se=N.read_shift(2),R=N.l+Se,ee=xe.f&&xe.f(N,Se,D);if(N.l=R,F(ee,xe,J))return}}}function e(N,F){switch(F.type){case"base64":return r(fn(os(N)),F);case"binary":return r(fn(N),F);case"buffer":case"array":return r(N,F)}throw"Unsupported type "+F.type}function r(N,F){if(!N)return N;var D=F||{},M=D.dense?[]:{},J="Sheet1",xe="",Se=0,R={},ee=[],be=[],ie={s:{r:0,c:0},e:{r:0,c:0}},Ne=D.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)D.Enum=Ee,t(N,function(ve,Pt,ar){switch(ar){case 0:D.vers=ve,ve>=4096&&(D.qpro=!0);break;case 6:ie=ve;break;case 204:ve&&(xe=ve);break;case 222:xe=ve;break;case 15:case 51:D.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:ar==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=D.dateNF||vt[14],D.cellDates&&(ve[1].t="d",ve[1].v=oE(ve[1].v))),D.qpro&&ve[3]>Se&&(M["!ref"]=St(ie),R[J]=M,ee.push(J),M=D.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Se=ve[3],J=xe||"Sheet"+(Se+1),xe="");var Ar=D.dense?(M[ve[0].r]||[])[ve[0].c]:M[qe(ve[0])];if(Ar){Ar.t=ve[1].t,Ar.v=ve[1].v,ve[1].z!=null&&(Ar.z=ve[1].z),ve[1].f!=null&&(Ar.f=ve[1].f);break}D.dense?(M[ve[0].r]||(M[ve[0].r]=[]),M[ve[0].r][ve[0].c]=ve[1]):M[qe(ve[0])]=ve[1];break}},D);else if(N[2]==26||N[2]==14)D.Enum=X,N[2]==14&&(D.qpro=!0,N.l=0),t(N,function(ve,Pt,ar){switch(ar){case 204:J=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>Se&&(M["!ref"]=St(ie),R[J]=M,ee.push(J),M=D.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},Se=ve[3],J="Sheet"+(Se+1)),Ne>0&&ve[0].r>=Ne)break;D.dense?(M[ve[0].r]||(M[ve[0].r]=[]),M[ve[0].r][ve[0].c]=ve[1]):M[qe(ve[0])]=ve[1],ie.e.c<ve[0].c&&(ie.e.c=ve[0].c),ie.e.r<ve[0].r&&(ie.e.r=ve[0].r);break;case 27:ve[14e3]&&(be[ve[14e3][0]]=ve[14e3][1]);break;case 1537:be[ve[0]]=ve[1],ve[0]==Se&&(J=ve[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(M["!ref"]=St(ie),R[xe||J]=M,ee.push(xe||J),!be.length)return{SheetNames:ee,Sheets:R};for(var ke={},at=[],Be=0;Be<be.length;++Be)R[ee[Be]]?(at.push(be[Be]||ee[Be]),ke[be[Be]]=R[be[Be]]||R[ee[Be]]):(at.push(be[Be]),ke[be[Be]]={"!ref":"A1"});return{SheetNames:at,Sheets:ke}}function n(N,F){var D=F||{};if(+D.codepage>=0&&ol(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Tr(),J=it(N["!ref"]),xe=Array.isArray(N),Se=[];de(M,0,i(1030)),de(M,6,l(J));for(var R=Math.min(J.e.r,8191),ee=J.s.r;ee<=R;++ee)for(var be=qt(ee),ie=J.s.c;ie<=J.e.c;++ie){ee===J.s.r&&(Se[ie]=nr(ie));var Ne=Se[ie]+be,ke=xe?(N[ee]||[])[ie]:N[Ne];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?de(M,13,p(ee,ie,ke.v)):de(M,14,m(ee,ie,ke.v));else{var at=ls(ke);de(M,15,h(ee,ie,at.slice(0,239)))}}return de(M,1),M.end()}function s(N,F){var D=F||{};if(+D.codepage>=0&&ol(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Tr();de(M,0,a(N));for(var J=0,xe=0;J<N.SheetNames.length;++J)(N.Sheets[N.SheetNames[J]]||{})["!ref"]&&de(M,27,fe(N.SheetNames[J],xe++));var Se=0;for(J=0;J<N.SheetNames.length;++J){var R=N.Sheets[N.SheetNames[J]];if(!(!R||!R["!ref"])){for(var ee=it(R["!ref"]),be=Array.isArray(R),ie=[],Ne=Math.min(ee.e.r,8191),ke=ee.s.r;ke<=Ne;++ke)for(var at=qt(ke),Be=ee.s.c;Be<=ee.e.c;++Be){ke===ee.s.r&&(ie[Be]=nr(Be));var ve=ie[Be]+at,Pt=be?(R[ke]||[])[Be]:R[ve];if(!(!Pt||Pt.t=="z"))if(Pt.t=="n")de(M,23,j(ke,Be,Se,Pt.v));else{var ar=ls(Pt);de(M,22,T(ke,Be,Se,ar.slice(0,239)))}}++Se}}return de(M,1),M.end()}function i(N){var F=q(2);return F.write_shift(2,N),F}function a(N){var F=q(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var D=0,M=0,J=0,xe=0;xe<N.SheetNames.length;++xe){var Se=N.SheetNames[xe],R=N.Sheets[Se];if(!(!R||!R["!ref"])){++J;var ee=Ur(R["!ref"]);D<ee.e.r&&(D=ee.e.r),M<ee.e.c&&(M=ee.e.c)}}return D>8191&&(D=8191),F.write_shift(2,D),F.write_shift(1,J),F.write_shift(1,M),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function o(N,F,D){var M={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&D.qpro?(M.s.c=N.read_shift(1),N.l++,M.s.r=N.read_shift(2),M.e.c=N.read_shift(1),N.l++,M.e.r=N.read_shift(2),M):(M.s.c=N.read_shift(2),M.s.r=N.read_shift(2),F==12&&D.qpro&&(N.l+=2),M.e.c=N.read_shift(2),M.e.r=N.read_shift(2),F==12&&D.qpro&&(N.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(N){var F=q(8);return F.write_shift(2,N.s.c),F.write_shift(2,N.s.r),F.write_shift(2,N.e.c),F.write_shift(2,N.e.r),F}function u(N,F,D){var M=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(M[0].c=N.read_shift(1),M[3]=N.read_shift(1),M[0].r=N.read_shift(2),N.l+=2):(M[2]=N.read_shift(1),M[0].c=N.read_shift(2),M[0].r=N.read_shift(2)),M}function d(N,F,D){var M=N.l+F,J=u(N,F,D);if(J[1].t="s",D.vers==20768){N.l++;var xe=N.read_shift(1);return J[1].v=N.read_shift(xe,"utf8"),J}return D.qpro&&N.l++,J[1].v=N.read_shift(M-N.l,"cstr"),J}function h(N,F,D){var M=q(7+D.length);M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,N),M.write_shift(1,39);for(var J=0;J<M.length;++J){var xe=D.charCodeAt(J);M.write_shift(1,xe>=128?95:xe)}return M.write_shift(1,0),M}function f(N,F,D){var M=u(N,F,D);return M[1].v=N.read_shift(2,"i"),M}function p(N,F,D){var M=q(7);return M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,N),M.write_shift(2,D,"i"),M}function g(N,F,D){var M=u(N,F,D);return M[1].v=N.read_shift(8,"f"),M}function m(N,F,D){var M=q(13);return M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,N),M.write_shift(8,D,"f"),M}function w(N,F,D){var M=N.l+F,J=u(N,F,D);if(J[1].v=N.read_shift(8,"f"),D.qpro)N.l=M;else{var xe=N.read_shift(2);_(N.slice(N.l,N.l+xe),J),N.l+=xe}return J}function v(N,F,D){var M=F&32768;return F&=-32769,F=(M?N:0)+(F>=8192?F-16384:F),(M?"":"$")+(D?nr(F):qt(F))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(N,F){Rr(N,0);for(var D=[],M=0,J="",xe="",Se="",R="";N.l<N.length;){var ee=N[N.l++];switch(ee){case 0:D.push(N.read_shift(8,"f"));break;case 1:xe=v(F[0].c,N.read_shift(2),!0),J=v(F[0].r,N.read_shift(2),!1),D.push(xe+J);break;case 2:{var be=v(F[0].c,N.read_shift(2),!0),ie=v(F[0].r,N.read_shift(2),!1);xe=v(F[0].c,N.read_shift(2),!0),J=v(F[0].r,N.read_shift(2),!1),D.push(be+ie+":"+xe+J)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(N.read_shift(2));break;case 6:{for(var Ne="";ee=N[N.l++];)Ne+=String.fromCharCode(ee);D.push('"'+Ne.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:R=D.pop(),Se=D.pop(),D.push(["AND","OR"][ee-20]+"("+Se+","+R+")");break;default:if(ee<32&&x[ee])R=D.pop(),Se=D.pop(),D.push(Se+x[ee]+R);else if(y[ee]){if(M=y[ee][1],M==69&&(M=N[N.l++]),M>D.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+D.join("|")+"|");return}var ke=D.slice(-M);D.length-=M,D.push(y[ee][0]+"("+ke.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}D.length==1?F[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function P(N){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=N.read_shift(2),F[3]=N[N.l++],F[0].c=N[N.l++],F}function S(N,F){var D=P(N);return D[1].t="s",D[1].v=N.read_shift(F-4,"cstr"),D}function T(N,F,D,M){var J=q(6+M.length);J.write_shift(2,N),J.write_shift(1,D),J.write_shift(1,F),J.write_shift(1,39);for(var xe=0;xe<M.length;++xe){var Se=M.charCodeAt(xe);J.write_shift(1,Se>=128?95:Se)}return J.write_shift(1,0),J}function O(N,F){var D=P(N);D[1].v=N.read_shift(2);var M=D[1].v>>1;if(D[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return D[1].v=M,D}function L(N,F){var D=P(N),M=N.read_shift(4),J=N.read_shift(4),xe=N.read_shift(2);if(xe==65535)return M===0&&J===3221225472?(D[1].t="e",D[1].v=15):M===0&&J===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var Se=xe&32768;return xe=(xe&32767)-16446,D[1].v=(1-Se*2)*(J*Math.pow(2,xe+32)+M*Math.pow(2,xe)),D}function j(N,F,D,M){var J=q(14);if(J.write_shift(2,N),J.write_shift(1,D),J.write_shift(1,F),M==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var xe=0,Se=0,R=0,ee=0;return M<0&&(xe=1,M=-M),Se=Math.log2(M)|0,M/=Math.pow(2,Se-31),ee=M>>>0,ee&2147483648||(M/=2,++Se,ee=M>>>0),M-=ee,ee|=2147483648,ee>>>=0,M*=Math.pow(2,32),R=M>>>0,J.write_shift(4,R),J.write_shift(4,ee),Se+=16383+(xe?32768:0),J.write_shift(2,Se),J}function G(N,F){var D=L(N);return N.l+=F-14,D}function W(N,F){var D=P(N),M=N.read_shift(4);return D[1].v=M>>6,D}function re(N,F){var D=P(N),M=N.read_shift(8,"f");return D[1].v=M,D}function te(N,F){var D=re(N);return N.l+=F-10,D}function me(N,F){return N[N.l+F-1]==0?N.read_shift(F,"cstr"):""}function ne(N,F){var D=N[N.l++];D>F-1&&(D=F-1);for(var M="";M.length<D;)M+=String.fromCharCode(N[N.l++]);return M}function Ce(N,F,D){if(!(!D.qpro||F<21)){var M=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var J=N.read_shift(F-21,"cstr");return[M,J]}}function se(N,F){for(var D={},M=N.l+F;N.l<M;){var J=N.read_shift(2);if(J==14e3){for(D[J]=[0,""],D[J][0]=N.read_shift(2);N[N.l];)D[J][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return D}function fe(N,F){var D=q(5+N.length);D.write_shift(2,14e3),D.write_shift(2,F);for(var M=0;M<N.length;++M){var J=N.charCodeAt(M);D[D.l++]=J>127?95:J}return D[D.l++]=0,D}var Ee={0:{n:"BOF",f:UE},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}(),ZP=/^\s|\s$|[\t\n\r]/;function GE(t,e){if(!e.bookSST)return"";var r=[At];r[r.length]=ue("sst",null,{xmlns:qa[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(ZP)&&(i+=' xml:space="preserve"'),i+=">"+We(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function e4(t){return[t.read_shift(4),t.read_shift(4)]}function t4(t,e){return e||(e=q(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var r4=WO;function n4(t){var e=Tr();Z(e,159,t4(t));for(var r=0;r<t.length;++r)Z(e,19,r4(t[r]));return Z(e,160),e.end()}function s4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function WE(t){var e=0,r,n=s4(t),s=n.length+1,i,a,o,l,u;for(r=_i(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^a;return e^52811}var i4=function(){function t(s,i){switch(i.type){case"base64":return e(os(s),i);case"binary":return e(s,i);case"buffer":return e(ze&&Buffer.isBuffer(s)?s.toString("binary"):kl(s),i);case"array":return e(xd(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,h){Array.isArray(o)&&(o[h]=[]);for(var f=/\\\w+\b/g,p=0,g,m=-1;g=f.exec(d);){switch(g[0]){case"\\cell":var w=d.slice(p,f.lastIndex-g[0].length);if(w[0]==" "&&(w=w.slice(1)),++m,w.length){var v={v:w,t:"s"};Array.isArray(o)?o[h][m]=v:o[qe({r:h,c:m})]=v}break}p=f.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=St(u),o}function r(s,i){return Ni(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=it(s["!ref"]),o,l=Array.isArray(s),u=a.s.r;u<=a.e.r;++u){i.push("\\trowd\\trautofit1");for(var d=a.s.c;d<=a.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=a.s.c;d<=a.e.c;++d){var h=qe({r:u,c:d});o=l?(s[u]||[])[d]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(ls(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function ax(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var a4=6,ts=a4;function ku(t){return Math.floor((t+Math.round(128/ts)/256)*ts)}function Iu(t){return Math.floor((t-5)/ts*100+.5)/100}function qf(t){return Math.round((t*ts+5)/ts*256)/256}function Jp(t){t.width?(t.wpx=ku(t.width),t.wch=Iu(t.wpx),t.MDW=ts):t.wpx?(t.wch=Iu(t.wpx),t.width=qf(t.wch),t.MDW=ts):typeof t.wch=="number"&&(t.width=qf(t.wch),t.wpx=ku(t.width),t.MDW=ts),t.customWidth&&delete t.customWidth}var o4=96,VE=o4;function Nu(t){return t*96/VE}function qE(t){return t*VE/96}function l4(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ue("numFmt",null,{numFmtId:n,formatCode:We(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function c4(t){var e=[];return e[e.length]=ue("cellXfs",null),t.forEach(function(r){e[e.length]=ue("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function YE(t,e){var r=[At,ue("styleSheet",null,{xmlns:qa[0],"xmlns:vt":Dt.vt})],n;return t.SSF&&(n=l4(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=c4(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function u4(t,e){var r=t.read_shift(2),n=sr(t);return[r,n]}function d4(t,e,r){r||(r=q(6+4*e.length)),r.write_shift(2,t),Ut(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function h4(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=ZO(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=JO(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=sr(t),n}function f4(t,e){e||(e=q(25+4*32)),e.write_shift(2,t.sz*20),eP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Au(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),Ut(t.name,e),e.length>e.l?e.slice(0,e.l):e}var p4=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vh,m4=Fn;function ox(t,e){e||(e=q(4*3+8*7+16*1)),vh||(vh=Bp(p4));var r=vh[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Au({auto:1},e),Au({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function g4(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function QE(t,e,r){r||(r=q(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function uo(t,e){return e||(e=q(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var v4=Fn;function x4(t,e){return e||(e=q(51)),e.write_shift(1,0),uo(null,e),uo(null,e),uo(null,e),uo(null,e),uo(null,e),e.length>e.l?e.slice(0,e.l):e}function y4(t,e){return e||(e=q(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),Su(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function w4(t,e,r){var n=q(2052);return n.write_shift(4,t),Su(e,n),Su(r,n),n.length>n.l?n.slice(0,n.l):n}function _4(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(Z(t,615,yn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&Z(t,44,d4(s,e[s]))}),Z(t,616))}}function E4(t){var e=1;Z(t,611,yn(e)),Z(t,43,f4({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Z(t,612)}function T4(t){var e=2;Z(t,603,yn(e)),Z(t,45,ox({patternType:"none"})),Z(t,45,ox({patternType:"gray125"})),Z(t,604)}function C4(t){var e=1;Z(t,613,yn(e)),Z(t,46,x4()),Z(t,614)}function S4(t){var e=1;Z(t,626,yn(e)),Z(t,47,QE({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Z(t,627)}function A4(t,e){Z(t,617,yn(e.length)),e.forEach(function(r){Z(t,47,QE(r,0))}),Z(t,618)}function b4(t){var e=1;Z(t,619,yn(e)),Z(t,48,y4({xfId:0,builtinId:0,name:"Normal"})),Z(t,620)}function k4(t){var e=0;Z(t,505,yn(e)),Z(t,506)}function I4(t){var e=0;Z(t,508,w4(e,"TableStyleMedium9","PivotStyleMedium4")),Z(t,509)}function N4(t,e){var r=Tr();return Z(r,278),_4(r,t.SSF),E4(r),T4(r),C4(r),S4(r),A4(r,e.cellXfs),b4(r),k4(r),I4(r),Z(r,279),r.end()}function XE(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[At];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function R4(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:sr(t)}}function O4(t){var e=q(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ut(t.name,e),e.slice(0,e.l)}function P4(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function L4(t){var e=q(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function j4(t,e){var r=q(8+2*e.length);return r.write_shift(4,t),Ut(e,r),r.slice(0,r.l)}function M4(t){return t.l+=4,t.read_shift(4)!=0}function D4(t,e){var r=q(8);return r.write_shift(4,t),r.write_shift(4,1),r}function F4(){var t=Tr();return Z(t,332),Z(t,334,yn(1)),Z(t,335,O4({name:"XLDAPR",version:12e4,flags:3496657072})),Z(t,336),Z(t,339,j4(1,"XLDAPR")),Z(t,52),Z(t,35,yn(514)),Z(t,4096,yn(0)),Z(t,4097,Gr(1)),Z(t,36),Z(t,53),Z(t,340),Z(t,337,D4(1)),Z(t,51,L4([[1,0]])),Z(t,338),Z(t,333),t.end()}function JE(){var t=[At];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function U4(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=qe(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var fa=1024;function ZE(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ue("xml",null,{"xmlns:v":Pr.v,"xmlns:o":Pr.o,"xmlns:x":Pr.x,"xmlns:mv":Pr.mv}).replace(/\/>/,">"),ue("o:shapelayout",ue("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ue("v:shapetype",[ue("v:stroke",null,{joinstyle:"miter"}),ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];fa<t*1e3;)fa+=1e3;return e.forEach(function(i){var a=Ft(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ue("v:fill",l,o),d={on:"t",obscured:"t"};++fa,s=s.concat(["<v:shape"+dl({id:"_x0000_s"+fa,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ue("v:shadow",null,d),ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Wt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Wt("x:AutoFill","False"),Wt("x:Row",String(a.r)),Wt("x:Column",String(a.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function eT(t){var e=[At,ue("comments",null,{xmlns:qa[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var i=We(s.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(We(l.a))),i.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),i.length<=1)e.push(Wt("t",We(i[0]||"")));else{for(var a=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)a+=`Reply:
    `+i[o]+`
`;e.push(Wt("t",We(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function B4(t,e,r){var n=[At,ue("ThreadedComments",null,{xmlns:Dt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var i="";(s[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ue("threadedComment",Wt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function H4(t){var e=[At,ue("personList",null,{xmlns:Dt.TCMNT,"xmlns:x":qa[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function z4(t){var e={};e.iauthor=t.read_shift(4);var r=Li(t);return e.rfx=r.s,e.ref=qe(r.s),t.l+=16,e}function $4(t,e){return e==null&&(e=q(36)),e.write_shift(4,t[1].iauthor),Qa(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var K4=sr;function G4(t){return Ut(t.slice(0,54))}function W4(t){var e=Tr(),r=[];return Z(e,628),Z(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Z(e,632,G4(s.a)))})}),Z(e,631),Z(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Ft(n[0]),e:Ft(n[0])};Z(e,635,$4([i,s])),s.t&&s.t.length>0&&Z(e,637,qO(s)),Z(e,636),delete s.iauthor})}),Z(e,634),Z(e,629),e.end()}function V4(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Qe.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var tT=["xlsb","xlsm","xlam","biff8","xla"],q4=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,d=a.length>0?parseInt(a,10)|0:0;return o?d+=e.c:--d,l?u+=e.r:--u,s+(o?"":"$")+nr(d)+(l?"":"$")+qt(u)}return function(s,i){return e=i,s.replace(t,r)}}(),Zp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,em=function(){return function(e,r){return e.replace(Zp,function(n,s,i,a,o,l){var u=Vp(a)-(i?0:r.c),d=Wp(l)-(o?0:r.r),h=d==0?"":o?d+1:"["+d+"]",f=u==0?"":i?u+1:"["+u+"]";return s+"R"+h+"C"+f})}}();function Y4(t,e){return t.replace(Zp,function(r,n,s,i,a,o){return n+(s=="$"?s+i:nr(Vp(i)+e.c))+(a=="$"?a+o:qt(Wp(o)+e.r))})}function Q4(t){return t.length!=1}function wt(t){t.l+=1}function Bs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function rT(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return nT(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=Bs(t),o=Bs(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function nT(t){var e=Bs(t),r=Bs(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function X4(t,e,r){if(r.biff<8)return nT(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=Bs(t),a=Bs(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function sT(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return J4(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Bs(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function J4(t){var e=Bs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Z4(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function e3(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return t3(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function t3(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function r3(t,e,r){var n=(t[t.l++]&96)>>5,s=rT(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function n3(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=rT(t,i,r);return[n,s,a]}function s3(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function i3(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function a3(t,e,r){var n=(t[t.l++]&96)>>5,s=X4(t,e-1,r);return[n,s]}function o3(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function lx(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function l3(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function c3(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function u3(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function d3(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function h3(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function iT(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function f3(t){return t.read_shift(2),iT(t)}function p3(t){return t.read_shift(2),iT(t)}function m3(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=sT(t,0,r);return[n,s]}function g3(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=e3(t,0,r);return[n,s]}function v3(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=sT(t,0,r);return[n,s,i]}function x3(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[xL[s],lT[s],n]}function y3(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:w3(t);return[s,(i[0]===0?lT:vL)[i[1]]]}function w3(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function _3(t,e,r){t.l+=r&&r.biff==2?3:4}function E3(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function T3(t){return t.l++,Rl[t.read_shift(1)]}function C3(t){return t.l++,t.read_shift(2)}function S3(t){return t.l++,t.read_shift(1)!==0}function A3(t){return t.l++,Xa(t)}function b3(t,e,r){return t.l++,HE(t,e-1,r)}function k3(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vP(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Rl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Xa(t);break;case 2:r[1]=_P(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function I3(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Li:CP)(t));return s}function N3(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=k3(t,r.biff);return a}function R3(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function O3(t,e,r){if(r.biff==5)return P3(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function P3(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function L3(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function j3(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function M3(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function D3(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var F3=Fn,U3=Fn,B3=Fn;function Ol(t,e,r){return t.l+=2,[Z4(t)]}function tm(t){return t.l+=6,[]}var H3=Ol,z3=tm,$3=tm,K3=Ol;function aT(t){return t.l+=2,[UE(t),t.read_shift(2)&1]}var G3=Ol,W3=aT,V3=tm,q3=Ol,Y3=Ol,Q3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function X3(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=Q3[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function J3(t){return t.l+=2,[t.read_shift(4)]}function Z3(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function eL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function tL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function rL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function nL(t){return t.l+=4,[0,0]}var cx={1:{n:"PtgExp",f:E3},2:{n:"PtgTbl",f:B3},3:{n:"PtgAdd",f:wt},4:{n:"PtgSub",f:wt},5:{n:"PtgMul",f:wt},6:{n:"PtgDiv",f:wt},7:{n:"PtgPower",f:wt},8:{n:"PtgConcat",f:wt},9:{n:"PtgLt",f:wt},10:{n:"PtgLe",f:wt},11:{n:"PtgEq",f:wt},12:{n:"PtgGe",f:wt},13:{n:"PtgGt",f:wt},14:{n:"PtgNe",f:wt},15:{n:"PtgIsect",f:wt},16:{n:"PtgUnion",f:wt},17:{n:"PtgRange",f:wt},18:{n:"PtgUplus",f:wt},19:{n:"PtgUminus",f:wt},20:{n:"PtgPercent",f:wt},21:{n:"PtgParen",f:wt},22:{n:"PtgMissArg",f:wt},23:{n:"PtgStr",f:b3},26:{n:"PtgSheet",f:Z3},27:{n:"PtgEndSheet",f:eL},28:{n:"PtgErr",f:T3},29:{n:"PtgBool",f:S3},30:{n:"PtgInt",f:C3},31:{n:"PtgNum",f:A3},32:{n:"PtgArray",f:o3},33:{n:"PtgFunc",f:x3},34:{n:"PtgFuncVar",f:y3},35:{n:"PtgName",f:R3},36:{n:"PtgRef",f:m3},37:{n:"PtgArea",f:r3},38:{n:"PtgMemArea",f:L3},39:{n:"PtgMemErr",f:F3},40:{n:"PtgMemNoMem",f:U3},41:{n:"PtgMemFunc",f:j3},42:{n:"PtgRefErr",f:M3},43:{n:"PtgAreaErr",f:s3},44:{n:"PtgRefN",f:g3},45:{n:"PtgAreaN",f:a3},46:{n:"PtgMemAreaN",f:tL},47:{n:"PtgMemNoMemN",f:rL},57:{n:"PtgNameX",f:O3},58:{n:"PtgRef3d",f:v3},59:{n:"PtgArea3d",f:n3},60:{n:"PtgRefErr3d",f:D3},61:{n:"PtgAreaErr3d",f:i3},255:{}},sL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iL={1:{n:"PtgElfLel",f:aT},2:{n:"PtgElfRw",f:q3},3:{n:"PtgElfCol",f:H3},6:{n:"PtgElfRwV",f:Y3},7:{n:"PtgElfColV",f:K3},10:{n:"PtgElfRadical",f:G3},11:{n:"PtgElfRadicalS",f:V3},13:{n:"PtgElfColS",f:z3},15:{n:"PtgElfColSV",f:$3},16:{n:"PtgElfRadicalLel",f:W3},25:{n:"PtgList",f:X3},29:{n:"PtgSxName",f:J3},255:{}},aL={0:{n:"PtgAttrNoop",f:nL},1:{n:"PtgAttrSemi",f:h3},2:{n:"PtgAttrIf",f:u3},4:{n:"PtgAttrChoose",f:l3},8:{n:"PtgAttrGoto",f:c3},16:{n:"PtgAttrSum",f:_3},32:{n:"PtgAttrBaxcel",f:lx},33:{n:"PtgAttrBaxcel",f:lx},64:{n:"PtgAttrSpace",f:f3},65:{n:"PtgAttrSpaceSemi",f:p3},128:{n:"PtgAttrIfError",f:d3},255:{}};function oL(t,e,r,n){if(n.biff<8)return Fn(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=N3(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=I3(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Fn(t,e)),i}function lL(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=cx[i]||cx[sL[i]],(i===24||i===25)&&(s=(i===24?iL:aL)[t[t.l+1]]),!s||!s.f?Fn(t,e):a.push([s.n,s.f(t,e,r)]);return a}function cL(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var uL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function oT(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ux(t,e,r){var n=oT(t,e,r);return n=="#REF"?n:dL(n,r)}function Ba(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,u,d,h=0,f=0,p,g="";if(!t[0]||!t[0][0])return"";for(var m=-1,w="",v=0,y=t[0].length;v<y;++v){var x=t[0][v];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:w=gt(" ",t[0][m][1][1]);break;case 1:w=gt("\r",t[0][m][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}u=u+w,m=-1}o.push(u+uL[x[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Do(x[1][1],a,s),o.push(Fo(d,i));break;case"PtgRefN":d=r?Do(x[1][1],r,s):x[1][1],o.push(Fo(d,i));break;case"PtgRef3d":h=x[1][1],d=Do(x[1][2],a,s),g=ux(n,h,s),o.push(g+"!"+Fo(d,i));break;case"PtgFunc":case"PtgFuncVar":var _=x[1][0],P=x[1][1];_||(_=0),_&=127;var S=_==0?[]:o.slice(-_);o.length-=_,P==="User"&&(P=S.shift()),o.push(P+"("+S.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=qv(x[1][1],r?{s:r}:a,s),o.push(mh(p,s));break;case"PtgArea":p=qv(x[1][1],a,s),o.push(mh(p,s));break;case"PtgArea3d":h=x[1][1],p=x[1][2],g=ux(n,h,s),o.push(g+"!"+mh(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":f=x[1][2];var T=(n.names||[])[f-1]||(n[0]||[])[f],O=T?T.Name:"SH33TJSNAME"+String(f);O&&O.slice(0,6)=="_xlfn."&&!s.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var L=x[1][1];f=x[1][2];var j;if(s.biff<=5)L<0&&(L=-L),n[L]&&(j=n[L][f]);else{var G="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][f]&&n[L][f].itab>0&&(G=n.SheetNames[n[L][f].itab-1]+"!"):G=n.SheetNames[f-1]+"!"),n[L]&&n[L][f])G+=n[L][f].Name;else if(n[0]&&n[0][f])G+=n[0][f].Name;else{var W=(oT(n,L,s)||"").split(";;");W[f-1]?G=W[f-1]:G+="SH33TJSERRX"}o.push(G);break}j||(j={Name:"SH33TJSERRY"}),o.push(j.Name);break;case"PtgParen":var re="(",te=")";if(m>=0){switch(w="",t[0][m][1][0]){case 2:re=gt(" ",t[0][m][1][1])+re;break;case 3:re=gt("\r",t[0][m][1][1])+re;break;case 4:te=gt(" ",t[0][m][1][1])+te;break;case 5:te=gt("\r",t[0][m][1][1])+te;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(re+o.pop()+te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:x[1][1],r:x[1][0]};var me={c:r.c,r:r.r};if(n.sharedf[qe(d)]){var ne=n.sharedf[qe(d)];o.push(Ba(ne,a,me,n,s))}else{var Ce=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ba(u[1],a,me,n,s)),Ce=!0;break}Ce||o.push(x[1])}break;case"PtgArray":o.push("{"+cL(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&se.indexOf(t[0][v][0])==-1){x=t[0][m];var fe=!0;switch(x[1][0]){case 4:fe=!1;case 0:w=gt(" ",x[1][1]);break;case 5:fe=!1;case 1:w=gt("\r",x[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((fe?w:"")+o.pop()+(fe?"":w)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function hL(t){if(t==null){var e=q(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ei(t);return Ei(0)}function fL(t,e,r,n,s){var i=Ti(e,r,s),a=hL(t.v),o=q(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=q(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var h=Gt([i,a,o,u]);return h}function yd(t,e,r){var n=t.read_shift(4),s=lL(t,n,r),i=t.read_shift(4),a=i>0?oL(t,i,s,r):null;return[s,a]}var pL=yd,wd=yd,mL=yd,gL=yd,vL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yL(t){var e="of:="+t.replace(Zp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function wL(t){return t.replace(/\./,"!")}var Uo=typeof Map<"u";function rm(t,e,r){var n=0,s=t.length;if(r){if(Uo?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=Uo?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Uo?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function _d(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(ts=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Iu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=qf(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function cT(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ws(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,i=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){sE(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=i;++s)if(t[s].numFmtId===n)return s;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function _L(t,e,r){if(t&&t["!ref"]){var n=it(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function EL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+St(t[r])+'"/>';return e+"</mergeCells>"}function TL(t,e,r,n,s){var i=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,a.codeName=ul(We(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+ue("outlinePr",null,u)}!i&&!o||(s[s.length]=ue("sheetPr",o,a))}var CL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],SL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AL(t){var e={sheet:1};return CL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),SL.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=WE(t.password).toString(16).toUpperCase()),ue("sheetProtection",null,e)}function bL(t){return cT(t),ue("pageMargins",null,t)}function kL(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=ue("col",null,_d(s,n)));return r[r.length]="</cols>",r.join("")}function IL(t,e,r,n){var s=typeof t.ref=="string"?t.ref:St(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,a=Ur(s);a.s.r==a.e.r&&(a.e.r=Ur(e["!ref"]).e.r,s=St(a));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ue("autoFilter",null,{ref:s})}function NL(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ue("sheetViews",ue("sheetView",null,s),{})}function RL(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",i=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Rl[t.v];break;case"d":n&&n.cellDates?s=fr(t.v,-1).toISOString():(t=Sr(t),t.t="n",s=""+(t.v=Cr(fr(t.v)))),typeof t.z>"u"&&(t.z=vt[14]);break;default:s=t.v;break}var o=Wt("v",We(s)),l={r:e},u=Ws(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Wt("v",""+rm(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=i&&(t.t=i,t.v=a),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ue("f",We(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),ue("c",o,l)}function OL(t,e,r,n){var s=[],i=[],a=it(t["!ref"]),o="",l,u="",d=[],h=0,f=0,p=t["!rows"],g=Array.isArray(t),m={r:u},w,v=-1;for(f=a.s.c;f<=a.e.c;++f)d[f]=nr(f);for(h=a.s.r;h<=a.e.r;++h){for(i=[],u=qt(h),f=a.s.c;f<=a.e.c;++f){l=d[f]+u;var y=g?(t[h]||[])[f]:t[l];y!==void 0&&(o=RL(y,l,t,e))!=null&&i.push(o)}(i.length>0||p&&p[h])&&(m={r:u},p&&p[h]&&(w=p[h],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Nu(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level)),s[s.length]=ue("row",i.join(""),m))}if(p)for(;h<p.length;++h)p&&p[h]&&(m={r:h+1},w=p[h],w.hidden&&(m.hidden=1),v=-1,w.hpx?v=Nu(w.hpx):w.hpt&&(v=w.hpt),v>-1&&(m.ht=v,m.customHeight=1),w.level&&(m.outlineLevel=w.level),s[s.length]=ue("row","",m));return s.join("")}function uT(t,e,r,n){var s=[At,ue("worksheet",null,{xmlns:qa[0],"xmlns:r":Dt.r})],i=r.SheetNames[t],a=0,o="",l=r.Sheets[i];l==null&&(l={});var u=l["!ref"]||"A1",d=it(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=St(d)}n||(n={}),l["!comments"]=[];var h=[];TL(l,r,t,e,s),s[s.length]=ue("dimension",null,{ref:u}),s[s.length]=NL(l,e,t,r),e.sheetFormat&&(s[s.length]=ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=kL(l,l["!cols"])),s[a=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=OL(l,e),o.length>0&&(s[s.length]=o)),s.length>a+1&&(s[s.length]="</sheetData>",s[a]=s[a].replace("/>",">")),l["!protect"]&&(s[s.length]=AL(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=IL(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=EL(l["!merges"]));var f=-1,p,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=Ge(n,-1,We(m[1].Target).replace(/#.*$/,""),He.HLINK),p["r:id"]="rId"+g),(f=m[1].Target.indexOf("#"))>-1&&(p.location=We(m[1].Target.slice(f+1))),m[1].Tooltip&&(p.tooltip=We(m[1].Tooltip)),s[s.length]=ue("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=bL(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Wt("ignoredErrors",ue("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(g=Ge(n,-1,"../drawings/drawing"+(t+1)+".xml",He.DRAW),s[s.length]=ue("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=Ge(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",He.VML),s[s.length]=ue("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function PL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function LL(t,e,r){var n=q(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;s.hpx?i=Nu(s.hpx)*20:s.hpt&&(i=s.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var a=0;s.level&&(a|=s.level),s.hidden&&(a|=16),(s.hpx||s.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var h=-1,f=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[qe(u)];g&&(h<0&&(h=p),f=p)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,f))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function jL(t,e,r,n){var s=LL(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&Z(t,0,s)}var ML=Li,DL=Qa;function FL(){}function UL(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=YO(t),r}function BL(t,e,r){r==null&&(r=q(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Au({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),SE(t,r),r.slice(0,r.l)}function HL(t){var e=tn(t);return[e]}function zL(t,e,r){return r==null&&(r=q(8)),Ri(e,r)}function $L(t){var e=Oi(t);return[e]}function KL(t,e,r){return r==null&&(r=q(4)),Pi(e,r)}function GL(t){var e=tn(t),r=t.read_shift(1);return[e,r,"b"]}function WL(t,e,r){return r==null&&(r=q(9)),Ri(e,r),r.write_shift(1,t.v?1:0),r}function VL(t){var e=Oi(t),r=t.read_shift(1);return[e,r,"b"]}function qL(t,e,r){return r==null&&(r=q(5)),Pi(e,r),r.write_shift(1,t.v?1:0),r}function YL(t){var e=tn(t),r=t.read_shift(1);return[e,r,"e"]}function QL(t,e,r){return r==null&&(r=q(9)),Ri(e,r),r.write_shift(1,t.v),r}function XL(t){var e=Oi(t),r=t.read_shift(1);return[e,r,"e"]}function JL(t,e,r){return r==null&&(r=q(8)),Pi(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZL(t){var e=tn(t),r=t.read_shift(4);return[e,r,"s"]}function ej(t,e,r){return r==null&&(r=q(12)),Ri(e,r),r.write_shift(4,e.v),r}function tj(t){var e=Oi(t),r=t.read_shift(4);return[e,r,"s"]}function rj(t,e,r){return r==null&&(r=q(8)),Pi(e,r),r.write_shift(4,e.v),r}function nj(t){var e=tn(t),r=Xa(t);return[e,r,"n"]}function sj(t,e,r){return r==null&&(r=q(16)),Ri(e,r),Ei(t.v,r),r}function ij(t){var e=Oi(t),r=Xa(t);return[e,r,"n"]}function aj(t,e,r){return r==null&&(r=q(12)),Pi(e,r),Ei(t.v,r),r}function oj(t){var e=tn(t),r=AE(t);return[e,r,"n"]}function lj(t,e,r){return r==null&&(r=q(12)),Ri(e,r),bE(t.v,r),r}function cj(t){var e=Oi(t),r=AE(t);return[e,r,"n"]}function uj(t,e,r){return r==null&&(r=q(8)),Pi(e,r),bE(t.v,r),r}function dj(t){var e=tn(t),r=qp(t);return[e,r,"is"]}function hj(t){var e=tn(t),r=sr(t);return[e,r,"str"]}function fj(t,e,r){return r==null&&(r=q(12+4*t.v.length)),Ri(e,r),Ut(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pj(t){var e=Oi(t),r=sr(t);return[e,r,"str"]}function mj(t,e,r){return r==null&&(r=q(8+4*t.v.length)),Pi(e,r),Ut(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gj(t,e,r){var n=t.l+e,s=tn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=wd(t,n-t.l,r);a[3]=Ba(o,null,s,r.supbooks,r)}else t.l=n;return a}function vj(t,e,r){var n=t.l+e,s=tn(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=wd(t,n-t.l,r);a[3]=Ba(o,null,s,r.supbooks,r)}else t.l=n;return a}function xj(t,e,r){var n=t.l+e,s=tn(t);s.r=r["!row"];var i=Xa(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=wd(t,n-t.l,r);a[3]=Ba(o,null,s,r.supbooks,r)}else t.l=n;return a}function yj(t,e,r){var n=t.l+e,s=tn(t);s.r=r["!row"];var i=sr(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=wd(t,n-t.l,r);a[3]=Ba(o,null,s,r.supbooks,r)}else t.l=n;return a}var wj=Li,_j=Qa;function Ej(t,e){return e==null&&(e=q(4)),e.write_shift(4,t),e}function Tj(t,e){var r=t.l+e,n=Li(t),s=Yp(t),i=sr(t),a=sr(t),o=sr(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function Cj(t,e){var r=q(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Qa({s:Ft(t[0]),e:Ft(t[0])},r),Qp("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return Ut(s||"",r),Ut(t[1].Tooltip||"",r),Ut("",r),r.slice(0,r.l)}function Sj(){}function Aj(t,e,r){var n=t.l+e,s=kE(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=pL(t,n-t.l,r);a[1]=o}else t.l=n;return a}function bj(t,e,r){var n=t.l+e,s=Li(t),i=[s];if(r.cellFormula){var a=gL(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}function kj(t,e,r){r==null&&(r=q(18));var n=_d(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var dT=["left","right","top","bottom","header","footer"];function Ij(t){var e={};return dT.forEach(function(r){e[r]=Xa(t)}),e}function Nj(t,e){return e==null&&(e=q(6*8)),cT(t),dT.forEach(function(r){Ei(t[r],e)}),e}function Rj(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Oj(t,e,r){r==null&&(r=q(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Pj(t){var e=q(24);return e.write_shift(4,4),e.write_shift(4,1),Qa(t,e),e}function Lj(t,e){return e==null&&(e=q(16*4+2)),e.write_shift(2,t.password?WE(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function jj(){}function Mj(){}function Dj(t,e,r,n,s,i,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Sr(e),e.z=e.z||vt[14],e.v=Cr(fr(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Ws(s.cellXfs,e,s),e.l&&i["!links"].push([qe(l),e.l]),e.c&&i["!comments"].push([qe(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=rm(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,a?Z(t,18,rj(e,l)):Z(t,7,ej(e,l))):(l.t="str",a?Z(t,17,mj(e,l)):Z(t,6,fj(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?Z(t,13,uj(e,l)):Z(t,2,lj(e,l)):a?Z(t,16,aj(e,l)):Z(t,5,sj(e,l)),!0;case"b":return l.t="b",a?Z(t,15,qL(e,l)):Z(t,4,WL(e,l)),!0;case"e":return l.t="e",a?Z(t,14,JL(e,l)):Z(t,3,QL(e,l)),!0}return a?Z(t,12,KL(e,l)):Z(t,1,zL(e,l)),!0}function Fj(t,e,r,n){var s=it(e["!ref"]||"A1"),i,a="",o=[];Z(t,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){a=qt(d),jL(t,e,s,d);var h=!1;if(d<=s.e.r)for(var f=s.s.c;f<=s.e.c;++f){d===s.s.r&&(o[f]=nr(f)),i=o[f]+a;var p=l?(e[d]||[])[f]:e[i];if(!p){h=!1;continue}h=Dj(t,p,d,f,n,e,h)}}Z(t,146)}function Uj(t,e){!e||!e["!merges"]||(Z(t,177,Ej(e["!merges"].length)),e["!merges"].forEach(function(r){Z(t,176,_j(r))}),Z(t,178))}function Bj(t,e){!e||!e["!cols"]||(Z(t,390),e["!cols"].forEach(function(r,n){r&&Z(t,60,kj(n,r))}),Z(t,391))}function Hj(t,e){!e||!e["!ref"]||(Z(t,648),Z(t,649,Pj(it(e["!ref"]))),Z(t,650))}function zj(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Ge(r,-1,n[1].Target.replace(/#.*$/,""),He.HLINK);Z(t,494,Cj(n,s))}}),delete e["!links"]}function $j(t,e,r,n){if(e["!comments"].length>0){var s=Ge(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",He.VML);Z(t,551,Qp("rId"+s)),e["!legacy"]=s}}function Kj(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],i=typeof s.ref=="string"?s.ref:St(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ur(i);o.s.r==o.e.r&&(o.e.r=Ur(e["!ref"]).e.r,i=St(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Z(t,161,Qa(it(i))),Z(t,162)}}function Gj(t,e,r){Z(t,133),Z(t,137,Oj(e,r)),Z(t,138),Z(t,134)}function Wj(t,e){e["!protect"]&&Z(t,535,Lj(e["!protect"]))}function Vj(t,e,r,n){var s=Tr(),i=r.SheetNames[t],a=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=it(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Z(s,129),(r.vbaraw||a["!outline"])&&Z(s,147,BL(o,a["!outline"])),Z(s,148,DL(l)),Gj(s,a,r.Workbook),Bj(s,a),Fj(s,a,t,e),Wj(s,a),Kj(s,a,r,t),Uj(s,a),zj(s,a,n),a["!margins"]&&Z(s,476,Nj(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Hj(s,a),$j(s,a,t,n),Z(s,130),s.end()}function qj(t,e){t.l+=10;var r=sr(t);return{name:r}}var Yj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Qj(t){return!t.Workbook||!t.Workbook.WBProps?"false":bO(t.Workbook.WBProps.date1904)?"true":"false"}var Xj="][*?/\\".split("");function hT(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Xj.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Jj(t,e,r){t.forEach(function(n,s){hT(n);for(var i=0;i<s;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[s]&&e[s].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Zj(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Jj(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)_L(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function fT(t){var e=[At];e[e.length]=ue("workbook",null,{xmlns:qa[0],"xmlns:r":Dt.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Yj.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ue("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var a={name:We(t.SheetNames[i].slice(0,31))};if(a.sheetId=""+(i+1),a["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ue("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=ue("definedName",We(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function eM(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Vf(t),r.name=sr(t),r}function tM(t,e){return e||(e=q(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Qp(t.strRelID,e),Ut(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rM(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?sr(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function nM(t,e){e||(e=q(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),SE(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function sM(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=QO(t),a=mL(t,0,r),o=Yp(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function iM(t,e){Z(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Z(t,156,tM(s))}Z(t,144)}function aM(t,e){e||(e=q(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ut("SheetJS",e),Ut(yu.version,e),Ut(yu.version,e),Ut("7262",e),e.length>e.l?e.slice(0,e.l):e}function oM(t,e){e||(e=q(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function lM(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&i==-1&&(i=n);i>s||(Z(t,135),Z(t,158,oM(s)),Z(t,136))}}function cM(t,e){var r=Tr();return Z(r,131),Z(r,128,aM()),Z(r,153,nM(t.Workbook&&t.Workbook.WBProps||null)),lM(r,t),iM(r,t),Z(r,132),r.end()}function uM(t,e,r){return(e.slice(-4)===".bin"?cM:fT)(t)}function dM(t,e,r,n,s){return(e.slice(-4)===".bin"?Vj:uT)(t,r,n,s)}function hM(t,e,r){return(e.slice(-4)===".bin"?N4:YE)(t,r)}function fM(t,e,r){return(e.slice(-4)===".bin"?n4:GE)(t,r)}function pM(t,e,r){return(e.slice(-4)===".bin"?W4:eT)(t)}function mM(t){return(t.slice(-4)===".bin"?F4:JE)()}function gM(t,e){var r=[];return t.Props&&r.push(hP(t.Props,e)),t.Custprops&&r.push(fP(t.Props,t.Custprops)),r.join("")}function vM(){return""}function xM(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var i=[];i.push(ue("NumberFormat",null,{"ss:Format":We(vt[n.numFmtId])}));var a={"ss:ID":"s"+(21+s)};r.push(ue("Style",i.join(""),a))}),ue("Styles",r.join(""))}function pT(t){return ue("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+em(t.Ref,{r:0,c:0})})}function yM(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(pT(s)))}return ue("Names",r.join(""))}function wM(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,i=[],a=0;a<s.length;++a){var o=s[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(pT(o)))}return i.join("")}function _M(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(ue("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(ue("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(ue("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(Wt("ProtectContents","True")),t["!protect"].objects&&s.push(Wt("ProtectObjects","True")),t["!protect"].scenarios&&s.push(Wt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(Wt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(Wt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&s.push("<"+a[1]+"/>")})),s.length==0?"":ue("WorksheetOptions",s.join(""),{xmlns:Pr.x})}function EM(t){return t.map(function(e){var r=AO(e.t||""),n=ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ue("Comment",n,{"ss:Author":e.a})}).join("")}function TM(t,e,r,n,s,i,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+We(em(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var l=Ft(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=We(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=We(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=a.c||u[d].s.r!=a.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var h="",f="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",f=String(t.v);break;case"b":h="Boolean",f=t.v?"1":"0";break;case"e":h="Error",f=Rl[t.v];break;case"d":h="DateTime",f=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||vt[14]);break;case"s":h="String",f=SO(t.v||"");break}var p=Ws(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var g=t.v!=null?f:"",m=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(m+=EM(t.c)),ue("Cell",m,o)}function CM(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qE(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function SM(t,e,r,n){if(!t["!ref"])return"";var s=it(t["!ref"]),i=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,v){Jp(w);var y=!!w.width,x=_d(v,w),_={"ss:Index":v+1};y&&(_["ss:Width"]=ku(x.width)),w.hidden&&(_["ss:Hidden"]="1"),o.push(ue("Column",null,_))});for(var l=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var d=[CM(u,(t["!rows"]||[])[u])],h=s.s.c;h<=s.e.c;++h){var f=!1;for(a=0;a!=i.length;++a)if(!(i[a].s.c>h)&&!(i[a].s.r>u)&&!(i[a].e.c<h)&&!(i[a].e.r<u)){(i[a].s.c!=h||i[a].s.r!=u)&&(f=!0);break}if(!f){var p={r:u,c:h},g=qe(p),m=l?(t[u]||[])[h]:t[g];d.push(TM(m,g,t,e,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function AM(t,e,r){var n=[],s=r.SheetNames[t],i=r.Sheets[s],a=i?wM(i,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=i?SM(i,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(_M(i,e,t,r)),n.join("")}function bM(t,e){e||(e={}),t.SSF||(t.SSF=Sr(vt)),t.SSF&&(gd(),md(t.SSF),e.revssf=vd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ws(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(gM(t,e)),r.push(vM()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ue("Worksheet",AM(n,e,t),{"ss:Name":We(t.SheetNames[n])}));return r[2]=xM(t,e),r[3]=yM(t),At+ue("Workbook",r.join(""),{xmlns:Pr.ss,"xmlns:o":Pr.o,"xmlns:x":Pr.x,"xmlns:ss":Pr.ss,"xmlns:dt":Pr.dt,"xmlns:html":Pr.html})}var xh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kM(t,e){var r=[],n=[],s=[],i=0,a,o=Dv(Qv,"n"),l=Dv(Xv,"n");if(t.Props)for(a=Qt(t.Props),i=0;i<a.length;++i)(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Props[a[i]]]);if(t.Custprops)for(a=Qt(t.Custprops),i=0;i<a.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},a[i])||(Object.prototype.hasOwnProperty.call(o,a[i])?r:Object.prototype.hasOwnProperty.call(l,a[i])?n:s).push([a[i],t.Custprops[a[i]]]);var u=[];for(i=0;i<s.length;++i)FE.indexOf(s[i][0])>-1||jE.indexOf(s[i][0])>-1||s[i][1]!=null&&u.push(s[i]);n.length&&Qe.utils.cfb_add(e,"/SummaryInformation",rx(n,xh.SI,l,Xv)),(r.length||u.length)&&Qe.utils.cfb_add(e,"/DocumentSummaryInformation",rx(r,xh.DSI,o,Qv,u.length?u:null,xh.UDI))}function IM(t,e){var r=e||{},n=Qe.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qe.utils.cfb_add(n,s,mT(t,r)),r.biff==8&&(t.Props||t.Custprops)&&kM(t,n),r.biff==8&&t.vbaraw&&V4(n,Qe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var NM={0:{f:PL},1:{f:HL},2:{f:oj},3:{f:YL},4:{f:GL},5:{f:nj},6:{f:hj},7:{f:ZL},8:{f:yj},9:{f:xj},10:{f:gj},11:{f:vj},12:{f:$L},13:{f:cj},14:{f:XL},15:{f:VL},16:{f:ij},17:{f:pj},18:{f:tj},19:{f:qp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sM},40:{},42:{},43:{f:h4},44:{f:u4},45:{f:m4},46:{f:v4},47:{f:g4},48:{},49:{f:$O},50:{},51:{f:P4},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:KP},62:{f:dj},63:{f:U4},64:{f:jj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Fn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Rj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:UL},148:{f:ML,p:16},151:{f:Sj},152:{},153:{f:rM},154:{},155:{},156:{f:eM},157:{},158:{},159:{T:1,f:e4},160:{T:-1},161:{T:1,f:Li},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:R4},336:{T:-1},337:{f:M4,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:FP},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Aj},427:{f:bj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ij},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Tj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:K4},633:{T:1},634:{T:-1},635:{T:1,f:z4},636:{T:-1},637:{f:VO},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Mj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function de(t,e,r,n){var s=e;if(!isNaN(s)){var i=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&Gp(r)&&t.push(r)}}function RM(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return de(t,e,r,s);var i=e;if(!isNaN(i)){for(var a=r.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<s;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Pl(t,e,r){return t||(t=q(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function OM(t,e,r,n){var s=q(9);return Pl(s,t,e),BE(r,n||"b",s),s}function PM(t,e,r){var n=q(8+2*r.length);return Pl(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function LM(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Cr(fr(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?de(t,2,qP(r,n,s)):de(t,3,VP(r,n,s));return;case"b":case"e":de(t,5,OM(r,n,e.v,e.t));return;case"s":case"str":de(t,4,PM(r,n,(e.v||"").slice(0,255)));return}de(t,1,Pl(null,r,n))}function jM(t,e,r,n){var s=Array.isArray(e),i=it(e["!ref"]||"A1"),a,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),a=St(i)}for(var u=i.s.r;u<=i.e.r;++u){o=qt(u);for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(l[d]=nr(d)),a=l[d]+o;var h=s?(e[u]||[])[d]:e[a];h&&LM(t,h,u,d)}}}function MM(t,e){for(var r=e||{},n=Tr(),s=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return de(n,r.biff==4?1033:r.biff==3?521:9,Xp(t,16,r)),jM(n,t.Sheets[t.SheetNames[s]],s,r),de(n,10),n.end()}function DM(t,e,r){de(t,49,NP({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function FM(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&de(t,1054,PP(s,e[s],r))})}function UM(t,e){var r=q(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),de(t,2151,r),r=q(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),$E(it(e["!ref"]||"A1"),r),r.write_shift(4,4),de(t,2152,r)}function BM(t,e){for(var r=0;r<16;++r)de(t,224,sx({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){de(t,224,sx(n,0,e))})}function HM(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];de(t,440,HP(n)),n[1].Tooltip&&de(t,2048,zP(n))}delete e["!links"]}function zM(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&de(t,125,GP(_d(s,n),s))})}}function $M(t,e,r,n,s){var i=16+Ws(s.cellXfs,e,s);if(e.v==null&&!e.bf){de(t,513,Ti(r,n,i));return}if(e.bf)de(t,6,fL(e,r,n,s,i));else switch(e.t){case"d":case"n":var a=e.t=="d"?Cr(fr(e.v)):e.v;de(t,515,DP(r,n,a,i));break;case"b":case"e":de(t,517,MP(r,n,e.v,i,s,e.t));break;case"s":case"str":if(s.bookSST){var o=rm(s.Strings,e.v,s.revStrings);de(t,253,RP(r,n,o,i))}else de(t,516,OP(r,n,(e.v||"").slice(0,255),i,s));break;default:de(t,513,Ti(r,n,i))}}function KM(t,e,r){var n=Tr(),s=r.SheetNames[t],i=r.Sheets[s]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},l=Array.isArray(i),u=e.biff==8,d,h="",f=[],p=it(i["!ref"]||"A1"),g=u?65536:16384;if(p.e.c>255||p.e.r>=g){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}de(n,2057,Xp(r,16,e)),de(n,13,Gr(1)),de(n,12,Gr(100)),de(n,15,dr(!0)),de(n,17,dr(!1)),de(n,16,Ei(.001)),de(n,95,dr(!0)),de(n,42,dr(!1)),de(n,43,dr(!1)),de(n,130,Gr(1)),de(n,128,jP()),de(n,131,dr(!1)),de(n,132,dr(!1)),u&&zM(n,i["!cols"]),de(n,512,LP(p,e)),u&&(i["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){h=qt(m);for(var w=p.s.c;w<=p.e.c;++w){m===p.s.r&&(f[w]=nr(w)),d=f[w]+h;var v=l?(i[m]||[])[w]:i[d];v&&($M(n,v,m,w,e),u&&v.l&&i["!links"].push([d,v.l]))}}var y=o.CodeName||o.name||s;return u&&de(n,574,IP((a.Views||[])[0])),u&&(i["!merges"]||[]).length&&de(n,229,BP(i["!merges"])),u&&HM(n,i),de(n,442,zE(y)),u&&UM(n,i),de(n,10),n.end()}function GM(t,e,r){var n=Tr(),s=(t||{}).Workbook||{},i=s.Sheets||[],a=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(de(n,2057,Xp(t,5,r)),r.bookType=="xla"&&de(n,135),de(n,225,o?Gr(1200):null),de(n,193,gP(2)),l&&de(n,191),l&&de(n,192),de(n,226),de(n,92,SP("SheetJS",r)),de(n,66,Gr(o?1200:1252)),o&&de(n,353,Gr(0)),o&&de(n,448),de(n,317,WP(t.SheetNames.length)),o&&t.vbaraw&&de(n,211),o&&t.vbaraw){var u=a.CodeName||"ThisWorkbook";de(n,442,zE(u))}de(n,156,Gr(17)),de(n,25,dr(!1)),de(n,18,dr(!1)),de(n,19,Gr(0)),o&&de(n,431,dr(!1)),o&&de(n,444,Gr(0)),de(n,61,kP()),de(n,64,dr(!1)),de(n,141,Gr(0)),de(n,34,dr(Qj(t)=="true")),de(n,14,dr(!0)),o&&de(n,439,dr(!1)),de(n,218,Gr(0)),DM(n,t,r),FM(n,t.SSF,r),BM(n,r),o&&de(n,352,dr(!1));var d=n.end(),h=Tr();o&&de(h,140,$P()),o&&r.Strings&&RM(h,252,bP(r.Strings)),de(h,10);var f=h.end(),p=Tr(),g=0,m=0;for(m=0;m<t.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var w=d.length+g+f.length;for(m=0;m<t.SheetNames.length;++m){var v=i[m]||{};de(p,133,AP({pos:w,hs:v.Hidden||0,dt:0,name:t.SheetNames[m]},r)),w+=e[m].length}var y=p.end();if(g!=y.length)throw new Error("BS8 "+g+" != "+y.length);var x=[];return d.length&&x.push(d),y.length&&x.push(y),f.length&&x.push(f),Gt(x)}function WM(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Sr(vt)),t&&t.SSF&&(gd(),md(t.SSF),r.revssf=vd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,nm(r),r.cellXfs=[],Ws(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=KM(s,r,t);return n.unshift(GM(t,n,r)),Gt(n)}function mT(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Ur(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return WM(t,e);case 4:case 3:case 2:return MM(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function VM(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>a)&&!(s[u].e.r<r||s[u].e.c<a)){if(s[u].s.r<r||s[u].s.c<a){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=qe({r,c:a}),h=n.dense?(t[r]||[])[a]:t[d],f=h&&h.v!=null&&(h.h||CO(h.w||(ls(h),h.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(p["data-t"]=h&&h.t||"z",h.v!=null&&(p["data-v"]=h.v),h.z!=null&&(p["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),p.id=(n.id||"sjs")+"-"+d,i.push(ue("td",f,p))}}var g="<tr>";return g+i.join("")+"</tr>"}var qM='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',YM="</body></html>";function QM(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function gT(t,e){var r=e||{},n=r.header!=null?r.header:qM,s=r.footer!=null?r.footer:YM,i=[n],a=Ur(t["!ref"]);r.dense=Array.isArray(t),i.push(QM(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(VM(t,a,o,r));return i.push("</table>"+s),i.join("")}function vT(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?Ft(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var d=Ur(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var h=[],f=0,p=t["!rows"]||(t["!rows"]=[]),g=0,m=0,w=0,v=0,y=0,x=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&m<l;++g){var _=o[g];if(dx(_)){if(n.display)continue;p[m]={hidden:!0}}var P=_.children;for(w=v=0;w<P.length;++w){var S=P[w];if(!(n.display&&dx(S))){var T=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):kO(S.innerHTML),O=S.getAttribute("data-z")||S.getAttribute("z");for(f=0;f<h.length;++f){var L=h[f];L.s.c==v+i&&L.s.r<m+s&&m+s<=L.e.r&&(v=L.e.c+1-i,f=-1)}x=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||x>1)&&h.push({s:{r:m+s,c:v+i},e:{r:m+s+(y||1)-1,c:v+i+(x||1)-1}});var j={t:"s",v:T},G=S.getAttribute("data-t")||S.getAttribute("t")||"";T!=null&&(T.length==0?j.t=G||"z":n.raw||T.trim().length==0||G=="s"||(T==="TRUE"?j={t:"b",v:!0}:T==="FALSE"?j={t:"b",v:!1}:isNaN(es(T))?isNaN(cl(T).getDate())||(j={t:"d",v:fr(T)},n.cellDates||(j={t:"n",v:Cr(j.v)}),j.z=n.dateNF||vt[14]):j={t:"n",v:es(T)})),j.z===void 0&&O!=null&&(j.z=O);var W="",re=S.getElementsByTagName("A");if(re&&re.length)for(var te=0;te<re.length&&!(re[te].hasAttribute("href")&&(W=re[te].getAttribute("href"),W.charAt(0)!="#"));++te);W&&W.charAt(0)!="#"&&(j.l={Target:W}),n.dense?(t[m+s]||(t[m+s]=[]),t[m+s][v+i]=j):t[qe({c:v+i,r:m+s})]=j,u.e.c<v+i&&(u.e.c=v+i),v+=x}}++m}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,m-1+s),t["!ref"]=St(u),m>=l&&(t["!fullref"]=St((u.e.r=o.length-g+m-1+s,u))),t}function xT(t,e){var r=e||{},n=r.dense?[]:{};return vT(n,t,e)}function XM(t,e){return Ni(xT(t,e),e)}function dx(t){var e="",r=JM(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function JM(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ZM=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return At+e}}(),hx=function(){var t=function(i){return We(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,a,o){var l=[];l.push('      <table:table table:name="'+We(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,h=Ur(i["!ref"]||"A1"),f=i["!merges"]||[],p=0,g=Array.isArray(i);if(i["!cols"])for(d=0;d<=h.e.c;++d)l.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var m="",w=i["!rows"]||[];for(u=0;u<h.s.r;++u)m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=h.e.r;++u){for(m=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+m+`>
`),d=0;d<h.s.c;++d)l.push(e);for(;d<=h.e.c;++d){var v=!1,y={},x="";for(p=0;p!=f.length;++p)if(!(f[p].s.c>d)&&!(f[p].s.r>u)&&!(f[p].e.c<d)&&!(f[p].e.r<u)){(f[p].s.c!=d||f[p].s.r!=u)&&(v=!0),y["table:number-columns-spanned"]=f[p].e.c-f[p].s.c+1,y["table:number-rows-spanned"]=f[p].e.r-f[p].s.r+1;break}if(v){l.push(r);continue}var _=qe({r:u,c:d}),P=g?(i[u]||[])[d]:i[_];if(P&&P.f&&(y["table:formula"]=We(yL(P.f)),P.F&&P.F.slice(0,_.length)==_)){var S=Ur(P.F);y["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,y["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!P){l.push(e);continue}switch(P.t){case"b":x=P.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=P.v?"true":"false";break;case"n":x=P.w||String(P.v||0),y["office:value-type"]="float",y["office:value"]=P.v||0;break;case"s":case"str":x=P.v==null?"":P.v,y["office:value-type"]="string";break;case"d":x=P.w||fr(P.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=fr(P.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(e);continue}var T=t(x);if(P.l&&P.l.Target){var O=P.l.Target;O=O.charAt(0)=="#"?"#"+wL(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),T=ue("text:a",T,{"xlink:href":O.replace(/&/g,"&amp;")})}l.push("          "+ue("table:table-cell",ue("text:p",T,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,a){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var h=u["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Jp(h),h.ods=o;var f=u["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+f+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var h=u["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(a,o){var l=[At],u=dl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=dl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(PE().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function yT(t,e){if(e.bookType=="fods")return hx(t,e);var r=Hp(),n="",s=[],i=[];return n="mimetype",Le(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Le(r,n,hx(t,e)),s.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Le(r,n,ZM(t,e)),s.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Le(r,n,At+PE()),s.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Le(r,n,dP(i)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Le(r,n,cP(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ru(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function eD(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):fn(ul(t))}function tD(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Hs(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function rD(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;s>=1;++i,s/=256)t[e+i]=s&255;t[e+15]|=r>=0?0:128}function hl(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function $e(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Sa(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function kt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=hl(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=hl(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:i};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function zt(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push($e(n*8+s.type)),s.type==2&&e.push($e(s.data.length)),e.push(s.data))})}),Hs(e)}function nn(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=hl(t,n),i=kt(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:Sa(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=kt(o.data),u=Sa(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=i[3])!=null&&e[0]&&(a.merge=Sa(i[3][0].data)>>>0>0),r.push(a)}return r}function Ki(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:$e(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$e(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(a){s.push(a.data),a.meta[3]=[{type:0,data:$e(a.data.length)}],n[2].push({data:zt(a.meta),type:2})});var i=zt(n);e.push($e(i.length)),e.push(i),s.forEach(function(a){return e.push(a)})}),Hs(e)}function nD(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=hl(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,u=0;if(i==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Hs(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Hs(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function sn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(nD(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Hs(e)}function Gi(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var i=$e(n),a=i.length;e.push(i),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,s[0]=0,s[1]=a&255,s[2]=a>>8&255,s[3]=a>>16&255,r+=n}return Hs(e)}function yh(t,e){var r=new Uint8Array(32),n=Ru(r),s=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,rD(r,s,t.v),i|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),i|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,s)}function wh(t,e){var r=new Uint8Array(32),n=Ru(r),s=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),i|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),i|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,s)}function ps(t){var e=kt(t);return hl(e[1][0].data)}function sD(t,e,r){var n,s,i,a;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(i=t[8])==null?void 0:i[0])==null?void 0:a.data)&&Sa(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Ru(t[7][0].data),d=0,h=[],f=Ru(t[4][0].data),p=0,g=[],m=0;m<e.length;++m){if(e[m]==null){u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535);continue}u.setUint16(m*2,d,!0),f.setUint16(m*2,p,!0);var w,v;switch(typeof e[m]){case"string":w=yh({t:"s",v:e[m]},r),v=wh({t:"s",v:e[m]},r);break;case"number":w=yh({t:"n",v:e[m]},r),v=wh({t:"n",v:e[m]},r);break;case"boolean":w=yh({t:"b",v:e[m]},r),v=wh({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}h.push(w),d+=w.length,g.push(v),p+=v.length,++l}for(t[2][0].data=$e(l);m<t[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),f.setUint16(m*2,65535,!0);return t[6][0].data=Hs(h),t[3][0].data=Hs(g),l}function iD(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ur(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(St(n)));var i=Ou(r,{range:n,header:1}),a=["~Sh33tJ5~"];i.forEach(function(F){return F.forEach(function(D){typeof D=="string"&&a.push(D)})});var o={},l=[],u=Qe.read(e.numbers,{type:"base64"});u.FileIndex.map(function(F,D){return[F,u.FullPaths[D]]}).forEach(function(F){var D=F[0],M=F[1];if(D.type==2&&D.name.match(/\.iwa/)){var J=D.content,xe=sn(J),Se=nn(xe);Se.forEach(function(R){l.push(R.id),o[R.id]={deps:[],location:M,type:Sa(R.messages[0].meta[1][0].data)}})}}),l.sort(function(F,D){return F-D});var d=l.filter(function(F){return F>1}).map(function(F){return[F,$e(F)]});u.FileIndex.map(function(F,D){return[F,u.FullPaths[D]]}).forEach(function(F){var D=F[0];if(F[1],!!D.name.match(/\.iwa/)){var M=nn(sn(D.content));M.forEach(function(J){J.messages.forEach(function(xe){d.forEach(function(Se){J.messages.some(function(R){return Sa(R.meta[1][0].data)!=11006&&tD(R.data,Se[1])})&&o[Se[0]].deps.push(J.id)})})})}});for(var h=Qe.find(u,o[1].location),f=nn(sn(h.content)),p,g=0;g<f.length;++g){var m=f[g];m.id==1&&(p=m)}var w=ps(kt(p.messages[0].data)[1][0].data);for(h=Qe.find(u,o[w].location),f=nn(sn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);for(w=ps(kt(p.messages[0].data)[2][0].data),h=Qe.find(u,o[w].location),f=nn(sn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);for(w=ps(kt(p.messages[0].data)[2][0].data),h=Qe.find(u,o[w].location),f=nn(sn(h.content)),g=0;g<f.length;++g)m=f[g],m.id==w&&(p=m);var v=kt(p.messages[0].data);{v[6][0].data=$e(n.e.r+1),v[7][0].data=$e(n.e.c+1);var y=ps(v[46][0].data),x=Qe.find(u,o[y].location),_=nn(sn(x.content));{for(var P=0;P<_.length&&_[P].id!=y;++P);if(_[P].id!=y)throw"Bad ColumnRowUIDMapArchive";var S=kt(_[P].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var T=0;T<=n.e.c;++T){var O=[];O[1]=O[2]=[{type:0,data:$e(T+420690)}],S[1].push({type:2,data:zt(O)}),S[2].push({type:0,data:$e(T)}),S[3].push({type:0,data:$e(T)})}S[4]=[],S[5]=[],S[6]=[];for(var L=0;L<=n.e.r;++L)O=[],O[1]=O[2]=[{type:0,data:$e(L+726270)}],S[4].push({type:2,data:zt(O)}),S[5].push({type:0,data:$e(L)}),S[6].push({type:0,data:$e(L)});_[P].messages[0].data=zt(S)}x.content=Gi(Ki(_)),x.size=x.content.length,delete v[46];var j=kt(v[4][0].data);{j[7][0].data=$e(n.e.r+1);var G=kt(j[1][0].data),W=ps(G[2][0].data);x=Qe.find(u,o[W].location),_=nn(sn(x.content));{if(_[0].id!=W)throw"Bad HeaderStorageBucket";var re=kt(_[0].messages[0].data);for(L=0;L<i.length;++L){var te=kt(re[2][0].data);te[1][0].data=$e(L),te[4][0].data=$e(i[L].length),re[2][L]={type:re[2][0].type,data:zt(te)}}_[0].messages[0].data=zt(re)}x.content=Gi(Ki(_)),x.size=x.content.length;var me=ps(j[2][0].data);x=Qe.find(u,o[me].location),_=nn(sn(x.content));{if(_[0].id!=me)throw"Bad HeaderStorageBucket";for(re=kt(_[0].messages[0].data),T=0;T<=n.e.c;++T)te=kt(re[2][0].data),te[1][0].data=$e(T),te[4][0].data=$e(n.e.r+1),re[2][T]={type:re[2][0].type,data:zt(te)};_[0].messages[0].data=zt(re)}x.content=Gi(Ki(_)),x.size=x.content.length;var ne=ps(j[4][0].data);(function(){for(var F=Qe.find(u,o[ne].location),D=nn(sn(F.content)),M,J=0;J<D.length;++J){var xe=D[J];xe.id==ne&&(M=xe)}var Se=kt(M.messages[0].data);{Se[3]=[];var R=[];a.forEach(function(ie,Ne){R[1]=[{type:0,data:$e(Ne)}],R[2]=[{type:0,data:$e(1)}],R[3]=[{type:2,data:eD(ie)}],Se[3].push({type:2,data:zt(R)})})}M.messages[0].data=zt(Se);var ee=Ki(D),be=Gi(ee);F.content=be,F.size=F.content.length})();var Ce=kt(j[3][0].data);{var se=Ce[1][0];delete Ce[2];var fe=kt(se.data);{var Ee=ps(fe[2][0].data);(function(){for(var F=Qe.find(u,o[Ee].location),D=nn(sn(F.content)),M,J=0;J<D.length;++J){var xe=D[J];xe.id==Ee&&(M=xe)}var Se=kt(M.messages[0].data);{delete Se[6],delete Ce[7];var R=new Uint8Array(Se[5][0].data);Se[5]=[];for(var ee=0,be=0;be<=n.e.r;++be){var ie=kt(R);ee+=sD(ie,i[be],a),ie[1][0].data=$e(be),Se[5].push({data:zt(ie),type:2})}Se[1]=[{type:0,data:$e(n.e.c+1)}],Se[2]=[{type:0,data:$e(n.e.r+1)}],Se[3]=[{type:0,data:$e(ee)}],Se[4]=[{type:0,data:$e(n.e.r+1)}]}M.messages[0].data=zt(Se);var Ne=Ki(D),ke=Gi(Ne);F.content=ke,F.size=F.content.length})()}se.data=zt(fe)}j[3][0].data=zt(Ce)}v[4][0].data=zt(j)}p.messages[0].data=zt(v);var X=Ki(f),N=Gi(X);return h.content=N,h.size=h.content.length,u}function aD(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function nm(t){aD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function oD(t,e){return e.bookType=="ods"?yT(t,e):e.bookType=="numbers"?iD(t,e):e.bookType=="xlsb"?lD(t,e):cD(t,e)}function lD(t,e){fa=1024,t&&!t.SSF&&(t.SSF=Sr(vt)),t&&t.SSF&&(gd(),md(t.SSF),e.revssf=vd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=tT.indexOf(e.bookType)>-1,s=NE();nm(e=e||{});var i=Hp(),a="",o=0;if(e.cellXfs=[],Ws(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Le(i,a,LE(t.Props,e)),s.coreprops.push(a),Ge(e.rels,2,a,He.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,Le(i,a,ME(t.Props)),s.extprops.push(a),Ge(e.rels,3,a,He.EXT_PROPS),t.Custprops!==t.Props&&Qt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Le(i,a,DE(t.Custprops)),s.custprops.push(a),Ge(e.rels,4,a,He.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Le(i,a,dM(o-1,a,e,t,d)),s.sheets.push(a),Ge(e.wbrels,-1,"worksheets/sheet"+o+"."+r,He.WS[0])}if(h){var p=h["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Le(i,m,pM(p,m)),s.comments.push(m),Ge(d,-1,"../comments"+o+"."+r,He.CMNT),g=!0),h["!legacy"]&&g&&Le(i,"xl/drawings/vmlDrawing"+o+".vml",ZE(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Le(i,OE(a),Ta(d))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Le(i,a,fM(e.Strings,a,e)),s.strs.push(a),Ge(e.wbrels,-1,"sharedStrings."+r,He.SST)),a="xl/workbook."+r,Le(i,a,uM(t,a)),s.workbooks.push(a),Ge(e.rels,1,a,He.WB),a="xl/theme/theme1.xml",Le(i,a,XE(t.Themes,e)),s.themes.push(a),Ge(e.wbrels,-1,"theme/theme1.xml",He.THEME),a="xl/styles."+r,Le(i,a,hM(t,a,e)),s.styles.push(a),Ge(e.wbrels,-1,"styles."+r,He.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Le(i,a,t.vbaraw),s.vba.push(a),Ge(e.wbrels,-1,"vbaProject.bin",He.VBA)),a="xl/metadata."+r,Le(i,a,mM(a)),s.metadata.push(a),Ge(e.wbrels,-1,"metadata."+r,He.XLMETA),Le(i,"[Content_Types].xml",RE(s,e)),Le(i,"_rels/.rels",Ta(e.rels)),Le(i,"xl/_rels/workbook."+r+".rels",Ta(e.wbrels)),delete e.revssf,delete e.ssf,i}function cD(t,e){fa=1024,t&&!t.SSF&&(t.SSF=Sr(vt)),t&&t.SSF&&(gd(),md(t.SSF),e.revssf=vd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Uo?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=tT.indexOf(e.bookType)>-1,s=NE();nm(e=e||{});var i=Hp(),a="",o=0;if(e.cellXfs=[],Ws(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Le(i,a,LE(t.Props,e)),s.coreprops.push(a),Ge(e.rels,2,a,He.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,Le(i,a,ME(t.Props)),s.extprops.push(a),Ge(e.rels,3,a,He.EXT_PROPS),t.Custprops!==t.Props&&Qt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Le(i,a,DE(t.Custprops)),s.custprops.push(a),Ge(e.rels,4,a,He.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Le(i,a,uT(o-1,e,t,h)),s.sheets.push(a),Ge(e.wbrels,-1,"worksheets/sheet"+o+"."+r,He.WS[0])}if(f){var g=f["!comments"],m=!1,w="";if(g&&g.length>0){var v=!1;g.forEach(function(y){y[1].forEach(function(x){x.T==!0&&(v=!0)})}),v&&(w="xl/threadedComments/threadedComment"+o+"."+r,Le(i,w,B4(g,d,e)),s.threadedcomments.push(w),Ge(h,-1,"../threadedComments/threadedComment"+o+"."+r,He.TCMNT)),w="xl/comments"+o+"."+r,Le(i,w,eT(g)),s.comments.push(w),Ge(h,-1,"../comments"+o+"."+r,He.CMNT),m=!0}f["!legacy"]&&m&&Le(i,"xl/drawings/vmlDrawing"+o+".vml",ZE(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Le(i,OE(a),Ta(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Le(i,a,GE(e.Strings,e)),s.strs.push(a),Ge(e.wbrels,-1,"sharedStrings."+r,He.SST)),a="xl/workbook."+r,Le(i,a,fT(t)),s.workbooks.push(a),Ge(e.rels,1,a,He.WB),a="xl/theme/theme1.xml",Le(i,a,XE(t.Themes,e)),s.themes.push(a),Ge(e.wbrels,-1,"theme/theme1.xml",He.THEME),a="xl/styles."+r,Le(i,a,YE(t,e)),s.styles.push(a),Ge(e.wbrels,-1,"styles."+r,He.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Le(i,a,t.vbaraw),s.vba.push(a),Ge(e.wbrels,-1,"vbaProject.bin",He.VBA)),a="xl/metadata."+r,Le(i,a,JE()),s.metadata.push(a),Ge(e.wbrels,-1,"metadata."+r,He.XLMETA),d.length>1&&(a="xl/persons/person.xml",Le(i,a,H4(d)),s.people.push(a),Ge(e.wbrels,-1,"persons/person.xml",He.PEOPLE)),Le(i,"[Content_Types].xml",RE(s,e)),Le(i,"_rels/.rels",Ta(e.rels)),Le(i,"xl/_rels/workbook."+r+".rels",Ta(e.wbrels)),delete e.revssf,delete e.ssf,i}function uD(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=os(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wT(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Il(e.file,Qe.write(t,{type:ze?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Qe.write(t,e)}function dD(t,e){var r=Sr(e||{}),n=oD(t,r);return hD(n,r)}function hD(t,e){var r={},n=ze?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Qe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(pd(s))}return e.password&&typeof encrypt_agile<"u"?wT(encrypt_agile(s,e.password),e):e.type==="file"?Il(e.file,s):e.type=="string"?jo(s):s}function fD(t,e){var r=e||{},n=IM(t,r);return wT(n,r)}function An(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return ll(ul(n));case"binary":return ul(n);case"string":return t;case"file":return Il(e.file,n,"utf8");case"buffer":return ze?us(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):An(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function pD(t,e){switch(e.type){case"base64":return ll(t);case"binary":return t;case"string":return t;case"file":return Il(e.file,t,"binary");case"buffer":return ze?us(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function xc(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?ll(r):e.type=="string"?jo(r):r;case"file":return Il(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function _T(t,e){zR(),Zj(t);var r=Sr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=_T(t,r);return r.type="array",pd(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return An(bM(t,r),r);case"slk":case"sylk":return An(QP.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return An(gT(t.Sheets[t.SheetNames[s]],r),r);case"txt":return pD(ET(t.Sheets[t.SheetNames[s]],r),r);case"csv":return An(sm(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return An(XP.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return xc(YP.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return An(JP.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return An(i4.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return An(KE.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return An(yT(t,r),r);case"wk1":return xc(ix.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return xc(ix.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xc(mT(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),fD(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return dD(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mD(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function oi(t,e,r){var n={};return n.type="file",n.file=e,mD(n),_T(t,n)}function gD(t,e,r,n,s,i,a,o){var l=qt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch{f.__rowNum__=r}else f.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var g=a?t[r][p]:t[n[p]+l];if(g===void 0||g.t===void 0){if(u===void 0)continue;i[p]!=null&&(f[i[p]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[p]!=null){if(m==null)if(g.t=="e"&&m===null)f[i[p]]=null;else if(u!==void 0)f[i[p]]=u;else if(d&&m===null)f[i[p]]=null;else continue;else f[i[p]]=d&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:ls(g,m,o);m!=null&&(h=!1)}}return{row:f,isempty:h}}function Ou(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=it(d);break;case"number":l=it(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var h=qt(l.s.r),f=[],p=[],g=0,m=0,w=Array.isArray(t),v=l.s.r,y=0,x={};w&&!t[v]&&(t[v]=[]);var _=u.skipHidden&&t["!cols"]||[],P=u.skipHidden&&t["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(_[y]||{}).hidden)switch(f[y]=nr(y),r=w?t[v][y]:t[f[y]+h],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=f[y];break;case 3:i[y]=u.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ls(r,null,u),m=x[a]||0,!m)x[a]=1;else{do o=a+"_"+m++;while(x[o]);x[a]=m,x[o]=1}i[y]=o}for(v=l.s.r+s;v<=l.e.r;++v)if(!(P[v]||{}).hidden){var S=gD(t,l,v,f,n,i,w,u);(S.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[g++]=S.row)}return p.length=g,p}var fx=/"/g;function vD(t,e,r,n,s,i,a,o){for(var l=!0,u=[],d="",h=qt(r),f=e.s.c;f<=e.e.c;++f)if(n[f]){var p=o.dense?(t[r]||[])[f]:t[n[f]+h];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:ls(p,null,o));for(var g=0,m=0;g!==d.length;++g)if((m=d.charCodeAt(g))===s||m===i||m===34||o.forceQuotes){d='"'+d.replace(fx,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(fx,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(a)}function sm(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=it(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),d="",h=[];n.dense=Array.isArray(t);for(var f=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(f[g]||{}).hidden||(h[g]=nr(g));for(var m=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=vD(t,s,w,h,a,l,i,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((m++?o:"")+d)));return delete n.dense,r.join("")}function ET(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=sm(t,e);return r}function xD(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=it(t["!ref"]),i="",a=[],o,l=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=nr(o);for(var d=s.s.r;d<=s.e.r;++d)for(i=qt(d),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function TT(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Ft(n.origin):n.origin;a=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var h=it(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),a==-1&&(a=h.e.r+1,d.e.r=a+e.length-1+s)}else a==-1&&(a=0,d.e.r=e.length-1+s);var f=n.header||[],p=0;e.forEach(function(m,w){Qt(m).forEach(function(v){(p=f.indexOf(v))==-1&&(f[p=f.length]=v);var y=m[v],x="z",_="",P=qe({c:o+p,r:a+w+s});u=fl(i,P),y&&typeof y=="object"&&!(y instanceof Date)?i[P]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",n.cellDates||(x="n",y=Cr(y)),_=n.dateNF||vt[14]):y===null&&n.nullError&&(x="e",y=0),u?(u.t=x,u.v=y,delete u.w,delete u.R,_&&(u.z=_)):i[P]=u={t:x,v:y},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,o+f.length-1);var g=qt(a);if(s)for(p=0;p<f.length;++p)i[nr(p+o)+g]={t:"s",v:f[p]};return i["!ref"]=St(d),i}function yD(t,e){return TT(null,t,e)}function fl(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ft(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?fl(t,qe(e)):fl(t,qe({r:e,c:r||0}))}function wD(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function _D(){return{SheetNames:[],Sheets:{}}}function ED(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(hT(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function TD(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=wD(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function CD(t,e){return t.z=e,t}function CT(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function SD(t,e,r){return CT(t,"#"+e,r)}function AD(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function bD(t,e,r,n){for(var s=typeof e!="string"?e:it(e),i=typeof e=="string"?e:St(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=fl(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Je={encode_col:nr,encode_row:qt,encode_cell:qe,encode_range:St,decode_col:Vp,decode_row:Wp,split_cell:zO,decode_cell:Ft,decode_range:Ur,format_cell:ls,sheet_add_aoa:CE,sheet_add_json:TT,sheet_add_dom:vT,aoa_to_sheet:Ya,json_to_sheet:yD,table_to_sheet:xT,table_to_book:XM,sheet_to_csv:sm,sheet_to_txt:ET,sheet_to_json:Ou,sheet_to_html:gT,sheet_to_formulae:xD,sheet_to_row_object_array:Ou,sheet_get_cell:fl,book_new:_D,book_append_sheet:ED,book_set_sheet_visibility:TD,cell_set_number_format:CD,cell_set_hyperlink:CT,cell_set_internal_link:SD,cell_add_comment:AD,sheet_set_array_formula:bD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function kD(){var Se;const{profile:t}=en(),{logAction:e}=bl(),[r,n]=Y.useState([]),[s,i]=Y.useState([]),[a,o]=Y.useState([]),[l,u]=Y.useState([]),[d,h]=Y.useState(!0),[f,p]=Y.useState(""),[g,m]=Y.useState(""),[w,v]=Y.useState(""),[y,x]=Y.useState("all"),[_,P]=Y.useState(!1),[S,T]=Y.useState(null),[O,L]=Y.useState(!1),[j,G]=Y.useState(null),[W,re]=Y.useState({new_building_id:"",new_room_number:"",reason:"",notes:""}),[te,me]=Y.useState({key_system_id:"",key_code:"",room_number:"",building_id:"",notes:"",bitting:"",core_code:"",status:"available",top_pins:Array(7).fill(""),control_pins:Array(7).fill(""),master_pins:Array(7).fill(""),bottom_pins:Array(7).fill("")}),ne=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="super_administrator";Y.useEffect(()=>{Ce()},[]);const Ce=async()=>{try{const[R,ee,be,ie]=await Promise.all([supabase.from("keys").select("*, key_system:key_systems(name, brand, campus_id, campus:campuses(name)), building:buildings(name, campus_id, campus:campuses(name))").order("key_code"),supabase.from("buildings").select("id, name, campus_id").eq("active",!0).order("name"),supabase.from("key_systems").select("id, name, brand, campus_id").eq("active",!0).order("name"),supabase.from("campuses").select("id, name").eq("active",!0).order("name")]);R.data&&n(R.data),ee.data&&i(ee.data),be.data&&o(be.data),ie.data&&u(ie.data)}catch(R){console.error("Error:",R)}finally{h(!1)}},se=async R=>{R.preventDefault();try{const ee={top_pins:te.top_pins.map(ie=>ie===""?null:parseInt(ie)).filter(ie=>ie!==null&&!isNaN(ie)),control_pins:te.control_pins.map(ie=>ie===""?null:parseInt(ie)).filter(ie=>ie!==null&&!isNaN(ie)),master_pins:te.master_pins.map(ie=>ie===""?null:parseInt(ie)).filter(ie=>ie!==null&&!isNaN(ie)),bottom_pins:te.bottom_pins.map(ie=>ie===""?null:parseInt(ie)).filter(ie=>ie!==null&&!isNaN(ie))},be={key_system_id:te.key_system_id,key_code:te.key_code,room_number:te.room_number||null,building_id:te.building_id||null,notes:te.notes,bitting:te.bitting,core_code:te.core_code,status:te.status,top_pins:ee.top_pins.length>0?ee.top_pins:null,control_pins:ee.control_pins.length>0?ee.control_pins:null,master_pins:ee.master_pins.length>0?ee.master_pins:null,bottom_pins:ee.bottom_pins.length>0?ee.bottom_pins:null};if(S)await supabase.from("keys").update({...be,updated_at:new Date().toISOString()}).eq("id",S.id),await e("update","key","Updated key: "+te.key_code,{entityId:S.id});else{const{data:ie}=await supabase.from("keys").insert([be]).select().single();await e("create","key","Created key: "+te.key_code,{entityId:ie==null?void 0:ie.id})}P(!1),T(null),fe(),Ce()}catch(ee){console.error("Error saving key:",ee),alert("Error saving key")}},fe=()=>{me({key_system_id:"",key_code:"",room_number:"",building_id:"",notes:"",bitting:"",core_code:"",status:"available",top_pins:Array(7).fill(""),control_pins:Array(7).fill(""),master_pins:Array(7).fill(""),bottom_pins:Array(7).fill("")})},Ee=R=>{T(R),me({key_system_id:R.key_system_id,key_code:R.key_code,room_number:R.room_number||"",building_id:R.building_id||"",notes:R.notes||"",bitting:R.bitting||"",core_code:R.core_code||"",status:R.status,top_pins:R.top_pins?[...R.top_pins,...Array(7-R.top_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),control_pins:R.control_pins?[...R.control_pins,...Array(7-R.control_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),master_pins:R.master_pins?[...R.master_pins,...Array(7-R.master_pins.length).fill("")].slice(0,7).map(String):Array(7).fill(""),bottom_pins:R.bottom_pins?[...R.bottom_pins,...Array(7-R.bottom_pins.length).fill("")].slice(0,7).map(String):Array(7).fill("")}),P(!0)},X=async R=>{if(confirm("Delete this key?"))try{await supabase.from("keys").delete().eq("id",R.id),await e("delete","key","Deleted key "+R.key_code,{entityId:R.id}),Ce()}catch{alert("Error deleting key")}},N=R=>{var ee,be,ie,Ne,ke,at,Be;UR({key_code:R.key_code,bitting:R.bitting,core_code:R.core_code,campus:((be=(ee=R.building)==null?void 0:ee.campus)==null?void 0:be.name)||((Ne=(ie=R.key_system)==null?void 0:ie.campus)==null?void 0:Ne.name),building:(ke=R.building)==null?void 0:ke.name,room_number:R.room_number||void 0,system:(at=R.key_system)==null?void 0:at.name,brand:(Be=R.key_system)==null?void 0:Be.brand,notes:R.notes,top_pins:R.top_pins||void 0,control_pins:R.control_pins||void 0,master_pins:R.master_pins||void 0,bottom_pins:R.bottom_pins||void 0})},F=R=>{G(R),re({new_building_id:R.building_id||"",new_room_number:R.room_number||"",reason:"",notes:""}),L(!0)},D=async R=>{var ee,be;if(R.preventDefault(),!!j)try{const{error:ie}=await supabase.from("keys").update({building_id:W.new_building_id||null,room_number:W.new_room_number||null,notes:W.notes||j.notes,updated_at:new Date().toISOString()}).eq("id",j.id);if(ie)throw ie;await e("update","keys",j.id,{action:"key_reassigned",key_code:j.key_code,previous_location:`${((ee=j.building)==null?void 0:ee.name)||"N/A"} - Room ${j.room_number||"N/A"}`,new_location:`${((be=s.find(Ne=>Ne.id===W.new_building_id))==null?void 0:be.name)||"N/A"} - Room ${W.new_room_number||"N/A"}`,reason:W.reason}),await Ce(),L(!1),G(null),re({new_building_id:"",new_room_number:"",reason:"",notes:""})}catch(ie){console.error("Error reassigning key:",ie),alert("Error reassigning key: "+ie.message)}},M=async()=>{const R=r.map(ie=>{var Ne,ke,at,Be,ve,Pt,ar,Ar,zr,ds,ji;return{Campus:((ke=(Ne=ie.building)==null?void 0:Ne.campus)==null?void 0:ke.name)||((Be=(at=ie.key_system)==null?void 0:at.campus)==null?void 0:Be.name)||"",Building:((ve=ie.building)==null?void 0:ve.name)||"","Key System":((Pt=ie.key_system)==null?void 0:Pt.name)||"",Brand:((ar=ie.key_system)==null?void 0:ar.brand)||"","Key Code":ie.key_code,Bitting:ie.bitting||"","Core Code":ie.core_code||"",Room:ie.room_number||"",Status:ie.status,Notes:ie.notes||"","Top Pins":((Ar=ie.top_pins)==null?void 0:Ar.join(","))||"","Control Pins":((zr=ie.control_pins)==null?void 0:zr.join(","))||"","Master Pins":((ds=ie.master_pins)==null?void 0:ds.join(","))||"","Bottom Pins":((ji=ie.bottom_pins)==null?void 0:ji.join(","))||""}}),ee=Je.json_to_sheet(R),be=Je.book_new();Je.book_append_sheet(be,ee,"Keys"),oi(be,"keys-"+new Date().toISOString().split("T")[0]+".xlsx")},J=()=>{const R={};r.forEach(Ne=>{var ve,Pt,ar,Ar,zr,ds;const ke=((Pt=(ve=Ne.building)==null?void 0:ve.campus)==null?void 0:Pt.name)||((Ar=(ar=Ne.key_system)==null?void 0:ar.campus)==null?void 0:Ar.name)||"Unknown Campus",at=((zr=Ne.building)==null?void 0:zr.name)||"No Building",Be=((ds=Ne.key_system)==null?void 0:ds.name)||"Unknown System";R[ke]||(R[ke]={}),R[ke][at]||(R[ke][at]={}),R[ke][at][Be]||(R[ke][at][Be]=[]),R[ke][at][Be].push({key_code:Ne.key_code,bitting:Ne.bitting,core_code:Ne.core_code,room_number:Ne.room_number,status:Ne.status,notes:Ne.notes,medeco_pins:{top:Ne.top_pins,control:Ne.control_pins,master:Ne.master_pins,bottom:Ne.bottom_pins}})});const ee=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),be=URL.createObjectURL(ee),ie=document.createElement("a");ie.href=be,ie.download="keys-organized-"+new Date().toISOString().split("T")[0]+".json",ie.click()},xe=r.filter(R=>{var ke,at;const ee=R.key_code.toLowerCase().includes(f.toLowerCase())||R.room_number&&R.room_number.toLowerCase().includes(f.toLowerCase())||R.bitting&&R.bitting.toLowerCase().includes(f.toLowerCase()),be=!g||((ke=R.building)==null?void 0:ke.campus_id)===g||((at=R.key_system)==null?void 0:at.campus_id)===g,ie=!w||R.building_id===w,Ne=y==="all"||R.status===y;return ee&&be&&ie&&Ne});return d?c.jsx("div",{className:"text-center py-12",children:"Loading..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Keys"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage keys inventory"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Excel"})]}),c.jsxs("button",{onClick:J,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"JSON"})]}),ne&&c.jsxs("button",{onClick:()=>{T(null),fe(),P(!0)},className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[c.jsx(Sl,{className:"w-4 h-4"}),c.jsx("span",{children:"Add Key"})]})]})]}),_&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full my-8",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:S?"Edit Key":"Add Key"}),c.jsxs("form",{onSubmit:se,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Key System *"}),c.jsxs("select",{value:te.key_system_id,onChange:R=>me({...te,key_system_id:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:[c.jsx("option",{value:"",children:"Select"}),a.map(R=>c.jsxs("option",{value:R.id,children:[R.name," - ",R.brand]},R.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Key Code *"}),c.jsx("input",{type:"text",value:te.key_code,onChange:R=>me({...te,key_code:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Building"}),c.jsxs("select",{value:te.building_id,onChange:R=>me({...te,building_id:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[c.jsx("option",{value:"",children:"Select"}),s.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Room Number"}),c.jsx("input",{type:"text",value:te.room_number,onChange:R=>me({...te,room_number:R.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bitting Code"}),c.jsx("input",{type:"text",value:te.bitting,onChange:R=>me({...te,bitting:R.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Core Code"}),c.jsx("input",{type:"text",value:te.core_code,onChange:R=>me({...te,core_code:R.target.value}),className:"w-full px-3 py-2 border rounded-lg"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status *"}),c.jsxs("select",{value:te.status,onChange:R=>me({...te,status:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:[c.jsx("option",{value:"available",children:"Available"}),c.jsx("option",{value:"in_use",children:"In Use"}),c.jsx("option",{value:"lost",children:"Lost"}),c.jsx("option",{value:"retired",children:"Retired"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),c.jsx("textarea",{value:te.notes,onChange:R=>me({...te,notes:R.target.value}),className:"w-full px-3 py-2 border rounded-lg",rows:2})]}),c.jsxs("div",{className:"border-t pt-4",children:[c.jsx("h3",{className:"font-semibold mb-3",children:"Medeco Pin Configuration (Optional)"}),c.jsx("div",{className:"space-y-3",children:["top_pins","control_pins","master_pins","bottom_pins"].map(R=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs font-medium mb-1 uppercase text-slate-600",children:R.replace("_"," ")}),c.jsx("div",{className:"grid grid-cols-7 gap-2",children:Array.from({length:7},(ee,be)=>c.jsx("input",{type:"number",min:"0",max:"9",value:te[R][be],onChange:ie=>{const Ne=[...te[R]];Ne[be]=ie.target.value,me({...te,[R]:Ne})},className:"w-full px-2 py-1 border rounded text-center",placeholder:"-"},be))})]},R))})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg",children:"Save"}),c.jsx("button",{type:"button",onClick:()=>{P(!1),T(null)},className:"flex-1 px-4 py-2 bg-slate-200 rounded-lg",children:"Cancel"})]})]})]})}),O&&j&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-2xl w-full",children:[c.jsx("h2",{className:"text-xl font-bold mb-4",children:"Reassign Key"}),c.jsxs("div",{className:"mb-4 p-4 bg-slate-50 rounded-lg",children:[c.jsxs("div",{className:"font-medium text-slate-900",children:["Key: ",j.key_code]}),c.jsxs("div",{className:"text-sm text-slate-600",children:["Current Location: ",((Se=j.building)==null?void 0:Se.name)||"N/A"," - Room ",j.room_number||"N/A"]})]}),c.jsxs("form",{onSubmit:D,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"New Building *"}),c.jsxs("select",{value:W.new_building_id,onChange:R=>re({...W,new_building_id:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[c.jsx("option",{value:"",children:"Select Building"}),s.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"New Room Number *"}),c.jsx("input",{type:"text",value:W.new_room_number,onChange:R=>re({...W,new_room_number:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",placeholder:"e.g. 101, A-205",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Reason for Reassignment *"}),c.jsxs("select",{value:W.reason,onChange:R=>re({...W,reason:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0,children:[c.jsx("option",{value:"",children:"Select Reason"}),c.jsx("option",{value:"Room renovation",children:"Room renovation"}),c.jsx("option",{value:"Lock change",children:"Lock change"}),c.jsx("option",{value:"Key recycling",children:"Key recycling"}),c.jsx("option",{value:"Room reallocation",children:"Room reallocation"}),c.jsx("option",{value:"Lost key replacement",children:"Lost key replacement"}),c.jsx("option",{value:"Other",children:"Other"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Additional Notes"}),c.jsx("textarea",{value:W.notes,onChange:R=>re({...W,notes:R.target.value}),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",rows:3,placeholder:"Add any additional information about this reassignment..."})]}),c.jsxs("div",{className:"flex gap-2 pt-2",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition font-medium",children:"Reassign Key"}),c.jsx("button",{type:"button",onClick:()=>{L(!1),G(null)},className:"flex-1 px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 transition font-medium",children:"Cancel"})]})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search by key code, room, or bitting...",value:f,onChange:R=>p(R.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),l.length>1&&c.jsxs("select",{value:g,onChange:R=>{m(R.target.value),v("")},className:"px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"",children:"All Campuses"}),l.map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]}),c.jsxs("select",{value:w,onChange:R=>v(R.target.value),className:"px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"",children:"All Buildings"}),s.filter(R=>!g||R.campus_id===g).map(R=>c.jsx("option",{value:R.id,children:R.name},R.id))]}),c.jsxs("select",{value:y,onChange:R=>x(R.target.value),className:"px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"all",children:"All Status"}),c.jsx("option",{value:"available",children:"Available"}),c.jsx("option",{value:"in_use",children:"In Use"}),c.jsx("option",{value:"lost",children:"Lost"}),c.jsx("option",{value:"retired",children:"Retired"})]})]}),c.jsxs("div",{className:"flex gap-4 text-sm",children:[c.jsxs("div",{children:["Total: ",c.jsx("strong",{children:r.length})]}),c.jsxs("div",{children:["Available: ",c.jsx("strong",{className:"text-emerald-600",children:r.filter(R=>R.status==="available").length})]}),c.jsxs("div",{children:["In Use: ",c.jsx("strong",{className:"text-blue-600",children:r.filter(R=>R.status==="in_use").length})]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Key Code"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"System / Brand"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Location"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Bitting / Core"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-700 uppercase",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-700 uppercase",children:"Actions"})]})}),c.jsxs("tbody",{className:"divide-y",children:[xe.map(R=>{var ee,be,ie;return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"bg-slate-100 p-2 rounded-lg",children:c.jsx(al,{className:"w-5 h-5 text-slate-600"})}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:R.key_code}),R.notes&&c.jsx("div",{className:"text-xs text-slate-500",children:R.notes})]})]})}),c.jsxs("td",{className:"px-6 py-4 text-sm",children:[c.jsx("div",{children:(ee=R.key_system)==null?void 0:ee.name}),c.jsx("div",{className:"text-xs text-slate-500",children:(be=R.key_system)==null?void 0:be.brand})]}),c.jsxs("td",{className:"px-6 py-4 text-sm",children:[c.jsx("div",{children:((ie=R.building)==null?void 0:ie.name)||"-"}),R.room_number&&c.jsxs("div",{className:"text-xs text-slate-500",children:["Room ",R.room_number]})]}),c.jsxs("td",{className:"px-6 py-4 text-sm font-mono",children:[c.jsx("div",{children:R.bitting||"-"}),R.core_code&&c.jsx("div",{className:"text-xs text-slate-500",children:R.core_code})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full "+(R.status==="available"?"bg-emerald-100 text-emerald-700":R.status==="in_use"?"bg-blue-100 text-blue-700":R.status==="lost"?"bg-red-100 text-red-700":"bg-slate-100 text-slate-700"),children:R.status.replace("_"," ")})}),c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>N(R),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg",title:"Print",children:c.jsx(TR,{className:"w-4 h-4"})}),ne&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>F(R),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg",title:"Reassign Key",children:c.jsx(z_,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>Ee(R),className:"p-2 text-slate-600 hover:bg-slate-100 rounded-lg",title:"Edit",children:c.jsx(Cl,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>X(R),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:c.jsx(Al,{className:"w-4 h-4"})})]})]})})]},R.id)}),xe.length===0&&c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-500",children:"No keys found"})})]})]})})]})]})}function ID(){const[t,e]=Y.useState({totalKeys:0,availableKeys:0,inUseKeys:0,lostKeys:0,retiredKeys:0,totalCampuses:0,totalBuildings:0,totalKeySystems:0,recentActivities:0}),[r,n]=Y.useState(!0),[s,i]=Y.useState("inventory");Y.useEffect(()=>{a()},[]);const a=async()=>{var h,f,p,g;try{const[m,w,v,y,x]=await Promise.all([supabase.from("keys").select("status"),supabase.from("campuses").select("id").eq("active",!0),supabase.from("buildings").select("id").eq("active",!0),supabase.from("key_systems").select("id").eq("active",!0),supabase.from("audit_logs").select("id").gte("created_at",new Date(Date.now()-6048e5).toISOString())]),_=m.data||[];e({totalKeys:_.length,availableKeys:_.filter(P=>P.status==="available").length,inUseKeys:_.filter(P=>P.status==="in_use").length,lostKeys:_.filter(P=>P.status==="lost").length,retiredKeys:_.filter(P=>P.status==="retired").length,totalCampuses:((h=w.data)==null?void 0:h.length)||0,totalBuildings:((f=v.data)==null?void 0:f.length)||0,totalKeySystems:((p=y.data)==null?void 0:p.length)||0,recentActivities:((g=x.data)==null?void 0:g.length)||0})}catch(m){console.error("Error fetching stats:",m)}finally{n(!1)}},o=async()=>{try{const{data:h}=await supabase.from("keys").select("*, key_system:key_systems(name, brand, campus:campuses(name)), building:buildings(name, campus:campuses(name))"),f=(h||[]).map(m=>{var w,v,y,x,_,P,S;return{Campus:((v=(w=m.building)==null?void 0:w.campus)==null?void 0:v.name)||((x=(y=m.key_system)==null?void 0:y.campus)==null?void 0:x.name)||"N/A",Building:((_=m.building)==null?void 0:_.name)||"N/A","Key System":((P=m.key_system)==null?void 0:P.name)||"N/A",Brand:((S=m.key_system)==null?void 0:S.brand)||"N/A","Key Code":m.key_code,Bitting:m.bitting||"","Core Code":m.core_code||"",Room:m.room_number||"",Status:m.status,Notes:m.notes||""}}),p=Je.json_to_sheet(f),g=Je.book_new();Je.book_append_sheet(g,p,"Inventory Report"),oi(g,`inventory-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(h){console.error("Error generating report:",h),alert("Error generating report")}},l=async()=>{try{const{data:h}=await supabase.from("keys").select("*, key_system:key_systems(name, campus:campuses(name)), building:buildings(name)"),f={},p={},g={},m={available:0,in_use:0,lost:0,retired:0};(h||[]).forEach(x=>{var T,O,L,j;const _=((O=(T=x.key_system)==null?void 0:T.campus)==null?void 0:O.name)||"Unknown",P=((L=x.building)==null?void 0:L.name)||"No Building",S=((j=x.key_system)==null?void 0:j.name)||"Unknown System";f[_]=(f[_]||0)+1,p[P]=(p[P]||0)+1,g[S]=(g[S]||0)+1,m[x.status]=(m[x.status]||0)+1});const w=[{"Report Type":"Summary"},{"Total Keys":(h==null?void 0:h.length)||0},{"":""},{"Report Type":"By Campus"},...Object.entries(f).map(([x,_])=>({Campus:x,Keys:_})),{"":""},{"Report Type":"By Building"},...Object.entries(p).map(([x,_])=>({Building:x,Keys:_})),{"":""},{"Report Type":"By Key System"},...Object.entries(g).map(([x,_])=>({System:x,Keys:_})),{"":""},{"Report Type":"By Status"},...Object.entries(m).map(([x,_])=>({Status:x,Keys:_}))],v=Je.json_to_sheet(w),y=Je.book_new();Je.book_append_sheet(y,v,"Usage Report"),oi(y,`usage-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(h){console.error("Error generating report:",h),alert("Error generating report")}},u=async()=>{try{const{data:h}=await supabase.from("audit_logs").select("*, user:user_profiles(full_name, net_id)").order("created_at",{ascending:!1}).limit(1e3),f=(h||[]).map(m=>{var w,v;return{Date:new Date(m.created_at).toLocaleString(),User:((w=m.user)==null?void 0:w.full_name)||"System",NetID:((v=m.user)==null?void 0:v.net_id)||"N/A",Action:m.action_type,Entity:m.entity_type,Description:m.description,"IP Address":m.ip_address||"N/A"}}),p=Je.json_to_sheet(f),g=Je.book_new();Je.book_append_sheet(g,p,"Audit Trail"),oi(g,`audit-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(h){console.error("Error generating report:",h),alert("Error generating report")}},d=async()=>{var h,f,p;try{const[g,m,w,v,y]=await Promise.all([supabase.from("campuses").select("*").eq("active",!0),supabase.from("buildings").select("*, campus:campuses(name)").eq("active",!0),supabase.from("key_systems").select("*, campus:campuses(name)").eq("active",!0),supabase.from("keys").select("status"),supabase.from("user_profiles").select("role, active")]),x=Je.book_new(),_=(g.data||[]).map(te=>({"Campus Name":te.name,Code:te.code,Address:te.address||"",Active:te.active?"Yes":"No"})),P=Je.json_to_sheet(_);Je.book_append_sheet(x,P,"Campuses");const S=(m.data||[]).map(te=>{var me;return{Campus:((me=te.campus)==null?void 0:me.name)||"","Building Name":te.name,Code:te.code,Address:te.address||"",Active:te.active?"Yes":"No"}}),T=Je.json_to_sheet(S);Je.book_append_sheet(x,T,"Buildings");const O=(w.data||[]).map(te=>{var me;return{Campus:((me=te.campus)==null?void 0:me.name)||"","System Name":te.name,Brand:te.brand,Description:te.description||"",Active:te.active?"Yes":"No"}}),L=Je.json_to_sheet(O);Je.book_append_sheet(x,L,"Key Systems");const j=v.data||[],G=y.data||[],W=[{Metric:"Total Campuses",Value:((h=g.data)==null?void 0:h.length)||0},{Metric:"Total Buildings",Value:((f=m.data)==null?void 0:f.length)||0},{Metric:"Total Key Systems",Value:((p=w.data)==null?void 0:p.length)||0},{Metric:"Total Keys",Value:j.length},{Metric:"Available Keys",Value:j.filter(te=>te.status==="available").length},{Metric:"In Use Keys",Value:j.filter(te=>te.status==="in_use").length},{Metric:"Lost Keys",Value:j.filter(te=>te.status==="lost").length},{Metric:"Retired Keys",Value:j.filter(te=>te.status==="retired").length},{Metric:"Total Users",Value:G.length},{Metric:"Active Users",Value:G.filter(te=>te.active).length},{Metric:"Super Administrators",Value:G.filter(te=>te.role==="super_administrator").length},{Metric:"Administrators",Value:G.filter(te=>te.role==="administrator").length}],re=Je.json_to_sheet(W);Je.book_append_sheet(x,re,"Summary"),oi(x,`system-report-${new Date().toISOString().split("T")[0]}.xlsx`)}catch(g){console.error("Error generating report:",g),alert("Error generating report")}};return r?c.jsx("div",{className:"text-center py-12",children:"Loading..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Reports & Analytics"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Comprehensive reports on key usage, assignments, and system activity"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Total Keys"}),c.jsx(al,{className:"w-5 h-5 text-slate-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t.totalKeys}),c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[t.availableKeys," available"]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Buildings"}),c.jsx(fd,{className:"w-5 h-5 text-slate-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t.totalBuildings}),c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[t.totalCampuses," campuses"]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"In Use"}),c.jsx(Kf,{className:"w-5 h-5 text-blue-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-blue-600",children:t.inUseKeys}),c.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[Math.round(t.inUseKeys/t.totalKeys*100)||0,"% of total"]})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Recent Activity"}),c.jsx(_v,{className:"w-5 h-5 text-green-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-green-600",children:t.recentActivities}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 7 days"})]})]}),t.lostKeys>0&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[c.jsx(jp,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-red-900",children:"Alert: Lost Keys"}),c.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["There are ",t.lostKeys," keys marked as lost. Please review and take appropriate action."]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"p-6 border-b",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Generate Reports"}),c.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Export comprehensive reports in Excel format"})]}),c.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("inventory"),children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:c.jsx(pR,{className:"w-6 h-6 text-blue-600"})}),c.jsx("h3",{className:"font-semibold text-slate-900",children:"Inventory Report"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete list of all keys with campus, building, system, and status information."}),c.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Generate Excel Report"})]})]}),c.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("usage"),children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:c.jsx(Kf,{className:"w-6 h-6 text-green-600"})}),c.jsx("h3",{className:"font-semibold text-slate-900",children:"Usage Analytics"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Key distribution by campus, building, system, and status with usage statistics."}),c.jsxs("button",{onClick:l,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Generate Excel Report"})]})]}),c.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("audit"),children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"bg-amber-100 p-3 rounded-lg",children:c.jsx(_v,{className:"w-6 h-6 text-amber-600"})}),c.jsx("h3",{className:"font-semibold text-slate-900",children:"Audit Trail Report"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete history of all system actions, user activities, and changes (last 1000 entries)."}),c.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Generate Excel Report"})]})]}),c.jsxs("div",{className:"border rounded-lg p-6 hover:border-slate-400 transition cursor-pointer",onClick:()=>i("system"),children:[c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsx("div",{className:"bg-slate-100 p-3 rounded-lg",children:c.jsx(H_,{className:"w-6 h-6 text-slate-600"})}),c.jsx("h3",{className:"font-semibold text-slate-900",children:"System Overview"})]}),c.jsx("p",{className:"text-sm text-slate-600 mb-4",children:"Complete system information including campuses, buildings, key systems, and users."}),c.jsxs("button",{onClick:d,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Generate Excel Report"})]})]})]})]})]})}function ND(){const{user:t}=en();return{logError:async(r,n,s)=>{try{await U_.from("error_logs").insert({error_type:r,severity:(s==null?void 0:s.severity)||"medium",user_id:(t==null?void 0:t.id)||null,message:n,stack_trace:(s==null?void 0:s.stackTrace)||"",context:(s==null?void 0:s.context)||{},resolved:!1})}catch(i){console.error("Failed to log error:",i)}}}}const px=[{value:"basic_user",label:"Basic User",description:"View-only access to assigned campuses"},{value:"standard_user",label:"Standard User",description:"Can manage keys in assigned campuses"},{value:"administrator",label:"Administrator",description:"Full access to all campuses"},{value:"super_administrator",label:"Super Administrator",description:"Full system access including configuration"}];function RD(){const{profile:t}=en(),{logAction:e}=bl(),{logError:r}=ND(),[n,s]=Y.useState([]),[i,a]=Y.useState([]),[o,l]=Y.useState({}),[u,d]=Y.useState(!0),[h,f]=Y.useState(""),[p,g]=Y.useState(!1),[m,w]=Y.useState(null),[v,y]=Y.useState(!1),[x,_]=Y.useState({netId:"",fullName:"",email:"",role:"basic_user",password:"",active:!0,selectedCampuses:[]});Y.useEffect(()=>{P()},[]);const P=async()=>{try{d(!0);const[ne,Ce,se]=await Promise.all([supabase.from("user_profiles").select("*").order("full_name"),supabase.from("campuses").select("*").order("name"),supabase.from("user_campus_permissions").select("*")]);if(ne.error)throw ne.error;if(Ce.error)throw Ce.error;if(se.error)throw se.error;s(ne.data||[]),a(Ce.data||[]);const fe={};(se.data||[]).forEach(Ee=>{fe[Ee.user_id]||(fe[Ee.user_id]=[]),fe[Ee.user_id].push(Ee.campus_id)}),l(fe)}catch(ne){await r("database","high","Failed to load users",ne)}finally{d(!1)}},S=()=>{w(null),_({netId:"",fullName:"",email:"",role:"basic_user",password:"",active:!0,selectedCampuses:[]}),y(!1),g(!0)},T=ne=>{w(ne),_({netId:ne.net_id,fullName:ne.full_name,email:ne.email,role:ne.role,password:"",active:ne.active,selectedCampuses:o[ne.id]||[]}),y(!1),g(!0)},O=async ne=>{ne.preventDefault();try{m?await j():await L(),g(!1),await P()}catch(Ce){await r("validation","medium","User form submission failed",Ce),alert(Ce instanceof Error?Ce.message:"Failed to save user")}},L=async()=>{if(!x.password)throw new Error("Password is required for new users");const{data:{session:ne}}=await supabase.auth.getSession();if(!ne)throw new Error("Not authenticated");const se=await fetch("https://owvcdjfcsuzbflwmrazq.supabase.co/functions/v1/manage-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ne.access_token}`},body:JSON.stringify({action:"create",data:{netId:x.netId,email:x.email,fullName:x.fullName,password:x.password,role:x.role,active:x.active,selectedCampuses:x.selectedCampuses}})}),fe=await se.json();if(!se.ok)throw new Error(fe.error||"Failed to create user");await e("create","user",fe.userId,`Created user: ${x.fullName} (${x.netId})`)},j=async()=>{if(!m)return;const{data:{session:ne}}=await supabase.auth.getSession();if(!ne)throw new Error("Not authenticated");const se=await fetch("https://owvcdjfcsuzbflwmrazq.supabase.co/functions/v1/manage-users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ne.access_token}`},body:JSON.stringify({action:"update",data:{userId:m.id,netId:x.netId,email:x.email,fullName:x.fullName,password:x.password||void 0,role:x.role,active:x.active,selectedCampuses:x.selectedCampuses}})}),fe=await se.json();if(!se.ok)throw new Error(fe.error||"Failed to update user");await e("update","user",m.id,`Updated user: ${x.fullName} (${x.netId})`)},G=async ne=>{if(confirm(`Are you sure you want to delete user "${ne.full_name}"?

This will permanently remove the user and all associated data.`))try{const{error:Ce}=await supabase.from("user_profiles").delete().eq("id",ne.id);if(Ce)throw Ce;await e("delete","user",ne.id,`Deleted user: ${ne.full_name} (${ne.net_id})`),await P()}catch(Ce){await r("database","high","Failed to delete user",Ce),alert("Failed to delete user")}},W=n.filter(ne=>ne.full_name.toLowerCase().includes(h.toLowerCase())||ne.net_id.toLowerCase().includes(h.toLowerCase())||ne.email.toLowerCase().includes(h.toLowerCase())),re=ne=>{var Ce;return((Ce=px.find(se=>se.value===ne))==null?void 0:Ce.label)||ne},te=ne=>{const Ce=o[ne]||[];return i.filter(se=>Ce.includes(se.id)).map(se=>se.name)},me=(t==null?void 0:t.role)==="administrator"||(t==null?void 0:t.role)==="super_administrator";return u?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-600",children:"Loading users..."})]})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"User Management"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage system users and their permissions"})]}),me&&c.jsxs("button",{onClick:S,className:"flex items-center gap-2 bg-slate-900 text-white px-4 py-2 rounded-lg hover:bg-slate-800 transition",children:[c.jsx(Sl,{className:"w-5 h-5"}),"Add User"]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsx("div",{className:"p-4 border-b border-slate-200",children:c.jsxs("div",{className:"relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search users by name, NetID, or email...",value:h,onChange:ne=>f(ne.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"User"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"NetID"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Role"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Campus Access"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),me&&c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-200",children:W.length===0?c.jsx("tr",{children:c.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-slate-500",children:"No users found"})}):W.map(ne=>{const Ce=te(ne.id),se=ne.role==="administrator"||ne.role==="super_administrator";return c.jsxs("tr",{className:"hover:bg-slate-50",children:[c.jsx("td",{className:"px-6 py-4",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:ne.full_name}),c.jsx("div",{className:"text-sm text-slate-500",children:ne.email})]})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:"font-mono text-sm text-slate-700",children:ne.net_id})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:"text-sm text-slate-900",children:re(ne.role)})}),c.jsx("td",{className:"px-6 py-4",children:se?c.jsx("span",{className:"text-sm text-slate-500 italic",children:"All Campuses"}):Ce.length>0?c.jsx("div",{className:"flex flex-wrap gap-1",children:Ce.map((fe,Ee)=>c.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-slate-100 text-slate-700 rounded",children:fe},Ee))}):c.jsx("span",{className:"text-sm text-slate-400",children:"No access"})}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ne.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:ne.active?"Active":"Inactive"})}),me&&c.jsx("td",{className:"px-6 py-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>T(ne),className:"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition",title:"Edit user",children:c.jsx(Cl,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>G(ne),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition",title:"Delete user",children:c.jsx(Al,{className:"w-4 h-4"})})]})})]},ne.id)})})]})})]}),p&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-slate-200",children:[c.jsx("h2",{className:"text-xl font-bold text-slate-900",children:m?"Edit User":"Add New User"}),c.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-slate-100 rounded-lg transition",children:c.jsx(K_,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:O,className:"p-6 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Full Name *"}),c.jsx("input",{type:"text",value:x.fullName,onChange:ne=>_({...x,fullName:ne.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"NetID *"}),c.jsx("input",{type:"text",value:x.netId,onChange:ne=>_({...x,netId:ne.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email *"}),c.jsx("input",{type:"email",value:x.email,onChange:ne=>_({...x,email:ne.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:["Password ",m?"(leave blank to keep current)":"*"]}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:v?"text":"password",value:x.password,onChange:ne=>_({...x,password:ne.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none pr-12",required:!m,minLength:8}),c.jsx("button",{type:"button",onClick:()=>y(!v),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:v?c.jsx(gR,{className:"w-5 h-5"}):c.jsx(vR,{className:"w-5 h-5"})})]}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:m?"User will be required to change password on next login if updated":"Minimum 8 characters. User will be required to change on first login."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Role *"}),c.jsx("div",{className:"space-y-2",children:px.map(ne=>c.jsxs("label",{className:"flex items-start gap-3 p-3 border border-slate-200 rounded-lg hover:bg-slate-50 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"role",value:ne.value,checked:x.role===ne.value,onChange:Ce=>_({...x,role:Ce.target.value}),className:"mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-slate-900",children:ne.label}),c.jsx("div",{className:"text-xs text-slate-500",children:ne.description})]})]},ne.value))})]}),!["administrator","super_administrator"].includes(x.role)&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Campus Access"}),c.jsx("div",{className:"border border-slate-200 rounded-lg p-3 space-y-2 max-h-48 overflow-y-auto",children:i.length===0?c.jsx("p",{className:"text-sm text-slate-500",children:"No campuses available"}):i.map(ne=>c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:x.selectedCampuses.includes(ne.id),onChange:Ce=>{Ce.target.checked?_({...x,selectedCampuses:[...x.selectedCampuses,ne.id]}):_({...x,selectedCampuses:x.selectedCampuses.filter(se=>se!==ne.id)})},className:"rounded"}),c.jsx("span",{className:"text-sm text-slate-900",children:ne.name})]},ne.id))})]}),c.jsx("div",{children:c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:x.active,onChange:ne=>_({...x,active:ne.target.checked}),className:"rounded"}),c.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Active User"})]})}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[c.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition",children:m?"Update User":"Create User"})]})]})]})})]})}function OD(){return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Audit Logs"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"View system activity and audit trail"})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-slate-100 rounded-full mb-4",children:c.jsx(xu,{className:"w-8 h-8 text-slate-600"})}),c.jsx("h2",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Audit Trail"}),c.jsx("p",{className:"text-slate-600 max-w-md mx-auto",children:"Complete history of all system actions, user activities, and changes for compliance and security."})]})})]})}function PD(){const[t,e]=Y.useState([]),[r,n]=Y.useState(!0),[s,i]=Y.useState(""),[a,o]=Y.useState("all");Y.useEffect(()=>{l();const g=supabase.channel("error_logs_channel").on("postgres_changes",{event:"*",schema:"public",table:"error_logs"},l).subscribe();return()=>{g.unsubscribe()}},[]);const l=async()=>{try{const{data:g}=await supabase.from("error_logs").select("*, user:user_profiles(full_name, net_id)").order("created_at",{ascending:!1}).limit(100);g&&e(g)}catch(g){console.error("Error fetching error logs:",g)}finally{n(!1)}},u=async g=>{try{await supabase.from("error_logs").update({resolved:!0,resolved_at:new Date().toISOString()}).eq("id",g),l()}catch(m){console.error("Error resolving error:",m),alert("Error updating status")}},d=()=>{const g=h.map(v=>{var y,x;return{Date:new Date(v.created_at).toLocaleString(),Type:v.error_type,Message:v.error_message,User:((y=v.user)==null?void 0:y.full_name)||"N/A",NetID:((x=v.user)==null?void 0:x.net_id)||"N/A",Status:v.resolved?"Resolved":"Unresolved","Resolved At":v.resolved_at?new Date(v.resolved_at).toLocaleString():""}}),m=Je.json_to_sheet(g),w=Je.book_new();Je.book_append_sheet(w,m,"Error Logs"),oi(w,`error-logs-${new Date().toISOString().split("T")[0]}.xlsx`)},h=t.filter(g=>{const m=g.error_type.toLowerCase().includes(s.toLowerCase())||g.error_message.toLowerCase().includes(s.toLowerCase()),w=a==="all"||a==="resolved"&&g.resolved||a==="unresolved"&&!g.resolved;return m&&w}),f=t.filter(g=>!g.resolved).length,p=t.filter(g=>g.resolved&&g.resolved_at&&new Date(g.resolved_at).toDateString()===new Date().toDateString()).length;return r?c.jsx("div",{className:"text-center py-12",children:"Loading..."}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Error Reports"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Monitor and resolve system errors for optimal health"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Total Errors"}),c.jsx(zf,{className:"w-5 h-5 text-slate-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-slate-900",children:t.length}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Last 100 entries"})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Unresolved"}),c.jsx(Av,{className:"w-5 h-5 text-red-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-red-600",children:f}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Needs attention"})]}),c.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("h3",{className:"text-sm font-medium text-slate-600",children:"Resolved Today"}),c.jsx(hh,{className:"w-5 h-5 text-green-400"})]}),c.jsx("p",{className:"text-3xl font-bold text-green-600",children:p}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Issues fixed"})]})]}),f>0&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[c.jsx(zf,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-red-900",children:"Action Required"}),c.jsxs("p",{className:"text-sm text-red-700 mt-1",children:["There are ",f," unresolved errors that need attention."]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400"}),c.jsx("input",{type:"text",placeholder:"Search error type or message...",value:s,onChange:g=>i(g.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg"})]}),c.jsxs("select",{value:a,onChange:g=>o(g.target.value),className:"px-4 py-2 border rounded-lg",children:[c.jsx("option",{value:"all",children:"All Errors"}),c.jsx("option",{value:"unresolved",children:"Unresolved"}),c.jsx("option",{value:"resolved",children:"Resolved"})]}),c.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-lg hover:bg-slate-800",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Export"})]})]})}),c.jsx("div",{className:"divide-y",children:h.length===0?c.jsx("div",{className:"p-12 text-center text-slate-500",children:t.length===0?c.jsxs("div",{children:[c.jsx(hh,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),c.jsx("p",{className:"font-medium",children:"No Errors!"}),c.jsx("p",{className:"text-sm mt-1",children:"System is running smoothly"})]}):c.jsx("p",{children:"No errors match your filters"})}):h.map(g=>c.jsx("div",{className:"p-6 hover:bg-slate-50",children:c.jsxs("div",{className:"flex items-start justify-between gap-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("div",{className:`p-2 rounded-lg ${g.resolved?"bg-green-100":"bg-red-100"}`,children:g.resolved?c.jsx(hh,{className:"w-5 h-5 text-green-600"}):c.jsx(Av,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("h3",{className:"font-semibold text-slate-900",children:g.error_type}),c.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-medium rounded-full ${g.resolved?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g.resolved?"Resolved":"Unresolved"})]}),c.jsx("p",{className:"text-sm text-slate-600 mt-1",children:g.error_message})]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-500 mt-3",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(mR,{className:"w-3 h-3"}),c.jsx("span",{children:new Date(g.created_at).toLocaleString()})]}),g.user&&c.jsxs("div",{children:["User: ",g.user.full_name," (",g.user.net_id,")"]}),g.resolved_at&&c.jsxs("div",{children:["Resolved: ",new Date(g.resolved_at).toLocaleString()]})]}),g.stack_trace&&c.jsxs("details",{className:"mt-3",children:[c.jsx("summary",{className:"text-xs text-slate-600 cursor-pointer hover:text-slate-900",children:"View Stack Trace"}),c.jsx("pre",{className:"mt-2 text-xs bg-slate-50 p-3 rounded border overflow-x-auto",children:g.stack_trace})]})]}),!g.resolved&&c.jsx("button",{onClick:()=>u(g.id),className:"px-3 py-1.5 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Mark Resolved"})]})},g.id))})]})]})}function LD(){const t=lt.getInstance();if(t.isInitialized()){const e=t.getConfig();if((e==null?void 0:e.type)==="supabase")return qr()}return qr()}function jD(){const[t,e]=Y.useState(!1),r=async i=>{e(!0);const a=LD();try{const[o,l,u,d,h,f]=await Promise.all([a.from("campuses").select("*"),a.from("buildings").select("*"),a.from("key_systems").select("*"),a.from("keys").select("*"),a.from("user_profiles").select("id, net_id, full_name, email, role, active, created_at"),a.from("audit_logs").select("*").order("created_at",{ascending:!1}).limit(1e3)]),p={export_date:new Date().toISOString(),campuses:o.data||[],buildings:l.data||[],key_systems:u.data||[],keys:d.data||[],users:h.data||[],audit_logs:f.data||[]};if(i==="json"){const g=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),m=URL.createObjectURL(g),w=document.createElement("a");w.href=m,w.download=`database-export-${new Date().toISOString().split("T")[0]}.json`,w.click(),URL.revokeObjectURL(m)}else n("campuses",o.data||[]),n("buildings",l.data||[]),n("key_systems",u.data||[]),n("keys",d.data||[]),n("users",h.data||[]),n("audit_logs",f.data||[]);alert(`Database exported successfully as ${i.toUpperCase()}!`)}catch(o){console.error("Error exporting data:",o),alert("Error exporting data. Please try again.")}finally{e(!1)}},n=(i,a)=>{if(a.length===0)return;const o=Object.keys(a[0]),l=a.map(p=>o.map(g=>{const m=p[g];return m==null?"":typeof m=="object"?JSON.stringify(m):String(m)})),u=[o,...l].map(p=>p.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(",")).join(`
`),d=new Blob([u],{type:"text/csv"}),h=URL.createObjectURL(d),f=document.createElement("a");f.href=h,f.download=`${i}-${new Date().toISOString().split("T")[0]}.csv`,f.click(),URL.revokeObjectURL(h)},s=async(i,a)=>{try{const{data:o,error:l}=await supabase.from(i).select("*");if(l)throw l;const u=new Blob([JSON.stringify(o,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=`${i}-${new Date().toISOString().split("T")[0]}.json`,h.click(),URL.revokeObjectURL(d),alert(`${a} exported successfully!`)}catch(o){console.error("Error exporting table:",o),alert(`Error exporting ${a}. Please try again.`)}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Backup & Export"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Manage data backups and exports"})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"bg-slate-900 p-3 rounded-lg",children:c.jsx(Qn,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Full Database Export"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Export all data in JSON or CSV format"})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{onClick:()=>r("json"),disabled:t,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-slate-900 text-white rounded-lg hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx(xR,{className:"w-5 h-5"}),c.jsx("span",{children:t?"Exporting...":"Export All Data (JSON)"})]}),c.jsxs("button",{onClick:()=>r("csv"),disabled:t,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[c.jsx(yR,{className:"w-5 h-5"}),c.jsx("span",{children:t?"Exporting...":"Export All Data (CSV)"})]})]}),c.jsx("div",{className:"mt-4 p-3 bg-slate-50 rounded-lg",children:c.jsxs("p",{className:"text-xs text-slate-600",children:[c.jsx("strong",{children:"Note:"})," JSON export creates a single file with all tables. CSV export creates separate files for each table."]})})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"bg-blue-600 p-3 rounded-lg",children:c.jsx(Fs,{className:"w-6 h-6 text-white"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Individual Table Export"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Export specific tables as JSON"})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("button",{onClick:()=>s("campuses","Campuses"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Campuses"}),c.jsx("button",{onClick:()=>s("buildings","Buildings"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Buildings"}),c.jsx("button",{onClick:()=>s("key_systems","Key Systems"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Key Systems"}),c.jsx("button",{onClick:()=>s("keys","Keys"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Keys"}),c.jsx("button",{onClick:()=>s("user_profiles","Users"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Users"}),c.jsx("button",{onClick:()=>s("audit_logs","Audit Logs"),className:"w-full text-left px-4 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded-lg transition border border-slate-200",children:"Export Audit Logs"})]})]})]}),c.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(kR,{className:"w-6 h-6 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-amber-900 mb-2",children:"Data Import"}),c.jsx("p",{className:"text-sm text-amber-800 mb-3",children:"To import data, use the individual management pages (Campuses, Buildings, Keys, etc.) where you can add items one by one."}),c.jsxs("p",{className:"text-xs text-amber-700",children:[c.jsx("strong",{children:"For keys:"})," Use the Keys page where you can add individual keys with all required information."]})]})]})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Export Information"}),c.jsxs("div",{className:"space-y-3 text-sm text-slate-600",children:[c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"JSON Format:"}),c.jsx("span",{children:"Complete data export with all relationships and metadata. Best for backups and data migration."})]}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"CSV Format:"}),c.jsx("span",{children:"Spreadsheet-compatible format. Best for analysis in Excel, Google Sheets, or other tools."})]}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"Data Included:"}),c.jsx("span",{children:"Campuses, Buildings, Key Systems, Keys, Users (without passwords), and recent Audit Logs."})]}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"font-medium text-slate-900 min-w-[120px]",children:"Security:"}),c.jsx("span",{children:"Password hashes and sensitive authentication data are never included in exports."})]})]})]})]})}function MD(){const{profile:t}=en(),[e,r]=Y.useState(null),[n,s]=Y.useState(!0),[i,a]=Y.useState(!1),[o,l]=Y.useState(""),[u,d]=Y.useState(""),[h,f]=Y.useState({azureClientId:"",azureTenantId:"",azureRedirectUri:"",azureEnabled:!1,databaseUrl:""});Y.useEffect(()=>{p()},[]);const p=async()=>{try{s(!0);const y=qr(),{data:x,error:_}=await y.from("system_config").select("*").maybeSingle();if(_)throw _;x&&(r(x),f({azureClientId:x.azure_client_id||"",azureTenantId:x.azure_tenant_id||"",azureRedirectUri:x.azure_redirect_uri||window.location.origin,azureEnabled:x.azure_enabled||!1,databaseUrl:x.database_url||""}))}catch(y){l(y instanceof Error?y.message:"Failed to load configuration")}finally{s(!1)}},g=async y=>{y.preventDefault(),l(""),d(""),a(!0);try{const x=qr(),{error:_}=await x.from("system_config").update({azure_client_id:h.azureClientId||null,azure_tenant_id:h.azureTenantId||null,azure_redirect_uri:h.azureRedirectUri||null,azure_enabled:h.azureEnabled,database_url:h.databaseUrl||null}).eq("id",e.id);if(_)throw _;d("Configuration saved successfully! Please refresh the page for changes to take effect."),await p()}catch(x){l(x instanceof Error?x.message:"Failed to save configuration")}finally{a(!1)}};if((t==null?void 0:t.role)!=="super_administrator")return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"System Configuration"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Configure system settings and preferences"})]}),c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(jp,{className:"w-6 h-6 text-red-600"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-red-900",children:"Access Denied"}),c.jsx("p",{className:"text-sm text-red-700",children:"Only super administrators can access system configuration."})]})]})})]});if(n)return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"System Configuration"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Configure system settings and preferences"})]}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12 text-center",children:c.jsx("p",{className:"text-slate-600",children:"Loading configuration..."})})]});const m=()=>{confirm("This will clear all configuration and restart the setup process. You will need to reconfigure the database connection. Continue?")&&(localStorage.clear(),window.location.reload())},v=lt.getInstance().getConfig();return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"System Configuration"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Configure system settings and preferences"})]}),o&&c.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:c.jsx("p",{className:"text-sm text-red-700",children:o})}),u&&c.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:c.jsx("p",{className:"text-sm text-green-700",children:u})}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:c.jsx(Fs,{className:"w-5 h-5 text-green-700"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Current Database Connection"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Active database configuration"})]})]}),c.jsxs("button",{type:"button",onClick:m,className:"px-4 py-2 border border-red-300 text-red-700 rounded-lg font-medium hover:bg-red-50 transition flex items-center gap-2",children:[c.jsx(z_,{className:"w-4 h-4"}),"Reconfigure System"]})]}),v?c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-100",children:[c.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Database Type:"}),c.jsx("span",{className:"text-sm font-semibold text-slate-900 uppercase",children:v.type})]}),v.type==="firebase"&&v.config.projectId&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-100",children:[c.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Project ID:"}),c.jsx("span",{className:"text-sm font-mono text-slate-900",children:v.config.projectId})]}),c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-100",children:[c.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Database URL:"}),c.jsx("span",{className:"text-sm font-mono text-slate-900 truncate max-w-md",children:v.config.databaseURL})]}),v.config.useFirebaseAuth&&c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-100",children:[c.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Firebase Auth:"}),c.jsx("span",{className:"text-sm font-semibold text-green-700",children:"Enabled"})]})]}),v.type==="supabase"&&c.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-slate-100",children:[c.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Supabase URL:"}),c.jsx("span",{className:"text-sm font-mono text-slate-900 truncate max-w-md",children:v.config.url})]}),c.jsx("div",{className:"mt-4 p-3 bg-green-50 rounded-lg",children:c.jsxs("p",{className:"text-xs text-green-700",children:[c.jsx("strong",{children:"Status:"})," Database is connected and operational"]})})]}):c.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:c.jsx("p",{className:"text-sm text-amber-800",children:"No database configuration found. This should not happen in a configured system."})})]}),c.jsxs("form",{onSubmit:g,className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-slate-100 rounded-lg",children:c.jsx(Fs,{className:"w-5 h-5 text-slate-700"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Database Configuration"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Manage database connection settings"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Database URL",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Read-only reference)"})]}),c.jsx("input",{type:"text",value:h.databaseUrl,onChange:y=>f({...h,databaseUrl:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none transition",placeholder:"https://your-database-url.supabase.co",disabled:i}),c.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"This is for reference only. Changing this will not affect the actual connection."})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx($f,{className:"w-5 h-5 text-blue-700"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Azure Active Directory"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Configure Microsoft Azure AD authentication"})]}),c.jsxs("label",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"checkbox",checked:h.azureEnabled,onChange:y=>f({...h,azureEnabled:y.target.checked}),className:"w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500",disabled:i}),c.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Enabled"})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Client ID",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Application ID)"})]}),c.jsx("input",{type:"text",value:h.azureClientId,onChange:y=>f({...h,azureClientId:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition font-mono text-sm",placeholder:"00000000-0000-0000-0000-000000000000",disabled:i})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Tenant ID",c.jsx("span",{className:"text-slate-400 font-normal ml-1",children:"(Directory ID)"})]}),c.jsx("input",{type:"text",value:h.azureTenantId,onChange:y=>f({...h,azureTenantId:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition font-mono text-sm",placeholder:"00000000-0000-0000-0000-000000000000",disabled:i})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Redirect URI"}),c.jsx("input",{type:"url",value:h.azureRedirectUri,onChange:y=>f({...h,azureRedirectUri:y.target.value}),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-600 focus:border-transparent outline-none transition",placeholder:window.location.origin,disabled:i})]})]}),c.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:c.jsxs("p",{className:"text-xs text-blue-700",children:[c.jsx("strong",{children:"Note:"})," After changing Azure AD settings, users will need to refresh their browser for changes to take effect."]})})]}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx("button",{type:"button",onClick:p,disabled:i,className:"px-6 py-2.5 border border-slate-300 text-slate-700 rounded-lg font-medium hover:bg-slate-50 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Reset"}),c.jsxs("button",{type:"submit",disabled:i,className:"px-6 py-2.5 bg-slate-900 text-white rounded-lg font-medium hover:bg-slate-800 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[c.jsx(SR,{className:"w-4 h-4"}),i?"Saving...":"Save Configuration"]})]})]}),e&&c.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:c.jsxs("p",{className:"text-xs text-slate-600",children:["Last updated: ",new Date(e.updated_at).toLocaleString()]})})]})}function DD(){const[t,e]=Y.useState([]),[r,n]=Y.useState(!0),[s,i]=Y.useState(""),[a,o]=Y.useState("all"),[l,u]=Y.useState([]),[d,h]=Y.useState("");Y.useEffect(()=>{f()},[]);const f=async()=>{try{const v=qr(),[y,x]=await Promise.all([v.rpc("get_key_history",{p_limit:500}),v.from("buildings").select("id, name").eq("active",!0).order("name")]);y.data&&e(y.data),x.data&&u(x.data)}catch(v){console.error("Error fetching key history:",v)}finally{n(!1)}},p=()=>{const v=w.map(_=>({"Key Code":_.key_code,"Key System":_.key_system_name,Type:g(_.reassignment_type),"Previous Location":_.previous_building&&_.previous_room?`${_.previous_building} - Room ${_.previous_room}`:"N/A","New Location":_.new_building&&_.new_room?`${_.new_building} - Room ${_.new_room}`:_.reassignment_type==="unassigned"?"Unassigned":"N/A",Reason:_.reassignment_reason,"Reassigned By":_.reassigned_by_name||"System",Date:new Date(_.reassigned_at).toLocaleString(),Notes:_.notes||""})),y=Je.json_to_sheet(v),x=Je.book_new();Je.book_append_sheet(x,y,"Key History"),oi(x,"key-history-"+new Date().toISOString().split("T")[0]+".xlsx")},g=v=>({initial_assignment:"Initial Assignment",room_change:"Room Change",recycled:"Recycled",unassigned:"Unassigned"})[v]||v,m=v=>({initial_assignment:"bg-green-100 text-green-700 border-green-200",room_change:"bg-blue-100 text-blue-700 border-blue-200",recycled:"bg-orange-100 text-orange-700 border-orange-200",unassigned:"bg-slate-100 text-slate-700 border-slate-200"})[v]||"bg-slate-100 text-slate-700 border-slate-200",w=t.filter(v=>{var P,S,T,O;const y=v.key_code.toLowerCase().includes(s.toLowerCase())||v.key_system_name.toLowerCase().includes(s.toLowerCase())||((P=v.previous_room)==null?void 0:P.toLowerCase().includes(s.toLowerCase()))||((S=v.new_room)==null?void 0:S.toLowerCase().includes(s.toLowerCase())),x=a==="all"||v.reassignment_type===a,_=!d||v.previous_building===((T=l.find(L=>L.id===d))==null?void 0:T.name)||v.new_building===((O=l.find(L=>L.id===d))==null?void 0:O.name);return y&&x&&_});return r?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Key History"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Track key movements and reassignments"})]}),c.jsx("div",{className:"text-center py-12",children:c.jsx("p",{className:"text-slate-600",children:"Loading history..."})})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-slate-900",children:"Key History"}),c.jsx("p",{className:"text-slate-600 mt-1",children:"Track key movements and reassignments"})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition",children:[c.jsx(CR,{className:"w-4 h-4"}),c.jsx("span",{children:"Refresh"})]}),c.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[c.jsx(Qn,{className:"w-4 h-4"}),c.jsx("span",{children:"Export"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[c.jsxs("div",{className:"p-4 border-b space-y-4",children:[c.jsx("div",{className:"flex gap-4",children:c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Ii,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-5 h-5"}),c.jsx("input",{type:"text",placeholder:"Search by key code, system, or room...",value:s,onChange:v=>i(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none"})]})}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[c.jsx(Cv,{className:"w-4 h-4 inline mr-1"}),"Type"]}),c.jsxs("select",{value:a,onChange:v=>o(v.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",children:[c.jsx("option",{value:"all",children:"All Types"}),c.jsx("option",{value:"initial_assignment",children:"Initial Assignment"}),c.jsx("option",{value:"room_change",children:"Room Change"}),c.jsx("option",{value:"recycled",children:"Recycled"}),c.jsx("option",{value:"unassigned",children:"Unassigned"})]})]}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:[c.jsx(Cv,{className:"w-4 h-4 inline mr-1"}),"Building"]}),c.jsxs("select",{value:d,onChange:v=>h(v.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-slate-900 focus:border-transparent outline-none",children:[c.jsx("option",{value:"",children:"All Buildings"}),l.map(v=>c.jsx("option",{value:v.id,children:v.name},v.id))]})]})]}),c.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",w.length," of ",t.length," records"]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"Key Code"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"Type"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"From"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"To"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"Reason"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-600 uppercase",children:"By"})]})}),c.jsx("tbody",{className:"divide-y divide-slate-200",children:w.length===0?c.jsx("tr",{children:c.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center text-slate-500",children:[c.jsx(xu,{className:"w-12 h-12 mx-auto mb-2 text-slate-300"}),c.jsx("p",{children:"No history records found"})]})}):w.map(v=>c.jsxs("tr",{className:"hover:bg-slate-50 transition",children:[c.jsxs("td",{className:"px-4 py-3 text-sm text-slate-600",children:[new Date(v.reassigned_at).toLocaleDateString(),c.jsx("br",{}),c.jsx("span",{className:"text-xs text-slate-400",children:new Date(v.reassigned_at).toLocaleTimeString()})]}),c.jsxs("td",{className:"px-4 py-3",children:[c.jsx("div",{className:"font-medium text-slate-900",children:v.key_code}),c.jsx("div",{className:"text-xs text-slate-500",children:v.key_system_name})]}),c.jsx("td",{className:"px-4 py-3",children:c.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${m(v.reassignment_type)}`,children:g(v.reassignment_type)})}),c.jsx("td",{className:"px-4 py-3 text-sm",children:v.previous_building&&v.previous_room?c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:v.previous_building}),c.jsxs("div",{className:"text-xs text-slate-500",children:["Room ",v.previous_room]})]}):c.jsx("span",{className:"text-slate-400",children:"-"})}),c.jsx("td",{className:"px-4 py-3 text-sm",children:v.reassignment_type==="unassigned"?c.jsx("span",{className:"text-slate-500 italic",children:"Unassigned"}):v.new_building&&v.new_room?c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-slate-900",children:v.new_building}),c.jsxs("div",{className:"text-xs text-slate-500",children:["Room ",v.new_room]})]}):c.jsx("span",{className:"text-slate-400",children:"-"})}),c.jsxs("td",{className:"px-4 py-3 text-sm text-slate-600",children:[v.reassignment_reason,v.notes&&c.jsx("div",{className:"text-xs text-slate-400 mt-1",children:v.notes})]}),c.jsx("td",{className:"px-4 py-3 text-sm text-slate-600",children:v.reassigned_by_name||"System"})]},v.id))})]})})]})]})}function FD(){const{user:t,profile:e,loading:r}=en(),[n,s]=Y.useState("dashboard"),[i,a]=Y.useState(!1),[o,l]=Y.useState(!0);Y.useEffect(()=>{u()},[]),Y.useEffect(()=>{!i&&ui()&&lR()},[i]);const u=async()=>{try{const h=localStorage.getItem("setup_complete"),f=localStorage.getItem("database_type");if(!h||!f){a(!0),l(!1);return}if(f==="supabase"){const p=ui();if(!p){a(!0),l(!1);return}const g=`${p.url}/functions/v1/check-setup`,m=await fetch(g,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p.anonKey}`}}),w=await m.json();m.ok?a(w.needsSetup):(console.error("Error checking setup:",w.error),a(!0))}else a(!1)}catch(h){console.error("Error checking setup:",h),a(!0)}finally{l(!1)}};if(r||o)return c.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-slate-200 border-t-slate-900 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-slate-600",children:"Loading..."})]})});if(i)return c.jsx(RR,{});if(!t||!e)return c.jsx(OR,{});if(e.temporary_password)return c.jsx(PR,{});const d=()=>{switch(n){case"dashboard":return c.jsx(bv,{});case"campuses":return c.jsx(jR,{});case"buildings":return c.jsx(MR,{});case"key-systems":return c.jsx(DR,{});case"keys":return c.jsx(kD,{});case"reports":return c.jsx(ID,{});case"users":return c.jsx(RD,{});case"audit-logs":return c.jsx(OD,{});case"error-reports":return c.jsx(PD,{});case"backup":return c.jsx(jD,{});case"system-config":return c.jsx(MD,{});case"key-history":return c.jsx(DD,{});default:return c.jsx(bv,{})}};return c.jsx(LR,{currentView:n,onNavigate:s,children:d()})}function UD(){return c.jsx(dR,{children:c.jsx(FD,{})})}const _h=hd(),BD=_h!=null&&_h.clientId?new fu(cR()):new fu({auth:{clientId:"dummy-client-id",authority:"https://login.microsoftonline.com/common",redirectUri:window.location.origin},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}});b1(document.getElementById("root")).render(c.jsx(Y.StrictMode,{children:c.jsx(Vk,{instance:BD,children:c.jsx(UD,{})})}));export{D_ as c};
